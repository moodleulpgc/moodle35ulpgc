{"version":3,"sources":["../src/graphelements.js"],"names":["define","util","Node","parent","x","y","mouseOffsetX","mouseOffsetY","isAcceptState","text","prototype","setMouseStart","mouseX","mouseY","setAnchorPoint","trackMouse","draw","c","beginPath","arc","nodeRadius","Math","PI","stroke","drawText","closestPointOnCircle","dx","dy","scale","sqrt","containsPoint","neighbours","links","link","i","length","Link","nodeA","includes","nodeB","push","traverseGraph","visited","neighbour","a","b","lineAngleAdjust","parallelPart","perpendicularPart","getAnchorPoint","abs","SNAP_TO_PADDING","getEndPointsAndCircle","midX","midY","start","end","anchor","circle","circleFromThreePoints","isReversed","reverseScale","rRatio","radius","startAngle","atan2","endAngle","startX","cos","startY","sin","endX","endY","linkInfo","textX","textY","textAngle","hasCircle","circleX","circleY","circleRadius","moveTo","lineTo","arrowIfReqd","distance","HIT_TARGET_PADDING","angle","temp","percent","SelfLink","node","mouse","anchorAngle","mouseOffsetAngle","snap","round","StartLink","deltaX","deltaY","getEndPoints","endPoints","TemporaryLink","from","to","HelpBox","topX","topY","BUTTON_WIDTH","BUTTON_HEIGHT","TEXT_OFFSET_X","TEXT_OFFSET_Y","LINE_HEIGHT","HELP_INDENT","isSelected","mouseIsOver","lines","helpText","fillStyle","fillRect","lineWidth","strokeStyle","strokeRect","font","textAlign","fillText","split"],"mappings":"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","sourcesContent":["/******************************************************************************\n *\n * A module for use by ui_graph, defining classes Node, Link, SelfLink,\n * StartLink and TemporaryLink\n *\n ******************************************************************************/\n// This code is a modified version of Finite State Machine Designer\n// (http://madebyevan.com/fsm/)\n/*\n Finite State Machine Designer (http://madebyevan.com/fsm/)\n License: MIT License (see below)\n Copyright (c) 2010 Evan Wallace\n Permission is hereby granted, free of charge, to any person\n obtaining a copy of this software and associated documentation\n files (the \"Software\"), to deal in the Software without\n restriction, including without limitation the rights to use,\n copy, modify, merge, publish, distribute, sublicense, and/or sell\n copies of the Software, and to permit persons to whom the\n Software is furnished to do so, subject to the following\n conditions:\n The above copyright notice and this permission notice shall be\n included in all copies or substantial portions of the Software.\n THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n OTHER DEALINGS IN THE SOFTWARE.\n*/\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more util.details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n\ndefine(['qtype_coderunner/graphutil'], function(util) {\n\n    /***********************************************************************\n     *\n     * Define a class Node that represents a node in a graph\n     *\n     ***********************************************************************/\n\n    function Node(parent, x, y) {\n        this.parent = parent;  // The ui_graph instance.\n        this.x = x;\n        this.y = y;\n        this.mouseOffsetX = 0;\n        this.mouseOffsetY = 0;\n        this.isAcceptState = false;\n        this.text = '';\n    }\n\n    // At the start of a drag, record our position relative to the mouse.\n    Node.prototype.setMouseStart = function(mouseX, mouseY) {\n        this.mouseOffsetX = this.x - mouseX;\n        this.mouseOffsetY = this.y - mouseY;\n    };\n\n    Node.prototype.setAnchorPoint = function(x, y) {\n        this.x = x + this.mouseOffsetX;\n        this.y = y + this.mouseOffsetY;\n    };\n\n    // Given a new mouse position during a drag, move to the appropriate\n    // new position.\n    Node.prototype.trackMouse = function(mouseX, mouseY) {\n        this.x = this.mouseOffsetX + mouseX;\n        this.y = this.mouseOffsetY + mouseY;\n    };\n\n    Node.prototype.draw = function(c) {\n        // Draw the circle.\n        c.beginPath();\n        c.arc(this.x, this.y, this.parent.nodeRadius(), 0, 2 * Math.PI, false);\n        c.stroke();\n\n        // Draw the text.\n        this.parent.drawText(this.text, this.x, this.y, null, this);\n\n        // Draw a double circle for an accept state.\n        if(this.isAcceptState) {\n            c.beginPath();\n            c.arc(this.x, this.y, this.parent.nodeRadius() - 6, 0, 2 * Math.PI, false);\n            c.stroke();\n        }\n    };\n\n    Node.prototype.closestPointOnCircle = function(x, y) {\n        var dx = x - this.x;\n        var dy = y - this.y;\n        var scale = Math.sqrt(dx * dx + dy * dy);\n        return {\n            'x': this.x + dx * this.parent.nodeRadius() / scale,\n            'y': this.y + dy * this.parent.nodeRadius() / scale,\n        };\n    };\n\n    Node.prototype.containsPoint = function(x, y) {\n        return (x - this.x) * (x - this.x) + (y - this.y) * (y - this.y) < this.parent.nodeRadius() * this.parent.nodeRadius();\n    };\n\n    // Method of a Node that, given a list of all links in a graph, returns\n    // a list of any nodes that contain a link to this node (excluding StartLinks\n    // and SelfLinks).\n    Node.prototype.neighbours = function(links) {\n        var neighbours = [], link;\n        for (var i = 0; i < links.length; i++) {\n            link = links[i];\n            if (link instanceof Link) { // Exclude SelfLinks and StartLinks.\n                if (link.nodeA === this && !neighbours.includes(link.nodeB)) {\n                    neighbours.push(link.nodeB);\n                } else if (link.nodeB === this && !neighbours.includes(link.nodeA)) {\n                    neighbours.push(link.nodeA);\n                }\n            }\n        }\n        return neighbours;\n    };\n\n    // Method of Node that traverses a graph defined by a given set of links\n    // starting at 'this' node and updating the visited list for each new\n    // node. Returns the updated visited list, which (for the root call)\n    // is a list of all nodes connected to the given start node.\n    Node.prototype.traverseGraph = function(links, visited) {\n        var neighbours,\n            neighbour;\n        if (!visited.includes(this)) {\n            visited.push(this);\n            neighbours = this.neighbours(links);\n            for (var i = 0; i < neighbours.length; i++) {\n                neighbour = neighbours[i];\n                if (!visited.includes(neighbour)) {\n                    neighbour.traverseGraph(links, visited);\n                }\n            }\n        }\n        return visited;\n    };\n\n    /***********************************************************************\n     *\n     * Define a class Link that represents a connection between two nodes.\n     *\n     ***********************************************************************/\n    function Link(parent, a, b) {\n        this.parent = parent;  // The parent ui_digraph instance.\n        this.nodeA = a;\n        this.nodeB = b;\n        this.text = '';\n        this.lineAngleAdjust = 0; // Value to add to textAngle when link is straight line.\n\n        // Make anchor point relative to the locations of nodeA and nodeB.\n        this.parallelPart = 0.5;    // Percentage from nodeA to nodeB.\n        this.perpendicularPart = 0; // Pixels from line between nodeA and nodeB.\n    }\n\n    Link.prototype.getAnchorPoint = function() {\n        var dx = this.nodeB.x - this.nodeA.x;\n        var dy = this.nodeB.y - this.nodeA.y;\n        var scale = Math.sqrt(dx * dx + dy * dy);\n        return {\n            'x': this.nodeA.x + dx * this.parallelPart - dy * this.perpendicularPart / scale,\n            'y': this.nodeA.y + dy * this.parallelPart + dx * this.perpendicularPart / scale\n        };\n    };\n\n    Link.prototype.setAnchorPoint = function(x, y) {\n        var dx = this.nodeB.x - this.nodeA.x;\n        var dy = this.nodeB.y - this.nodeA.y;\n        var scale = Math.sqrt(dx * dx + dy * dy);\n        this.parallelPart = (dx * (x - this.nodeA.x) + dy * (y - this.nodeA.y)) / (scale * scale);\n        this.perpendicularPart = (dx * (y - this.nodeA.y) - dy * (x - this.nodeA.x)) / scale;\n        // Snap to a straight line.\n        if(this.parallelPart > 0 && this.parallelPart < 1 && Math.abs(this.perpendicularPart) < this.parent.SNAP_TO_PADDING) {\n            this.lineAngleAdjust = (this.perpendicularPart < 0) * Math.PI;\n            this.perpendicularPart = 0;\n        }\n    };\n\n    Link.prototype.getEndPointsAndCircle = function() {\n        if(this.perpendicularPart === 0) {\n            var midX = (this.nodeA.x + this.nodeB.x) / 2;\n            var midY = (this.nodeA.y + this.nodeB.y) / 2;\n            var start = this.nodeA.closestPointOnCircle(midX, midY);\n            var end = this.nodeB.closestPointOnCircle(midX, midY);\n            return {\n                'hasCircle': false,\n                'startX': start.x,\n                'startY': start.y,\n                'endX': end.x,\n                'endY': end.y,\n            };\n        }\n        var anchor = this.getAnchorPoint();\n        var circle = util.circleFromThreePoints(this.nodeA.x, this.nodeA.y, this.nodeB.x, this.nodeB.y, anchor.x, anchor.y);\n        var isReversed = (this.perpendicularPart > 0);\n        var reverseScale = isReversed ? 1 : -1;\n        var rRatio = reverseScale * this.parent.nodeRadius() / circle.radius;\n        var startAngle = Math.atan2(this.nodeA.y - circle.y, this.nodeA.x - circle.x) - rRatio;\n        var endAngle = Math.atan2(this.nodeB.y - circle.y, this.nodeB.x - circle.x) + rRatio;\n        var startX = circle.x + circle.radius * Math.cos(startAngle);\n        var startY = circle.y + circle.radius * Math.sin(startAngle);\n        var endX = circle.x + circle.radius * Math.cos(endAngle);\n        var endY = circle.y + circle.radius * Math.sin(endAngle);\n        return {\n            'hasCircle': true,\n            'startX': startX,\n            'startY': startY,\n            'endX': endX,\n            'endY': endY,\n            'startAngle': startAngle,\n            'endAngle': endAngle,\n            'circleX': circle.x,\n            'circleY': circle.y,\n            'circleRadius': circle.radius,\n            'reverseScale': reverseScale,\n            'isReversed': isReversed,\n        };\n    };\n\n    Link.prototype.draw = function(c) {\n        var linkInfo = this.getEndPointsAndCircle(), textX, textY, textAngle;\n        // Draw arc.\n        c.beginPath();\n        if(linkInfo.hasCircle) {\n            c.arc(linkInfo.circleX,\n                  linkInfo.circleY,\n                  linkInfo.circleRadius,\n                  linkInfo.startAngle,\n                  linkInfo.endAngle,\n                  linkInfo.isReversed);\n        } else {\n            c.moveTo(linkInfo.startX, linkInfo.startY);\n            c.lineTo(linkInfo.endX, linkInfo.endY);\n        }\n        c.stroke();\n        // Draw the head of the arrow.\n        if(linkInfo.hasCircle) {\n            this.parent.arrowIfReqd(c,\n                      linkInfo.endX,\n                      linkInfo.endY,\n                      linkInfo.endAngle - linkInfo.reverseScale * (Math.PI / 2));\n        } else {\n            this.parent.arrowIfReqd(c,\n                      linkInfo.endX,\n                      linkInfo.endY,\n                      Math.atan2(linkInfo.endY - linkInfo.startY, linkInfo.endX - linkInfo.startX));\n        }\n        // Draw the text.\n        if(linkInfo.hasCircle) {\n            var startAngle = linkInfo.startAngle;\n            var endAngle = linkInfo.endAngle;\n            if(endAngle < startAngle) {\n                endAngle += Math.PI * 2;\n            }\n            textAngle = (startAngle + endAngle) / 2 + linkInfo.isReversed * Math.PI;\n            textX = linkInfo.circleX + linkInfo.circleRadius * Math.cos(textAngle);\n            textY = linkInfo.circleY + linkInfo.circleRadius * Math.sin(textAngle);\n            this.parent.drawText(this.text, textX, textY, textAngle, this);\n        } else {\n            textX = (linkInfo.startX + linkInfo.endX) / 2;\n            textY = (linkInfo.startY + linkInfo.endY) / 2;\n            textAngle = Math.atan2(linkInfo.endX - linkInfo.startX, linkInfo.startY - linkInfo.endY);\n            this.parent.drawText(this.text, textX, textY, textAngle + this.lineAngleAdjust, this);\n        }\n    };\n\n    Link.prototype.containsPoint = function(x, y) {\n        var linkInfo = this.getEndPointsAndCircle(), dx, dy, distance;\n        if(linkInfo.hasCircle) {\n            dx = x - linkInfo.circleX;\n            dy = y - linkInfo.circleY;\n            distance = Math.sqrt(dx * dx + dy * dy) - linkInfo.circleRadius;\n            if(Math.abs(distance) < this.parent.HIT_TARGET_PADDING) {\n                var angle = Math.atan2(dy, dx);\n                var startAngle = linkInfo.startAngle;\n                var endAngle = linkInfo.endAngle;\n                if(linkInfo.isReversed) {\n                    var temp = startAngle;\n                    startAngle = endAngle;\n                    endAngle = temp;\n                }\n                if(endAngle < startAngle) {\n                    endAngle += Math.PI * 2;\n                }\n                if(angle < startAngle) {\n                    angle += Math.PI * 2;\n                } else if(angle > endAngle) {\n                    angle -= Math.PI * 2;\n                }\n                return (angle > startAngle && angle < endAngle);\n            }\n        } else {\n            dx = linkInfo.endX - linkInfo.startX;\n            dy = linkInfo.endY - linkInfo.startY;\n            var length = Math.sqrt(dx * dx + dy * dy);\n            var percent = (dx * (x - linkInfo.startX) + dy * (y - linkInfo.startY)) / (length * length);\n            distance = (dx * (y - linkInfo.startY) - dy * (x - linkInfo.startX)) / length;\n            return (percent > 0 && percent < 1 && Math.abs(distance) < this.parent.HIT_TARGET_PADDING);\n        }\n        return false;\n    };\n\n    /***********************************************************************\n     *\n     * Define a class SelfLink that represents a connection from a node back\n     * to itself.\n     *\n     ***********************************************************************/\n\n    function SelfLink(parent, node, mouse) {\n        this.parent = parent;\n        this.node = node;\n        this.anchorAngle = 0;\n        this.mouseOffsetAngle = 0;\n        this.text = '';\n\n        if(mouse) {\n            this.setAnchorPoint(mouse.x, mouse.y);\n        }\n    }\n\n    SelfLink.prototype.setMouseStart = function(x, y) {\n        this.mouseOffsetAngle = this.anchorAngle - Math.atan2(y - this.node.y, x - this.node.x);\n    };\n\n    SelfLink.prototype.setAnchorPoint = function(x, y) {\n        this.anchorAngle = Math.atan2(y - this.node.y, x - this.node.x) + this.mouseOffsetAngle;\n        // Snap to 90 degrees.\n        var snap = Math.round(this.anchorAngle / (Math.PI / 2)) * (Math.PI / 2);\n        if(Math.abs(this.anchorAngle - snap) < 0.1) {\n            this.anchorAngle = snap;\n        }\n        // Keep in the range -pi to pi so our containsPoint() function always works.\n        if(this.anchorAngle < -Math.PI) {\n            this.anchorAngle += 2 * Math.PI;\n        }\n        if(this.anchorAngle > Math.PI) {\n            this.anchorAngle -= 2 * Math.PI;\n        }\n    };\n\n    SelfLink.prototype.getEndPointsAndCircle = function() {\n        var circleX = this.node.x + 1.5 * this.parent.nodeRadius() * Math.cos(this.anchorAngle);\n        var circleY = this.node.y + 1.5 * this.parent.nodeRadius() * Math.sin(this.anchorAngle);\n        var circleRadius = 0.75 * this.parent.nodeRadius();\n        var startAngle = this.anchorAngle - Math.PI * 0.8;\n        var endAngle = this.anchorAngle + Math.PI * 0.8;\n        var startX = circleX + circleRadius * Math.cos(startAngle);\n        var startY = circleY + circleRadius * Math.sin(startAngle);\n        var endX = circleX + circleRadius * Math.cos(endAngle);\n        var endY = circleY + circleRadius * Math.sin(endAngle);\n        return {\n            'hasCircle': true,\n            'startX': startX,\n            'startY': startY,\n            'endX': endX,\n            'endY': endY,\n            'startAngle': startAngle,\n            'endAngle': endAngle,\n            'circleX': circleX,\n            'circleY': circleY,\n            'circleRadius': circleRadius\n        };\n    };\n\n    SelfLink.prototype.draw = function(c) {\n        var linkInfo = this.getEndPointsAndCircle();\n        // Draw arc.\n        c.beginPath();\n        c.arc(linkInfo.circleX, linkInfo.circleY, linkInfo.circleRadius, linkInfo.startAngle, linkInfo.endAngle, false);\n        c.stroke();\n        // Draw the text on the loop farthest from the node.\n        var textX = linkInfo.circleX + linkInfo.circleRadius * Math.cos(this.anchorAngle);\n        var textY = linkInfo.circleY + linkInfo.circleRadius * Math.sin(this.anchorAngle);\n        this.parent.drawText(this.text, textX, textY, this.anchorAngle, this);\n        // Draw the head of the arrow.\n        this.parent.arrowIfReqd(c, linkInfo.endX, linkInfo.endY, linkInfo.endAngle + Math.PI * 0.4);\n    };\n\n    SelfLink.prototype.containsPoint = function(x, y) {\n        var linkInfo = this.getEndPointsAndCircle();\n        var dx = x - linkInfo.circleX;\n        var dy = y - linkInfo.circleY;\n        var distance = Math.sqrt(dx * dx + dy * dy) - linkInfo.circleRadius;\n        return (Math.abs(distance) < this.parent.HIT_TARGET_PADDING);\n    };\n\n    /***********************************************************************\n     *\n     * Define a class StartLink that represents a start link in a finite\n     * state machine. Not useful in general digraphs.\n     *\n     ***********************************************************************/\n    function StartLink(parent, node, start) {\n        this.parent = parent;\n        this.node = node;\n        this.deltaX = 0;\n        this.deltaY = 0;\n\n        if(start) {\n            this.setAnchorPoint(start.x, start.y);\n        }\n    }\n\n    StartLink.prototype.setAnchorPoint = function(x, y) {\n        this.deltaX = x - this.node.x;\n        this.deltaY = y - this.node.y;\n\n        if(Math.abs(this.deltaX) < this.parent.SNAP_TO_PADDING) {\n            this.deltaX = 0;\n        }\n\n        if(Math.abs(this.deltaY) < this.parent.SNAP_TO_PADDING) {\n            this.deltaY = 0;\n        }\n    };\n\n    StartLink.prototype.getEndPoints = function() {\n        var startX = this.node.x + this.deltaX;\n        var startY = this.node.y + this.deltaY;\n        var end = this.node.closestPointOnCircle(startX, startY);\n        return {\n            'startX': startX,\n            'startY': startY,\n            'endX': end.x,\n            'endY': end.y,\n        };\n    };\n\n    StartLink.prototype.draw = function(c) {\n        var endPoints = this.getEndPoints();\n\n        // Draw the line.\n        c.beginPath();\n        c.moveTo(endPoints.startX, endPoints.startY);\n        c.lineTo(endPoints.endX, endPoints.endY);\n        c.stroke();\n\n        // Draw the head of the arrow.\n        this.parent.arrowIfReqd(c, endPoints.endX, endPoints.endY, Math.atan2(-this.deltaY, -this.deltaX));\n    };\n\n    StartLink.prototype.containsPoint = function(x, y) {\n        var endPoints = this.getEndPoints();\n        var dx = endPoints.endX - endPoints.startX;\n        var dy = endPoints.endY - endPoints.startY;\n        var length = Math.sqrt(dx * dx + dy * dy);\n        var percent = (dx * (x - endPoints.startX) + dy * (y - endPoints.startY)) / (length * length);\n        var distance = (dx * (y - endPoints.startY) - dy * (x - endPoints.startX)) / length;\n        return (percent > 0 && percent < 1 && Math.abs(distance) < this.parent.HIT_TARGET_PADDING);\n    };\n\n    /***********************************************************************\n     *\n     * Define a class TemporaryLink that represents a link that's in the\n     * process of being created.\n     *\n     ***********************************************************************/\n\n    function TemporaryLink(parent, from, to) {\n        this.parent = parent;\n        this.from = from;\n        this.to = to;\n    }\n\n    TemporaryLink.prototype.draw = function(c) {\n        // Draw the line.\n        c.beginPath();\n        c.moveTo(this.to.x, this.to.y);\n        c.lineTo(this.from.x, this.from.y);\n        c.stroke();\n\n        // Draw the head of the arrow.\n        this.parent.arrowIfReqd(c, this.to.x, this.to.y, Math.atan2(this.to.y - this.from.y, this.to.x - this.from.x));\n    };\n\n    /***********************************************************************\n     *\n     * Define a class HelpBox for the help box and its pseudo-menu buttonb.\n     *\n     ***********************************************************************/\n\n    function HelpBox(parent, topX, topY) {\n        this.BUTTON_WIDTH = 50;\n        this.BUTTON_HEIGHT = 25;\n        this.TEXT_OFFSET_X = 25;\n        this.TEXT_OFFSET_Y = 17;\n        this.LINE_HEIGHT = 18;\n        this.HELP_INDENT = 5;\n        this.topX = topX;\n        this.topY = topY;\n        this.parent = parent;\n    }\n\n    HelpBox.prototype.containsPoint = function(x, y) {\n        return x >= this.topX && y >= this.topY &&\n                x <= this.topX + this.BUTTON_WIDTH &&\n                y <= this.topY + this.BUTTON_HEIGHT;\n    };\n\n    HelpBox.prototype.draw = function(c, isSelected, mouseIsOver) {\n        var lines, i, y, helpText;\n\n        if (mouseIsOver) {\n            c.fillStyle = '#FFFFFF';\n        } else {\n            c.fillStyle = '#F0F0F0';\n        }\n        c.fillRect(this.topX, this.topY,\n            this.topX + this.BUTTON_WIDTH, this.topY + this.BUTTON_HEIGHT);\n        c.lineWidth = 0.5;\n        c.strokeStyle = '#000000';\n        c.strokeRect(this.topX, this.topY,\n            this.topX + this.BUTTON_WIDTH, this.topY + this.BUTTON_HEIGHT);\n\n        c.font = '12pt Arial';\n        c.fillStyle = '#000000';\n        c.textAlign = \"center\";\n        c.fillText('Help', this.topX + this.TEXT_OFFSET_X, this.topY + this.TEXT_OFFSET_Y);\n        c.textAlign = \"left\";\n\n        if (isSelected) {\n            helpText = this.parent.helpText;\n            c.font = '12pt Arial';\n            lines = helpText.split('\\n');\n            y = this.topY + this.BUTTON_HEIGHT;\n            for (i = 0; i < lines.length; i += 1) {\n                y += this.LINE_HEIGHT;\n                c.fillText(lines[i], this.topX + this.HELP_INDENT, y);\n            }\n        }\n    };\n\n    return {\n        Node: Node,\n        Link: Link,\n        SelfLink: SelfLink,\n        TemporaryLink: TemporaryLink,\n        StartLink: StartLink,\n        HelpBox: HelpBox\n    };\n});"],"file":"graphelements.min.js"}