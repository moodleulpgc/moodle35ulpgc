define ("qtype_coderunner/authorform",["jquery","qtype_coderunner/userinterfacewrapper"],function(a,b){var c={template:["#id_template","value",""],iscombinatortemplate:["#id_iscombinatortemplate","checked","",function(a){return"1"===a?!0:!1}],cputimelimitsecs:["#id_cputimelimitsecs","value",""],memlimitmb:["#id_memlimitmb","value",""],sandbox:["#id_sandbox","value","DEFAULT"],sandboxparams:["#id_sandboxparams","value",""],testsplitterre:["#id_testsplitterre","value","",function(a){return a.replace("\n","\\n")}],allowmultiplestdins:["#id_allowmultiplestdins","checked","",function(a){return"1"===a?!0:!1}],grader:["#id_grader","value","EqualityGrader"],resultcolumns:["#id_resultcolumns","value",""],language:["#id_language","value",""],acelang:["#id_acelang","value",""],uiplugin:["#id_uiplugin","value","ace"]};return{initEditForm:function(d){var r=a("#id_coderunnertype"),s=a("#id_template"),t=a("#id_globalextra"),u=a("#id_useace"),v=a("#id_language"),w=a("#id_acelang"),x=a("#id_customise"),y=a("#id_iscombinatortemplate"),z=a("#id_testsplitterre"),A=a("#id_allowmultiplestdins"),B=a("#id_customisationheader"),C=a("#id_advancedcustomisationheader"),D=x.prop("checked"),E=a("#id_prototypetype"),F=a("#id_answerpreloadhdr"),G=a("#id_typename"),H=a("input[name=\"courseid\"]").prop("value"),I=a("#qtype-help"),J=a("select#id_precheck"),K=a("div.testtype"),L=a("#id_missing_prototype"),N=a("#id_uiplugin");function e(c,d){var e=a(document.getElementById(c)),f,g=e.attr("data-lang"),h=e.attr("data-params"),i={},j;e.attr("data-globalextra",t.val());e.attr("data-test0",a("#id_testcode_0").val());try{i=JSON.parse(h)}catch(a){}d=d.toLowerCase();if("none"===d){d=""}if("id_templateparams"==c){f=""}else{f=v.prop("value");if("id_template"!==c&&w.prop("value")){f=m(w.prop("value"))}}j=e.data("current-ui-wrapper");if(j&&j.uiname===d&&g==f){return}e.attr("data-lang",f);if(!j){j=new b.InterfaceWrapper(d,c)}else{i.lang=f;j.loadUi(d,i)}}function f(){var a=N.val();if(a&&"html"!==a){e("id_answer",a);e("id_answerpreload",a)}}function g(a){var b=a?"block":"none";B.css("display",b);C.css("display",b);if(a&&u.prop("checked")){e("id_template","ace")}}function h(){var a=y.prop("checked");z.prop("disabled",!a);A.prop("disabled",!a)}function i(b,d){var e,f,i;for(var j in c){e=c[j];f=d[j]?d[j]:e[2];if(3<e.length){i=e[3];f=i(f)}a(e[0]).prop(e[1],f)}G.prop("value",b);x.prop("checked",!1);I.html(k(b,d.questiontext));g(!1);h()}function j(a,b){var c;window.alert(l("prototype_load_failure")+b);c=l("prototype_error")+"\n";c+=b+"\n";c+="CourseId: "+H+", qtype: "+a;s.prop("value",c)}function k(a,b){var c="<p class=\"question-type-details-header\">";c+=l("coderunner_question_type");c+=a+"</p>\n"+b;return c}function l(a){return d[a]}function m(a){var b,c;if(0>a.indexOf(",")){return a}else{b=a.split(",");for(c=0;c<b.length;c++){if(b[c].endsWith("*")){return b[c].substr(0,b[c].length-1)}}return 0<b.length?b[0]:""}}function n(){var b=r.children("option:selected").text();if(""!==b&&"Undefined"!==b){r.children("option:first-child").prop("disabled","disabled");a.getJSON(M.cfg.wwwroot+"/question/type/coderunner/ajax.php",{qtype:b,courseid:H,sesskey:M.cfg.sesskey},function(a){if(a.success){i(b,a);f()}else{j(b,a.error)}}).fail(function(){window.alert(l("error_loading_prototype"));s.prop("value",l("ajax_error"))})}}function o(){if("3"===J.val()){K.show()}else{K.hide()}}function p(){if("ace"===N.val()){f()}}function q(){if(u.prop("checked")){e("id_template","ace")}}if(1==E.prop("value")){window.alert(l("proceed_at_own_risk"));E.prop("disabled",!0);r.prop("disabled",!0);x.prop("disabled",!0)}(function(){var b=L.prop("value"),c=null;if(""!==b){c=a("<p>"+L.prop("value")+"</p>");a("#id_qtype_coderunner_error_div").append(c)}})();g(D);if(!D){n()}else{f();I.html("<p>"+l("info_unavailable")+"</p>")}o();if(u.prop("checked")){e("id_templateparams","ace")}x.on("change",function(){var a=x.prop("checked");if(a){g(!0)}else{if(window.confirm(l("confirm_proceed"))){g(!1)}else{x.prop("checked",!0)}}});w.on("change",p);v.on("change",function(){q();p()});r.on("change",function(){if(!x.prop("checked")||window.confirm(l("question_type_changed"))){n()}});u.on("change",function(){var a=u.prop("checked");if(a){e("id_template","ace");e("id_templateparams","ace")}else{e("id_template","");e("id_templateparams","")}});N.on("change",f);J.on("change",o);var O=new MutationObserver(function(){f()});O.observe(F.get(0),{attributes:!0});a("button.replaceexpectedwithgot").click(function(){var b=a(this).prev("pre[id^=\"id_got_\"]"),c=b.attr("id").replace("id_got_","");a("#id_expected_"+c).val(b.text());a("#id_fail_expected_"+c).html(b.text());a(".failrow_"+c).addClass("fixed");a(this).prop("disabled",!0)})}}});
//# sourceMappingURL=authorform.min.js.map
