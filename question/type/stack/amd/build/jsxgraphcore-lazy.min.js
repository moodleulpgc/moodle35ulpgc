define(function(){var requirejs,require,define;return function(a){function b(a,b){return s.call(a,b)}function c(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o=b&&b.split("/"),p=q.map,r=p&&p["*"]||{};if(a){for(a=a.split("/"),g=a.length-1,q.nodeIdCompat&&u.test(a[g])&&(a[g]=a[g].replace(u,"")),"."===a[0].charAt(0)&&o&&(n=o.slice(0,o.length-1),a=n.concat(a)),k=0;k<a.length;k++)if(m=a[k],"."===m)a.splice(k,1),k-=1;else if(".."===m){if(0===k||1===k&&".."===a[2]||".."===a[k-1])continue;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}if((o||r)&&p){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),o)for(l=o.length;l>0;l-=1)if(e=p[o.slice(0,l).join("/")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&r&&r[d]&&(i=r[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function d(b,c){return function(){var d=t.call(arguments,0);return"string"!=typeof d[0]&&1===d.length&&d.push(null),l.apply(a,d.concat([b,c]))}}function e(a){return function(b){return c(b,a)}}function f(a){return function(b){o[a]=b}}function g(c){if(b(p,c)){var d=p[c];delete p[c],r[c]=!0,k.apply(a,d)}if(!b(o,c)&&!b(r,c))throw new Error("No "+c);return o[c]}function h(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function i(a){return a?h(a):[]}function j(a){return function(){return q&&q.config&&q.config[a]||{}}}var k,l,m,n,o={},p={},q={},r={},s=Object.prototype.hasOwnProperty,t=[].slice,u=/\.js$/;m=function(a,b){var d,f=h(a),i=f[0],j=b[1];return a=f[1],i&&(i=c(i,j),d=g(i)),i?a=d&&d.normalize?d.normalize(a,e(j)):c(a,j):(a=c(a,j),f=h(a),i=f[0],a=f[1],i&&(d=g(i))),{f:i?i+"!"+a:a,n:a,pr:i,p:d}},n={require:function(a){return d(a)},exports:function(a){var b=o[a];return"undefined"!=typeof b?b:o[a]={}},module:function(a){return{id:a,uri:"",exports:o[a],config:j(a)}}},k=function(c,e,h,j){var k,l,q,s,t,u,v,w=[],x=typeof h;if(j=j||c,u=i(j),"undefined"===x||"function"===x){for(e=!e.length&&h.length?["require","exports","module"]:e,t=0;t<e.length;t+=1)if(s=m(e[t],u),l=s.f,"require"===l)w[t]=n.require(c);else if("exports"===l)w[t]=n.exports(c),v=!0;else if("module"===l)k=w[t]=n.module(c);else if(b(o,l)||b(p,l)||b(r,l))w[t]=g(l);else{if(!s.p)throw new Error(c+" missing "+l);s.p.load(s.n,d(j,!0),f(l),{}),w[t]=o[l]}q=h?h.apply(o[c],w):void 0,c&&(k&&k.exports!==a&&k.exports!==o[c]?o[c]=k.exports:q===a&&v||(o[c]=q))}else c&&(o[c]=h)},requirejs=require=l=function(b,c,d,e,f){if("string"==typeof b)return n[b]?n[b](c):g(m(b,i(c)).f);if(!b.splice){if(q=b,q.deps&&l(q.deps,q.callback),!c)return;c.splice?(b=c,c=d,d=null):b=a}return c=c||function(){},"function"==typeof d&&(d=e,e=f),e?k(a,b,c,d):setTimeout(function(){k(a,b,c,d)},4),l},l.config=function(a){return l(a)},requirejs._defined=o,define=function(a,c,d){if("string"!=typeof a)throw new Error("See almond README: incorrect module build, no module name");c.splice||(d=c,c=[]),b(o,a)||b(p,a)||(p[a]=[a,c,d])},define.amd={jQuery:!0}}(),define("../node_modules/almond/almond",function(){}),define("jxg",[],function(){"use strict";var a={};return"object"!=typeof JXG||JXG.extend||(a=JXG),a.extend=function(a,b,c,d){var e,f;c=c||!1,d=d||!1;for(e in b)(!c||c&&b.hasOwnProperty(e))&&(f=d?e.toLowerCase():e,a[f]=b[e])},a.extend(a,{boards:{},readers:{},elements:{},registerElement:function(a,b){a=a.toLowerCase(),this.elements[a]=b},registerReader:function(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c].toLowerCase(),"function"!=typeof this.readers[d]&&(this.readers[d]=a)},shortcut:function(a,b){return function(){return a[b].apply(this,arguments)}},getRef:function(b,c){return a.deprecated("JXG.getRef()","Board.select()"),b.select(c)},getReference:function(b,c){return a.deprecated("JXG.getReference()","Board.select()"),b.select(c)},getBoardByContainerId:function(a){var b;for(b in JXG.boards)if(JXG.boards.hasOwnProperty(b)&&JXG.boards[b].container===a)return JXG.boards[b];return null},deprecated:function(b,c){var d=b+" is deprecated.";c&&(d+=" Please use "+c+" instead."),a.warn(d)},warn:function(a){"object"==typeof window&&window.console&&console.warn?console.warn("WARNING:",a):"object"==typeof document&&document.getElementById("warning")&&(document.getElementById("debug").innerHTML+="WARNING: "+a+"<br />")},debugInt:function(a){var b,c;for(b=0;b<arguments.length;b++)c=arguments[b],"object"==typeof window&&window.console&&console.log?console.log(c):"object"==typeof document&&document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=c+"<br/>")},debugWST:function(b){var c=new Error;a.debugInt.apply(this,arguments),c&&c.stack&&(a.debugInt("stacktrace"),a.debugInt(c.stack.split("\n").slice(1).join("\n")))},debugLine:function(b){var c=new Error;a.debugInt.apply(this,arguments),c&&c.stack&&a.debugInt("Called from",c.stack.split("\n").slice(2,3).join("\n"))},debug:function(b){a.debugInt.apply(this,arguments)}}),a}),define("base/constants",["jxg"],function(a){"use strict";var b,c=0,d=99,e=7,f=!1,g=c+"."+d+"."+e+(f?"-"+f:"");return b={version:g,licenseText:"JSXGraph v"+g+" Copyright (C) see http://jsxgraph.org",COORDS_BY_USER:1,COORDS_BY_SCREEN:2,OBJECT_TYPE_ARC:1,OBJECT_TYPE_ARROW:2,OBJECT_TYPE_AXIS:3,OBJECT_TYPE_AXISPOINT:4,OBJECT_TYPE_TICKS:5,OBJECT_TYPE_CIRCLE:6,OBJECT_TYPE_CONIC:7,OBJECT_TYPE_CURVE:8,OBJECT_TYPE_GLIDER:9,OBJECT_TYPE_IMAGE:10,OBJECT_TYPE_LINE:11,OBJECT_TYPE_POINT:12,OBJECT_TYPE_SLIDER:13,OBJECT_TYPE_CAS:14,OBJECT_TYPE_GXTCAS:15,OBJECT_TYPE_POLYGON:16,OBJECT_TYPE_SECTOR:17,OBJECT_TYPE_TEXT:18,OBJECT_TYPE_ANGLE:19,OBJECT_TYPE_INTERSECTION:20,OBJECT_TYPE_TURTLE:21,OBJECT_TYPE_VECTOR:22,OBJECT_TYPE_OPROJECT:23,OBJECT_TYPE_GRID:24,OBJECT_TYPE_TANGENT:25,OBJECT_TYPE_HTMLSLIDER:26,OBJECT_TYPE_CHECKBOX:27,OBJECT_TYPE_INPUT:28,OBJECT_TYPE_BUTTON:29,OBJECT_TYPE_TRANSFORMATION:30,OBJECT_CLASS_POINT:1,OBJECT_CLASS_LINE:2,OBJECT_CLASS_CIRCLE:3,OBJECT_CLASS_CURVE:4,OBJECT_CLASS_AREA:5,OBJECT_CLASS_OTHER:6,OBJECT_CLASS_TEXT:7,GENTYPE_ABC:1,GENTYPE_AXIS:2,GENTYPE_MID:3,GENTYPE_REFLECTION:4,GENTYPE_MIRRORELEMENT:5,GENTYPE_TANGENT:6,GENTYPE_PARALLEL:7,GENTYPE_BISECTORLINES:8,GENTYPE_BOARDIMG:9,GENTYPE_BISECTOR:10,GENTYPE_NORMAL:11,GENTYPE_POINT:12,GENTYPE_GLIDER:13,GENTYPE_INTERSECTION:14,GENTYPE_CIRCLE:15,GENTYPE_CIRCLE2POINTS:16,GENTYPE_LINE:17,GENTYPE_TRIANGLE:18,GENTYPE_QUADRILATERAL:19,GENTYPE_TEXT:20,GENTYPE_POLYGON:21,GENTYPE_REGULARPOLYGON:22,GENTYPE_SECTOR:23,GENTYPE_ANGLE:24,GENTYPE_PLOT:25,GENTYPE_SLIDER:26,GENTYPE_TRUNCATE:27,GENTYPE_JCODE:28,GENTYPE_MOVEMENT:29,GENTYPE_COMBINED:30,GENTYPE_RULER:31,GENTYPE_SLOPETRIANGLE:32,GENTYPE_PERPSEGMENT:33,GENTYPE_LABELMOVEMENT:34,GENTYPE_VECTOR:35,GENTYPE_NONREFLEXANGLE:36,GENTYPE_REFLEXANGLE:37,GENTYPE_PATH:38,GENTYPE_DERIVATIVE:39,GENTYPE_DELETE:41,GENTYPE_COPY:42,GENTYPE_MIRROR:43,GENTYPE_ROTATE:44,GENTYPE_ABLATION:45,GENTYPE_MIGRATE:46,GENTYPE_VECTORCOPY:47,GENTYPE_CTX_TYPE_G:51,GENTYPE_CTX_TYPE_P:52,GENTYPE_CTX_TRACE:53,GENTYPE_CTX_VISIBILITY:54,GENTYPE_CTX_CCVISIBILITY:55,GENTYPE_CTX_MPVISIBILITY:56,GENTYPE_CTX_WITHLABEL:57,GENTYPE_CTX_LABEL:58,GENTYPE_CTX_FIXED:59,GENTYPE_CTX_STROKEWIDTH:60,GENTYPE_CTX_LABELSIZE:61,GENTYPE_CTX_SIZE:62,GENTYPE_CTX_FACE:63,GENTYPE_CTX_STRAIGHT:64,GENTYPE_CTX_ARROW:65,GENTYPE_CTX_COLOR:66,GENTYPE_CTX_RADIUS:67,GENTYPE_CTX_COORDS:68,GENTYPE_CTX_TEXT:69,GENTYPE_CTX_ANGLERADIUS:70,GENTYPE_CTX_DOTVISIBILITY:71,GENTYPE_CTX_FILLOPACITY:72,GENTYPE_CTX_PLOT:73,GENTYPE_CTX_SCALE:74,GENTYPE_CTX_INTVAL:75,GENTYPE_CTX_POINT1:76,GENTYPE_CTX_POINT2:77,GENTYPE_CTX_LABELSTICKY:78,GENTYPE_CTX_TYPE_I:79,GENTYPE_CTX_HASINNERPOINTS:80,GENTYPE_CTX_SNAPWIDTH:81,GENTYPE_CTX_SNAPTOGRID:82},a.extend(a,b),b}),define("utils/type",["jxg","base/constants"],function(a,b){"use strict";return a.extend(a,{isId:function(a,b){return"string"==typeof b&&!!a.objects[b]},isName:function(a,b){return"string"==typeof b&&!!a.elementsByName[b]},isGroup:function(a,b){return"string"==typeof b&&!!a.groups[b]},isString:function(a){return"string"==typeof a},isNumber:function(a){return"number"==typeof a||"[Object Number]"===Object.prototype.toString.call(a)},isFunction:function(a){return"function"==typeof a},isArray:function(a){var b;return b=Array.isArray?Array.isArray(a):null!==a&&"object"==typeof a&&"function"==typeof a.splice&&"function"==typeof a.join},isObject:function(a){return"object"==typeof a&&!this.isArray(a)},isPoint:function(a){return null!==a&&"object"==typeof a&&a.elementClass===b.OBJECT_CLASS_POINT},isPointType:function(a,b){var c,d;return!!this.isArray(b)||(!!(this.isFunction(b)&&(c=b(),this.isArray(c)&&c.length>1))||(d=a.select(b),this.isPoint(d)))},isTransformationOrArray:function(a){if(null!==a){if(this.isArray(a)&&a.length>0)return this.isTransformationOrArray(a[0]);if("object"==typeof a)return a.type===b.OBJECT_TYPE_TRANSFORMATION}return!1},exists:function(a){return function(b){return!(b===a||null===b)}}(),def:function(a,b){return this.exists(a)?a:b},str2Bool:function(a){return!this.exists(a)||("boolean"==typeof a?a:!!this.isString(a)&&"true"===a.toLowerCase())},createEvalFunction:function(b,c,d){var e,f=[];for(e=0;e<d;e++)f[e]=a.createFunction(c[e],b,"",!0);return function(a){return f[a]()}},createFunction:function(a,b,c,d){var e=null;return this.exists(d)&&!d||!this.isString(a)?this.isFunction(a)?e=a:this.isNumber(a)?e=function(){return a}:this.isString(a)&&(e=function(){return a}):e=b.jc.snippet(a,!0,c,!0),null!==e&&(e.origin=a),e},providePoints:function(a,b,c,d,e){var f,g,h,i,j,k=0,l=[];for(this.isArray(b)||(b=[b]),h=b.length,this.exists(e)&&(k=e.length),0===k&&(i=this.copyAttributes(c,a.options,d)),f=0;f<h;++f)if(k>0&&(g=Math.min(f,k-1),i=this.copyAttributes(c,a.options,d,e[g])),this.isArray(b[f])&&b[f].length>1?l.push(a.create("point",b[f],i)):this.isFunction(b[f])?(j=b[f](),this.isArray(j)&&j.length>1&&l.push(a.create("point",[b[f]],i))):l.push(a.select(b[f])),!this.isPoint(l[f]))return!1;return l},bind:function(a,b){return function(){return a.apply(b,arguments)}},evaluate:function(a){return this.isFunction(a)?a():a},indexOf:function(a,b,c){var d,e=this.exists(c);if(Array.indexOf&&!e)return a.indexOf(b);for(d=0;d<a.length;d++)if(e&&a[d][c]===b||!e&&a[d]===b)return d;return-1},eliminateDuplicates:function(a){var b,c=a.length,d=[],e={};for(b=0;b<c;b++)e[a[b]]=0;for(b in e)e.hasOwnProperty(b)&&d.push(b);return d},swap:function(a,b,c){var d;return d=a[b],a[b]=a[c],a[c]=d,a},uniqueArray:function(b){var c,d,e,f=[];if(0===b.length)return[];for(c=0;c<b.length;c++)if(e=this.isArray(b[c]),this.exists(b[c]))for(d=c+1;d<b.length;d++)e&&a.cmpArrays(b[c],b[d])?b[c]=[]:e||b[c]!==b[d]||(b[c]="");else b[c]="";for(d=0,c=0;c<b.length;c++)e=this.isArray(b[c]),e||""===b[c]?e&&0!==b[c].length&&(f[d]=b[c].slice(0),d++):(f[d]=b[c],d++);return b=f,f},isInArray:function(b,c){return a.indexOf(b,c)>-1},coordsArrayToMatrix:function(a,b){var c,d=[],e=[];for(c=0;c<a.length;c++)b?(d.push(a[c].usrCoords[1]),e.push(a[c].usrCoords[2])):e.push([a[c].usrCoords[1],a[c].usrCoords[2]]);return b&&(e=[d,e]),e},cmpArrays:function(a,b){var c;if(a===b)return!0;if(a.length!==b.length)return!1;for(c=0;c<a.length;c++)if(this.isArray(a[c])&&this.isArray(b[c])){if(!this.cmpArrays(a[c],b[c]))return!1}else if(a[c]!==b[c])return!1;return!0},removeElementFromArray:function(a,b){var c;for(c=0;c<a.length;c++)if(a[c]===b)return a.splice(c,1),a;return a},trunc:function(b,c){return c=a.def(c,0),this.toFixed(b,c)},_decimalAdjust:function(a,b,c){return void 0===c||0===+c?Math[a](b):(b=+b,c=+c,isNaN(b)||"number"!=typeof c||c%1!==0?NaN:(b=b.toString().split("e"),b=Math[a](+(b[0]+"e"+(b[1]?+b[1]-c:-c))),b=b.toString().split("e"),+(b[0]+"e"+(b[1]?+b[1]+c:c))))},_round10:function(a,b){return this._decimalAdjust("round",a,b)},_floor10:function(a,b){return this._decimalAdjust("floor",a,b)},_ceil10:function(a,b){return this._decimalAdjust("ceil",a,b)},toFixed:function(a,b){return this._round10(a,-b).toFixed(b)},autoDigits:function(a){var b,c=Math.abs(a);return b=c>.1?this.toFixed(a,2):c>=.01?this.toFixed(a,4):c>=1e-4?this.toFixed(a,6):a},keys:function(a,b){var c,d=[];for(c in a)b?a.hasOwnProperty(c)&&d.push(c):d.push(c);return d},clone:function(a){var b={};return b.prototype=a,b},cloneAndCopy:function(a,b){var c,d=function(){};d.prototype=a;for(c in b)d[c]=b[c];return d},merge:function(a,b){var c,d;for(c in b)if(b.hasOwnProperty(c))if(this.isArray(b[c]))for(a[c]||(a[c]=[]),d=0;d<b[c].length;d++)"object"==typeof b[c][d]?a[c][d]=this.merge(a[c][d],b[c][d]):a[c][d]=b[c][d];else"object"==typeof b[c]?(a[c]||(a[c]={}),a[c]=this.merge(a[c],b[c])):a[c]=b[c];return a},deepCopy:function(a,b,c){var d,e,f,g;if(c=c||!1,"object"!=typeof a||null===a)return a;if(this.isArray(a))for(d=[],e=0;e<a.length;e++)f=a[e],"object"==typeof f?this.exists(f.board)?d[e]=f.id:d[e]=this.deepCopy(f):d[e]=f;else{d={};for(e in a)a.hasOwnProperty(e)&&(g=c?e.toLowerCase():e,f=a[e],null!==f&&"object"==typeof f?this.exists(f.board)?d[g]=f.id:d[g]=this.deepCopy(f):d[g]=f);for(e in b)b.hasOwnProperty(e)&&(g=c?e.toLowerCase():e,f=b[e],"object"==typeof f?this.isArray(f)||!this.exists(d[g])?d[g]=this.deepCopy(f):d[g]=this.deepCopy(d[g],f,c):d[g]=f)}return d},copyAttributes:function(b,c,d){var e,f,g,h,i,j={circle:1,curve:1,image:1,line:1,point:1,polygon:1,text:1,ticks:1,integral:1};for(g=arguments.length,e=g<3||j[d]?a.deepCopy(c.elements,null,!0):{},g<4&&this.exists(d)&&this.exists(c.layer[d])&&(e.layer=c.layer[d]),h=c,i=!0,f=2;f<g;f++){if(!this.exists(h[arguments[f]])){i=!1;break}h=h[arguments[f]]}for(i&&(e=a.deepCopy(e,h,!0)),h=b,i=!0,f=3;f<g;f++){if(!this.exists(h[arguments[f]])){i=!1;break}h=h[arguments[f]]}for(i&&this.extend(e,h,null,!0),h=c,i=!0,f=2;f<g;f++){if(!this.exists(h[arguments[f]])){i=!1;break}h=h[arguments[f]]}return i&&this.exists(h.label)&&(e.label=a.deepCopy(h.label,e.label)),e.label=a.deepCopy(c.label,e.label),e},copyPrototypeMethods:function(a,b,c){var d;a.prototype[c]=b.prototype.constructor;for(d in b.prototype)b.prototype.hasOwnProperty(d)&&(a.prototype[d]=b.prototype[d])},toJSON:function(b,c){var d,e,f,g,h;if(c=a.def(c,!1),JSON.stringify&&!c)try{return g=JSON.stringify(b)}catch(i){}switch(typeof b){case"object":if(b){if(d=[],this.isArray(b)){for(f=0;f<b.length;f++)d.push(a.toJSON(b[f],c));return"["+d.join(",")+"]"}for(e in b)if(b.hasOwnProperty(e)){try{h=a.toJSON(b[e],c)}catch(j){h=""}c?d.push(e+":"+h):d.push('"'+e+'":'+h)}return"{"+d.join(",")+"} "}return"null";case"string":return"'"+b.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return b.toString()}return"0"},clearVisPropOld:function(a){return a.visPropOld={cssclass:"",cssdefaultstyle:"",cssstyle:"",fillcolor:"",fillopacity:"",firstarrow:!1,fontsize:-1,lastarrow:!1,left:-1e5,linecap:"",shadow:!1,strokecolor:"",strokeopacity:"",strokewidth:"",transitionduration:0,top:-1e5,visible:null},a},isInObject:function(a,b){var c;for(c in a)if(a.hasOwnProperty(c)&&a[c]===b)return!0;return!1},escapeHTML:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(a){return a.replace(/<\/?[^>]+>/gi,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},capitalize:function(a){return a.charAt(0).toUpperCase()+a.substring(1).toLowerCase()},trimNumber:function(a){return a=a.replace(/^0+/,""),a=a.replace(/0+$/,""),"."!==a[a.length-1]&&","!==a[a.length-1]||(a=a.slice(0,-1)),"."!==a[0]&&","!==a[0]||(a="0"+a),a},filterElements:function(a,b){var c,d,e,f,g,h,i,j=a.length,k=[];if("function"!=typeof b&&"object"!=typeof b)return k;for(c=0;c<j;c++){if(i=!0,e=a[c],"object"==typeof b){for(d in b)if(b.hasOwnProperty(d)&&(f=d.toLowerCase(),g="function"==typeof e[d]?e[d]():e[d],h=e.visProp&&"function"==typeof e.visProp[f]?e.visProp[f]():e.visProp&&e.visProp[f],i="function"==typeof b[d]?b[d](g)||b[d](h):g===b[d]||h===b[d],!i))break}else"function"==typeof b&&(i=b(e));i&&k.push(e)}return k},trim:function(a){return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},sanitizeHTML:function(a,b){return"function"==typeof html_sanitize&&b?html_sanitize(a,function(){},function(a){return a}):(a&&(a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;")),a)},evalSlider:function(a){return a&&a.type===b.OBJECT_TYPE_GLIDER&&"function"==typeof a.Value?a.Value():a}}),a}),define("utils/env",["jxg","utils/type"],function(a,b){"use strict";return a.extend(a,{touchProperty:"touches",isBrowser:"object"==typeof window&&"object"==typeof document,supportsVML:function(){return this.isBrowser&&!!document.namespaces},supportsSVG:function(){return this.isBrowser&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")},supportsCanvas:function(){var a,b=!1;if(this.isNode())try{a="object"==typeof module?module.require("canvas"):require("canvas"),b=!!a}catch(c){}return b||this.isBrowser&&!!document.createElement("canvas").getContext},isNode:function(){return!this.isBrowser&&("object"==typeof module&&!!module.exports||"object"==typeof global&&global.requirejsVars&&!global.requirejsVars.isBrowser)},isWebWorker:function(){return!this.isBrowser&&"object"==typeof self&&"function"==typeof self.postMessage},supportsPointerEvents:function(){return!!(this.isBrowser&&window.navigator&&(window.PointerEvent||window.navigator.pointerEnabled||window.navigator.msPointerEnabled))},isTouchDevice:function(){return this.isBrowser&&void 0!==window.ontouchstart},isAndroid:function(){return b.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")>-1},isWebkitAndroid:function(){return this.isAndroid()&&navigator.userAgent.indexOf(" AppleWebKit/")>-1},isApple:function(){return b.exists(navigator)&&(navigator.userAgent.indexOf("iPad")>-1||navigator.userAgent.indexOf("iPhone")>-1)},isWebkitApple:function(){return this.isApple()&&navigator.userAgent.search(/Mobile\/[0-9A-Za-z\.]*Safari/)>-1},isMetroApp:function(){return"object"==typeof window&&window.clientInformation&&window.clientInformation.appVersion&&window.clientInformation.appVersion.indexOf("MSAppHost")>-1},isMozilla:function(){return b.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1&&navigator.userAgent.toLowerCase().indexOf("apple")===-1},isFirefoxOS:function(){return b.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")===-1&&navigator.userAgent.toLowerCase().indexOf("apple")===-1&&navigator.userAgent.toLowerCase().indexOf("mobile")>-1&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1},ieVersion:function(){var a,b,c=3;if("object"!=typeof document)return 0;a=document.createElement("div"),b=a.getElementsByTagName("i");do a.innerHTML="<!--[if gt IE "+ ++c+"]><i></i><![endif]-->";while(b[0]);return c>4?c:void 0}(),getDimensions:function(a,c){var d,e,f,g,h,i,j,k,l,m=/\d+(\.\d*)?px/;if(!this.isBrowser||null===a)return{width:500,height:500};if(c=c||document,d=c.getElementById(a),!b.exists(d))throw new Error("\nJSXGraph: HTML container element '"+a+"' not found.");return e=d.style.display,"none"!==e&&null!==e?d.clientWidth>0&&d.clientHeight>0?{width:d.clientWidth,height:d.clientHeight}:(l=window.getComputedStyle?window.getComputedStyle(d):d.style,{width:m.test(l.width)?parseFloat(l.width):0,height:m.test(l.height)?parseFloat(l.height):0}):(f=d.style,g=f.visibility,h=f.position,i=f.display,f.visibility="hidden",f.position="absolute",f.display="block",j=d.clientWidth,k=d.clientHeight,f.display=i,f.position=h,f.visibility=g,{width:j,height:k})},addEvent:function(a,c,d,e){var f=function(){return d.apply(e,arguments)};f.origin=d,e["x_internal"+c]=e["x_internal"+c]||[],e["x_internal"+c].push(f),b.exists(a)&&b.exists(a.addEventListener)&&a.addEventListener(c,f,!1),b.exists(a)&&b.exists(a.attachEvent)&&a.attachEvent("on"+c,f)},removeEvent:function(c,d,e,f){var g;if(!b.exists(f))return void a.debug("no such owner");if(!b.exists(f["x_internal"+d]))return void a.debug("no such type: "+d);if(!b.isArray(f["x_internal"+d]))return void a.debug("owner[x_internal + "+d+"] is not an array");if(g=b.indexOf(f["x_internal"+d],e,"origin"),g===-1)return void a.debug("no such event function in internal list: "+e);try{b.exists(c)&&b.exists(c.removeEventListener)&&c.removeEventListener(d,f["x_internal"+d][g],!1),b.exists(c)&&b.exists(c.detachEvent)&&c.detachEvent("on"+d,f["x_internal"+d][g])}catch(h){a.debug("event not registered in browser: ("+d+" -- "+e+")")}f["x_internal"+d].splice(g,1)},removeAllEvents:function(b,c,d){var e,f;if(d["x_internal"+c]){for(f=d["x_internal"+c].length,e=f-1;e>=0;e--)a.removeEvent(b,c,d["x_internal"+c][e].origin,d);d["x_internal"+c].length>0&&a.debug("removeAllEvents: Not all events could be removed.")}},getPosition:function(c,d,e){var f,g,h,i=0,j=0;if(c||(c=window.event),e=e||document,h=c[a.touchProperty],b.exists(h)&&0===h.length&&(h=c.changedTouches),b.exists(d)&&b.exists(h))if(d===-1){for(g=h.length,f=0;f<g;f++)if(h[f]){c=h[f];break}}else c=h[d];return c.clientX&&(i=c.clientX,j=c.clientY),[i,j]},getOffset:function(a){var b,c=a,d=a,e=c.offsetLeft-c.scrollLeft,f=c.offsetTop-c.scrollTop;for(b=this.getCSSTransform([e,f],c),e=b[0],f=b[1],c=c.offsetParent;c;){for(e+=c.offsetLeft,f+=c.offsetTop,c.offsetParent&&(e+=c.clientLeft-c.scrollLeft,f+=c.clientTop-c.scrollTop),b=this.getCSSTransform([e,f],c),e=b[0],f=b[1],d=d.parentNode;d!==c;)e+=d.clientLeft-d.scrollLeft,f+=d.clientTop-d.scrollTop,b=this.getCSSTransform([e,f],d),e=b[0],f=b[1],d=d.parentNode;c=c.offsetParent}return[e,f]},getStyle:function(b,c){var d,e=b.ownerDocument;return e.defaultView&&e.defaultView.getComputedStyle?d=e.defaultView.getComputedStyle(b,null).getPropertyValue(c):b.currentStyle&&a.ieVersion>=9?d=b.currentStyle[c]:b.style&&(c=c.replace(/-([a-z]|[0-9])/gi,function(a,b){return b.toUpperCase()}),d=b.style[c]),d},getProp:function(a,b){var c=parseInt(this.getStyle(a,b),10);return isNaN(c)?0:c},getCSSTransform:function(a,c){var d,e,f,g,h,i,j,k,l=["transform","webkitTransform","MozTransform","msTransform","oTransform"];for(i=l.length,d=0,f="";d<i;d++)if(b.exists(c.style[l[d]])){f=c.style[l[d]];break}if(""!==f&&(h=f.indexOf("("),h>0)){for(i=f.length,g=f.substring(h+1,i-1),k=g.split(","),e=0,j=k.length;e<j;e++)k[e]=parseFloat(k[e]);0===f.indexOf("matrix")?(a[0]+=k[4],a[1]+=k[5]):0===f.indexOf("translateX")?a[0]+=k[0]:0===f.indexOf("translateY")?a[1]+=k[0]:0===f.indexOf("translate")&&(a[0]+=k[0],a[1]+=k[1])}return b.exists(c.style.zoom)&&(f=c.style.zoom,""!==f&&(a[0]*=parseFloat(f),a[1]*=parseFloat(f))),a},getCSSTransformMatrix:function(a){var c,d,e,f,g,h,i,j,k,l=a.ownerDocument,m=["transform","webkitTransform","MozTransform","msTransform","oTransform"],n=[[1,0,0],[0,1,0],[0,0,1]];if(l.defaultView&&l.defaultView.getComputedStyle)k=l.defaultView.getComputedStyle(a,null),e=k.getPropertyValue("-webkit-transform")||k.getPropertyValue("-moz-transform")||k.getPropertyValue("-ms-transform")||k.getPropertyValue("-o-transform")||k.getPropertyValue("transform");else for(h=m.length,c=0,e="";c<h;c++)if(b.exists(a.style[m[c]])){e=a.style[m[c]];break}if(""!==e&&(g=e.indexOf("("),g>0)){for(h=e.length,f=e.substring(g+1,h-1),j=f.split(","),d=0,i=j.length;d<i;d++)j[d]=parseFloat(j[d]);0===e.indexOf("matrix")?n=[[1,0,0],[0,j[0],j[1]],[0,j[2],j[3]]]:0===e.indexOf("scaleX")?n[1][1]=j[0]:0===e.indexOf("scaleY")?n[2][2]=j[0]:0===e.indexOf("scale")&&(n[1][1]=j[0],n[2][2]=j[1])}return b.exists(a.style.zoom)&&(e=a.style.zoom,""!==e&&(n[1][1]*=parseFloat(e),n[2][2]*=parseFloat(e))),n},timedChunk:function(a,b,c,d){var e=a.concat(),f=function(){var g=+new Date;do b.call(c,e.shift());while(e.length>0&&+new Date-g<300);e.length>0?window.setTimeout(f,1):d(a)};window.setTimeout(f,1)}}),a}),define("utils/xml",["jxg","utils/type"],function(a,b){"use strict";return a.XML={cleanWhitespace:function(a){for(var c=a.firstChild;b.exists(c);)3!==c.nodeType||/\S/.test(c.nodeValue)?1===c.nodeType&&this.cleanWhitespace(c):a.removeChild(c),c=c.nextSibling},parse:function(a){var b,c,d;return d="function"==typeof DOMParser||"object"==typeof DOMParser?DOMParser:function(){this.parseFromString=function(a){var b;return"function"==typeof ActiveXObject&&(b=new ActiveXObject("MSXML.DomDocument"),b.loadXML(a)),b}},b=new d,c=b.parseFromString(a,"text/xml"),this.cleanWhitespace(c),c}},a.XML}),define("utils/event",["jxg","utils/type"],function(a,b){"use strict";return a.EventEmitter={eventHandlers:{},suspended:{},trigger:function(a,b){var c,d,e,f,g,h;for(g=a.length,d=0;d<g;d++)if(f=this.eventHandlers[a[d]],!this.suspended[a[d]]){if(this.suspended[a[d]]=!0,f)for(h=f.length,c=0;c<h;c++)e=f[c],e.handler.apply(e.context,b);this.suspended[a[d]]=!1}return this},on:function(a,c,d){return b.isArray(this.eventHandlers[a])||(this.eventHandlers[a]=[]),d=b.def(d,this),this.eventHandlers[a].push({handler:c,context:d}),this},off:function(a,c){var d;return a&&b.isArray(this.eventHandlers[a])?(c?(d=b.indexOf(this.eventHandlers[a],c,"handler"),d>-1&&this.eventHandlers[a].splice(d,1),0===this.eventHandlers[a].length&&delete this.eventHandlers[a]):delete this.eventHandlers[a],this):this},eventify:function(a){a.eventHandlers={},a.on=this.on,a.off=this.off,a.triggerEventHandlers=this.trigger,a.trigger=this.trigger,a.suspended={}}},a.EventEmitter}),define("math/math",["jxg","utils/type"],function(a,b){"use strict";var c,d=function(a){var b,d;return a.memo?a.memo:(b={},d=Array.prototype.join,a.memo=function(){var e=d.call(arguments);return b[e]!==c?b[e]:b[e]=a.apply(this,arguments)},a.memo)};return a.Math={eps:1e-6,relDif:function(a,b){var c=Math.abs(a),d=Math.abs(b);return d=Math.max(c,d),0===d?0:Math.abs(a-b)/d},mod:function(a,b){return a-Math.floor(a/b)*b},vector:function(a,b){var c,d;for(b=b||0,c=[],d=0;d<a;d++)c[d]=b;return c},matrix:function(a,b,c){var d,e,f;for(c=c||0,b=b||a,d=[],e=0;e<a;e++)for(d[e]=[],f=0;f<b;f++)d[e][f]=c;return d},identity:function(a,b){var d,e;for(b===c&&"number"!=typeof b&&(b=a),d=this.matrix(a,b),e=0;e<Math.min(a,b);e++)d[e][e]=1;return d},frustum:function(a,b,c,d,e,f){var g=this.matrix(4,4);return g[0][0]=2*e/(b-a),g[0][1]=0,g[0][2]=(b+a)/(b-a),g[0][3]=0,g[1][0]=0,g[1][1]=2*e/(d-c),g[1][2]=(d+c)/(d-c),g[1][3]=0,g[2][0]=0,g[2][1]=0,g[2][2]=-(f+e)/(f-e),g[2][3]=-(f*e*2)/(f-e),g[3][0]=0,g[3][1]=0,g[3][2]=-1,g[3][3]=0,g},projection:function(a,b,c,d){var e=c*Math.tan(a/2),f=e*b;return this.frustum(-f,f,-e,e,c,d)},matVecMult:function(a,b){var c,d,e,f=a.length,g=b.length,h=[];if(3===g)for(c=0;c<f;c++)h[c]=a[c][0]*b[0]+a[c][1]*b[1]+a[c][2]*b[2];else for(c=0;c<f;c++){for(d=0,e=0;e<g;e++)d+=a[c][e]*b[e];h[c]=d}return h},matMatMult:function(a,b){var c,d,e,f,g=a.length,h=g>0?b[0].length:0,i=b.length,j=this.matrix(g,h);for(c=0;c<g;c++)for(d=0;d<h;d++){for(e=0,f=0;f<i;f++)e+=a[c][f]*b[f][d];j[c][d]=e}return j},transpose:function(a){var b,c,d,e,f;for(e=a.length,f=a.length>0?a[0].length:0,b=this.matrix(f,e),c=0;c<f;c++)for(d=0;d<e;d++)b[c][d]=a[d][c];return b},inverse:function(a){var b,c,d,e,f,g,h,i=a.length,j=[],k=[],l=[];for(b=0;b<i;b++){for(j[b]=[],c=0;c<i;c++)j[b][c]=a[b][c];k[b]=b}for(c=0;c<i;c++){for(f=Math.abs(j[c][c]),g=c,b=c+1;b<i;b++)Math.abs(j[b][c])>f&&(f=Math.abs(j[b][c]),g=b);if(f<=this.eps)return[];if(g>c){for(d=0;d<i;d++)h=j[c][d],j[c][d]=j[g][d],j[g][d]=h;h=k[c],k[c]=k[g],k[g]=h}for(e=1/j[c][c],b=0;b<i;b++)j[b][c]*=e;for(j[c][c]=e,d=0;d<i;d++)if(d!==c){for(b=0;b<i;b++)b!==c&&(j[b][d]-=j[b][c]*j[c][d]);j[c][d]=-e*j[c][d]}}for(b=0;b<i;b++){for(d=0;d<i;d++)l[k[d]]=j[b][d];for(d=0;d<i;d++)j[b][d]=l[d]}return j},innerProduct:function(a,d,e){var f,g=0;for(e!==c&&b.isNumber(e)||(e=a.length),f=0;f<e;f++)g+=a[f]*d[f];return g},crossProduct:function(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]},factorial:d(function(a){return a<0?NaN:(a=Math.floor(a),0===a||1===a?1:a*this.factorial(a-1))}),binomial:d(function(a,b){var c,d;if(b>a||b<0)return NaN;if(b=Math.round(b),a=Math.round(a),0===b||b===a)return 1;for(c=1,d=0;d<b;d++)c*=a-d,c/=d+1;return c}),cosh:function(a){return.5*(Math.exp(a)+Math.exp(-a))},sinh:function(a){return.5*(Math.exp(a)-Math.exp(-a))},pow:function(a,b){return 0===a?0===b?1:0:Math.floor(b)===b?Math.pow(a,b):a>0?Math.exp(b*Math.log(Math.abs(a))):NaN},log10:function(a){return Math.log(a)/Math.log(10)},log2:function(a){return Math.log(a)/Math.log(2)},log:function(a,c){return void 0!==c&&b.isNumber(c)?Math.log(a)/Math.log(c):Math.log(a)},sign:Math.sign||function(a){return a=+a,0===a||isNaN(a)?a:a>0?1:-1},squampow:function(a,b){var c;if(Math.floor(b)===b){for(c=1,b<0&&(a=1/a,b*=-1);0!==b;)1&b&&(c*=a),b>>=1,a*=a;return c}return this.pow(a,b)},gcd:function(a,c){if(a=Math.abs(a),c=Math.abs(c),!b.isNumber(a)||!b.isNumber(c))return NaN;if(c>a){var d=a;a=c,c=d}for(;;){if(a%=c,0===a)return c;if(c%=a,0===c)return a}},lcm:function(a,c){var d;return b.isNumber(a)&&b.isNumber(c)?(d=a*c,0!==d?d/this.gcd(a,c):0):NaN},normalize:function(a){var b,c,d=2*a[3],e=a[4]/d;return a[5]=e,a[6]=-a[1]/d,a[7]=-a[2]/d,isFinite(e)?Math.abs(e)>=1?(a[0]=(a[6]*a[6]+a[7]*a[7]-e*e)/(2*e),a[1]=-a[6]/e,a[2]=-a[7]/e,a[3]=1/(2*e),a[4]=1):(c=e<=0?-1:1,a[0]=c*(a[6]*a[6]+a[7]*a[7]-e*e)*.5,a[1]=-c*a[6],a[2]=-c*a[7],a[3]=c/2,a[4]=c*e):(b=Math.sqrt(a[1]*a[1]+a[2]*a[2]),a[0]/=b,a[1]/=b,a[2]/=b,a[3]=0,a[4]=1),a},toGL:function(a){var b,c,d;if(b="function"==typeof Float32Array?new Float32Array(16):new Array(16),4!==a.length&&4!==a[0].length)return b;for(c=0;c<4;c++)for(d=0;d<4;d++)b[c+4*d]=a[c][d];return b}},a.Math}),define("base/coords",["jxg","base/constants","utils/event","utils/type","math/math"],function(a,b,c,d,e){"use strict";return a.Coords=function(a,b,e,f){this.board=e,this.usrCoords=[],this.scrCoords=[],this.emitter=!d.exists(f)||f,this.emitter&&c.eventify(this),this.setCoordinates(a,b,!0,!0)},a.extend(a.Coords.prototype,{normalizeUsrCoords:function(){Math.abs(this.usrCoords[0])>e.eps&&(this.usrCoords[1]/=this.usrCoords[0],this.usrCoords[2]/=this.usrCoords[0],this.usrCoords[0]=1)},usr2screen:function(a){var b=Math.round,c=this.board,d=this.usrCoords,e=c.origin.scrCoords;a===!0?(this.scrCoords[0]=b(d[0]),this.scrCoords[1]=b(d[0]*e[1]+d[1]*c.unitX),this.scrCoords[2]=b(d[0]*e[2]-d[2]*c.unitY)):(this.scrCoords[0]=d[0],this.scrCoords[1]=d[0]*e[1]+d[1]*c.unitX,this.scrCoords[2]=d[0]*e[2]-d[2]*c.unitY)},screen2usr:function(){var a=this.board.origin.scrCoords,b=this.scrCoords,c=this.board;this.usrCoords[0]=1,this.usrCoords[1]=(b[1]-a[1])/c.unitX,this.usrCoords[2]=(a[2]-b[2])/c.unitY},distance:function(a,c){var d,f,g=0,h=this.usrCoords,i=this.scrCoords;if(a===b.COORDS_BY_USER){if(d=c.usrCoords,f=h[0]-d[0],g=f*f,g>e.eps*e.eps)return Number.POSITIVE_INFINITY;f=h[1]-d[1],g+=f*f,f=h[2]-d[2],g+=f*f}else d=c.scrCoords,f=i[1]-d[1],g+=f*f,f=i[2]-d[2],g+=f*f;return Math.sqrt(g)},setCoordinates:function(a,c,d,e){var f=this.usrCoords,g=this.scrCoords,h=[f[0],f[1],f[2]],i=[g[0],g[1],g[2]];return a===b.COORDS_BY_USER?(2===c.length?(f[0]=1,f[1]=c[0],f[2]=c[1]):(f[0]=c[0],f[1]=c[1],f[2]=c[2],this.normalizeUsrCoords()),this.usr2screen(d)):(2===c.length?(g[1]=c[0],g[2]=c[1]):(g[1]=c[1],g[2]=c[2]),this.screen2usr()),!this.emitter||e||i[1]===g[1]&&i[2]===g[2]||this.triggerEventHandlers(["update"],[h,i]),this},copy:function(a,b){return void 0===b&&(b=0),this[a].slice(b)},__evt__update:function(a,b){},__evt:function(){}}),a.Coords}),define("utils/expect",["jxg","utils/type","base/constants","base/coords"],function(a,b,c,d){"use strict";var e={each:function(a,c,d){var e,f,g=[];if(b.exists(a.length))for(f=a.length,e=0;e<f;e++)g.push(c.call(this,a[e],d));return g},coords:function(a,b){var e=a;return a&&a.elementClass===c.OBJECT_CLASS_POINT?e=a.coords:a.usrCoords&&a.scrCoords&&a.usr2screen&&(e=a),b&&(e=new d(c.COORDS_BY_USER,e.usrCoords,e.board)),e},coordsArray:function(a,c){var d;return d=b.isArray(a)?a:this.coords(a).usrCoords,d.length<3&&d.unshift(1),c&&(d=[d[0],d[1],d[2]]),d}};return a.Expect=e,e}),define("math/qdt",["math/math","utils/type"],function(a,b){"use strict";var c=function(a){this.capacity=10,this.points=[],this.xlb=a[0],this.xub=a[2],this.ylb=a[3],this.yub=a[1],this.northWest=null,this.northEast=null,this.southEast=null,this.southWest=null};return b.extend(c.prototype,{contains:function(a,b){return this.xlb<a&&a<=this.xub&&this.ylb<b&&b<=this.yub},insert:function(a){return!!this.contains(a.usrCoords[1],a.usrCoords[2])&&(this.points.length<this.capacity?(this.points.push(a),!0):(null===this.northWest&&this.subdivide(),
!!this.northWest.insert(a)||(!!this.northEast.insert(a)||(!!this.southEast.insert(a)||!!this.southWest.insert(a)))))},subdivide:function(){var a,b=this.points.length,d=this.xlb+(this.xub-this.xlb)/2,e=this.ylb+(this.yub-this.ylb)/2;for(this.northWest=new c([this.xlb,this.yub,d,e]),this.northEast=new c([d,this.yub,this.xub,e]),this.southEast=new c([this.xlb,e,d,this.ylb]),this.southWest=new c([d,e,this.xub,this.ylb]),a=0;a<b;a+=1)this.northWest.insert(this.points[a]),this.northEast.insert(this.points[a]),this.southEast.insert(this.points[a]),this.southWest.insert(this.points[a])},_query:function(a,b){var c;if(this.contains(a,b)){if(null===this.northWest)return this;if(c=this.northWest._query(a,b))return c;if(c=this.northEast._query(a,b))return c;if(c=this.southEast._query(a,b))return c;if(c=this.southWest._query(a,b))return c}return!1},query:function(a,c){var d,e;return b.exists(c)?(d=a,e=c):(d=a.usrCoords[1],e=a.usrCoords[2]),this._query(d,e)}}),a.Quadtree=c,c}),define("math/numerics",["jxg","utils/type","math/math"],function(a,b,c){"use strict";var d={rk4:{s:4,A:[[0,0,0,0],[.5,0,0,0],[0,.5,0,0],[0,0,1,0]],b:[1/6,1/3,1/3,1/6],c:[0,.5,.5,1]},heun:{s:2,A:[[0,0],[1,0]],b:[.5,.5],c:[0,1]},euler:{s:1,A:[[0]],b:[1],c:[0]}};return c.Numerics={Gauss:function(a,d){var e,f,g,h,i,j=c.eps,k=a.length>0?a[0].length:0;if(k!==d.length||k!==a.length)throw new Error("JXG.Math.Numerics.Gauss: Dimensions don't match. A must be a square matrix and b must be of the same length as A.");for(h=[],i=d.slice(0,k),e=0;e<k;e++)h[e]=a[e].slice(0,k);for(f=0;f<k;f++){for(e=k-1;e>f;e--)if(Math.abs(h[e][f])>j)if(Math.abs(h[f][f])<j)b.swap(h,e,f),b.swap(i,e,f);else for(h[e][f]/=h[f][f],i[e]-=h[e][f]*i[f],g=f+1;g<k;g++)h[e][g]-=h[e][f]*h[f][g];if(Math.abs(h[f][f])<j)throw new Error("JXG.Math.Numerics.Gauss(): The given matrix seems to be singular.")}return this.backwardSolve(h,i,!0),i},backwardSolve:function(a,b,c){var d,e,f,g,h;for(d=c?b:b.slice(0,b.length),e=a.length,f=a.length>0?a[0].length:0,g=e-1;g>=0;g--){for(h=f-1;h>g;h--)d[g]-=a[g][h]*d[h];d[g]/=a[g][g]}return d},gaussBareiss:function(a){var b,d,e,f,g,h,i,j,k,l=c.eps;if(i=a.length,i<=0)return 0;for(a[0].length<i&&(i=a[0].length),j=[],f=0;f<i;f++)j[f]=a[f].slice(0,i);for(d=1,e=1,b=0;b<i-1;b++){if(h=j[b][b],Math.abs(h)<l){for(f=b+1;f<i&&!(Math.abs(j[f][b])>=l);f++);if(f===i)return 0;for(g=b;g<i;g++)k=j[f][g],j[f][g]=j[b][g],j[b][g]=k;e=-e,h=j[b][b]}for(f=b+1;f<i;f++)for(g=b+1;g<i;g++)k=h*j[f][g]-j[f][b]*j[b][g],j[f][g]=k/d;d=h}return e*j[i-1][i-1]},det:function(a){var b=a.length;return 2===b&&2===a[0].length?a[0][0]*a[1][1]-a[1][0]*a[0][1]:this.gaussBareiss(a)},Jacobi:function(a){var b,d,e,f,g,h,i,j,k,l=c.eps,m=0,n=a.length,o=[[0,0,0],[0,0,0],[0,0,0]],p=[[0,0,0],[0,0,0],[0,0,0]],q=0;for(b=0;b<n;b++){for(d=0;d<n;d++)o[b][d]=0,p[b][d]=a[b][d],m+=Math.abs(p[b][d]);o[b][b]=1}if(1===n)return[p,o];if(m<=0)return[p,o];m/=n*n;do{for(j=0,k=0,d=1;d<n;d++)for(b=0;b<d;b++)if(f=Math.abs(p[b][d]),f>k&&(k=f),j+=f,f>=l){for(f=.5*Math.atan2(2*p[b][d],p[b][b]-p[d][d]),g=Math.sin(f),h=Math.cos(f),e=0;e<n;e++)i=p[e][b],p[e][b]=h*i+g*p[e][d],p[e][d]=-g*i+h*p[e][d],i=o[e][b],o[e][b]=h*i+g*o[e][d],o[e][d]=-g*i+h*o[e][d];for(p[b][b]=h*p[b][b]+g*p[d][b],p[d][d]=-g*p[b][d]+h*p[d][d],p[b][d]=0,e=0;e<n;e++)p[b][e]=p[e][b],p[d][e]=p[e][d]}q+=1}while(Math.abs(j)/m>l&&q<2e3);return[p,o]},NewtonCotes:function(a,c,d){var e,f,g,h=0,i=d&&b.isNumber(d.number_of_nodes)?d.number_of_nodes:28,j={trapez:!0,simpson:!0,milne:!0},k=d&&d.integration_type&&j.hasOwnProperty(d.integration_type)&&j[d.integration_type]?d.integration_type:"milne",l=(a[1]-a[0])/i;switch(k){case"trapez":for(h=.5*(c(a[0])+c(a[1])),e=a[0],f=0;f<i-1;f++)e+=l,h+=c(e);h*=l;break;case"simpson":if(i%2>0)throw new Error("JSXGraph:  INT_SIMPSON requires config.number_of_nodes dividable by 2.");for(g=i/2,h=c(a[0])+c(a[1]),e=a[0],f=0;f<g-1;f++)e+=2*l,h+=2*c(e);for(e=a[0]-l,f=0;f<g;f++)e+=2*l,h+=4*c(e);h*=l/3;break;default:if(i%4>0)throw new Error("JSXGraph: Error in INT_MILNE: config.number_of_nodes must be a multiple of 4");for(g=.25*i,h=7*(c(a[0])+c(a[1])),e=a[0],f=0;f<g-1;f++)e+=4*l,h+=14*c(e);for(e=a[0]-3*l,f=0;f<g;f++)e+=4*l,h+=32*(c(e)+c(e+2*l));for(e=a[0]-2*l,f=0;f<g;f++)e+=4*l,h+=12*c(e);h*=2*l/45}return h},Romberg:function(a,c,d){var e,f,g,h,i,j,k,l,m=[],n=0,o=1/0,p=d&&b.isNumber(d.max_iterations)?d.max_iterations:20,q=d&&b.isNumber(d.eps)?d.eps:d.eps||1e-7;for(e=a[0],f=a[1],g=f-e,i=1,m[0]=.5*g*(c(e)+c(f)),j=0;j<p;++j){for(h=0,g*=.5,i*=2,l=1,k=1;k<i;k+=2)h+=c(e+k*g);for(m[j+1]=.5*m[j]+h*g,n=m[j+1],k=j-1;k>=0;--k)l*=4,m[k]=m[k+1]+(m[k+1]-m[k])/(l-1),n=m[k];if(Math.abs(n-o)<q*Math.abs(n))break;o=n}return n},GaussLegendre:function(a,c,d){var e,f,g,h,i,j,k,l,m=0,n=[],o=[],p=d&&b.isNumber(d.n)?d.n:12;if(p>18&&(p=18),n[2]=[.5773502691896257],o[2]=[1],n[4]=[.33998104358485626,.8611363115940526],o[4]=[.6521451548625461,.34785484513745385],n[6]=[.2386191860831969,.6612093864662645,.932469514203152],o[6]=[.46791393457269104,.3607615730481386,.17132449237917036],n[8]=[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],o[8]=[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],n[10]=[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],o[10]=[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],n[12]=[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],o[12]=[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],n[14]=[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],o[14]=[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],n[16]=[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499],o[16]=[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096],n[18]=[.0847750130417353,.2518862256915055,.41175116146284263,.5597708310739475,.6916870430603532,.8037049589725231,.8926024664975557,.9558239495713977,.9915651684209309],o[18]=[.1691423829631436,.16427648374583273,.15468467512626524,.14064291467065065,.12255520671147846,.10094204410628717,.07642573025488905,.0497145488949698,.02161601352648331],n[3]=[0,.7745966692414834],o[3]=[.8888888888888888,.5555555555555556],n[5]=[0,.5384693101056831,.906179845938664],o[5]=[.5688888888888889,.47862867049936647,.23692688505618908],n[7]=[0,.4058451513773972,.7415311855993945,.9491079123427585],o[7]=[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],n[9]=[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],o[9]=[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],n[11]=[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],o[11]=[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],n[13]=[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],o[13]=[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],n[15]=[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],o[15]=[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],n[17]=[0,.17848418149584785,.3512317634538763,.5126905370864769,.6576711592166907,.7815140038968014,.8802391537269859,.9506755217687678,.9905754753144174],o[17]=[.17944647035620653,.17656270536699264,.16800410215645004,.15404576107681028,.13513636846852548,.11188384719340397,.08503614831717918,.0554595293739872,.02414830286854793],e=a[0],f=a[1],h=p+1>>1,k=n[p],l=o[p],j=.5*(f-e),i=.5*(f+e),p&!0)for(m=l[0]*c(i),g=1;g<h;++g)m+=l[g]*(c(i+j*k[g])+c(i-j*k[g]));else for(m=0,g=0;g<h;++g)m+=l[g]*(c(i+j*k[g])+c(i-j*k[g]));return j*m},_rescale_error:function(a,b,c){var d,e,f=2.2250738585072014e-308,g=2.220446049250313e-16;return a=Math.abs(a),0!==c&&0!==a&&(d=Math.pow(200*a/c,1.5),a=d<1?c*d:c),b>f/(50*g)&&(e=50*g*b,e>a&&(a=e)),a},_gaussKronrod:function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q=a[0],r=a[1],s=.5*(q+r),t=.5*(r-q),u=Math.abs(t),v=b(s),w=0,x=v*f[c-1],y=Math.abs(x),z=0,A=0,B=0,C=[],D=[];for(c%2===0&&(w=v*e[c/2-1]),h=Math.floor((c-1)/2),j=0;j<h;j++)k=2*j+1,l=t*d[k],m=b(s-l),n=b(s+l),o=m+n,C[k]=m,D[k]=n,w+=e[j]*o,x+=f[k]*o,y+=f[k]*(Math.abs(m)+Math.abs(n));for(h=Math.floor(c/2),j=0;j<h;j++)p=2*j,l=t*d[p],m=b(s-l),n=b(s+l),C[p]=m,D[p]=n,x+=f[p]*(m+n),y+=f[p]*(Math.abs(m)+Math.abs(n));for(A=.5*x,z=f[c-1]*Math.abs(v-A),j=0;j<c-1;j++)z+=f[j]*(Math.abs(C[j]-A)+Math.abs(D[j]-A));return B=(x-w)*t,x*=t,y*=u,z*=u,i=x,g.abserr=this._rescale_error(B,y,z),g.resabs=y,g.resasc=z,i},GaussKronrod15:function(a,b,c){var d=[.9914553711208126,.9491079123427585,.8648644233597691,.7415311855993945,.5860872354676911,.4058451513773972,.20778495500789848,0],e=[.1294849661688697,.27970539148927664,.3818300505051189,.4179591836734694],f=[.022935322010529224,.06309209262997856,.10479001032225019,.14065325971552592,.1690047266392679,.19035057806478542,.20443294007529889,.20948214108472782];return this._gaussKronrod(a,b,8,d,e,f,c)},GaussKronrod21:function(a,b,c){var d=[.9956571630258081,.9739065285171717,.9301574913557082,.8650633666889845,.7808177265864169,.6794095682990244,.5627571346686047,.4333953941292472,.2943928627014602,.14887433898163122,0],e=[.06667134430868814,.1494513491505806,.21908636251598204,.26926671930999635,.29552422471475287],f=[.011694638867371874,.032558162307964725,.054755896574351995,.07503967481091996,.0931254545836976,.10938715880229764,.12349197626206584,.13470921731147334,.14277593857706009,.14773910490133849,.1494455540029169];return this._gaussKronrod(a,b,11,d,e,f,c)},GaussKronrod31:function(a,b,c){var d=[.9980022986933971,.9879925180204854,.9677390756791391,.937273392400706,.8972645323440819,.8482065834104272,.790418501442466,.7244177313601701,.650996741297417,.5709721726085388,.4850818636402397,.3941513470775634,.29918000715316884,.20119409399743451,.1011420669187175,0],e=[.03075324199611727,.07036604748810812,.10715922046717194,.13957067792615432,.16626920581699392,.1861610000155622,.19843148532711158,.2025782419255613],f=[.005377479872923349,.015007947329316122,.02546084732671532,.03534636079137585,.04458975132476488,.05348152469092809,.06200956780067064,.06985412131872826,.07684968075772038,.08308050282313302,.08856444305621176,.09312659817082532,.09664272698362368,.09917359872179196,.10076984552387559,.10133000701479154];return this._gaussKronrod(a,b,16,d,e,f,c)},_workspace:function(a,b){return{limit:b,size:0,nrmax:0,i:0,alist:[a[0]],blist:[a[1]],rlist:[0],elist:[0],order:[0],level:[0],qpsrt:function(){var a,b,c,d,e,f=this.size-1,g=this.limit,h=this.nrmax,i=this.order[h];if(f<2)return this.order[0]=0,this.order[1]=1,void(this.i=i);for(a=this.elist[i];h>0&&a>this.elist[this.order[h-1]];)this.order[h]=this.order[h-1],h--;for(e=f<g/2+2?f:g-f+1,c=h+1;c<e&&a<this.elist[this.order[c]];)this.order[c-1]=this.order[c],c++;for(this.order[c-1]=i,b=this.elist[f],d=e-1;d>c-2&&b>=this.elist[this.order[d]];)this.order[d+1]=this.order[d],d--;this.order[d+1]=f,i=this.order[h],this.i=i,this.nrmax=h},set_initial_result:function(a,b){this.size=1,this.rlist[0]=a,this.elist[0]=b},update:function(a,b,c,d,e,f,g,h){var i=this.i,j=this.size,k=this.level[this.i]+1;h>d?(this.alist[i]=e,this.rlist[i]=g,this.elist[i]=h,this.level[i]=k,this.alist[j]=a,this.blist[j]=b,this.rlist[j]=c,this.elist[j]=d,this.level[j]=k):(this.blist[i]=b,this.rlist[i]=c,this.elist[i]=d,this.level[i]=k,this.alist[j]=e,this.blist[j]=f,this.rlist[j]=g,this.elist[j]=h,this.level[j]=k),this.size++,k>this.maximum_level&&(this.maximum_level=k),this.qpsrt()},retrieve:function(){var a=this.i;return{a:this.alist[a],b:this.blist[a],r:this.rlist[a],e:this.elist[a]}},sum_results:function(){var a,b=this.size,c=0;for(a=0;a<b;a++)c+=this.rlist[a];return c},subinterval_too_small:function(a,b,c){var d=2.220446049250313e-16,e=2.2250738585072014e-308,f=(1+100*d)*(Math.abs(b)+1e3*e);return Math.abs(a)<=f&&Math.abs(c)<=f}}},Qag:function(d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=2.220446049250313e-16,F=this._workspace(d,1e3),G=f&&b.isNumber(f.limit)?f.limit:15,H=f&&b.isNumber(f.epsrel)?f.epsrel:1e-7,I=f&&b.isNumber(f.epsabs)?f.epsabs:1e-7,J=f&&b.isFunction(f.q)?f.q:this.GaussKronrod15,K={},L=0,M=0,N=0,O=0,P=0,Q=0,R=0,S=0,T=0,U=0;if(G>F.limit&&a.warn("iteration limit exceeds available workspace"),I<=0&&(H<50*c.eps||H<5e-29)&&a.warn("tolerance cannot be acheived with given epsabs and epsrel"),i=J.apply(this,[d,e,K]),j=K.abserr,k=K.resabs,l=K.resasc,F.set_initial_result(i,j),o=Math.max(I,H*Math.abs(i)),p=50*E*k,j<=p&&j>o)return m=i,n=j,a.warn("cannot reach tolerance because of roundoff error on first attempt"),-(1/0);if(j<=o&&j!==l||0===j)return m=i,n=j,m;if(1===G)return m=i,n=j,a.warn("a maximum of one iteration was insufficient"),-(1/0);g=i,h=j,L=1;do P=0,Q=0,R=0,S=0,T=0,U=0,C=F.retrieve(),u=C.a,v=C.b,w=C.r,x=C.e,q=u,r=.5*(u+v),s=r,t=v,P=J.apply(this,[[q,r],e,K]),S=K.abserr,A=K.resabs,y=K.resasc,Q=J.apply(this,[[s,t],e,K]),T=K.abserr,B=K.resabs,z=K.resasc,R=P+Q,U=S+T,h+=U-x,g+=R-w,y!==S&&z!==T&&(D=w-R,Math.abs(D)<=1e-5*Math.abs(R)&&U>=.99*x&&M++,L>=10&&U>x&&N++),o=Math.max(I,H*Math.abs(g)),h>o&&((M>=6||N>=20)&&(O=2),F.subinterval_too_small(q,s,t)&&(O=3)),F.update(q,r,P,S,s,t,Q,T),C=F.retrieve(),u=C.a_i,v=C.b_i,w=C.r_i,x=C.e_i,L++;while(L<G&&!O&&h>o);return m=F.sum_results(),n=h,m},I:function(a,b){return this.Qag(a,b,{q:this.GaussKronrod15,limit:15,epsrel:1e-7,epsabs:1e-7})},Newton:function(a,d,e){var f,g=0,h=c.eps,i=a.apply(e,[d]),j=1;for(b.isArray(d)&&(d=d[0]);g<50&&Math.abs(i)>h;)f=this.D(a,e)(d),j+=2,Math.abs(f)>h?d-=i/f:d+=.2*Math.random()-1,i=a.apply(e,[d]),j+=1,g+=1;return d},root:function(a,b,c){return this.fzero(a,b,c)},generalizedNewton:function(a,b,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=0;for(this.generalizedNewton.t1memo?(f=this.generalizedNewton.t1memo,g=this.generalizedNewton.t2memo):(f=d,g=e),m=a.X(f)-b.X(g),n=a.Y(f)-b.Y(g),o=m*m+n*n,p=this.D(a.X,a),q=this.D(b.X,b),r=this.D(a.Y,a),s=this.D(b.Y,b);o>c.eps&&t<10;)h=p(f),i=-q(g),j=r(f),k=-s(g),l=h*k-i*j,f-=(k*m-i*n)/l,g-=(h*n-j*m)/l,m=a.X(f)-b.X(g),n=a.Y(f)-b.Y(g),o=m*m+n*n,t+=1;return this.generalizedNewton.t1memo=f,this.generalizedNewton.t2memo=g,Math.abs(f)<Math.abs(g)?[a.X(f),a.Y(f)]:[b.X(g),b.Y(g)]},Neville:function(a){var b=[],d=function(d){return function(e,f){var g,h,i,j=c.binomial,k=a.length,l=k-1,m=0,n=0;if(!f)for(i=1,g=0;g<k;g++)b[g]=j(l,g)*i,i*=-1;for(h=e,g=0;g<k;g++){if(0===h)return a[g][d]();i=b[g]/h,h-=1,m+=a[g][d]()*i,n+=i}return m/n}},e=d("X"),f=d("Y");return[e,f,0,function(){return a.length-1}]},splineDef:function(a,b){var c,d,e,f=Math.min(a.length,b.length),g=[],h=[],i=[],j=[],k=[],l=[];if(2===f)return[0,0];for(d=0;d<f;d++)c={X:a[d],Y:b[d]},i.push(c);for(i.sort(function(a,b){return a.X-b.X}),d=0;d<f;d++)a[d]=i[d].X,b[d]=i[d].Y;for(d=0;d<f-1;d++)j.push(a[d+1]-a[d]);for(d=0;d<f-2;d++)k.push(6*(b[d+2]-b[d+1])/j[d+1]-6*(b[d+1]-b[d])/j[d]);for(g.push(2*(j[0]+j[1])),h.push(k[0]),d=0;d<f-3;d++)e=j[d+1]/g[d],g.push(2*(j[d+1]+j[d+2])-e*j[d+1]),h.push(k[d+1]-e*h[d]);for(l[f-3]=h[f-3]/g[f-3],d=f-4;d>=0;d--)l[d]=(h[d]-j[d+1]*l[d+1])/g[d];for(d=f-3;d>=0;d--)l[d+1]=l[d];return l[0]=0,l[f-1]=0,l},splineEval:function(a,c,d,e){var f,g,h,i,j,k,l,m=Math.min(c.length,d.length),n=1,o=!1,p=[];for(b.isArray(a)?(n=a.length,o=!0):a=[a],f=0;f<n;f++){if(a[f]<c[0]||c[f]>c[m-1])return NaN;for(g=1;g<m&&!(a[f]<=c[g]);g++);g-=1,h=d[g],i=(d[g+1]-d[g])/(c[g+1]-c[g])-(c[g+1]-c[g])/6*(e[g+1]+2*e[g]),j=e[g]/2,k=(e[g+1]-e[g])/(6*(c[g+1]-c[g])),l=a[f]-c[g],p.push(h+(i+(j+k*l)*l)*l)}return o?p:p[0]},generatePolynomialTerm:function(a,b,c,d){var e,f=[];for(e=b;e>=0;e--)f=f.concat(["(",a[e].toPrecision(d),")"]),e>1?f=f.concat(["*",c,"<sup>",e,"<","/sup> + "]):1===e&&(f=f.concat(["*",c," + "]));return f.join("")},lagrangePolynomial:function(a){var b=[],c=function(c,d){var e,f,g,h,i=a.length,j=0,k=0;if(!d)for(e=0;e<i;e++){for(b[e]=1,g=a[e].X(),f=0;f<i;f++)f!==e&&(b[e]*=g-a[f].X());b[e]=1/b[e]}for(e=0;e<i;e++){if(g=a[e].X(),c===g)return a[e].Y();h=b[e]/(c-g),k+=h,j+=h*a[e].Y()}return j/k};return c.getTerm=function(){return""},c},_initCubicPoly:function(a,b,c,d){return[a,c,-3*a+3*b-2*c-d,2*a-2*b+c+d]},CardinalSpline:function(a,d,e){var f,g,h,i,j=[],k=this;return i=b.isFunction(d)?d:function(){return d},void 0===e&&(e="uniform"),g=function(b){return function(d,g){var l,m,n,o,p,q,r,s,t,u;if(a.length<2)return NaN;if(!g)for(h=i(),n={X:function(){return 2*a[0].X()-a[1].X()},Y:function(){return 2*a[0].Y()-a[1].Y()},Dist:function(a){var b=this.X()-a.X(),c=this.Y()-a.Y();return Math.sqrt(b*b+c*c)}},o={X:function(){return 2*a[a.length-1].X()-a[a.length-2].X()},Y:function(){return 2*a[a.length-1].Y()-a[a.length-2].Y()},Dist:function(a){var b=this.X()-a.X(),c=this.Y()-a.Y();return Math.sqrt(b*b+c*c)}},f=[n].concat(a,[o]),u=f.length,j[b]=[],l=0;l<u-3;l++)"centripetal"===e?(r=f[l].Dist(f[l+1]),s=f[l+2].Dist(f[l+1]),t=f[l+3].Dist(f[l+2]),r=Math.sqrt(r),s=Math.sqrt(s),t=Math.sqrt(t),s<c.eps&&(s=1),r<c.eps&&(r=s),t<c.eps&&(t=s),p=(f[l+1][b]()-f[l][b]())/r-(f[l+2][b]()-f[l][b]())/(s+r)+(f[l+2][b]()-f[l+1][b]())/s,q=(f[l+2][b]()-f[l+1][b]())/s-(f[l+3][b]()-f[l+1][b]())/(t+s)+(f[l+3][b]()-f[l+2][b]())/t,p*=s,q*=s,j[b][l]=k._initCubicPoly(f[l+1][b](),f[l+2][b](),h*p,h*q)):j[b][l]=k._initCubicPoly(f[l+1][b](),f[l+2][b](),h*(f[l+2][b]()-f[l][b]()),h*(f[l+3][b]()-f[l+1][b]()));return isNaN(d)?NaN:(u=a.length,d<=0?a[0][b]():d>=u?a[u-1][b]():(l=Math.floor(d),l===d?a[l][b]():(d-=l,m=j[b][l],void 0===m?NaN:((m[3]*d+m[2])*d+m[1])*d+m[0])))}},[g("X"),g("Y"),0,function(){return a.length-1}]},CatmullRomSpline:function(a,b){return this.CardinalSpline(a,.5,b)},regressionPolynomial:function(a,d,e){var f,g,h,i,j,k,l="";if(b.isPoint(a)&&b.isFunction(a.Value))g=function(){return a.Value()};else if(b.isFunction(a))g=a;else{if(!b.isNumber(a))throw new Error("JSXGraph: Can't create regressionPolynomial from degree of type'"+typeof a+"'.");g=function(){return a}}if(3===arguments.length&&b.isArray(d)&&b.isArray(e))j=0;else if(2===arguments.length&&b.isArray(d)&&d.length>0&&b.isPoint(d[0]))j=1;else{if(!(2===arguments.length&&b.isArray(d)&&d.length>0&&d[0].usrCoords&&d[0].scrCoords))throw new Error("JSXGraph: Can't create regressionPolynomial. Wrong parameters.");j=2}return k=function(a,k){var m,n,o,p,q,r,s,t,u,v=d.length;if(u=Math.floor(g()),!k){if(1===j)for(h=[],i=[],m=0;m<v;m++)h[m]=d[m].X(),i[m]=d[m].Y();if(2===j)for(h=[],i=[],m=0;m<v;m++)h[m]=d[m].usrCoords[1],i[m]=d[m].usrCoords[2];if(0===j)for(h=[],i=[],m=0;m<v;m++)b.isFunction(d[m])?h.push(d[m]()):h.push(d[m]),b.isFunction(e[m])?i.push(e[m]()):i.push(e[m]);for(o=[],n=0;n<v;n++)o.push([1]);for(m=1;m<=u;m++)for(n=0;n<v;n++)o[n][m]=o[n][m-1]*h[n];q=i,p=c.transpose(o),r=c.matMatMult(p,o),s=c.matVecMult(p,q),f=c.Numerics.Gauss(r,s),l=c.Numerics.generatePolynomialTerm(f,u,"x",3)}for(t=f[u],m=u-1;m>=0;m--)t=t*a+f[m];return t},k.getTerm=function(){return l},k},bezier:function(a){var b,c,d=function(d){return function(e,f){var g=3*Math.floor(e),h=e%1,i=1-h;return f||(c=3*Math.floor((a.length-1)/3),b=Math.floor(c/3)),e<0?a[0][d]():e>=b?a[c][d]():isNaN(e)?NaN:i*i*(i*a[g][d]()+3*h*a[g+1][d]())+(3*i*a[g+2][d]()+h*a[g+3][d]())*h*h}};return[d("X"),d("Y"),0,function(){return Math.floor(a.length/3)}]},bspline:function(a,b){var c,d=[],e=function(a,b){var c,d=[];for(c=0;c<a+b+1;c++)c<b?d[c]=0:c<=a?d[c]=c-b+1:d[c]=a-b+2;return d},f=function(a,b,c,d,e){var f,g,h,i,j,k=[];for(b[e]<=a&&a<b[e+1]?k[e]=1:k[e]=0,f=2;f<=d;f++)for(g=e-f+1;g<=e;g++)h=g<=e-f+1||g<0?0:k[g],i=g>=e?0:k[g+1],j=b[g+f-1]-b[g],0===j?k[g]=0:k[g]=(a-b[g])/j*h,j=b[g+f]-b[g+1],0!==j&&(k[g]+=(b[g+f]-a)/j*i);return k},g=function(g){return function(h,i){var j,k,l,m=a.length,n=m-1,o=b;if(n<=0)return NaN;if(n+2<=o&&(o=n+1),h<=0)return a[0][g]();if(h>=n-o+2)return a[n][g]();for(l=Math.floor(h)+o-1,c=e(n,o),d=f(h,c,n,o,l),j=0,k=l-o+1;k<=l;k++)k<m&&k>=0&&(j+=a[k][g]()*d[k]);return j}};return[g("X"),g("Y"),0,function(){return a.length-1}]},D:function(a,c){return b.exists(c)?function(b,d){var e=1e-5,f=2*e;return(a.apply(c,[b+e,d])-a.apply(c,[b-e,d]))/f}:function(b,c){var d=1e-5,e=2*d;return(a(b+d,c)-a(b-d,c))/e}},_riemannValue:function(a,b,c,d){var e,f,g,h;if(d<0&&("trapezoidal"!==c&&(a+=d),d*=-1,"lower"===c?c="upper":"upper"===c&&(c="lower")),h=.01*d,"right"===c)e=b(a+d);else if("middle"===c)e=b(a+.5*d);else if("left"===c||"trapezoidal"===c)e=b(a);else if("lower"===c){for(e=b(a),g=a+h;g<=a+d;g+=h)f=b(g),f<e&&(e=f);f=b(a+d),f<e&&(e=f)}else if("upper"===c){for(e=b(a),g=a+h;g<=a+d;g+=h)f=b(g),f>e&&(e=f);f=b(a+d),f>e&&(e=f)}else e="random"===c?b(a+d*Math.random()):"simpson"===c?(b(a)+4*b(a+.5*d)+b(a+d))/6:b(a);return e},riemann:function(a,c,d,e,f){var g,h,i,j,k,l,m,n=[],o=[],p=0,q=e,r=0;if(b.isArray(a)?(k=a[0],j=a[1]):j=a,c=Math.floor(c),c<=0)return[n,o,r];for(h=(f-e)/c,g=0;g<c;g++)i=this._riemannValue(q,j,d,h),n[p]=q,o[p]=i,p+=1,q+=h,"trapezoidal"===d&&(i=j(q)),n[p]=q,o[p]=i,p+=1;for(g=0;g<c;g++)i=k?this._riemannValue(q,k,d,-h):0,n[p]=q,o[p]=i,p+=1,q-=h,"trapezoidal"===d&&k&&(i=k(q)),n[p]=q,o[p]=i,"trapezoidal"!==d?(l=i,m=o[2*(c-1)-2*g]):(m=.5*(j(q+h)+j(q)),l=k?.5*(k(q+h)+k(q)):0),r+=(m-l)*h,p+=1,n[p]=q,o[p]=o[2*(c-1)-2*g],p+=1;return[n,o,r]},riemannsum:function(b,c,d,e,f){return a.deprecated("Numerics.riemannsum()","Numerics.riemann()"),this.riemann(b,c,d,e,f)[2]},rungeKutta:function(a,c,e,f,g){var h,i,j,k,l,m,n=[],o=[],p=(e[1]-e[0])/f,q=e[0],r=c.length,s=[],t=0;for(b.isString(a)&&(a=d[a]||d.euler),m=a.s,h=0;h<r;h++)n[h]=c[h];for(i=0;i<f;i++){for(s[t]=[],h=0;h<r;h++)s[t][h]=n[h];for(t+=1,k=[],j=0;j<m;j++){for(h=0;h<r;h++)o[h]=0;for(l=0;l<j;l++)for(h=0;h<r;h++)o[h]+=a.A[j][l]*p*k[l][h];for(h=0;h<r;h++)o[h]+=n[h];k.push(g(q+a.c[j]*p,o))}for(h=0;h<r;h++)o[h]=0;for(l=0;l<m;l++)for(h=0;h<r;h++)o[h]+=a.b[l]*k[l][h];for(h=0;h<r;h++)n[h]=n[h]+p*o[h];q+=p}return s},maxIterationsRoot:80,maxIterationsMinimize:500,fzero:function(a,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=c.eps,A=this.maxIterationsRoot,B=0,C=0;if(b.isArray(d)){if(d.length<2)throw new Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.");f=d[0],i=a.call(e,f),C+=1,g=d[1],j=a.call(e,g),C+=1}else{for(f=d,i=a.call(e,f),C+=1,l=0===f?1:f,m=[.9*l,1.1*l,l-1,l+1,.5*l,1.5*l,-l,2*l,-10*l,10*l],o=m.length,n=0;n<o&&(g=m[n],j=a.call(e,g),C+=1,!(i*j<=0));n++);g<f&&(p=f,f=g,g=p,q=i,i=j,j=q)}if(i*j>0)return b.isArray(d)?this.fminbr(a,[f,g],e):this.Newton(a,f,e);for(h=f,k=i;B<A;){if(r=g-f,Math.abs(k)<Math.abs(j)&&(f=g,g=h,h=f,i=j,j=k,k=i),v=2*z*Math.abs(g)+.5*z,y=.5*(h-g),Math.abs(y)<=v&&Math.abs(j)<=z)return g;Math.abs(r)>=v&&Math.abs(i)>Math.abs(j)&&(t=h-g,f===h?(s=j/i,w=t*s,x=1-s):(x=i/k,s=j/k,u=j/i,w=u*(t*x*(x-s)-(g-f)*(s-1)),x=(x-1)*(s-1)*(u-1)),w>0?x=-x:w=-w,w<.75*t*x-.5*Math.abs(v*x)&&w<Math.abs(r*x*.5)&&(y=w/x)),Math.abs(y)<v&&(y=y>0?v:-v),f=g,i=j,g+=y,j=a.call(e,g),C+=1,(j>0&&k>0||j<0&&k<0)&&(h=f,k=i),B++}return g},fminbr:function(a,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=.5*(3-Math.sqrt(5)),w=c.eps,x=c.eps,y=this.maxIterationsMinimize,z=0,A=0;if(!b.isArray(d)||d.length<2)throw new Error("JXG.Math.Numerics.fminbr: length of array x0 has to be at least two.");for(f=d[0],g=d[1],i=f+v*(g-f),l=a.call(e,i),A+=1,h=i,j=i,k=l,m=l;z<y;){if(n=g-f,o=.5*(f+g),p=x*Math.abs(h)+w/3,Math.abs(h-o)+.5*n<=2*p)return h;q=v*(h<o?g-h:f-h),Math.abs(h-j)>=p&&(t=(h-j)*(k-l),s=(h-i)*(k-m),r=(h-i)*s-(h-j)*t,s=2*(s-t),s>0?r=-r:s=-s,Math.abs(r)<Math.abs(q*s)&&r>s*(f-h+2*p)&&r<s*(g-h-2*p)&&(q=r/s)),Math.abs(q)<p&&(q=q>0?p:-p),t=h+q,u=a.call(e,t),A+=1,u<=k?(t<h?g=h:f=h,i=j,j=h,h=t,l=m,m=k,k=u):(t<h?f=t:g=t,u<=m||j===h?(i=j,j=t,l=m,m=u):(u<=l||i===h||i===j)&&(i=t,l=u)),z+=1}return h},RamerDouglasPeucker:function(a,b){var d,e,f,g=[],h=function(a,b,d){var e,f,g,h,i,j,k,l,m,n,o,p=0,q=b;if(d-b<2)return[-1,0];if(g=a[b].scrCoords,h=a[d].scrCoords,isNaN(g[1]+g[2]))return[NaN,b];if(isNaN(h[1]+h[2]))return[NaN,d];for(f=b+1;f<d;f++){if(i=a[f].scrCoords,isNaN(i[1]+i[2]))return[NaN,f];j=i[1]-g[1],k=i[2]-g[2],l=h[1]-g[1],m=h[2]-g[2],n=l*l+m*m,n>=c.eps?(o=(j*l+k*m)/n,o<0?o=0:o>1&&(o=1),j-=o*l,k-=o*m,e=j*j+k*k):(o=0,e=j*j+k*k),e>p&&(p=e,q=f)}return[Math.sqrt(p),q]},i=function(a,b,c,d,e){var f=h(a,b,c),g=f[1];if(isNaN(f[0])){i(a,b,g-1,d,e),e.push(a[g]);do++g;while(g<=c&&isNaN(a[g].scrCoords[1]+a[g].scrCoords[2]));g<=c&&e.push(a[g]),i(a,g+1,c,d,e)}else f[0]>d?(i(a,b,g,d,e),i(a,g,c,d,e)):e.push(a[c])};for(f=a.length,d=0;d<f&&isNaN(a[d].scrCoords[1]+a[d].scrCoords[2]);)d+=1;for(e=f-1;e>d&&isNaN(a[e].scrCoords[1]+a[e].scrCoords[2]);)e-=1;return d>e||d===f||(g[0]=a[d],i(a,d,e,b,g)),g},RamerDouglasPeuker:function(b,c){return a.deprecated("Numerics.RamerDouglasPeuker()","Numerics.RamerDouglasPeucker()"),this.RamerDouglasPeucker(b,c)},Visvalingam:function(b,c){var d,e,f,g,h,i,j,k,l,m=[],n=[],o=[];if(e=b.length,e<=2)return b;for(m[0]={used:!0,lft:null,node:null},h=0,d=1;d<e-1;d++)f=Math.abs(a.Math.Numerics.det([b[d-1].usrCoords,b[d].usrCoords,b[d+1].usrCoords])),isNaN(f)||(l={v:f,idx:d},n.push(l),m[d]={used:!0,lft:h,node:l},m[h].rt=d,h=d);for(m[e-1]={used:!0,rt:null,lft:h,node:null},m[h].rt=e-1,g=-(1/0);n.length>c;)n.sort(function(a,b){return b.v-a.v}),d=n.pop().idx,m[d].used=!1,g=m[d].node.v,h=m[d].lft,i=m[d].rt,m[h].rt=i,m[i].lft=h,j=m[h].lft,null!==j&&(f=Math.abs(a.Math.Numerics.det([b[j].usrCoords,b[h].usrCoords,b[i].usrCoords])),m[h].node.v=f>=g?f:g),k=m[i].rt,null!==k&&(f=Math.abs(a.Math.Numerics.det([b[h].usrCoords,b[i].usrCoords,b[k].usrCoords])),m[i].node.v=f>=g?f:g);d=0,o=[b[d]];do d=m[d].rt,o.push(b[d]);while(null!==m[d].rt);return o}},c.Numerics}),define("math/statistics",["jxg","math/math","utils/type"],function(a,b,c){"use strict";return b.Statistics={sum:function(a){var b,c=a.length,d=0;for(b=0;b<c;b++)d+=a[b];return d},prod:function(a){var b,c=a.length,d=1;for(b=0;b<c;b++)d*=a[b];return d},mean:function(a){return a.length>0?this.sum(a)/a.length:0},median:function(a){var b,c;return a.length>0?(b=a.slice(0),b.sort(function(a,b){return a-b}),c=b.length,c%2===1?b[parseInt(.5*c,10)]:.5*(b[.5*c-1]+b[.5*c])):0},variance:function(a){var b,c,d,e=a.length;if(e>1){for(b=this.mean(a),c=0,d=0;d<e;d++)c+=(a[d]-b)*(a[d]-b);return c/(a.length-1)}return 0},sd:function(a){return Math.sqrt(this.variance(a))},weightedMean:function(a,b){if(a.length!==b.length)throw new Error("JSXGraph error (Math.Statistics.weightedMean): Array dimension mismatch.");return a.length>0?this.mean(this.multiply(a,b)):0},max:function(a){return Math.max.apply(this,a)},min:function(a){return Math.min.apply(this,a)},range:function(a){return[this.min(a),this.max(a)]},abs:function(a){var b,d,e;if(c.isArray(a))for(d=a.length,e=[],b=0;b<d;b++)e[b]=Math.abs(a[b]);else e=Math.abs(a);return e},add:function(a,b){var d,e,f=[];if(a=c.evalSlider(a),b=c.evalSlider(b),c.isArray(a)&&c.isNumber(b))for(e=a.length,d=0;d<e;d++)f[d]=a[d]+b;else if(c.isNumber(a)&&c.isArray(b))for(e=b.length,d=0;d<e;d++)f[d]=a+b[d];else if(c.isArray(a)&&c.isArray(b))for(e=Math.min(a.length,b.length),d=0;d<e;d++)f[d]=a[d]+b[d];else f=a+b;return f},div:function(a,b){var d,e,f=[];if(a=c.evalSlider(a),b=c.evalSlider(b),c.isArray(a)&&c.isNumber(b))for(e=a.length,d=0;d<e;d++)f[d]=a[d]/b;else if(c.isNumber(a)&&c.isArray(b))for(e=b.length,d=0;d<e;d++)f[d]=a/b[d];else if(c.isArray(a)&&c.isArray(b))for(e=Math.min(a.length,b.length),d=0;d<e;d++)f[d]=a[d]/b[d];else f=a/b;return f},divide:function(){a.deprecated("Statistics.divide()","Statistics.div()"),b.Statistics.div.apply(b.Statistics,arguments)},mod:function(a,d,e){var f,g,h=[],i=function(a,b){return a%b};if(e=c.def(e,!1),e&&(i=b.mod),a=c.evalSlider(a),d=c.evalSlider(d),c.isArray(a)&&c.isNumber(d))for(g=a.length,f=0;f<g;f++)h[f]=i(a[f],d);else if(c.isNumber(a)&&c.isArray(d))for(g=d.length,f=0;f<g;f++)h[f]=i(a,d[f]);else if(c.isArray(a)&&c.isArray(d))for(g=Math.min(a.length,d.length),f=0;f<g;f++)h[f]=i(a[f],d[f]);else h=i(a,d);return h},multiply:function(a,b){var d,e,f=[];if(a=c.evalSlider(a),b=c.evalSlider(b),c.isArray(a)&&c.isNumber(b))for(e=a.length,d=0;d<e;d++)f[d]=a[d]*b;else if(c.isNumber(a)&&c.isArray(b))for(e=b.length,d=0;d<e;d++)f[d]=a*b[d];else if(c.isArray(a)&&c.isArray(b))for(e=Math.min(a.length,b.length),d=0;d<e;d++)f[d]=a[d]*b[d];else f=a*b;return f},subtract:function(a,b){var d,e,f=[];if(a=c.evalSlider(a),b=c.evalSlider(b),c.isArray(a)&&c.isNumber(b))for(e=a.length,d=0;d<e;d++)f[d]=a[d]-b;else if(c.isNumber(a)&&c.isArray(b))for(e=b.length,d=0;d<e;d++)f[d]=a-b[d];else if(c.isArray(a)&&c.isArray(b))for(e=Math.min(a.length,b.length),d=0;d<e;d++)f[d]=a[d]-b[d];else f=a-b;return f},TheilSenRegression:function(a){var c,d,e=[],f=[],g=[];for(c=0;c<a.length;c++){for(f.length=0,d=0;d<a.length;d++)Math.abs(a[d].usrCoords[1]-a[c].usrCoords[1])>b.eps&&(f[d]=(a[d].usrCoords[2]-a[c].usrCoords[2])/(a[d].usrCoords[1]-a[c].usrCoords[1]));e[c]=this.median(f),g.push(a[c].usrCoords[2]-e[c]*a[c].usrCoords[1])}return[this.median(g),this.median(e),-1]}},b.Statistics}),define("math/geometry",["jxg","base/constants","base/coords","math/math","math/numerics","utils/type","utils/expect"],function(a,b,c,d,e,f,g){"use strict";return d.Geometry={},a.extend(d.Geometry,{angle:function(b,c,d){var e,f,g,h,i=[],j=[],k=[];return a.deprecated("Geometry.angle()","Geometry.rad()"),b.coords?(i[0]=b.coords.usrCoords[1],i[1]=b.coords.usrCoords[2]):(i[0]=b[0],i[1]=b[1]),c.coords?(j[0]=c.coords.usrCoords[1],j[1]=c.coords.usrCoords[2]):(j[0]=c[0],j[1]=c[1]),d.coords?(k[0]=d.coords.usrCoords[1],k[1]=d.coords.usrCoords[2]):(k[0]=d[0],k[1]=d[1]),e=i[0]-j[0],f=i[1]-j[1],g=k[0]-j[0],h=k[1]-j[1],Math.atan2(e*h-f*g,e*g+f*h)},trueAngle:function(a,b,c){return 57.29577951308232*this.rad(a,b,c)},rad:function(a,b,c){var d,e,f,g,h,i,j;return a.coords?(d=a.coords.usrCoords[1],e=a.coords.usrCoords[2]):(d=a[0],e=a[1]),b.coords?(f=b.coords.usrCoords[1],g=b.coords.usrCoords[2]):(f=b[0],g=b[1]),c.coords?(h=c.coords.usrCoords[1],i=c.coords.usrCoords[2]):(h=c[0],i=c[1]),j=Math.atan2(i-g,h-f)-Math.atan2(e-g,d-f),j<0&&(j+=6.283185307179586),j},angleBisector:function(a,d,e,g){var h,i,j,k,l,m=a.coords.usrCoords,n=d.coords.usrCoords,o=e.coords.usrCoords;return f.exists(g)||(g=a.board),0===n[0]?new c(b.COORDS_BY_USER,[1,.5*(m[1]+o[1]),.5*(m[2]+o[2])],g):(k=m[1]-n[1],l=m[2]-n[2],h=Math.atan2(l,k),k=o[1]-n[1],l=o[2]-n[2],i=Math.atan2(l,k),j=.5*(h+i),h>i&&(j+=Math.PI),k=Math.cos(j)+n[1],l=Math.sin(j)+n[2],new c(b.COORDS_BY_USER,[1,k,l],g))},reflection:function(a,d,e){var g,h,i,j,k,l,m,n=d.coords.usrCoords,o=a.point1.coords.usrCoords,p=a.point2.coords.usrCoords;return f.exists(e)||(e=d.board),k=p[1]-o[1],l=p[2]-o[2],g=n[1]-o[1],h=n[2]-o[2],m=(k*h-l*g)/(k*k+l*l),i=n[1]+2*m*l,j=n[2]-2*m*k,new c(b.COORDS_BY_USER,[i,j],e)},rotation:function(a,d,e,g){var h,i,j,k,l,m,n=d.coords.usrCoords,o=a.coords.usrCoords;return f.exists(g)||(g=d.board),h=n[1]-o[1],i=n[2]-o[2],j=Math.cos(e),k=Math.sin(e),l=h*j-i*k+o[1],m=h*k+i*j+o[2],new c(b.COORDS_BY_USER,[l,m],g)},perpendicular:function(a,e,g){var h,i,j,k,l,m=a.point1.coords.usrCoords,n=a.point2.coords.usrCoords,o=e.coords.usrCoords;return f.exists(g)||(g=e.board),e===a.point1?(h=m[1]+n[2]-m[2],i=m[2]-n[1]+m[1],l=m[0]*n[0],Math.abs(l)<d.eps&&(h=n[2],i=-n[1]),k=[l,h,i],j=!0):e===a.point2?(h=n[1]+m[2]-n[2],i=n[2]-m[1]+n[1],l=m[0]*n[0],Math.abs(l)<d.eps&&(h=m[2],i=-m[1]),k=[l,h,i],j=!1):Math.abs(d.innerProduct(o,a.stdform,3))<d.eps?(h=o[1]+n[2]-o[2],i=o[2]-n[1]+o[1],l=n[0],Math.abs(l)<d.eps&&(h=n[2],i=-n[1]),j=!0,Math.abs(l)>d.eps&&Math.abs(h-o[1])<d.eps&&Math.abs(i-o[2])<d.eps&&(h=o[1]+m[2]-o[2],i=o[2]-m[1]+o[1],j=!1),k=[l,h,i]):(k=[0,a.stdform[1],a.stdform[2]],
k=d.crossProduct(k,o),k=d.crossProduct(k,a.stdform),j=!0),[new c(b.COORDS_BY_USER,k,g),j]},circumcenterMidpoint:function(){a.deprecated("Geometry.circumcenterMidpoint()","Geometry.circumcenter()"),this.circumcenter.apply(this,arguments)},circumcenter:function(a,e,g,h){var i,j,k,l,m=a.coords.usrCoords,n=e.coords.usrCoords,o=g.coords.usrCoords;return f.exists(h)||(h=a.board),i=[n[0]-m[0],-n[2]+m[2],n[1]-m[1]],j=[.5*(m[0]+n[0]),.5*(m[1]+n[1]),.5*(m[2]+n[2])],k=d.crossProduct(i,j),i=[o[0]-n[0],-o[2]+n[2],o[1]-n[1]],j=[.5*(n[0]+o[0]),.5*(n[1]+o[1]),.5*(n[2]+o[2])],l=d.crossProduct(i,j),new c(b.COORDS_BY_USER,d.crossProduct(k,l),h)},distance:function(a,b,c){var d,e=0;for(c||(c=Math.min(a.length,b.length)),d=0;d<c;d++)e+=(a[d]-b[d])*(a[d]-b[d]);return Math.sqrt(e)},affineDistance:function(a,b,c){var e;return e=this.distance(a,b,c),e>d.eps&&(Math.abs(a[0])<d.eps||Math.abs(b[0])<d.eps)?1/0:e},sortVertices:function(a){var b,c,e=g.each(a,g.coordsArray),h=e.length;for(b=1;b<h;b++)(e[b][2]<e[0][2]||Math.abs(e[b][2]-e[0][2])<d.eps&&e[b][1]<e[0][1])&&(e=f.swap(e,b,0));return c=e.shift(),e.sort(function(a,b){var d=Math.atan2(a[2]-c[2],a[1]-c[1]),e=Math.atan2(b[2]-c[2],b[1]-c[1]);return d-e}),e.unshift(c),e.unshift(e[e.length-1]),e},signedTriangle:function(a,b,c){var d=g.coordsArray(a),e=g.coordsArray(b),f=g.coordsArray(c);return.5*((e[1]-d[1])*(f[2]-d[2])-(e[2]-d[2])*(f[1]-d[1]))},signedPolygon:function(a,b){var c,d,e=0,f=g.each(a,g.coordsArray);for(void 0===b&&(b=!0),b?f.unshift(f[f.length-1]):f=this.sortVertices(f),d=f.length,c=1;c<d;c++)e+=f[c-1][1]*f[c][2]-f[c][1]*f[c-1][2];return.5*e},GrahamScan:function(a){var b,c=1,d=g.each(a,g.coordsArray),e=d.length;for(d=this.sortVertices(d),e=d.length,b=2;b<e;b++){for(;this.signedTriangle(d[c-1],d[c],d[b])<=0;)if(c>1)c-=1;else{if(b===e-1)break;b+=1}c+=1,d=f.swap(d,c,b)}return d.slice(0,c)},calcStraight:function(a,c,e,g){var h,i,j,k,l,m,n,o,p,q;if(f.exists(g)||(g=10),m=f.evaluate(a.visProp.straightfirst),n=f.evaluate(a.visProp.straightlast),Math.abs(c.scrCoords[0])<d.eps&&(m=!0),Math.abs(e.scrCoords[0])<d.eps&&(n=!0),(m||n)&&(o=[],o[0]=a.stdform[0]-a.stdform[1]*a.board.origin.scrCoords[1]/a.board.unitX+a.stdform[2]*a.board.origin.scrCoords[2]/a.board.unitY,o[1]=a.stdform[1]/a.board.unitX,o[2]=-a.stdform[2]/a.board.unitY,!isNaN(o[0]+o[1]+o[2]))){if(h=!1,i=!1,h=!m&&Math.abs(c.usrCoords[0])>=d.eps&&c.scrCoords[1]>=0&&c.scrCoords[1]<=a.board.canvasWidth&&c.scrCoords[2]>=0&&c.scrCoords[2]<=a.board.canvasHeight,i=!n&&Math.abs(e.usrCoords[0])>=d.eps&&e.scrCoords[1]>=0&&e.scrCoords[1]<=a.board.canvasWidth&&e.scrCoords[2]>=0&&e.scrCoords[2]<=a.board.canvasHeight,j=this.meetLineBoard(o,a.board,g),k=j[0],l=j[1],!h&&!i){if(!m&&n&&!this.isSameDirection(c,e,k)&&!this.isSameDirection(c,e,l))return;if(m&&!n&&!this.isSameDirection(e,c,k)&&!this.isSameDirection(e,c,l))return}h?i||(q=this.isSameDir(c,e,k,l)?l:k):i?p=this.isSameDir(c,e,k,l)?k:l:this.isSameDir(c,e,k,l)?(p=k,q=l):(q=k,p=l),p&&c.setCoordinates(b.COORDS_BY_USER,p.usrCoords),q&&e.setCoordinates(b.COORDS_BY_USER,q.usrCoords)}},calcLineDelimitingPoints:function(a,c,e){var g,h,i,j,k,l,m,n,o,p,q=!1,r=!1;if(l=f.evaluate(a.visProp.straightfirst),m=f.evaluate(a.visProp.straightlast),Math.abs(c.scrCoords[0])<d.eps&&(l=!0),Math.abs(e.scrCoords[0])<d.eps&&(m=!0),n=[],n[0]=a.stdform[0]-a.stdform[1]*a.board.origin.scrCoords[1]/a.board.unitX+a.stdform[2]*a.board.origin.scrCoords[2]/a.board.unitY,n[1]=a.stdform[1]/a.board.unitX,n[2]=-a.stdform[2]/a.board.unitY,!isNaN(n[0]+n[1]+n[2])){if(q=!l,r=!m,h=a.board.getBoundingBox(),i=a.getSlope(),i>=0?(j=this.projectPointToLine({coords:{usrCoords:[1,h[2],h[1]]}},a,a.board),k=this.projectPointToLine({coords:{usrCoords:[1,h[0],h[3]]}},a,a.board)):(j=this.projectPointToLine({coords:{usrCoords:[1,h[0],h[1]]}},a,a.board),k=this.projectPointToLine({coords:{usrCoords:[1,h[2],h[3]]}},a,a.board)),!q&&!r){if(!l&&!m){if(g=c.distance(b.COORDS_BY_USER,e),Math.abs(c.distance(b.COORDS_BY_USER,j)+j.distance(b.COORDS_BY_USER,e)-g)>d.eps)return;if(Math.abs(c.distance(b.COORDS_BY_USER,k)+k.distance(b.COORDS_BY_USER,e)-g)>d.eps)return}if(!l&&m&&!this.isSameDirection(c,e,j)&&!this.isSameDirection(c,e,k))return;if(l&&!m&&!this.isSameDirection(e,c,j)&&!this.isSameDirection(e,c,k))return}q?r||(p=this.isSameDir(c,e,j,k)?k:j):r?o=this.isSameDir(c,e,j,k)?j:k:this.isSameDir(c,e,j,k)?(o=j,p=k):(p=j,o=k),o&&c.setCoordinates(b.COORDS_BY_USER,o.usrCoords),p&&e.setCoordinates(b.COORDS_BY_USER,p.usrCoords)}},calcLabelQuadrant:function(a){var b;return a<0&&(a+=2*Math.PI),b=Math.floor((a+Math.PI/8)/(Math.PI/4))%8,["rt","urt","top","ulft","lft","llft","lrt"][b]},isSameDir:function(a,b,c,e){var f=b.usrCoords[1]-a.usrCoords[1],g=b.usrCoords[2]-a.usrCoords[2],h=e.usrCoords[1]-c.usrCoords[1],i=e.usrCoords[2]-c.usrCoords[2];return Math.abs(b.usrCoords[0])<d.eps&&(f=b.usrCoords[1],g=b.usrCoords[2]),Math.abs(a.usrCoords[0])<d.eps&&(f=-a.usrCoords[1],g=-a.usrCoords[2]),f*h+g*i>=0},isSameDirection:function(a,b,c){var e,f,g,h,i=!1;return e=b.usrCoords[1]-a.usrCoords[1],f=b.usrCoords[2]-a.usrCoords[2],g=c.usrCoords[1]-a.usrCoords[1],h=c.usrCoords[2]-a.usrCoords[2],Math.abs(e)<d.eps&&(e=0),Math.abs(f)<d.eps&&(f=0),Math.abs(g)<d.eps&&(g=0),Math.abs(h)<d.eps&&(h=0),e>=0&&g>=0?i=f>=0&&h>=0||f<=0&&h<=0:e<=0&&g<=0&&(i=f>=0&&h>=0||f<=0&&h<=0),i},intersectionFunction:function(a,d,e,g,h,i){var j,k=this;return j=d.elementClass===b.OBJECT_CLASS_CURVE&&e.elementClass===b.OBJECT_CLASS_CURVE?function(){return k.meetCurveCurve(d,e,g,h,d.board)}:d.elementClass===b.OBJECT_CLASS_CURVE&&e.elementClass===b.OBJECT_CLASS_LINE||e.elementClass===b.OBJECT_CLASS_CURVE&&d.elementClass===b.OBJECT_CLASS_LINE?function(){return k.meetCurveLine(d,e,g,d.board,i)}:d.elementClass===b.OBJECT_CLASS_LINE&&e.elementClass===b.OBJECT_CLASS_LINE?function(){var a,h,j,l,m,n;return j=l=f.evaluate(d.visProp.straightfirst),m=n=f.evaluate(d.visProp.straightlast),f.evaluate(i)||j&&m&&l&&n?k.meet(d.stdform,e.stdform,g,d.board):(a=k.meetSegmentSegment(d.point1.coords.usrCoords,d.point2.coords.usrCoords,e.point1.coords.usrCoords,e.point2.coords.usrCoords,d.board),h=!j&&a[1]<0||!m&&a[1]>1||!l&&a[2]<0||!n&&a[2]>1?[0,NaN,NaN]:a[0],new c(b.COORDS_BY_USER,h,d.board))}:function(){return k.meet(d.stdform,e.stdform,g,d.board)}},meet:function(a,b,c,e){var f,g=d.eps;return f=Math.abs(a[3])<g&&Math.abs(b[3])<g?this.meetLineLine(a,b,c,e):Math.abs(a[3])>=g&&Math.abs(b[3])<g?this.meetLineCircle(b,a,c,e):Math.abs(a[3])<g&&Math.abs(b[3])>=g?this.meetLineCircle(a,b,c,e):this.meetCircleCircle(a,b,c,e)},meetLineBoard:function(a,e,g){var h,i,j,k,l=[];for(f.exists(g)||(g=0),l[0]=d.crossProduct(a,[g,0,1]),l[1]=d.crossProduct(a,[g,1,0]),l[2]=d.crossProduct(a,[-g-e.canvasHeight,0,1]),l[3]=d.crossProduct(a,[-g-e.canvasWidth,1,0]),j=0;j<4;j++)if(Math.abs(l[j][0])>d.eps){for(k=2;k>0;k--)l[j][k]/=l[j][0];l[j][0]=1}return Math.abs(l[1][0])<d.eps?(h=l[0],i=l[2]):Math.abs(l[0][0])<d.eps?(h=l[1],i=l[3]):l[1][2]<0?(h=l[0],i=l[3][2]>e.canvasHeight?l[2]:l[3]):l[1][2]>e.canvasHeight?(h=l[2],i=l[3][2]<0?l[0]:l[3]):(h=l[1],i=l[3][2]<0?l[0]:l[3][2]>e.canvasHeight?l[2]:l[3]),h=new c(b.COORDS_BY_SCREEN,h.slice(1),e),i=new c(b.COORDS_BY_SCREEN,i.slice(1),e),[h,i]},meetLineLine:function(a,e,f,g){var h=isNaN(a[5]+e[5])?[0,0,0]:d.crossProduct(a,e);return new c(b.COORDS_BY_USER,h,g)},meetLineCircle:function(a,e,f,g){var h,i,j,k,l,m,n,o,p,q;return e[4]<d.eps?Math.abs(d.innerProduct([1,e[6],e[7]],a,3))<d.eps?new c(b.COORDS_BY_USER,e.slice(6,8),g):new c(b.COORDS_BY_USER,[NaN,NaN],g):(j=e[0],i=e.slice(1,3),h=e[3],k=a[0],l=a.slice(1,3),m=h,n=i[0]*l[1]-i[1]*l[0],o=h*k*k-(i[0]*l[0]+i[1]*l[1])*k+j,p=n*n-4*m*o,p>-d.eps*d.eps?(p=Math.sqrt(Math.abs(p)),q=[(-n+p)/(2*m),(-n-p)/(2*m)],0===f?new c(b.COORDS_BY_USER,[-q[0]*-l[1]-k*l[0],-q[0]*l[0]-k*l[1]],g):new c(b.COORDS_BY_USER,[-q[1]*-l[1]-k*l[0],-q[1]*l[0]-k*l[1]],g)):new c(b.COORDS_BY_USER,[0,0,0],g))},meetCircleCircle:function(a,e,f,g){var h;return a[4]<d.eps?Math.abs(this.distance(a.slice(6,2),e.slice(6,8))-e[4])<d.eps?new c(b.COORDS_BY_USER,a.slice(6,8),g):new c(b.COORDS_BY_USER,[0,0,0],g):e[4]<d.eps?Math.abs(this.distance(e.slice(6,2),a.slice(6,8))-a[4])<d.eps?new c(b.COORDS_BY_USER,e.slice(6,8),g):new c(b.COORDS_BY_USER,[0,0,0],g):(h=[e[3]*a[0]-a[3]*e[0],e[3]*a[1]-a[3]*e[1],e[3]*a[2]-a[3]*e[2],0,1,1/0,1/0,1/0],h=d.normalize(h),this.meetLineCircle(h,a,f,g))},meetCurveCurve:function(a,d,g,h,i,j){var k;return k=f.exists(j)&&"newton"===j?e.generalizedNewton(a,d,g,h):3===a.bezierDegree&&3===d.bezierDegree?this.meetBezierCurveRedBlueSegments(a,d,g):this.meetCurveRedBlueSegments(a,d,g),new c(b.COORDS_BY_USER,k,i)},meetCurveLine:function(a,c,d,e,g){var h,i,j=[0,NaN,NaN];return f.exists(e)||(e=a.board),a.elementClass===b.OBJECT_CLASS_CURVE?(h=a,i=c):(h=c,i=a),j=this.meetCurveLineDiscrete(h,i,d,e,!g)},meetCurveLineContinuous:function(a,f,g,h,i){var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=d.eps,y=d.eps;for(m=this.meetCurveLineDiscrete(a,f,g,h,i),n=m.usrCoords[1],o=m.usrCoords[2],k=function(b){var c,d;return b>a.maxX()||b<a.minX()?1/0:(c=n-a.X(b),d=o-a.Y(b),c*c+d*d)},l=function(b){var c=f.stdform[0]+f.stdform[1]*a.X(b)+f.stdform[2]*a.Y(b);return c*c},q=50,r=(a.maxX()-a.minX())/q,s=a.minX(),v=1e-4,u=NaN,t=0;t<q&&(j=e.root(k,[Math.max(s,a.minX()),Math.min(s+r,a.maxX())]),w=Math.abs(k(j)),!(w<=v&&(v=w,u=j,v<x)));t++)s+=r;return j=u,j=e.root(l,[Math.max(j-r,a.minX()),Math.min(j+r,a.maxX())]),w=l(j),p=isNaN(w)||Math.abs(w)>y?0:1,new c(b.COORDS_BY_USER,[p,a.X(j),a.Y(j)],h)},meetCurveLineContinuousOld:function(f,g,h,i){var j,k,l,m,n,o,p,q,r,s,t,u,v=10*d.eps;if(a.deprecated("Geometry.meetCurveLineContinuousOld()","Geometry.meetCurveLineContinuous()"),m=function(a){var b=g.stdform[0]+g.stdform[1]*f.X(a)+g.stdform[2]*f.Y(a);return b*b},this.meetCurveLineContinuous.t1memo?(r=this.meetCurveLineContinuous.t1memo,j=e.root(m,r)):(r=f.minX(),s=f.maxX(),j=e.root(m,[r,s])),this.meetCurveLineContinuous.t1memo=j,t=f.X(j),u=f.Y(j),1===h){if(this.meetCurveLineContinuous.t2memo&&(r=this.meetCurveLineContinuous.t2memo),k=e.root(m,r),!(Math.abs(k-j)>.1&&Math.abs(t-f.X(k))>.1&&Math.abs(u-f.Y(k))>.1))for(p=20,q=(f.maxX()-f.minX())/p,o=f.minX(),l=0;l<p&&(k=e.root(m,[o,o+q]),!(Math.abs(m(k))<=v&&Math.abs(k-j)>.1&&Math.abs(t-f.X(k))>.1&&Math.abs(u-f.Y(k))>.1));l++)o+=q;j=k,this.meetCurveLineContinuous.t2memo=j}return n=Math.abs(m(j))>v?NaN:1,new c(b.COORDS_BY_USER,[n,f.X(j),f.Y(j)],i)},meetCurveLineDiscrete:function(a,e,g,h,i){var j,k,l,m,n,o,p,q,r=e.point1.coords.usrCoords,s=e.point2.coords.usrCoords,t=0,u=a.numberPoints,v=f.evaluate(e.visProp.straightfirst),w=f.evaluate(e.visProp.straightlast);for(o=new c(b.COORDS_BY_USER,[0,NaN,NaN],h),0===r[0]?r=[1,s[1]+e.stdform[2],s[2]-e.stdform[1]]:0===s[0]&&(s=[1,r[1]+e.stdform[2],r[2]-e.stdform[1]]),m=a.points[0].usrCoords,j=1;j<u;j++)if(l=m.slice(0),m=a.points[j].usrCoords,p=this.distance(l,m),p>d.eps)for(3===a.bezierDegree?(q=this.meetBeziersegmentBeziersegment([a.points[j-1].usrCoords.slice(1),a.points[j].usrCoords.slice(1),a.points[j+1].usrCoords.slice(1),a.points[j+2].usrCoords.slice(1)],[r.slice(1),s.slice(1)],i),j+=2):q=[this.meetSegmentSegment(l,m,r,s)],k=0;k<q.length;k++)if(n=q[k],0<=n[1]&&n[1]<=1){if(t===g)return i&&(!v&&n[2]<0||!w&&n[2]>1)?o:o=new c(b.COORDS_BY_USER,n[0],h);t+=1}return o},meetCurveRedBlueSegments:function(a,b,c){var d,e,f,g,h,i,j,k,l,m=0,n=b.numberPoints,o=a.numberPoints;if(n<=1||o<=1)return[0,NaN,NaN];for(d=1;d<o;d++)for(f=a.points[d-1].usrCoords,g=a.points[d].usrCoords,k=Math.min(f[1],g[1]),l=Math.max(f[1],g[1]),i=b.points[0].usrCoords,e=1;e<n;e++)if(h=i,i=b.points[e].usrCoords,Math.min(h[1],i[1])<l&&Math.max(h[1],i[1])>k&&(j=this.meetSegmentSegment(f,g,h,i),j[1]>=0&&j[2]>=0&&(j[1]<1&&j[2]<1||d===o-1&&1===j[1]||e===n-1&&1===j[2]))){if(m===c)return j[0];m++}return[0,NaN,NaN]},meetSegmentSegment:function(a,b,c,e){var f,g,h,i=d.crossProduct(a,b),j=d.crossProduct(c,e),k=d.crossProduct(i,j),l=k[0];return Math.abs(l)<d.eps?[k,1/0,1/0]:(h=[c[1]-a[1],c[2]-a[2]],f=(h[0]*(e[2]-c[2])-h[1]*(e[1]-c[1]))/l,g=(h[0]*(b[2]-a[2])-h[1]*(b[1]-a[1]))/l,[k,f,g])},_bezierSplit:function(a){var b,c,d,e,f,g;return b=[.5*(a[0][0]+a[1][0]),.5*(a[0][1]+a[1][1])],c=[.5*(a[1][0]+a[2][0]),.5*(a[1][1]+a[2][1])],d=[.5*(a[2][0]+a[3][0]),.5*(a[2][1]+a[3][1])],e=[.5*(b[0]+c[0]),.5*(b[1]+c[1])],f=[.5*(c[0]+d[0]),.5*(c[1]+d[1])],g=[.5*(e[0]+f[0]),.5*(e[1]+f[1])],[[a[0],b,e,g],[g,f,d,a[3]]]},_bezierBbox:function(a){var b=[];return 4===a.length?(b[0]=Math.min(a[0][0],a[1][0],a[2][0],a[3][0]),b[1]=Math.max(a[0][1],a[1][1],a[2][1],a[3][1]),b[2]=Math.max(a[0][0],a[1][0],a[2][0],a[3][0]),b[3]=Math.min(a[0][1],a[1][1],a[2][1],a[3][1])):(b[0]=Math.min(a[0][0],a[1][0]),b[1]=Math.max(a[0][1],a[1][1]),b[2]=Math.max(a[0][0],a[1][0]),b[3]=Math.min(a[0][1],a[1][1])),b},_bezierOverlap:function(a,b){return a[2]>=b[0]&&a[0]<=b[2]&&a[1]>=b[3]&&a[3]<=b[1]},_bezierListConcat:function(a,b,c,d){var e,g=f.exists(d),h=0,i=b.length,j=a.length;for(j>0&&i>0&&(1===a[j-1][1]&&0===b[0][1]||g&&1===a[j-1][2]&&0===b[0][2])&&(h=1),e=h;e<i;e++)g&&(b[e][2]*=.5,b[e][2]+=d),b[e][1]*=.5,b[e][1]+=c,a.push(b[e])},_bezierMeetSubdivision:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=[],q=5;return e=this._bezierBbox(b),d=this._bezierBbox(a),this._bezierOverlap(e,d)?c<q?(f=this._bezierSplit(a),i=f[0],j=f[1],f=this._bezierSplit(b),g=f[0],h=f[1],this._bezierListConcat(p,this._bezierMeetSubdivision(i,g,c+1),0,0),this._bezierListConcat(p,this._bezierMeetSubdivision(i,h,c+1),0,.5),this._bezierListConcat(p,this._bezierMeetSubdivision(j,g,c+1),.5,0),this._bezierListConcat(p,this._bezierMeetSubdivision(j,h,c+1),.5,.5),p):(n=[1].concat(a[0]),o=[1].concat(a[3]),l=[1].concat(b[0]),m=[1].concat(b[3]),k=this.meetSegmentSegment(n,o,l,m),k[1]>=0&&k[2]>=0&&k[1]<=1&&k[2]<=1?[k]:[]):[]},_bezierLineMeetSubdivision:function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o=[],p=5;return e=this._bezierBbox(b),f=this._bezierBbox(a),d&&!this._bezierOverlap(f,e)?[]:c<p?(g=this._bezierSplit(a),h=g[0],i=g[1],this._bezierListConcat(o,this._bezierLineMeetSubdivision(h,b,c+1),0),this._bezierListConcat(o,this._bezierLineMeetSubdivision(i,b,c+1),.5),o):(m=[1].concat(a[0]),n=[1].concat(a[3]),k=[1].concat(b[0]),l=[1].concat(b[1]),j=this.meetSegmentSegment(m,n,k,l),j[1]>=0&&j[1]<=1&&(!d||j[2]>=0&&j[2]<=1)?[j]:[])},meetBeziersegmentBeziersegment:function(a,b,c){var d,e,f;for(d=4===a.length&&4===b.length?this._bezierMeetSubdivision(a,b,0):this._bezierLineMeetSubdivision(a,b,0,c),d.sort(function(a,b){return 1e7*(a[1]-b[1])+(a[2]-b[2])}),e=[],f=0;f<d.length;f++)0!==f&&d[f][1]===d[f-1][1]&&d[f][2]===d[f-1][2]||e.push(d[f]);return e},meetBezierCurveRedBlueSegments:function(a,b,c){var d,e,f,g,h,i,j,k=b.numberPoints,l=a.numberPoints,m=[];if(k<4||l<4)return[0,NaN,NaN];for(e=0;e<l-3;e+=3)for(d=a.points,g=[[d[e].usrCoords[1],d[e].usrCoords[2]],[d[e+1].usrCoords[1],d[e+1].usrCoords[2]],[d[e+2].usrCoords[1],d[e+2].usrCoords[2]],[d[e+3].usrCoords[1],d[e+3].usrCoords[2]]],i=this._bezierBbox(g),f=0;f<k-3;f+=3)if(d=b.points,h=[[d[f].usrCoords[1],d[f].usrCoords[2]],[d[f+1].usrCoords[1],d[f+1].usrCoords[2]],[d[f+2].usrCoords[1],d[f+2].usrCoords[2]],[d[f+3].usrCoords[1],d[f+3].usrCoords[2]]],j=this._bezierBbox(h),this._bezierOverlap(i,j)&&(m=m.concat(this.meetBeziersegmentBeziersegment(g,h)),m.length>c))return m[c][0];return m.length>c?m[c][0]:[0,NaN,NaN]},bezierSegmentEval:function(a,b){var c,d,e,f=1-a;return d=0,e=0,c=f*f*f,d+=c*b[0][0],e+=c*b[0][1],c=3*a*f*f,d+=c*b[1][0],e+=c*b[1][1],c=3*a*a*f,d+=c*b[2][0],e+=c*b[2][1],c=a*a*a,d+=c*b[3][0],e+=c*b[3][1],[1,d,e]},bezierArc:function(a,b,c,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=.5*Math.PI,y=b[1],z=b[2],A=b[0],B=[],C=[];for(k=this.distance(b,a),y/=A,z/=A,l=this.rad(a.slice(1),b.slice(1),c.slice(1)),f===-1&&(l=2*Math.PI-l),g=a,g[1]/=g[0],g[2]/=g[0],g[0]/=g[0],j=g.slice(0),e?(B=[y,y+.333*(g[1]-y),y+.666*(g[1]-y),g[1]],C=[z,z+.333*(g[2]-z),z+.666*(g[2]-z),g[2]]):(B=[g[1]],C=[g[2]]);l>d.eps;)l>x?(m=x,l-=x):(m=l,l=0),n=Math.cos(f*m),o=Math.sin(f*m),w=[[1,0,0],[y*(1-n)+z*o,n,-o],[z*(1-n)-y*o,o,n]],u=d.matVecMult(w,g),j=[u[0]/u[0],u[1]/u[0],u[2]/u[0]],p=g[1]-y,q=g[2]-z,r=j[1]-y,s=j[2]-z,v=Math.sqrt((p+r)*(p+r)+(q+s)*(q+s)),t=Math.abs(s-q)>d.eps?(p+r)*(k/v-.5)/(s-q)*8/3:(q+s)*(k/v-.5)/(p-r)*8/3,h=[1,g[1]-t*q,g[2]+t*p],i=[1,j[1]+t*s,j[2]-t*r],B=B.concat([h[1],i[1],j[1]]),C=C.concat([h[2],i[2],j[2]]),g=j.slice(0);return e&&(B=B.concat([j[1]+.333*(y-j[1]),j[1]+.666*(y-j[1]),y]),C=C.concat([j[2]+.333*(z-j[2]),j[2]+.666*(z-j[2]),z])),[B,C]},projectPointToCircle:function(a,e,g){var h,i,j,k,l,m=e.center.coords.usrCoords;return f.exists(g)||(g=a.board),f.isPoint(a)?(h=a.coords.distance(b.COORDS_BY_USER,e.center.coords),i=a.coords.usrCoords):(h=a.distance(b.COORDS_BY_USER,e.center.coords),i=a.usrCoords),Math.abs(h)<d.eps&&(h=d.eps),l=e.Radius()/h,j=m[1]+l*(i[1]-m[1]),k=m[2]+l*(i[2]-m[2]),new c(b.COORDS_BY_USER,[j,k],g)},projectPointToLine:function(a,e,g){var h=[0,e.stdform[1],e.stdform[2]];return f.exists(g)||(g=a.board),h=d.crossProduct(h,a.coords.usrCoords),new c(b.COORDS_BY_USER,d.crossProduct(h,e.stdform),g)},projectCoordsToSegment:function(a,b,c){var e,f,g=[c[1]-b[1],c[2]-b[2]],h=[a[1]-b[1],a[2]-b[2]];return Math.abs(g[0])<d.eps&&Math.abs(g[1])<d.eps?[b,0]:(e=d.innerProduct(h,g),f=d.innerProduct(g,g),e/=f,[[1,e*g[0]+b[1],e*g[1]+b[2]],e])},projectCoordsToBeziersegment:function(b,c,d){var e,f=function(a){var e=[1,c.X(d+a),c.Y(d+a)];return e[1]-=b[1],e[2]-=b[2],e[1]*e[1]+e[2]*e[2]};return e=a.Math.Numerics.fminbr(f,[0,1]),[[1,c.X(e+d),c.Y(e+d)],e]},projectPointToCurve:function(a,b,c){f.exists(c)||(c=a.board);var d=a.X(),e=a.Y(),g=a.position||0,h=this.projectCoordsToCurve(d,e,g,b,c);return a.position=h[1],h[0]},projectCoordsToCurve:function(a,d,g,h,i){var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=Number.POSITIVE_INFINITY;if(f.exists(i)||(i=h.board),"plot"===f.evaluate(h.visProp.curvetype)){if(g=0,n=E,j=0===h.numberPoints?[0,1,1]:[h.Z(0),h.X(0),h.Y(0)],h.numberPoints>1)for(q=[1,a,d],3===h.bezierDegree?m=0:t=[h.Z(0),h.X(0),h.Y(0)],l=0;l<h.numberPoints-1;l++)3===h.bezierDegree?v=this.projectCoordsToBeziersegment(q,h,m):(u=[h.Z(l+1),h.X(l+1),h.Y(l+1)],v=this.projectCoordsToSegment(q,t,u)),p=v[1],r=v[0],0<=p&&p<=1?(o=this.distance(r,q),s=l+p):p<0?(r=t,o=this.distance(t,q),s=l):p>1&&l===h.numberPoints-2&&(r=u,o=this.distance(r,q),s=h.numberPoints-1),o<n&&(n=o,g=s,j=r),3===h.bezierDegree?(m++,l+=2):t=u;k=new c(b.COORDS_BY_USER,j,i)}else{for(w=function(b){var c,e;return b<h.minX()||b>h.maxX()?NaN:(c=a-h.X(b),e=d-h.Y(b),c*c+e*e)},z=w(g),B=50,A=(h.maxX()-h.minX())/B,x=h.minX(),l=0;l<B;l++)y=w(x),(y<z||isNaN(z))&&(g=x,z=y),x+=A;g=e.fminbr(w,[g-A,g+A]),C=h.minX(),D=h.maxX(),g=g<C?C:g,g=g>D?D:g,k=new c(b.COORDS_BY_USER,[h.X(g),h.Y(g)],i)}return[h.updateTransform(k),g]},projectCoordsToPolygon:function(b,c){var d,e,f,g,h=c.vertices.length,i=1/0;for(d=0;d<h;d++)f=a.Math.Geometry.projectCoordsToSegment(b,c.vertices[d].coords.usrCoords,c.vertices[(d+1)%h].coords.usrCoords),e=a.Math.Geometry.distance(f[0],b,3),0<=f[1]&&f[1]<=1&&e<i&&(g=f[0].slice(0),i=e);return g},projectPointToTurtle:function(a,d,e){var g,h,i,j,k,l,m,n,o=0,p=0,q=Number.POSITIVE_INFINITY,r=d.objects.length;for(f.exists(e)||(e=a.board),k=0;k<r;k++)m=d.objects[k],m.elementClass===b.OBJECT_CLASS_CURVE&&(g=this.projectPointToCurve(a,m),l=this.distance(g.usrCoords,a.coords.usrCoords),l<q&&(i=g.usrCoords[1],j=g.usrCoords[2],h=a.position,q=l,n=m,p=o),o+=m.numberPoints);return g=new c(b.COORDS_BY_USER,[i,j],e),a.position=h+p,n.updateTransform(g)},projectPointToPoint:function(a,b){return b.coords},projectPointToBoard:function(a,b){var c,e,f,g=b||a.board,h=[[1,1,0,0,3,0,1],[-1,2,1,0,1,2,1],[-1,1,2,2,1,2,3],[1,2,3,0,3,2,3]],i=a.coords||a,j=g.getBoundingBox();for(c=0;c<4;c++)f=h[c],f[0]*i.usrCoords[f[1]]<f[0]*j[f[2]]&&(e=d.crossProduct([1,j[f[3]],j[f[4]]],[1,j[f[5]],j[f[6]]]),e[3]=0,e=d.normalize(e),i=this.projectPointToLine({coords:i},{stdform:e},g));return i},distPointLine:function(a,b){var c,e=b[1],f=b[2],g=b[0];return Math.abs(e)+Math.abs(f)<d.eps?Number.POSITIVE_INFINITY:(c=e*a[1]+f*a[2]+g,e*=e,f*=f,Math.abs(c)/Math.sqrt(e+f))},reuleauxPolygon:function(a,b){var c,e=2*Math.PI,f=e/b,g=(b-1)/2,h=0,i=function(i,j){return function(k,l){var m=(k%e+e)%e,n=Math.floor(m/f)%b;return l||(h=a[0].Dist(a[g]),c=d.Geometry.rad([a[0].X()+1,a[0].Y()],a[0],a[g%b])),isNaN(n)?n:(m=.5*m+n*f*.5+c,a[n][i]()+h*Math[j](m))}};return[i("X","cos"),i("Y","sin"),0,e]}}),d.Geometry}),define("utils/zip",["jxg"],function(a){"use strict";var b=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],d=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],f=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],g=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],h=256;return a.Util=a.Util||{},a.Util.Unzip=function(i){function j(){return L+=8,J<I?i[J++]:-1}function k(){K=1}function l(){var a;try{return L++,a=1&K,K>>=1,0===K&&(K=j(),a=1&K,K=K>>1|128),a}catch(b){throw b}}function m(a){var c=0,d=a;try{for(;d--;)c=c<<1|l();a&&(c=b[c]>>8-a)}catch(e){throw e}return c}function n(){G=0}function o(a){x++,F[G++]=a,C.push(String.fromCharCode(a)),32768===G&&(G=0)}function p(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1}function q(){for(;;){if(R[Q]>=A)return-1;if(z[R[Q]]===Q)return R[Q]++;R[Q]++}}function r(){var a,b=P[O];if(17===Q)return-1;if(O++,Q++,a=q(),a>=0)b.b0=a;else if(b.b0=32768,r())return-1;if(a=q(),a>=0)b.b1=a,b.jump=null;else if(b.b1=32768,b.jump=P[O],b.jumppos=O,r())return-1;return Q--,0}function s(a,b,c,d){var e;for(P=a,O=0,z=c,A=b,e=0;e<17;e++)R[e]=0;return Q=0,r()?-1:0}function t(a){for(var b,c,d,e=0,f=a[e];;)if(d=l()){if(!(32768&f.b1))return f.b1;for(f=f.jump,b=a.length,c=0;c<b;c++)if(a[c]===f){e=c;break}}else{if(!(32768&f.b0))return f.b0;e++,f=a[e]}}function u(){var h,i,q,r,u,v,w,x,y,z,A,B,C,D,E,H,I;do if(h=l(),q=m(2),0===q)for(k(),z=j(),z|=j()<<8,B=j(),B|=j()<<8,65535&(z^~B)&&a.debug("BlockLen checksum mismatch\n");z--;)i=j(),o(i);else if(1===q)for(;;)if(u=b[m(7)]>>1,u>23?(u=u<<1|l(),u>199?(u-=128,u=u<<1|l()):(u-=48,u>143&&(u+=136))):u+=256,u<256)o(u);else{if(256===u)break;for(u-=257,y=m(d[u])+c[u],u=b[m(5)]>>3,f[u]>8?(A=m(8),A|=m(f[u]-8)<<8):A=m(f[u]),A+=e[u],u=0;u<y;u++)i=F[G-A&32767],o(i)}else if(2===q){for(w=new Array(320),D=257+m(5),E=1+m(5),H=4+m(4),u=0;u<19;u++)w[u]=0;for(u=0;u<H;u++)w[g[u]]=m(3);for(y=N.length,r=0;r<y;r++)N[r]=new p;if(s(N,19,w,0))return n(),1;for(C=D+E,r=0,I=-1;r<C;)if(I++,u=t(N),u<16)w[r++]=u;else if(16===u){if(u=3+m(2),r+u>C)return n(),1;for(v=r?w[r-1]:0;u--;)w[r++]=v}else{if(u=17===u?3+m(3):11+m(7),r+u>C)return n(),1;for(;u--;)w[r++]=0}for(y=M.length,r=0;r<y;r++)M[r]=new p;if(s(M,D,w,0))return n(),1;for(y=M.length,r=0;r<y;r++)N[r]=new p;for(x=[],r=D;r<w.length;r++)x[r-D]=w[r];if(s(N,E,x,0))return n(),1;for(;;)if(u=t(M),u>=256){if(u-=256,0===u)break;for(u-=1,y=m(d[u])+c[u],u=t(N),f[u]>8?(A=m(8),A|=m(f[u]-8)<<8):A=m(f[u]),A+=e[u];y--;)i=F[G-A&32767],o(i)}else o(u)}while(!h);return n(),k(),0}function v(){var a,b,c,d,e,f,g,i,k=[];try{if(C=[],H=!1,k[0]=j(),k[1]=j(),120===k[0]&&218===k[1]&&(u(),E[D]=[C.join(""),"geonext.gxt"],D++),31===k[0]&&139===k[1]&&(B(),E[D]=[C.join(""),"file"],D++),80===k[0]&&75===k[1]&&(H=!0,k[2]=j(),k[3]=j(),3===k[2]&&4===k[3])){for(k[0]=j(),k[1]=j(),w=j(),w|=j()<<8,i=j(),i|=j()<<8,j(),j(),j(),j(),g=j(),g|=j()<<8,g|=j()<<16,g|=j()<<24,f=j(),f|=j()<<8,f|=j()<<16,f|=j()<<24,e=j(),e|=j()<<8,e|=j()<<16,e|=j()<<24,d=j(),d|=j()<<8,c=j(),c|=j()<<8,a=0,S=[];d--;)b=j(),"/"===b|":"===b?a=0:a<h-1&&(S[a++]=String.fromCharCode(b));for(y||(y=S),a=0;a<c;)b=j(),a++;x=0,8===i&&(u(),E[D]=new Array(2),E[D][0]=C.join(""),E[D][1]=S.join(""),D++),B()}}catch(l){throw l}}var w,x,y,z,A,B,C=[],D=0,E=[],F=new Array(32768),G=0,H=!1,I=i.length,J=0,K=1,L=0,M=new Array(288),N=new Array(32),O=0,P=null,Q=(new Array(64),new Array(64),0),R=new Array(17),S=[];R[0]=0,B=function(){var a,b,c,d,e,f,g=[];if(8&w&&(g[0]=j(),g[1]=j(),g[2]=j(),g[3]=j(),80===g[0]&&75===g[1]&&7===g[2]&&8===g[3]?(a=j(),a|=j()<<8,a|=j()<<16,a|=j()<<24):a=g[0]|g[1]<<8|g[2]<<16|g[3]<<24,b=j(),b|=j()<<8,b|=j()<<16,b|=j()<<24,c=j(),c|=j()<<8,c|=j()<<16,c|=j()<<24),H&&v(),g[0]=j(),8===g[0]){if(w=j(),j(),j(),j(),j(),j(),d=j(),4&w)for(g[0]=j(),g[2]=j(),Q=g[0]+256*g[1],e=0;e<Q;e++)j();if(8&w)for(e=0,S=[],f=j();f;)"7"!==f&&":"!==f||(e=0),e<h-1&&(S[e++]=f),f=j();if(16&w)for(f=j();f;)f=j();2&w&&(j(),j()),u(),a=j(),a|=j()<<8,a|=j()<<16,a|=j()<<24,c=j(),c|=j()<<8,c|=j()<<16,c|=j()<<24,H&&v()}},a.Util.Unzip.prototype.unzipFile=function(a){var b;for(this.unzip(),b=0;b<E.length;b++)if(E[b][1]===a)return E[b][0];return""},a.Util.Unzip.prototype.unzip=function(){return v(),E}},a.Util}),define("utils/encoding",["jxg"],function(a){"use strict";var b=0,c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,3,3,3,3,3,3,3,3,3,3,3,3,4,3,3,11,6,6,6,5,8,8,8,8,8,8,8,8,8,8,8,0,12,24,36,60,96,84,12,12,12,48,72,12,12,12,12,12,12,12,12,12,12,12,12,12,0,12,12,12,12,12,0,12,0,12,12,12,24,12,12,12,12,12,24,12,24,12,12,12,12,12,12,12,12,12,24,12,12,12,12,12,24,12,12,12,12,12,12,12,24,12,12,12,12,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,12,12,12,12,12];return a.Util=a.Util||{},a.Util.UTF8={encode:function(a){var b,c,d="",e=a.length;if(a=a.replace(/\r\n/g,"\n"),"function"==typeof unescape&&"function"==typeof encodeURIComponent)return unescape(encodeURIComponent(a));for(b=0;b<e;b++)c=a.charCodeAt(b),c<128?d+=String.fromCharCode(c):c>127&&c<2048?(d+=String.fromCharCode(c>>6|192),d+=String.fromCharCode(63&c|128)):(d+=String.fromCharCode(c>>12|224),d+=String.fromCharCode(c>>6&63|128),d+=String.fromCharCode(63&c|128));return d},decode:function(a){var d,e,f,g=0,h=0,i=b,j=[],k=a.length,l=[];for(d=0;d<k;d++)e=a.charCodeAt(d),f=c[e],h=i!==b?63&e|h<<6:255>>f&e,i=c[256+i+f],i===b&&(h>65535?j.push(55232+(h>>10),56320+(1023&h)):j.push(h),g++,g%1e4===0&&(l.push(String.fromCharCode.apply(null,j)),j=[]));return l.push(String.fromCharCode.apply(null,j)),l.join("")},asciiCharCodeAt:function(a,b){var c=a.charCodeAt(b);if(c>255)switch(c){case 8364:c=128;break;case 8218:c=130;break;case 402:c=131;break;case 8222:c=132;break;case 8230:c=133;break;case 8224:c=134;break;case 8225:c=135;break;case 710:c=136;break;case 8240:c=137;break;case 352:c=138;break;case 8249:c=139;break;case 338:c=140;break;case 381:c=142;break;case 8216:c=145;break;case 8217:c=146;break;case 8220:c=147;break;case 8221:c=148;break;case 8226:c=149;break;case 8211:c=150;break;case 8212:c=151;break;case 732:c=152;break;case 8482:c=153;break;case 353:c=154;break;case 8250:c=155;break;case 339:c=156;break;case 382:c=158;break;case 376:c=159}return c}},a.Util.UTF8}),define("utils/base64",["jxg","utils/encoding"],function(a,b){"use strict";function c(a,b){return 255&a.charCodeAt(b)}function d(a,b){return e.indexOf(a.charAt(b))}var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f="=";return a.Util=a.Util||{},a.Util.Base64={encode:function(a){var d,g,h,i,j,k=[];for(j=b.encode(a),h=j.length,i=h%3,d=0;d<h-i;d+=3)g=c(j,d)<<16|c(j,d+1)<<8|c(j,d+2),k.push(e.charAt(g>>18),e.charAt(g>>12&63),e.charAt(g>>6&63),e.charAt(63&g));switch(i){case 1:g=c(j,h-1),k.push(e.charAt(g>>2),e.charAt(g<<4&63),f,f);break;case 2:g=c(j,h-2)<<8|c(j,h-1),k.push(e.charAt(g>>10),e.charAt(g>>4&63),e.charAt(g<<2&63),f)}return k.join("")},decode:function(a,c){var e,g,h,i,j,k,l=[],m=[];if(e=a.replace(/[^A-Za-z0-9\+\/=]/g,""),h=e.length,h%4!==0)throw new Error("JSXGraph/utils/base64: Can't decode string (invalid input length).");for(e.charAt(h-1)===f&&(i=1,e.charAt(h-2)===f&&(i=2),h-=4),g=0;g<h;g+=4)j=d(e,g)<<18|d(e,g+1)<<12|d(e,g+2)<<6|d(e,g+3),m.push(j>>16,j>>8&255,255&j),g%1e4===0&&(l.push(String.fromCharCode.apply(null,m)),m=[]);switch(i){case 1:j=d(e,h)<<12|d(e,h+1)<<6|d(e,h+2),m.push(j>>10,j>>2&255);break;case 2:j=d(e,g)<<6|d(e,g+1),m.push(j>>4)}return l.push(String.fromCharCode.apply(null,m)),k=l.join(""),c&&(k=b.decode(k)),k},decodeAsArray:function(a){var b,c=this.decode(a),d=[],e=c.length;for(b=0;b<e;b++)d[b]=c.charCodeAt(b);return d}},a.Util.Base64}),define("server/server",["jxg","utils/zip","utils/base64","utils/type"],function(a,b,c,d){"use strict";return a.Server={modules:{},runningCalls:{},handleError:function(b){a.debug("error occured, server says: "+b.message)},callServer:function(e,f,g,h){var i,j,k,l,m,n,o;h=h||!1,l="";for(o in g)g.hasOwnProperty(o)&&(l+="&"+escape(o)+"="+escape(g[o]));n=d.toJSON(g);do m=e+Math.floor(4096*Math.random());while(d.exists(this.runningCalls[m]));return this.runningCalls[m]={action:e},d.exists(g.module)&&(this.runningCalls[m].module=g.module),i=a.serverBase+"JXGServer.py",j="action="+escape(e)+"&id="+m+"&dataJSON="+escape(c.encode(n)),this.cbp=function(a){var e,g,h,i,j,k,l,m;if(e=new b.Unzip(c.decodeAsArray(a)).unzip(),d.isArray(e)&&e.length>0&&(e=e[0][0]),d.exists(e))if(g=window.JSON&&window.JSON.parse?window.JSON.parse(e):new Function("return "+e)(),"error"===g.type)this.handleError(g);else if("response"===g.type){for(k=g.id,l=0;l<g.fields.length;l++)h=g.fields[l],i=h.namespace+("object"==typeof new Function("return "+h.namespace)()?".":".prototype.")+h.name+" = "+h.value,new Function(i)();for(l=0;l<g.handler.length;l++){for(h=g.handler[l],j=[],m=0;m<h.parameters.length;m++)j[m]='"'+h.parameters[m]+'": '+h.parameters[m];i="if(typeof JXG.Server.modules."+this.runningCalls[k].module+' == "undefined")JXG.Server.modules.'+this.runningCalls[k].module+" = {};",i+="JXG.Server.modules."+this.runningCalls[k].module+"."+h.name+"_cb = "+h.callback+";",i+="JXG.Server.modules."+this.runningCalls[k].module+"."+h.name+" = function ("+h.parameters.join(",")+', __JXGSERVER_CB__, __JXGSERVER_SYNC) {if(typeof __JXGSERVER_CB__ == "undefined") __JXGSERVER_CB__ = JXG.Server.modules.'+this.runningCalls[k].module+"."+h.name+"_cb;var __JXGSERVER_PAR__ = {"+j.join(",")+', "module": "'+this.runningCalls[k].module+'", "handler": "'+h.name+'" };JXG.Server.callServer("exec", __JXGSERVER_CB__, __JXGSERVER_PAR__, __JXGSERVER_SYNC);};',new Function(i)()}delete this.runningCalls[k],f(g.data)}},this.cb=a.bind(this.cbp,this),window.XMLHttpRequest?(k=new XMLHttpRequest,k.overrideMimeType("text/plain; charset=iso-8859-1")):k=new ActiveXObject("Microsoft.XMLHTTP"),!(!k||(k.open("POST",i,!h),k.setRequestHeader("Content-type","application/x-www-form-urlencoded"),h||(k.onreadystatechange=function(a){return function(){return 4===k.readyState&&200===k.status&&(a(k.responseText),!0)}}(this.cb)),k.send(j),!h))&&(this.cb(k.responseText),!0)},loadModule_cb:function(b){var c;for(c=0;c<b.length;c++)a.debug(b[c].name+": "+b[c].value)},loadModule:function(b){return a.Server.callServer("load",a.Server.loadModule_cb,{module:b},!0)}},a.Server.load=a.Server.loadModule,a.Server}),define("math/symbolic",["base/constants","base/coords","math/math","math/geometry","server/server","utils/type"],function(a,b,c,d,e,f){
"use strict";var g;return c.Symbolic={generateSymbolicCoordinatesPartial:function(a,b,c,d){var e,g,h,i=b.ancestors,j=0,k=function(a){var b;return b="underscore"===d?c+"_{"+a+"}":"brace"===d?c+"["+a+"]":c+a};a.listOfFreePoints=[],a.listOfDependantPoints=[];for(g in i)if(i.hasOwnProperty(g)&&(e=0,f.isPoint(i[g]))){for(h in i[g].ancestors)i[g].ancestors.hasOwnProperty(h)&&e++;0===e?(i[g].symbolic.x=i[g].coords.usrCoords[1],i[g].symbolic.y=i[g].coords.usrCoords[2],a.listOfFreePoints.push(i[g])):(j+=1,i[g].symbolic.x=k(j),j+=1,i[g].symbolic.y=k(j),a.listOfDependantPoints.push(i[g]))}return f.isPoint(b)&&(b.symbolic.x="x",b.symbolic.y="y"),j},clearSymbolicCoordinates:function(a){var b=function(a){var b,c=a&&a.length||0;for(b=0;b<c;b++)f.isPoint(a[b])&&(a[b].symbolic.x="",a[b].symbolic.y="")};b(a.listOfFreePoints),b(a.listOfDependantPoints),delete a.listOfFreePoints,delete a.listOfDependantPoints},generatePolynomials:function(a,b,c){var d,e,g,h,i=b.ancestors,j=[],k=[];c&&this.generateSymbolicCoordinatesPartial(a,b,"u","brace"),i[b.id]=b;for(d in i)if(i.hasOwnProperty(d)&&(h=0,j=[],f.isPoint(i[d]))){for(e in i[d].ancestors)i[d].ancestors.hasOwnProperty(e)&&h++;if(h>0)for(j=i[d].generatePolynomial(),g=0;g<j.length;g++)k.push(j[g])}return c&&this.clearSymbolicCoordinates(a),k},geometricLocusByGroebnerBase:function(h,i){var j,k,l,m,n,o,p,q,r,s,t,u,v,w=h.options.locus,x={},y=this.generateSymbolicCoordinatesPartial(h,i,"u","brace"),z=new b(a.COORDS_BY_USR,[0,0],h),A=new b(a.COORDS_BY_USR,[h.canvasWidth,h.canvasHeight],h),B=1,C=0,D=0,E=0;if(e.modules.geoloci===g&&e.loadModule("geoloci"),e.modules.geoloci===g)throw new Error("JSXGraph: Unable to load JXG.Server module 'geoloci.py'.");if(p=z.usrCoords[1],q=A.usrCoords[1],r=A.usrCoords[2],s=z.usrCoords[2],w.translateToOrigin&&h.listOfFreePoints.length>0){for(m=w.toOrigin!==g&&null!==w.toOrigin&&f.isInArray(h.listOfFreePoints,w.toOrigin.id)?w.toOrigin:h.listOfFreePoints[0],C=m.symbolic.x,D=m.symbolic.y,o=0;o<h.listOfFreePoints.length;o++)h.listOfFreePoints[o].symbolic.x-=C,h.listOfFreePoints[o].symbolic.y-=D;if(p-=C,q-=C,r-=D,s-=D,w.translateTo10&&h.listOfFreePoints.length>1){for(n=w.to10!==g&&null!==w.to10&&w.to10.id!==w.toOrigin.id&&f.isInArray(h.listOfFreePoints,w.to10.id)?w.to10:h.listOfFreePoints[0].id===m.id?h.listOfFreePoints[1]:h.listOfFreePoints[0],E=d.rad([1,0],[0,0],[n.symbolic.x,n.symbolic.y]),t=Math.cos(-E),u=Math.sin(-E),o=0;o<h.listOfFreePoints.length;o++)v=h.listOfFreePoints[o].symbolic.x,h.listOfFreePoints[o].symbolic.x=t*h.listOfFreePoints[o].symbolic.x-u*h.listOfFreePoints[o].symbolic.y,h.listOfFreePoints[o].symbolic.y=u*v+t*h.listOfFreePoints[o].symbolic.y;if(n.symbolic.y=0,v=p,p=t*p-u*r,r=u*v+t*r,v=q,q=t*q-u*s,s=u*v+t*s,w.stretch&&Math.abs(n.symbolic.x)>c.eps){for(B=n.symbolic.x,o=0;o<h.listOfFreePoints.length;o++)h.listOfFreePoints[o].symbolic.x/=B,h.listOfFreePoints[o].symbolic.y/=B;for(o=0;o<h.objectsList.length;o++)h.objectsList[o].elementClass===a.OBJECT_CLASS_CIRCLE&&"pointRadius"===h.objectsList[o].method&&(x[o]=h.objectsList[o].radius,h.objectsList[o].radius/=B);p/=B,q/=B,r/=B,s/=B,n.symbolic.x=1}}for(o=0;o<h.listOfFreePoints.length;o++)v=h.listOfFreePoints[o].symbolic.x,Math.abs(v)<c.eps&&(h.listOfFreePoints[o].symbolic.x=0),Math.abs(v-Math.round(v))<c.eps&&(h.listOfFreePoints[o].symbolic.x=Math.round(v)),v=h.listOfFreePoints[o].symbolic.y,Math.abs(v)<c.eps&&(h.listOfFreePoints[o].symbolic.y=0),Math.abs(v-Math.round(v))<c.eps&&(h.listOfFreePoints[o].symbolic.y=Math.round(v))}j=this.generatePolynomials(h,i),k=j.join(","),this.cbp=function(a){l=a},this.cb=f.bind(this.cbp,this),e.modules.geoloci.lociCoCoA(p,q,r,s,y,k,B,E,C,D,this.cb,!0),this.clearSymbolicCoordinates(h);for(o in x)x.hasOwnProperty(o)&&(h.objects[o].radius=x[o]);return l}},c.Symbolic}),define("math/poly",["jxg","math/math","utils/type"],function(a,b,c){"use strict";return b.Poly={},b.Poly.Ring=function(a){this.vars=a},a.extend(b.Poly.Ring.prototype,{}),b.Poly.Monomial=function(a,b,d){var e;if(!c.exists(a))throw new Error("JSXGraph error: In JXG.Math.Poly.monomial missing parameter 'ring'.");for(c.isArray(d)||(d=[]),d=d.slice(0,a.vars.length),e=d.length;e<a.vars.length;e++)d.push(0);this.ring=a,this.coefficient=b||0,this.exponents=c.deepCopy(d)},a.extend(b.Poly.Monomial.prototype,{copy:function(){return new b.Poly.Monomial(this.ring,this.coefficient,this.exponents)},print:function(){var a,b=[];for(a=0;a<this.ring.vars.length;a++)b.push(this.ring.vars[a]+"^"+this.exponents[a]);return this.coefficient+"*"+b.join("*")}}),b.Poly.Polynomial=function(a,b){var d,e=function(){};if(!c.exists(a))throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial missing parameter 'ring'.");d=c.exists(b)&&c.isString(b)?e(b):[],this.ring=a,this.monomials=d},a.extend(b.Poly.Polynomial.prototype,{findSignature:function(a){var b;for(b=0;b<this.monomials.length;b++)if(c.cmpArrays(this.monomials[b].exponents,a))return b;return-1},addSubMonomial:function(a,b){var c;c=this.findSignature(a.exponents),c>-1?this.monomials[c].coefficient+=b*a.coefficient:(a.coefficient*=b,this.monomials.push(a))},add:function(a){var b;if(!c.exists(a)||a.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.add either summand is undefined or rings don't match.");if(c.isArray(a.exponents))this.addSubMonomial(a,1);else for(b=0;b<a.monomials.length;b++)this.addSubMonomial(a.monomials[b],1)},sub:function(a){var b;if(!c.exists(a)||a.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.sub either summand is undefined or rings don't match.");if(c.isArray(a.exponents))this.addSubMonomial(a,-1);else for(b=0;b<a.monomials.length;b++)this.addSubMonomial(a.monomials[b],-1)},copy:function(){var a,c;for(c=new b.Poly.Polynomial(this.ring),a=0;a<this.monomials.length;a++)c.monomials.push(this.monomials[a].copy());return c},print:function(){var a,b=[];for(a=0;a<this.monomials.length;a++)b.push("("+this.monomials[a].print()+")");return b.join("+")}}),b.Poly}),define("math/complex",["jxg","utils/type"],function(a,b){"use strict";return a.Complex=function(a,b){this.isComplex=!0,a&&a.isComplex&&(b=a.imaginary,a=a.real),this.real=a||0,this.imaginary=b||0,this.absval=0,this.angle=0},a.extend(a.Complex.prototype,{toString:function(){return this.real+" + "+this.imaginary+"i"},add:function(a){return b.isNumber(a)?this.real+=a:(this.real+=a.real,this.imaginary+=a.imaginary),this},sub:function(a){return b.isNumber(a)?this.real-=a:(this.real-=a.real,this.imaginary-=a.imaginary),this},mult:function(a){var c,d;return b.isNumber(a)?(this.real*=a,this.imaginary*=a):(c=this.real,d=this.imaginary,this.real=c*a.real-d*a.imaginary,this.imaginary=c*a.imaginary+d*a.real),this},div:function(a){var c,d,e;if(b.isNumber(a)){if(Math.abs(a)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;this.real/=a,this.imaginary/=a}else{if(Math.abs(a.real)<Math.eps&&Math.abs(a.imaginary)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;c=a.real*a.real+a.imaginary*a.imaginary,e=this.real,d=this.imaginary,this.real=(e*a.real+d*a.imaginary)/c,this.imaginary=(d*a.real-e*a.imaginary)/c}return this},conj:function(){return this.imaginary*=-1,this}}),a.C={},a.C.add=function(b,c){var d=new a.Complex(b);return d.add(c),d},a.C.sub=function(b,c){var d=new a.Complex(b);return d.sub(c),d},a.C.mult=function(b,c){var d=new a.Complex(b);return d.mult(c),d},a.C.div=function(b,c){var d=new a.Complex(b);return d.div(c),d},a.C.conj=function(b){var c=new a.Complex(b);return c.conj(),c},a.C.abs=function(b){var c=new a.Complex(b);return c.conj(),c.mult(b),Math.sqrt(c.real)},a.Complex.C=a.C,a.Complex}),define("utils/color",["jxg","utils/type","math/math"],function(a,b,c){"use strict";var d={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},e=[{re:/^\s*rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]{1,3})\s*\)\s*$/,example:["rgba(123, 234, 45, 0.5)","rgba(255,234,245,1.0)"],process:function(a){return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10)]}},{re:/^\s*rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)\s*$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}];return a.rgbParser=function(a,c,f){var g,h,i,j,k,l,m,n,o,p,q=a;if(!b.exists(a))return[];if(b.exists(c)&&b.exists(f)&&(q=[a,c,f]),g=q,p=!1,b.isArray(g)){for(l=0;l<3;l++)p=p||/\./.test(q[l].toString());for(l=0;l<3;l++)p=p&&q[l]>=0&&q[l]<=1;return p?[Math.ceil(255*q[0]),Math.ceil(255*q[1]),Math.ceil(255*q[2])]:q}for("string"==typeof q&&(g=q),"#"===g.charAt(0)&&(g=g.substr(1,6)),g=g.replace(/ /g,"").toLowerCase(),g=d[g]||g,l=0;l<e.length;l++)i=e[l].re,j=e[l].process,k=i.exec(g),k&&(h=j(k),m=h[0],n=h[1],o=h[2]);return isNaN(m)||isNaN(n)||isNaN(o)?[]:(m=m<0||isNaN(m)?0:m>255?255:m,n=n<0||isNaN(n)?0:n>255?255:n,o=o<0||isNaN(o)?0:o>255?255:o,[m,n,o])},a.rgb2css=function(b,c,d){var e;return e=a.rgbParser(b,c,d),"rgb("+e[0]+", "+e[1]+", "+e[2]+")"},a.rgb2hex=function(b,c,d){var e,f,g;return e=a.rgbParser(b,c,d),f=e[1],g=e[2],e=e[0],e=e.toString(16),f=f.toString(16),g=g.toString(16),1===e.length&&(e="0"+e),1===f.length&&(f="0"+f),1===g.length&&(g="0"+g),"#"+e+f+g},a.hex2rgb=function(b){return a.deprecated("JXG.hex2rgb()","JXG.rgb2css()"),a.rgb2css(b)},a.hsv2rgb=function(a,b,d){var e,f,g,h,i,j,k,l,m;if(a=(a%360+360)%360,0===b){if(!(isNaN(a)||a<c.eps))return"#ffffff";e=d,f=d,g=d}else switch(j=a>=360?0:a,j/=60,i=Math.floor(j),h=j-i,k=d*(1-b),l=d*(1-b*h),m=d*(1-b*(1-h)),i){case 0:e=d,f=m,g=k;break;case 1:e=l,f=d,g=k;break;case 2:e=k,f=d,g=m;break;case 3:e=k,f=l,g=d;break;case 4:e=m,f=k,g=d;break;case 5:e=d,f=k,g=l}return e=Math.round(255*e).toString(16),e=2===e.length?e:1===e.length?"0"+e:"00",f=Math.round(255*f).toString(16),f=2===f.length?f:1===f.length?"0"+f:"00",g=Math.round(255*g).toString(16),g=2===g.length?g:1===g.length?"0"+g:"00",["#",e,f,g].join("")},a.rgb2hsv=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q;return e=a.rgbParser(b,c,d),f=e[1],g=e[2],e=e[0],h=e/255,i=f/255,j=g/255,p=Math.max(e,f,g),q=Math.min(e,f,g),k=p/255,l=q/255,o=k,n=0,o>0&&(n=(o-l)/o),m=1/(k-l),n>0&&(m=p===e?(i-j)*m:p===f?2+(j-h)*m:4+(h-i)*m),m*=60,m<0&&(m+=360),p===q&&(m=0),[m,n,o]},a.rgb2LMS=function(b,c,d){var e,f,g,h,i,j,k,l=[[.05059983,.08585369,.0095242],[.01893033,.08925308,.01370054],[.00292202,.00975732,.07145979]];return e=a.rgbParser(b,c,d),f=e[1],g=e[2],e=e[0],e=Math.pow(e,.476190476),f=Math.pow(f,.476190476),g=Math.pow(g,.476190476),h=e*l[0][0]+f*l[0][1]+g*l[0][2],i=e*l[1][0]+f*l[1][1]+g*l[1][2],j=e*l[2][0]+f*l[2][1]+g*l[2][2],k=[h,i,j],k.l=h,k.m=i,k.s=j,k},a.LMS2rgb=function(a,b,c){var d,e,f,g,h=[[30.830854,-29.832659,1.610474],[-6.481468,17.715578,-2.532642],[-.37569,-1.199062,14.273846]],i=function(a){for(var b=127,c=64;c>0;){if(Math.pow(b,.476190476)>a)b-=c;else{if(Math.pow(b+1,.476190476)>a)return b;b+=c}c/=2}return 254===b&&13.994955247<a?255:b};return d=a*h[0][0]+b*h[0][1]+c*h[0][2],e=a*h[1][0]+b*h[1][1]+c*h[1][2],f=a*h[2][0]+b*h[2][1]+c*h[2][2],d=i(d),e=i(e),f=i(f),g=[d,e,f],g.r=d,g.g=e,g.b=f,g},a.rgba2rgbo=function(a){var b;return 9===a.length&&"#"===a.charAt(0)?(b=parseInt(a.substr(7,2).toUpperCase(),16)/255,a=a.substr(0,7)):b=1,[a,b]},a.rgbo2rgba=function(a,b){var c;return"none"===a?a:(c=Math.round(255*b).toString(16),1===c.length&&(c="0"+c),a+c)},a.rgb2bw=function(b){var c,d,e,f="0123456789ABCDEF";return"none"===b?b:(e=a.rgbParser(b),c=Math.floor(.3*e[0]+.59*e[1]+.11*e[2]),d=f.charAt(c>>4&15)+f.charAt(15&c),b="#"+d+d+d)},a.rgb2cb=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q="0123456789ABCDEF";if("none"===b)return b;switch(h=a.rgb2LMS(b),e=h[0],f=h[1],g=h[2],c=c.toLowerCase()){case"protanopia":j=-.06150039994295001,k=.08277001656812001,l=-.013200141220000003,m=.05858939668799999,n=-.07934519995360001,o=.013289415272000003,p=.6903216543277437,i=g/f,e=i<p?-(k*f+l*g)/j:-(n*f+o*g)/m;break;case"tritanopia":j=-.00058973116217,k=.007690316482,l=-.01011703519052,m=.025495080838999994,n=-.0422740347,o=.017005316784,p=.8349489908460004,i=f/e,g=i<p?-(j*e+k*f)/l:-(m*e+n*f)/o;break;default:j=-.06150039994295001,k=.08277001656812001,l=-.013200141220000003,m=.05858939668799999,n=-.07934519995360001,o=.013289415272000003,p=.5763833686400911,i=g/e,f=i<p?-(j*e+l*g)/k:-(m*e+o*g)/n}return d=a.LMS2rgb(e,f,g),i=q.charAt(d[0]>>4&15)+q.charAt(15&d[0]),b="#"+i,i=q.charAt(d[1]>>4&15)+q.charAt(15&d[1]),b+=i,i=q.charAt(d[2]>>4&15)+q.charAt(15&d[2]),b+=i},a.autoHighlight=function(b){var c=a.rgba2rgbo(b),d=c[0],e=c[1];return"#"===b.charAt(0)?(e*=e<.3?1.8:.4,a.rgbo2rgba(d,e)):b},a}),define("options",["jxg","base/constants","math/math","utils/color","utils/type"],function(a,b,c,d,e){"use strict";return a.Options={jc:{enabled:!0,compile:!0},board:{boundingBox:[-5,5,5,-5],zoomFactor:1,zoomX:1,zoomY:1,showCopyright:!0,axis:!1,defaultAxes:{x:{name:"x",ticks:{label:{visible:"inherit",anchorX:"middle",anchorY:"top",fontSize:12,offset:[0,-3]},drawZero:!1,visible:"inherit"}},y:{name:"y",ticks:{label:{visible:"inherit",anchorX:"right",anchorY:"middle",fontSize:12,offset:[-6,0]},tickEndings:[1,0],drawZero:!1,visible:"inherit"}}},showNavigation:!0,showZoom:!0,showReload:!1,showScreenshot:!1,screenshot:{scale:1,type:"png",symbol:"⌘",css:"background-color:#eeeeee; opacity:1.0; border:2px solid black; border-radius:10px; text-align:center",cssButton:"padding: 4px 10px; border: solid #356AA0 1px; border-radius: 5px; position: absolute; right: 2ex; top: 2ex; background-color: rgba(255, 255, 255, 0.3);"},showClearTraces:!1,keepAspectRatio:!1,ignoreLabels:!0,maxNameLength:1,document:!1,takeFirst:!1,takeSizeFromFile:!1,renderer:"auto",animationDelay:35,registerEvents:!0,minimizeReflow:"svg",offsetX:0,offsetY:0,zoom:{enabled:!0,factorX:1.25,factorY:1.25,wheel:!0,needShift:!0,min:1e-4,max:1e4,pinchHorizontal:!0,pinchVertical:!0,pinchSensitivity:7},pan:{needShift:!0,needTwoFingers:!1,enabled:!0},selection:{enabled:!1,name:"selectionPolygon",needShift:!1,needCtrl:!0,withLines:!1,vertices:{visible:!1},fillColor:"#ffff00",visible:!1}},navbar:{strokeColor:"#333333",fillColor:"transparent",highlightFillColor:"#aaaaaa",padding:"2px",position:"absolute",fontSize:"14px",cursor:"pointer",zIndex:"100",right:"5px",bottom:"5px"},elements:{strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",fillColor:"red",highlightFillColor:"none",strokeOpacity:1,highlightStrokeOpacity:1,fillOpacity:1,highlightFillOpacity:1,transitionDuration:100,strokeWidth:2,highlightStrokeWidth:2,fixed:!1,frozen:!1,withLabel:!1,visible:!0,priv:!1,layer:0,dash:0,shadow:!1,trace:!1,traceAttributes:{},highlight:!0,needsRegularUpdate:!0,snapToGrid:!1,scalable:!0,dragToTopOfLayer:!1,draft:{draft:!1,strokeColor:"#565656",fillColor:"#565656",strokeOpacity:.8,fillOpacity:.8,strokeWidth:1},isLabel:!1},ticks:{generateLabelText:null,generateLabelValue:null,drawLabels:!1,label:{},useUnicodeMinus:!0,anchor:"left",drawZero:!1,insertTicks:!1,minTicksDistance:10,minorHeight:4,majorHeight:10,tickEndings:[1,1],minorTicks:4,scale:1,scaleSymbol:"",labels:[],maxLabelLength:5,precision:3,ticksDistance:1,strokeOpacity:1,strokeWidth:1,strokeColor:"black",highlightStrokeColor:"#888888",visible:"inherit",includeBoundaries:!1},hatch:{drawLabels:!1,drawZero:!0,majorHeight:20,anchor:"middle",strokeWidth:2,strokeColor:"blue",ticksDistance:.2},precision:{touch:15,touchMax:100,mouse:4,epsilon:1e-4,hasPoint:4},layer:{numlayers:20,text:9,point:9,glider:9,arc:8,line:7,circle:6,curve:5,turtle:5,polygon:3,sector:3,angle:3,integral:3,axis:2,ticks:2,grid:1,image:0,trace:0},angle:{withLabel:!0,radius:.5,type:"sector",orthoType:"square",orthoSensitivity:1,fillColor:"#FF7F00",highlightFillColor:"#FF7F00",strokeColor:"#FF7F00",fillOpacity:.3,highlightFillOpacity:.3,radiuspoint:{withLabel:!1,visible:!1,name:""},pointsquare:{withLabel:!1,visible:!1,name:""},dot:{visible:!1,strokeColor:"none",fillColor:"black",size:2,face:"o",withLabel:!1,name:""},label:{position:"top",offset:[0,0],strokeColor:"#0000FF"},arc:{visible:!1}},arc:{selection:"auto",hasInnerPoints:!1,label:{anchorX:"auto",anchorY:"auto"},firstArrow:!1,lastArrow:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",useDirection:!1,center:{},radiuspoint:{},anglepoint:{}},axis:{name:"",needsRegularUpdate:!1,strokeWidth:1,lastArrow:{type:1,size:8},strokeColor:"#666666",highlightStrokeWidth:1,highlightStrokeColor:"#888888",withTicks:!0,straightFirst:!0,straightLast:!0,margin:-4,withLabel:!1,scalable:!1,ticks:{label:{offset:[4,-9],parse:!1,needsRegularUpdate:!1,display:"internal",visible:"inherit",layer:9},visible:"inherit",needsRegularUpdate:!1,strokeWidth:1,strokeColor:"#666666",highlightStrokeColor:"#888888",drawLabels:!0,drawZero:!1,insertTicks:!0,minTicksDistance:5,minorHeight:10,majorHeight:-1,tickEndings:[0,1],minorTicks:4,ticksDistance:1,strokeOpacity:.25},point1:{needsRegularUpdate:!1,visible:!1},point2:{needsRegularUpdate:!1,visible:!1},label:{position:"lft",offset:[10,10]}},bisector:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},bisectorlines:{line1:{strokeColor:"black"},line2:{strokeColor:"black"}},button:{disabled:!1},cardinalspline:{createPoints:!0,isArrayOfCoordinates:!1,points:{strokeOpacity:.05,fillOpacity:.05,highlightStrokeOpacity:1,highlightFillOpacity:1,withLabel:!1,name:"",fixed:!1}},chart:{chartStyle:"line",colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"],highlightcolors:null,fillcolor:null,highlightonsector:!1,highlightbysize:!1,fillOpacity:.6,withLines:!1,label:{}},checkbox:{disabled:!1,checked:!1},circle:{hasInnerPoints:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""},label:{position:"urt"}},circumcircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},circumcirclearc:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""}},circumcirclesector:{useDirection:!0,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},conic:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",foci:{fixed:!1,visible:!1,withLabel:!1,name:""},center:{visible:!1,withLabel:!1,name:""},point:{withLabel:!1,name:""}},curve:{strokeWidth:1,strokeColor:"#0000ff",fillColor:"none",fixed:!0,useQDT:!1,handDrawing:!1,curveType:null,RDPsmoothing:!1,numberPointsHigh:1600,numberPointsLow:400,doAdvancedPlot:!0,recursionDepthHigh:17,recursionDepthLow:13,doAdvancedPlotOld:!1,label:{position:"lft"}},glider:{label:{}},grid:{needsRegularUpdate:!1,hasGrid:!1,gridX:1,gridY:1,strokeColor:"#C0C0C0",strokeOpacity:.5,strokeWidth:1,dash:0,snapToGrid:!1,snapSizeX:10,snapSizeY:10},group:{needsRegularUpdate:!0},htmlslider:{widthRange:100,widthOut:34,step:.01,frozen:!0,isLabel:!1,strokeColor:"black",display:"html",anchorX:"left",anchorY:"middle",withLabel:!1},image:{imageString:null,fillOpacity:1,highlightFillOpacity:.6,cssClass:"JXGimage",highlightCssClass:"JXGimageHighlight",rotate:0,snapSizeX:1,snapSizeY:1,attractors:[]},incircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},inequality:{fillColor:"red",fillOpacity:.2,strokeColor:"none",inverse:!1},infobox:{fontSize:12,isLabel:!1,strokeColor:"#bbbbbb",display:"html",anchorX:"left",anchorY:"middle",cssClass:"JXGinfobox",rotate:0,visible:!0,parse:!1,transitionDuration:0,needsRegularUpdate:!1},integral:{axis:"x",withLabel:!0,fixed:!0,strokeWidth:0,strokeOpacity:0,fillColor:"red",fillOpacity:.4,highlightFillColor:"red",highlightFillOpacity:.2,curveLeft:{visible:!0,withLabel:!1,color:"red",fillOpacity:.8,layer:9},baseLeft:{visible:!1,fixed:!1,withLabel:!1,name:""},curveRight:{visible:!0,withLabel:!1,color:"red",fillOpacity:.8,layer:9},baseRight:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{fontSize:20}},input:{disabled:!1,maxlength:524288},intersection:{alwaysIntersect:!0},label:{visible:"inherit",strokeColor:"black",strokeOpacity:1,highlightStrokeOpacity:.666666,highlightStrokeColor:"black",fixed:!0,position:"urt",offset:[10,10]},legend:{style:"vertical",labels:["1","2","3","4","5","6","7","8"],colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"]},line:{firstArrow:!1,lastArrow:!1,margin:0,straightFirst:!0,straightLast:!0,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#888888",withTicks:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},ticks:{drawLabels:!0,label:{offset:[4,-9]},drawZero:!1,insertTicks:!1,minTicksDistance:50,minorHeight:4,majorHeight:-1,minorTicks:4,defaultDistance:1,strokeOpacity:.3,visible:"inherit"},label:{position:"llft"},snapToGrid:!1,snapSizeX:1,snapSizeY:1,touchFirstPoint:!1,touchLastPoint:!1,lineCap:"butt"},locus:{translateToOrigin:!1,translateTo10:!1,stretch:!1,toOrigin:null,to10:null},normal:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},orthogonalprojection:{},parallel:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{position:"llft"}},perpendicular:{strokeColor:"#000000",straightFirst:!0,straightLast:!0},perpendicularsegment:{strokeColor:"#000000",straightFirst:!1,straightLast:!1,point:{visible:!1,fixed:!0,withLabel:!1,name:""}},point:{withLabel:!0,label:{},style:5,face:"o",size:3,sizeUnit:"screen",fillColor:"#ff0000",highlightFillColor:"#EEEEEE",strokeWidth:2,strokeColor:"#ff0000",highlightStrokeColor:"#C3D9FF",zoom:!1,showInfobox:!0,infoboxDigits:"auto",draft:!1,attractors:[],attractorUnit:"user",attractorDistance:0,snatchDistance:0,snapToGrid:!1,snapSizeX:1,snapSizeY:1,snapToPoints:!1,ignoredSnapToPoints:[]},polygon:{hasInnerPoints:!1,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"},visible:"inherit"},vertices:{layer:9,withLabel:!1,name:"",strokeColor:"#ff0000",fillColor:"#ff0000",fixed:!1,visible:"inherit"},label:{offset:[0,0]}},prescribedangle:{anglepoint:{size:2,visible:!1,withLabel:!1}},regularpolygon:{hasInnerPoints:!1,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"}},vertices:{layer:9,withLabel:!0,strokeColor:"#ff0000",fillColor:"#ff0000",fixed:!1},label:{offset:[0,0]}},riemannsum:{withLabel:!1,fillOpacity:.3,fillColor:"#ffff00"},sector:{fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,highlightOnSector:!1,highlightStrokeWidth:0,selection:"auto",arc:{visible:!1,fillColor:"none"},radiuspoint:{visible:!1,withLabel:!1},center:{visible:!1,withLabel:!1},anglepoint:{visible:!1,withLabel:!1},label:{offset:[0,0],anchorX:"auto",anchorY:"auto"}},segment:{label:{position:"top"}},semicircle:{center:{visible:!1,withLabel:!1,fixed:!1,name:""}},slider:{snapWidth:-1,precision:2,firstArrow:!1,lastArrow:!1,withTicks:!0,withLabel:!0,suffixLabel:null,unitLabel:null,postLabel:null,layer:9,showInfobox:!1,name:"",visible:!0,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"#ffffff",highlightFillColor:"none",size:6,point1:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},point2:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},baseline:{needsRegularUpdate:!1,fixed:!0,scalable:!1,name:"",strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888"},ticks:{needsRegularUpdate:!1,fixed:!0,drawLabels:!1,precision:2,includeBoundaries:1,drawZero:!0,label:{offset:[-4,-14],display:"internal"},minTicksDistance:30,insertTicks:!0,minorHeight:4,majorHeight:5,minorTicks:0,defaultDistance:1,strokeOpacity:1,strokeWidth:1,tickEndings:[0,1],strokeColor:"#000000",visible:"inherit"},highline:{strokeWidth:3,fixed:!0,name:"",strokeColor:"#000000",highlightStrokeColor:"#888888"},label:{strokeColor:"#000000"}},comb:{frequency:.2,width:.4,angle:Math.PI/3,reverse:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},curve:{strokeWidth:1,strokeColor:"#000000",fillColor:"none"}},slopetriangle:{fillColor:"red",fillOpacity:.4,highlightFillColor:"red",highlightFillOpacity:.3,borders:{lastArrow:{type:1,size:6}},glider:{fixed:!0,visible:!1,withLabel:!1},baseline:{visible:!1,withLabel:!1,name:""},basepoint:{visible:!1,withLabel:!1,name:""},tangent:{visible:!1,withLabel:!1,name:""},toppoint:{visible:!1,withLabel:!1,name:""},label:{visible:!0}},stepfunction:{},tapemeasure:{strokeColor:"#000000",strokeWidth:2,highlightStrokeColor:"#000000",withTicks:!0,withLabel:!0,precision:2,point1:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},point2:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},ticks:{drawLabels:!1,drawZero:!0,insertTicks:!0,minorHeight:8,majorHeight:16,minorTicks:4,tickEndings:[0,1],defaultDistance:.1,strokeOpacity:1,strokeWidth:1,strokeColor:"#000000",visible:"inherit"},label:{position:"top"}},text:{fontSize:12,digits:2,parse:!0,useCaja:!1,isLabel:!1,strokeColor:"black",highlightStrokeColor:"black",highlightStrokeOpacity:.666666,cssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",highlightCssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",cssStyle:"",highlightCssStyle:"",useASCIIMathML:!1,useMathJax:!1,display:"html",anchor:null,anchorX:"left",anchorY:"middle",cssClass:"JXGtext",highlightCssClass:"JXGtext",dragArea:"all",withLabel:!1,rotate:0,visible:!0,snapSizeX:1,snapSizeY:1,attractors:[]},tracecurve:{strokeColor:"#000000",fillColor:"none",numberPoints:100},turtle:{strokeWidth:1,fillColor:"none",strokeColor:"#000000",arrow:{strokeWidth:2,withLabel:!1,strokeColor:"#ff0000"}},shortcuts:{color:["strokeColor","fillColor"],opacity:["strokeOpacity","fillOpacity"],highlightColor:["highlightStrokeColor","highlightFillColor"],highlightOpacity:["highlightStrokeOpacity","highlightFillOpacity"],strokeWidth:["strokeWidth","highlightStrokeWidth"]}},a.Validator=function(){var b,d=function(a){return/^[0-9]+px$/.test(a)},f=function(a){return"html"===a||"internal"===a},g=function(a){return e.isString(a)},h=function(b){return e.exists(a.normalizePointFace(b))},i=function(a){return Math.abs(a-Math.round(a))<c.eps},j=function(a){return i(a)&&a>0},k=function(a){return"vml"===a||"svg"===a||"canvas"===a||"no"===a},l=function(a){return a>0},m=function(a){return a>=0},n={},o={attractorDistance:m,color:g,defaultDistance:e.isNumber,display:f,doAdvancedPlot:!1,draft:!1,drawLabels:!1,drawZero:!1,face:h,factor:e.isNumber,fillColor:g,fillOpacity:e.isNumber,firstArrow:!1,fontSize:i,dash:i,gridX:e.isNumber,gridY:e.isNumber,hasGrid:!1,highlightFillColor:g,highlightFillOpacity:e.isNumber,highlightStrokeColor:g,highlightStrokeOpacity:e.isNumber,insertTicks:!1,lastArrow:!1,majorHeight:i,minorHeight:i,minorTicks:m,minTicksDistance:j,numberPointsHigh:j,numberPointsLow:j,opacity:e.isNumber,radius:e.isNumber,RDPsmoothing:!1,renderer:k,right:d,showCopyright:!1,showInfobox:!1,showNavigation:!1,size:i,snapSizeX:l,snapSizeY:l,snapWidth:e.isNumber,snapToGrid:!1,snatchDistance:m,straightFirst:!1,straightLast:!1,stretch:!1,strokeColor:g,strokeOpacity:e.isNumber,strokeWidth:i,takeFirst:!1,takeSizeFromFile:!1,to10:!1,toOrigin:!1,translateTo10:!1,translateToOrigin:!1,useASCIIMathML:!1,useDirection:!1,useMathJax:!1,withLabel:!1,withTicks:!1,zoom:!1};for(b in o)o.hasOwnProperty(b)&&(n[b.toLowerCase()]=o[b]);return n}(),a.normalizePointFace=function(a){var b={cross:"x",x:"x",circle:"o",o:"o",square:"[]","[]":"[]",plus:"+","+":"+",diamond:"<>","<>":"<>",triangleup:"^",a:"^","^":"^",triangledown:"v",v:"v",triangleleft:"<","<":"<",triangleright:">",">":">"};return b[a]},a.useStandardOptions=function(c){var d,e,f,g,h=a.Options,i=c.hasGrid;c.options.grid.hasGrid=h.grid.hasGrid,c.options.grid.gridX=h.grid.gridX,c.options.grid.gridY=h.grid.gridY,c.options.grid.gridColor=h.grid.gridColor,c.options.grid.gridOpacity=h.grid.gridOpacity,c.options.grid.gridDash=h.grid.gridDash,c.options.grid.snapToGrid=h.grid.snapToGrid,c.options.grid.snapSizeX=h.grid.SnapSizeX,c.options.grid.snapSizeY=h.grid.SnapSizeY,c.takeSizeFromFile=h.takeSizeFromFile,g=function(a,b){a.visProp.fillcolor=b.fillColor,a.visProp.highlightfillcolor=b.highlightFillColor,a.visProp.strokecolor=b.strokeColor,a.visProp.highlightstrokecolor=b.highlightStrokeColor};for(d in c.objects)if(c.objects.hasOwnProperty(d))if(f=c.objects[d],
f.elementClass===b.OBJECT_CLASS_POINT)g(f,h.point);else if(f.elementClass===b.OBJECT_CLASS_LINE)for(g(f,h.line),e=0;e<f.ticks.length;e++)f.ticks[e].majorTicks=h.line.ticks.majorTicks,f.ticks[e].minTicksDistance=h.line.ticks.minTicksDistance,f.ticks[e].visProp.minorheight=h.line.ticks.minorHeight,f.ticks[e].visProp.majorheight=h.line.ticks.majorHeight;else f.elementClass===b.OBJECT_CLASS_CIRCLE?g(f,h.circle):f.type===b.OBJECT_TYPE_ANGLE?g(f,h.angle):f.type===b.OBJECT_TYPE_ARC?g(f,h.arc):f.type===b.OBJECT_TYPE_POLYGON?g(f,h.polygon):f.type===b.OBJECT_TYPE_CONIC?g(f,h.conic):f.type===b.OBJECT_TYPE_CURVE?g(f,h.curve):f.type===b.OBJECT_TYPE_SECTOR&&(f.arc.visProp.fillcolor=h.sector.fillColor,f.arc.visProp.highlightfillcolor=h.sector.highlightFillColor,f.arc.visProp.fillopacity=h.sector.fillOpacity,f.arc.visProp.highlightfillopacity=h.sector.highlightFillOpacity);c.fullUpdate(),i&&!c.hasGrid?c.removeGrids(c):!i&&c.hasGrid&&c.create("grid",[])},a.useBlackWhiteOptions=function(b){var c=a.Options;c.point.fillColor=d.rgb2bw(c.point.fillColor),c.point.highlightFillColor=d.rgb2bw(c.point.highlightFillColor),c.point.strokeColor=d.rgb2bw(c.point.strokeColor),c.point.highlightStrokeColor=d.rgb2bw(c.point.highlightStrokeColor),c.line.fillColor=d.rgb2bw(c.line.fillColor),c.line.highlightFillColor=d.rgb2bw(c.line.highlightFillColor),c.line.strokeColor=d.rgb2bw(c.line.strokeColor),c.line.highlightStrokeColor=d.rgb2bw(c.line.highlightStrokeColor),c.circle.fillColor=d.rgb2bw(c.circle.fillColor),c.circle.highlightFillColor=d.rgb2bw(c.circle.highlightFillColor),c.circle.strokeColor=d.rgb2bw(c.circle.strokeColor),c.circle.highlightStrokeColor=d.rgb2bw(c.circle.highlightStrokeColor),c.arc.fillColor=d.rgb2bw(c.arc.fillColor),c.arc.highlightFillColor=d.rgb2bw(c.arc.highlightFillColor),c.arc.strokeColor=d.rgb2bw(c.arc.strokeColor),c.arc.highlightStrokeColor=d.rgb2bw(c.arc.highlightStrokeColor),c.polygon.fillColor=d.rgb2bw(c.polygon.fillColor),c.polygon.highlightFillColor=d.rgb2bw(c.polygon.highlightFillColor),c.sector.fillColor=d.rgb2bw(c.sector.fillColor),c.sector.highlightFillColor=d.rgb2bw(c.sector.highlightFillColor),c.curve.strokeColor=d.rgb2bw(c.curve.strokeColor),c.grid.gridColor=d.rgb2bw(c.grid.gridColor),a.useStandardOptions(b)},a.Options.normalizePointFace=a.normalizePointFace,a.Options}),define("renderer/abstract",["jxg","options","base/coords","base/constants","math/math","math/geometry","utils/type","utils/env"],function(a,b,c,d,e,f,g,h){"use strict";return a.AbstractRenderer=function(){this.vOffsetText=0,this.enhancedRendering=!0,this.container=null,this.type="",this.supportsForeignObject=!1},a.extend(a.AbstractRenderer.prototype,{_updateVisual:function(a,b,c){(c||this.enhancedRendering)&&(b=b||{},this.setObjectTransition(a),g.evaluate(a.visProp.draft)?this.setDraft(a):(b.stroke||(a.highlighted?(this.setObjectStrokeColor(a,a.visProp.highlightstrokecolor,a.visProp.highlightstrokeopacity),this.setObjectStrokeWidth(a,a.visProp.highlightstrokewidth)):(this.setObjectStrokeColor(a,a.visProp.strokecolor,a.visProp.strokeopacity),this.setObjectStrokeWidth(a,a.visProp.strokewidth))),b.fill||(a.highlighted?this.setObjectFillColor(a,a.visProp.highlightfillcolor,a.visProp.highlightfillopacity):this.setObjectFillColor(a,a.visProp.fillcolor,a.visProp.fillopacity)),b.dash||this.setDashStyle(a,a.visProp),b.shadow||this.setShadow(a),b.gradient||this.setShadow(a)))},drawPoint:function(a){var c,d=b.normalizePointFace(g.evaluate(a.visProp.face));c="o"===d?"ellipse":"[]"===d?"rect":"path",a.rendNode=this.appendChildPrim(this.createPrim(c,a.id),g.evaluate(a.visProp.layer)),this.appendNodesToElement(a,c),this._updateVisual(a,{dash:!0,shadow:!0},!0),this.updatePoint(a)},updatePoint:function(a){var c,d=g.evaluate(a.visProp.size),e=b.normalizePointFace(g.evaluate(a.visProp.face)),f=g.evaluate(a.visProp.sizeunit),h=g.evaluate(a.visProp.zoom);isNaN(a.coords.scrCoords[2]+a.coords.scrCoords[1])||("user"===f&&(d*=Math.sqrt(a.board.unitX*a.board.unitY)),d*=a.board&&h?Math.sqrt(a.board.zoomX*a.board.zoomY):1,c=0===d?0:d+1,"o"===e?this.updateEllipsePrim(a.rendNode,a.coords.scrCoords[1],a.coords.scrCoords[2],c,c):"[]"===e?this.updateRectPrim(a.rendNode,a.coords.scrCoords[1]-d,a.coords.scrCoords[2]-d,2*d,2*d):this.updatePathPrim(a.rendNode,this.updatePathStringPoint(a,d,e),a.board),this._updateVisual(a,{dash:!1,shadow:!1}),this.setShadow(a))},changePointStyle:function(a){var b=this.getElementById(a.id);g.exists(b)&&this.remove(b),this.drawPoint(a),g.clearVisPropOld(a),a.visPropCalc.visible||this.hide(a),g.evaluate(a.visProp.draft)&&this.setDraft(a)},drawLine:function(a){a.rendNode=this.appendChildPrim(this.createPrim("line",a.id),g.evaluate(a.visProp.layer)),this.appendNodesToElement(a,"lines"),this.updateLine(a)},updateLineEndings:function(a,b){var e,h=new c(d.COORDS_BY_USER,a.point1.coords.usrCoords,a.board),i=new c(d.COORDS_BY_USER,a.point2.coords.usrCoords,a.board),j=null;return j=g.evaluate(a.visProp.margin),f.calcStraight(a,h,i,j),e=this.getPositionArrowHead(a,h,i,b),this.updateLinePrim(a.rendNode,e.c1.scrCoords[1]+e.d1x,e.c1.scrCoords[2]+e.d1y,e.c2.scrCoords[1]-e.d2x,e.c2.scrCoords[2]-e.d2y,a.board),e},updateArrowSize:function(a,b){var c,d,e;return d=g.evaluate(a.visProp.firstarrow),d&&(c=g.exists(d.size)?g.evaluate(d.size):3,this._setArrowWidth(a.rendNodeTriangleStart,b.sFirst,a.rendNode,c)),e=g.evaluate(a.visProp.lastarrow),e&&(c=g.exists(e.size)?g.evaluate(e.size):3,this._setArrowWidth(a.rendNodeTriangleEnd,b.sLast,a.rendNode,c)),this},updateLine:function(a){var b;b=this.updateLineEndings(a,g.evaluate(a.visProp.strokewidth)),this.makeArrows(a),this._updateVisual(a),this.updateArrowSize(a,b),this.setLineCap(a)},getPositionArrowHead:function(a,b,f,h){var i,j,k,l,m,n,o,p,q,r,s,t=e.eps,u=0,v=0,w=g.evaluate(a.visProp.firstarrow),x=g.evaluate(a.visProp.lastarrow);return m=n=o=p=0,(w||x)&&(j=g.evaluate(a.point1.visProp.size)+g.evaluate(a.point1.visProp.strokewidth),k=g.evaluate(a.point2.visProp.size)+g.evaluate(a.point2.visProp.strokewidth),i=j+k,x&&g.evaluate(a.visProp.touchlastpoint)&&(l=b.distance(d.COORDS_BY_SCREEN,f),l>i&&(o=(f.scrCoords[1]-b.scrCoords[1])*k/l,p=(f.scrCoords[2]-b.scrCoords[2])*k/l,f=new c(d.COORDS_BY_SCREEN,[f.scrCoords[1]-o,f.scrCoords[2]-p],a.board))),w&&g.evaluate(a.visProp.touchfirstpoint)&&(l=b.distance(d.COORDS_BY_SCREEN,f),l>i&&(m=(f.scrCoords[1]-b.scrCoords[1])*j/l,n=(f.scrCoords[2]-b.scrCoords[2])*j/l,b=new c(d.COORDS_BY_SCREEN,[b.scrCoords[1]+m,b.scrCoords[2]+n],a.board))),m=n=o=p=0,l=b.distance(d.COORDS_BY_SCREEN,f),g.exists(w.type)&&(q=g.evaluate(w.type)),g.exists(x.type)&&(r=g.evaluate(x.type)),w&&(s=g.exists(w.size)?g.evaluate(w.size):3,u=h*s,2===q?(u*=.5,t+=h*s):3===q?(u=h,t+=h):t+=h*s),x&&(s=g.exists(x.size)?g.evaluate(x.size):3,v=h*s,2===r?(v*=.5,t+=h*s):3===r?(v=h,t+=h):t+=h*s),w&&"vml"!==a.board.renderer.type&&(l>=t?(m=(f.scrCoords[1]-b.scrCoords[1])*u/l,n=(f.scrCoords[2]-b.scrCoords[2])*u/l):u=0),x&&"vml"!==a.board.renderer.type&&(l>=t?(o=(f.scrCoords[1]-b.scrCoords[1])*v/l,p=(f.scrCoords[2]-b.scrCoords[2])*v/l):v=0)),{c1:b,c2:f,d1x:m,d1y:n,d2x:o,d2y:p,sFirst:u,sLast:v}},setLineCap:function(a){},drawTicks:function(a){a.rendNode=this.appendChildPrim(this.createPrim("path",a.id),g.evaluate(a.visProp.layer)),this.appendNodesToElement(a,"path")},updateTicks:function(a){},drawCurve:function(a){a.rendNode=this.appendChildPrim(this.createPrim("path",a.id),g.evaluate(a.visProp.layer)),this.appendNodesToElement(a,"path"),a.numberPoints>1&&this.makeArrows(a),this._updateVisual(a,{shadow:!0},!0),this.updateCurve(a)},updateCurve:function(a){var b,c,d,e=g.evaluate(a.visProp.strokewidth);g.evaluate(a.visProp.handdrawing)?this.updatePathPrim(a.rendNode,this.updatePathStringBezierPrim(a),a.board):this.updatePathPrim(a.rendNode,this.updatePathStringPrim(a),a.board),a.numberPoints>1&&(this.makeArrows(a),c=g.evaluate(a.visProp.firstarrow),c&&(b=g.exists(c.size)?g.evaluate(c.size):3,this._setArrowWidth(a.rendNodeTriangleStart,e,a.rendNode,b)),d=g.evaluate(a.visProp.lastarrow),d&&(b=g.exists(d.size)?g.evaluate(d.size):3,this._setArrowWidth(a.rendNodeTriangleEnd,e,a.rendNode,b))),this._updateVisual(a)},drawEllipse:function(a){a.rendNode=this.appendChildPrim(this.createPrim("ellipse",a.id),g.evaluate(a.visProp.layer)),this.appendNodesToElement(a,"ellipse"),this.updateEllipse(a)},updateEllipse:function(a){this._updateVisual(a);var b=a.Radius();b>0&&Math.abs(a.center.coords.usrCoords[0])>e.eps&&!isNaN(b+a.center.coords.scrCoords[1]+a.center.coords.scrCoords[2])&&b*a.board.unitX<2e6&&this.updateEllipsePrim(a.rendNode,a.center.coords.scrCoords[1],a.center.coords.scrCoords[2],b*a.board.unitX,b*a.board.unitY)},drawPolygon:function(a){a.rendNode=this.appendChildPrim(this.createPrim("polygon",a.id),g.evaluate(a.visProp.layer)),this.appendNodesToElement(a,"polygon"),this.updatePolygon(a)},updatePolygon:function(a){this._updateVisual(a,{stroke:!0,dash:!0}),this.updatePolygonPrim(a.rendNode,a)},displayCopyright:function(a,b){},drawInternalText:function(a){},updateInternalText:function(a){},drawText:function(a){var b,c,d;"html"===g.evaluate(a.visProp.display)&&h.isBrowser&&"no"!==this.type?(b=this.container.ownerDocument.createElement("div"),b.style.position="absolute",b.className=g.evaluate(a.visProp.cssclass),d=g.evaluate(a.visProp.layer),g.exists(d)||(d=0),c=""===this.container.style.zIndex?0:parseInt(this.container.style.zIndex,10),b.style.zIndex=c+d,this.container.appendChild(b),b.setAttribute("id",this.container.id+"_"+a.id)):b=this.drawInternalText(a),a.rendNode=b,a.htmlStr="",this.updateText(a)},updateText:function(b){var c,d,e,f,h,i=b.plaintext;if(b.visPropCalc.visible)if(this.updateTextStyle(b,!1),"html"===g.evaluate(b.visProp.display)&&"no"!==this.type){if(isNaN(b.coords.scrCoords[1]+b.coords.scrCoords[2])||(d=b.coords.scrCoords[1],d=Math.abs(d)<1e6?d:1e6,f=b.getAnchorX(),c="right"===f?Math.floor(b.board.canvasWidth-d):"middle"===f?Math.floor(d-.5*b.size[0]):Math.floor(d),b.visPropOld.left!==f+c&&("right"===f?(b.rendNode.style.right=c+"px",b.rendNode.style.left="auto"):(b.rendNode.style.left=c+"px",b.rendNode.style.right="auto"),b.visPropOld.left=f+c),d=b.coords.scrCoords[2]+this.vOffsetText,d=Math.abs(d)<1e6?d:1e6,h=b.getAnchorY(),c="bottom"===h?Math.floor(b.board.canvasHeight-d):"middle"===h?Math.floor(d-.5*b.size[1]):Math.floor(d),b.visPropOld.top!==h+c&&("bottom"===h?(b.rendNode.style.top="auto",b.rendNode.style.bottom=c+"px"):(b.rendNode.style.bottom="auto",b.rendNode.style.top=c+"px"),b.visPropOld.top=h+c)),b.htmlStr!==i){try{b.rendNode.innerHTML=i}catch(j){e=b.rendNode.parentNode,b.rendNode.parentNode.removeChild(b.rendNode),b.rendNode.innerHTML=i,e.appendChild(b.rendNode)}if(b.htmlStr=i,g.evaluate(b.visProp.usemathjax))try{MathJax.Hub.Queue(["Typeset",MathJax.Hub,b.rendNode])}catch(j){a.debug("MathJax (not yet) loaded")}else if(g.evaluate(b.visProp.useasciimathml))try{AMprocessNode(b.rendNode,!1)}catch(j){a.debug("AsciiMathML (not yet) loaded")}}this.transformImage(b,b.transformations)}else this.updateInternalText(b)},_css2js:function(a){var b,c,d,e,f,h=[],i=g.trim(a).replace(/;$/,"").split(";");for(c=i.length,b=0;b<c;++b)""!==g.trim(i[b])&&(f=i[b].split(":"),d=g.trim(f[0].replace(/-([a-z])/gi,function(a,b){return b.toUpperCase()})),e=g.trim(f[1]),h.push({key:d,val:e}));return h},updateTextStyle:function(a,b){var c,d,e,f,i,j,k,l,m,n=a.visProp,o=h.isBrowser?n.display:"internal",p=["rendNode","rendNodeTag","rendNodeLabel"],q=p.length,r=["cssdefaultstyle","cssstyle"],s=r.length;if(b?(e=n.highlightstrokecolor,d=n.highlightstrokeopacity,f=n.highlightcssclass):(e=n.strokecolor,d=n.strokeopacity,f=n.cssclass),"no"!==this.type&&("html"===o||"canvas"!==this.type)){for(l=0;l<s;l++)if(m=g.evaluate(n[(b?"highlight":"")+r[l]]),""!==m&&a.visPropOld[r[l]]!==m){for(j=this._css2js(m),i=0;i<q;i++)if(g.exists(a[p[i]]))for(k in j)j.hasOwnProperty(k)&&(a[p[i]].style[j[k].key]=j[k].val);a.visPropOld[r[l]]=m}if(c=g.evaluate(n.fontsize),a.visPropOld.fontsize!==c){a.needsSizeUpdate=!0;try{for(i=0;i<q;i++)g.exists(a[p[i]])&&(a[p[i]].style.fontSize=c+"px")}catch(t){for(i=0;i<q;i++)g.exists(a[p[i]])&&(a[p[i]].style.fontSize=c)}a.visPropOld.fontsize=c}}return this.setObjectTransition(a),"html"===o&&"no"!==this.type?(a.visPropOld.cssclass!==f&&(a.rendNode.className=f,a.visPropOld.cssclass=f,a.needsSizeUpdate=!0),this.setObjectStrokeColor(a,e,d)):this.updateInternalTextStyle(a,e,d),this},updateInternalTextStyle:function(a,b,c){this.setObjectStrokeColor(a,b,c)},drawImage:function(a){},updateImage:function(a){this.updateRectPrim(a.rendNode,a.coords.scrCoords[1],a.coords.scrCoords[2]-a.size[1],a.size[0],a.size[1]),this.updateImageURL(a),this.transformImage(a,a.transformations),this._updateVisual(a,{stroke:!0,dash:!0},!0)},joinTransforms:function(a,b){var c,d=a.board.origin.scrCoords[1],f=a.board.origin.scrCoords[2],g=a.board.unitX,h=a.board.unitY,i=b.length,j=[[1,0,0],[-d/g,1/g,0],[f/h,0,-1/h]];for(c=0;c<i;c++)j=e.matMatMult(b[c].matrix,j);return j=e.matMatMult([[1,0,0],[d,g,0],[f,0,-h]],j)},transformImage:function(a,b){},updateImageURL:function(a){},updateImageStyle:function(a,b){a.rendNode.className=g.evaluate(b?a.visProp.highlightcssclass:a.visProp.cssclass)},appendChildPrim:function(a,b){},appendNodesToElement:function(a,b){},createPrim:function(a,b){return null},remove:function(a){},makeArrows:function(a){},_setArrowWidth:function(a,b,c){},updateEllipsePrim:function(a,b,c,d,e){},updateLinePrim:function(a,b,c,d,e,f){},updatePathPrim:function(a,b,c){},updatePathStringPoint:function(a,b,c){},updatePathStringPrim:function(a){},updatePathStringBezierPrim:function(a){},updatePolygonPrim:function(a,b){},updateRectPrim:function(a,b,c,d,e){},setPropertyPrim:function(a,b,c){},display:function(a,b){a&&(a.visPropOld.visible=b)},show:function(a){},hide:function(a){},setBuffering:function(a,b){},setDashStyle:function(a){},setDraft:function(a){if(g.evaluate(a.visProp.draft)){var b=a.board.options.elements.draft.color,c=a.board.options.elements.draft.opacity;this.setObjectTransition(a),a.type===d.OBJECT_TYPE_POLYGON?this.setObjectFillColor(a,b,c):(a.elementClass===d.OBJECT_CLASS_POINT?this.setObjectFillColor(a,b,c):this.setObjectFillColor(a,"none",0),this.setObjectStrokeColor(a,b,c),this.setObjectStrokeWidth(a,a.board.options.elements.draft.strokeWidth))}},removeDraft:function(a){this.setObjectTransition(a),a.type===d.OBJECT_TYPE_POLYGON?this.setObjectFillColor(a,a.visProp.fillcolor,a.visProp.fillopacity):(a.type===d.OBJECT_CLASS_POINT&&this.setObjectFillColor(a,a.visProp.fillcolor,a.visProp.fillopacity),this.setObjectStrokeColor(a,a.visProp.strokecolor,a.visProp.strokeopacity),this.setObjectStrokeWidth(a,a.visProp.strokewidth))},setGradient:function(a){},updateGradient:function(a){},setObjectTransition:function(a,b){},setObjectFillColor:function(a,b,c){},setObjectStrokeColor:function(a,b,c){},setObjectStrokeWidth:function(a,b){},setShadow:function(a){},highlight:function(a){var b,c,e,f=a.visProp;if(this.setObjectTransition(a),!f.draft){if(a.type===d.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(a,f.highlightfillcolor,f.highlightfillopacity),b=0;b<a.borders.length;b++)this.setObjectStrokeColor(a.borders[b],a.borders[b].visProp.highlightstrokecolor,a.borders[b].visProp.highlightstrokeopacity);else a.elementClass===d.OBJECT_CLASS_TEXT?this.updateTextStyle(a,!0):a.type===d.OBJECT_TYPE_IMAGE?(this.updateImageStyle(a,!0),this.setObjectFillColor(a,f.highlightfillcolor,f.highlightfillopacity)):(this.setObjectStrokeColor(a,f.highlightstrokecolor,f.highlightstrokeopacity),this.setObjectFillColor(a,f.highlightfillcolor,f.highlightfillopacity));f.highlightstrokewidth&&(c=Math.max(g.evaluate(f.highlightstrokewidth),g.evaluate(f.strokewidth)),this.setObjectStrokeWidth(a,c),a.elementClass===d.OBJECT_CLASS_LINE&&(e=this.updateLineEndings(a,c),this.makeArrows(a),this.updateArrowSize(a,e)))}return this},noHighlight:function(a){var b,c,e,f=a.visProp;if(this.setObjectTransition(a),!g.evaluate(a.visProp.draft)){if(a.type===d.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(a,f.fillcolor,f.fillopacity),b=0;b<a.borders.length;b++)this.setObjectStrokeColor(a.borders[b],a.borders[b].visProp.strokecolor,a.borders[b].visProp.strokeopacity);else a.elementClass===d.OBJECT_CLASS_TEXT?this.updateTextStyle(a,!1):a.type===d.OBJECT_TYPE_IMAGE?(this.updateImageStyle(a,!1),this.setObjectFillColor(a,f.fillcolor,f.fillopacity)):(this.setObjectStrokeColor(a,f.strokecolor,f.strokeopacity),this.setObjectFillColor(a,f.fillcolor,f.fillopacity));e=g.evaluate(f.strokewidth),this.setObjectStrokeWidth(a,e),a.elementClass===d.OBJECT_CLASS_LINE&&(c=this.updateLineEndings(a,e),this.makeArrows(a),this.updateArrowSize(a,c))}return this},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(a,b){var c,d,e=function(a){a||(a=window.event),a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},f=function(f,i){var j;j=c.createElement("span"),d.appendChild(j),j.appendChild(c.createTextNode(f)),j.style.paddingLeft="7px",j.style.paddingRight="7px",h.addEvent(j,"mouseover",function(){this.style.backgroundColor=b.highlightfillcolor},j),h.addEvent(j,"mouseover",function(){this.style.backgroundColor=b.highlightfillcolor},j),h.addEvent(j,"mouseout",function(){this.style.backgroundColor=b.fillcolor},j),h.addEvent(j,"click",function(b){return g.bind(i,a)(),!1},a),h.addEvent(j,"mouseup",e,a),h.addEvent(j,"mousedown",e,a),h.addEvent(j,"touchend",e,a),h.addEvent(j,"touchstart",e,a)};h.isBrowser&&"no"!==this.type&&(c=a.containerObj.ownerDocument,d=c.createElement("div"),d.setAttribute("id",a.containerObj.id+"_navigationbar"),d.style.color=b.strokecolor,d.style.backgroundColor=b.fillcolor,d.style.padding=b.padding,d.style.position=b.position,d.style.fontSize=b.fontsize,d.style.cursor=b.cursor,d.style.zIndex=b.zindex,a.containerObj.appendChild(d),d.style.right=b.right,d.style.bottom=b.bottom,a.attr.showscreenshot&&f(a.attr.screenshot.symbol,function(){setTimeout(function(){a.renderer.screenshot(a,"",!1)},330)}),a.attr.showreload&&f("↻",function(){a.reload()}),a.attr.showcleartraces&&f("⊗",function(){a.clearTraces()}),a.attr.shownavigation&&(a.attr.showzoom&&(f("–",a.zoomOut),f("o",a.zoom100),f("+",a.zoomIn)),f("←",a.clickLeftArrow),f("↓",a.clickUpArrow),f("↑",a.clickDownArrow),f("→",a.clickRightArrow)))},getElementById:function(a){return g.exists(this.container)?this.container.ownerDocument.getElementById(this.container.id+"_"+a):""},removeToInsertLater:function(a){var b=a.parentNode,c=a.nextSibling;return b.removeChild(a),function(){c?b.insertBefore(a,c):b.appendChild(a)}},resize:function(a,b){},createTouchpoints:function(a){},showTouchpoint:function(a){},hideTouchpoint:function(a){},updateTouchpoint:function(a,b){},dumpToCanvas:function(a){},screenshot:function(a){}}),a.AbstractRenderer}),define("renderer/no",["jxg","renderer/abstract"],function(a,b){"use strict";return a.NoRenderer=function(){this.enhancedRendering=!1,this.type="no"},a.extend(a.NoRenderer.prototype,{drawPoint:function(a){},updatePoint:function(a){},changePointStyle:function(a){},drawLine:function(a){},updateLine:function(a){},drawTicks:function(a){},updateTicks:function(a){},drawCurve:function(a){},updateCurve:function(a){},drawEllipse:function(a){},updateEllipse:function(a){},drawPolygon:function(a){},updatePolygon:function(a){},displayCopyright:function(a,b){},drawInternalText:function(a){},updateInternalText:function(a){},drawText:function(a){},updateText:function(a){},updateTextStyle:function(a,b){},updateInternalTextStyle:function(a,b,c){},drawImage:function(a){},updateImage:function(a){},transformImage:function(a,b){},updateImageURL:function(a){},appendChildPrim:function(a,b){},appendNodesToElement:function(a,b){},createPrim:function(a,b){return null},remove:function(a){},makeArrows:function(a){},updateEllipsePrim:function(a,b,c,d,e){},updateLinePrim:function(a,b,c,d,e,f){},updatePathPrim:function(a,b,c){},updatePathStringPoint:function(a,b,c){},updatePathStringPrim:function(a){},updatePathStringBezierPrim:function(a){},updatePolygonPrim:function(a,b){},updateRectPrim:function(a,b,c,d,e){},setPropertyPrim:function(a,b,c){},display:function(a,b){a&&(a.visPropOld.visible=b)},show:function(a){},hide:function(a){},setBuffering:function(a,b){},setDashStyle:function(a){},setDraft:function(a){},removeDraft:function(a){},setGradient:function(a){},updateGradient:function(a){},setObjectTransition:function(a,b){},setObjectFillColor:function(a,b,c){},setObjectStrokeColor:function(a,b,c){},setObjectStrokeWidth:function(a,b){},setShadow:function(a){},highlight:function(a){},noHighlight:function(a){},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(a){},getElementById:function(a){return null},resize:function(a,b){},removeToInsertLater:function(){return function(){}}}),a.NoRenderer.prototype=new b,a.NoRenderer}),define("reader/file",["jxg","utils/env","utils/type","utils/encoding","utils/base64"],function(a,b,c,d,e){"use strict";return a.FileReader={parseFileContent:function(b,f,g,h,i){var j=!1;c.exists(h)||(h=!0);try{j=new XMLHttpRequest,"raw"===g.toLowerCase()?j.overrideMimeType("text/plain; charset=iso-8859-1"):j.overrideMimeType("text/xml; charset=iso-8859-1")}catch(k){try{j=new ActiveXObject("Msxml2.XMLHTTP")}catch(l){try{j=new ActiveXObject("Microsoft.XMLHTTP")}catch(m){j=!1}}}if(!j)return void a.debug("AJAX not activated!");j.open("GET",b,h),"raw"===g.toLowerCase()?this.cbp=function(){var a=j;4===a.readyState&&f(a.responseText)}:this.cbp=function(){var a=j,b="";4===a.readyState&&(b=!c.exists(a.responseStream)||"PK"!==a.responseText.slice(0,2)&&31!==d.asciiCharCodeAt(a.responseText.slice(0,1),0)?a.responseText:e.decode(jxgBinFileReader(a)),this.parseString(b,f,g,i))},this.cb=c.bind(this.cbp,this),j.onreadystatechange=this.cb;try{j.send(null)}catch(n){throw new Error("JSXGraph: A problem occurred while trying to read '"+b+"'.")}},parseString:function(b,d,e,f){var g,h;if(e=e.toLowerCase(),g=a.readers[e],!c.exists(g))throw new Error("JSXGraph: There is no reader available for '"+e+"'.");h=new g(d,b),h.read(),c.isFunction(f)&&f(d)}},!b.isMetroApp()&&b.isBrowser&&"object"==typeof navigator&&/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&document&&document.write&&document.write('<script type="text/vbscript">\nFunction Base64Encode(inData)\n  Const Base64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"\n  Dim cOut, sOut, I\n  For I = 1 To LenB(inData) Step 3\n    Dim nGroup, pOut, sGroup\n    nGroup = &H10000 * AscB(MidB(inData, I, 1)) + _\n      &H100 * MyASC(MidB(inData, I + 1, 1)) + MyASC(MidB(inData, I + 2, 1))\n    nGroup = Oct(nGroup)\n    nGroup = String(8 - Len(nGroup), "0") & nGroup\n    pOut = Mid(Base64, CLng("&o" & Mid(nGroup, 1, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 3, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 5, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 7, 2)) + 1, 1)\n    sOut = sOut + pOut\n  Next\n  Select Case LenB(inData) Mod 3\n    Case 1: \'8 bit final\n      sOut = Left(sOut, Len(sOut) - 2) + "=="\n    Case 2: \'16 bit final\n      sOut = Left(sOut, Len(sOut) - 1) + "="\n  End Select\n  Base64Encode = sOut\nEnd Function\n\nFunction MyASC(OneChar)\n  If OneChar = "" Then MyASC = 0 Else MyASC = AscB(OneChar)\nEnd Function\n\nFunction jxgBinFileReader(xhr)\n    Dim byteString\n    Dim b64String\n    Dim i\n    byteString = xhr.responseBody\n    ReDim byteArray(LenB(byteString))\n    For i = 1 To LenB(byteString)\n        byteArray(i-1) = AscB(MidB(byteString, i, 1))\n    Next\n    b64String = Base64Encode(byteString)\n    jxgBinFileReader = b64String\nEnd Function\n</script>\n'),a.FileReader}),define("parser/geonext",["jxg","base/constants","utils/type"],function(a,b,c){"use strict";return a.GeonextParser={replacePow:function(a){var b,c,d,e,f,g,h,i,j,k,l,m;for(a=a.replace(/(\s*)\^(\s*)/g,"^"),k=a.indexOf("^"),e=-1;k>=0&&k<a.length-1;){if(e===k)throw new Error("JSXGraph: Error while parsing expression '"+a+"'");if(e=k,j=a.slice(0,k),l=a.slice(k+1),")"===j.charAt(j.length-1)){for(b=1,c=j.length-2;c>=0&&b>0;)d=j.charAt(c),")"===d?b++:"("===d&&(b-=1),c-=1;if(0!==b)throw new Error("JSXGraph: Missing '(' in expression");for(f="",h=j.substring(0,c+1),i=c;i>=0&&h.substr(i,1).match(/([\w\.]+)/);)f=RegExp.$1+f,i-=1;f+=j.substring(c+1,j.length),f=f.replace(/([\(\)\+\*\%\^\-\/\]\[])/g,"\\$1")}else f="[\\w\\.]+";if(l.match(/^([\w\.]*\()/)){for(b=1,c=RegExp.$1.length;c<l.length&&b>0;)d=l.charAt(c),")"===d?b-=1:"("===d&&(b+=1),c+=1;if(0!==b)throw new Error("JSXGraph: Missing ')' in expression");g=l.substring(0,c),g=g.replace(/([\(\)\+\*\%\^\-\/\[\]])/g,"\\$1")}else g="[\\w\\.]+";m=new RegExp("("+f+")\\^("+g+")"),a=a.replace(m,"pow($1,$2)"),k=a.indexOf("^")}return a},replaceIf:function(a){var b,c,d,e,f,g,h,i,j,k="",l=null,m=null,n=null;if(d=a.indexOf("If("),d<0)return a;for(a=a.replace(/""/g,"0");d>=0;){for(b=a.slice(0,d),c=a.slice(d+3),f=1,e=0,g=-1,h=-1;e<c.length&&f>0;)i=c.charAt(e),")"===i?f-=1:"("===i?f+=1:","===i&&1===f&&(g<0?g=e:h=e),e+=1;if(j=c.slice(0,e-1),c=c.slice(e),g<0)return"";if(h<0)return"";l=j.slice(0,g),m=j.slice(g+1,h),n=j.slice(h+1),l=this.replaceIf(l),m=this.replaceIf(m),n=this.replaceIf(n),k+=b+"(("+l+")?("+m+"):("+n+"))",a=c,l=null,m=null,d=a.indexOf("If(")}return k+=c},replaceNameById:function(a,b,c){var d,e,f,g,h=0,i=["X","Y","L","V"],j=function(a){return c?"$('"+a+"')":a};for(g=0;g<i.length;g++)for(h=a.indexOf(i[g]+"(");h>=0;)h>=0&&(d=a.indexOf(")",h+2),d>=0&&(e=a.slice(h+2,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],f&&(a=a.slice(0,h+2)+(c?"$('":"")+j(f.id)+a.slice(d)))),d=a.indexOf(")",h+2),h=a.indexOf(i[g]+"(",d);for(h=a.indexOf("Dist(");h>=0;)h>=0&&(d=a.indexOf(",",h+5),d>=0&&(e=a.slice(h+5,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],f&&(a=a.slice(0,h+5)+j(f.id)+a.slice(d)))),d=a.indexOf(",",h+5),h=a.indexOf(",",d),d=a.indexOf(")",h+1),d>=0&&(e=a.slice(h+1,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],f&&(a=a.slice(0,h+1)+j(f.id)+a.slice(d))),d=a.indexOf(")",h+1),h=a.indexOf("Dist(",d);for(i=["Deg","Rad"],g=0;g<i.length;g++)for(h=a.indexOf(i[g]+"(");h>=0;)h>=0&&(d=a.indexOf(",",h+4),d>=0&&(e=a.slice(h+4,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],f&&(a=a.slice(0,h+4)+j(f.id)+a.slice(d)))),d=a.indexOf(",",h+4),h=a.indexOf(",",d),d=a.indexOf(",",h+1),d>=0&&(e=a.slice(h+1,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],f&&(a=a.slice(0,h+1)+j(f.id)+a.slice(d))),d=a.indexOf(",",h+1),h=a.indexOf(",",d),d=a.indexOf(")",h+1),d>=0&&(e=a.slice(h+1,d),e=e.replace(/\\(['"])?/g,"$1"),f=b.elementsByName[e],f&&(a=a.slice(0,h+1)+j(f.id)+a.slice(d))),d=a.indexOf(")",h+1),h=a.indexOf(i[g]+"(",d);return a},replaceIdByObj:function(a){var b=/(X|Y|L)\(([\w_]+)\)/g;return a=a.replace(b,"$('$2').$1()"),b=/(V)\(([\w_]+)\)/g,a=a.replace(b,"$('$2').Value()"),b=/(Dist)\(([\w_]+),([\w_]+)\)/g,a=a.replace(b,"dist($('$2'), $('$3'))"),b=/(Deg)\(([\w_]+),([ \w\[\w_]+),([\w_]+)\)/g,a=a.replace(b,"deg($('$2'),$('$3'),$('$4'))"),b=/Rad\(([\w_]+),([\w_]+),([\w_]+)\)/g,a=a.replace(b,"rad($('$1'),$('$2'),$('$3'))"),b=/N\((.+)\)/g,a=a.replace(b,"($1)")},geonext2JS:function(a,b){var c,d,e,f=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Factorial","Floor","Log","Max","Min","Random","Round","Sin","Sqrt","Tan","Trunc"],g=["abs","acos","asin","atan","ceil","cos","exp","factorial","floor","log","max","min","random","round","sin","sqrt","tan","ceil"];for(a=a.replace(/&lt;/g,"<"),a=a.replace(/&gt;/g,">"),a=a.replace(/&amp;/g,"&"),d=a,d=this.replaceNameById(d,b),d=this.replaceIf(d),d=this.replacePow(d),d=this.replaceIdByObj(d),e=0;e<f.length;e++)c=new RegExp(["(\\W|^)(",f[e],")"].join(""),"ig"),d=d.replace(c,["$1",g[e]].join(""));return d=d.replace(/True/g,"true"),d=d.replace(/False/g,"false"),d=d.replace(/fasle/g,"false"),d=d.replace(/Pi/g,"PI"),d=d.replace(/"/g,"'")},findDependencies:function(a,d,e){var f,g,h,i;c.exists(e)||(e=a.board),f=e.elementsByName;for(g in f)f.hasOwnProperty(g)&&g!==a.name&&(f[g].elementClass===b.OBJECT_CLASS_TEXT?c.evaluate(f[g].visProp.islabel)||(i=g.replace(/\[/g,"\\["),i=i.replace(/\]/g,"\\]"),h=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+i+")(,[\\w\\[\\]'_ ]+)*\\)","g"),d.search(h)>=0&&f[g].addChild(a)):(i=g.replace(/\[/g,"\\["),i=i.replace(/\]/g,"\\]"),h=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+i+")(,[\\w\\[\\]'_ ]+)*\\)","g"),d.search(h)>=0&&f[g].addChild(a)))},gxt2jc:function(a,b){var c;return a=a.replace(/&lt;/g,"<"),a=a.replace(/&gt;/g,">"),a=a.replace(/&amp;/g,"&"),c=a,c=this.replaceNameById(c,b,!0),c=c.replace(/True/g,"true"),c=c.replace(/False/g,"false"),c=c.replace(/fasle/g,"false")}},a.GeonextParser}),define("base/element",["jxg","base/constants","base/coords","math/math","math/statistics","options","parser/geonext","utils/event","utils/color","utils/type"],function(a,b,c,d,e,f,g,h,i,j){"use strict";return a.GeometryElement=function(a,c,d,e){var f,g,i;if(this.needsUpdate=!0,this.isDraggable=!1,this.isReal=!0,this.childElements={},this.hasLabel=!1,this.highlighted=!1,this.notExistingParents={},this.traces={},this.numTraces=0,this.transformations=[],this.baseElement=null,this.descendants={},this.ancestors={},this.parents=[],this.symbolic={},this.rendNode=null,this.elType="",this.dump=!0,this.subs={},this.inherits=[],this._pos=-1,this.stdform=[1,0,0,0,1,1,0,0],this.methodMap={setLabel:"setLabel",label:"label",setName:"setName",getName:"getName",addTransform:"addTransform",setProperty:"setAttribute",setAttribute:"setAttribute",addChild:"addChild",animate:"animate",on:"on",off:"off",trigger:"trigger"},this.quadraticform=[[1,0,0],[0,1,0],[0,0,1]],this.visProp={},this.visPropCalc={visible:!1},h.eventify(this),this.mouseover=!1,this.lastDragTime=new Date,arguments.length>0){this.board=a,this.type=d,this._org_type=d,this.elementClass=e||b.OBJECT_CLASS_OTHER,this.id=c.id,f=c.name,j.exists(f)||(f=this.board.generateName(this)),""!==f&&(this.board.elementsByName[f]=this),this.name=f,this.needsRegularUpdate=c.needsregularupdate,j.clearVisPropOld(this),i=this.resolveShortcuts(c);for(g in i)i.hasOwnProperty(g)&&this._set(g,i[g]);this.visProp.draft=i.draft&&i.draft.draft,this.visProp.gradientangle="270",this.visProp.gradientsecondopacity=j.evaluate(this.visProp.fillopacity),this.visProp.gradientpositionx=.5,this.visProp.gradientpositiony=.5}},a.extend(a.GeometryElement.prototype,{addChild:function(a){var b,c;this.childElements[a.id]=a,this.addDescendants(a),a.ancestors[this.id]=this;for(b in this.descendants)if(this.descendants.hasOwnProperty(b)){this.descendants[b].ancestors[this.id]=this;for(c in this.ancestors)this.ancestors.hasOwnProperty(c)&&(this.descendants[b].ancestors[this.ancestors[c].id]=this.ancestors[c])}for(b in this.ancestors)if(this.ancestors.hasOwnProperty(b))for(c in this.descendants)this.descendants.hasOwnProperty(c)&&(this.ancestors[b].descendants[this.descendants[c].id]=this.descendants[c]);return this},addDescendants:function(a){var b;this.descendants[a.id]=a;for(b in a.childElements)a.childElements.hasOwnProperty(b)&&this.addDescendants(a.childElements[b]);return this},addParents:function(a){var b,c,d;for(d=j.isArray(a)?a:arguments,c=d.length,b=0;b<c;++b)j.exists(d[b])&&(j.isId(this.board,d[b])?this.parents.push(d[b]):j.exists(d[b].id)&&this.parents.push(d[b].id));this.parents=j.uniqueArray(this.parents)},setParents:function(a){this.parents=[],this.addParents(a)},removeChild:function(a){return delete this.childElements[a.id],this.removeDescendants(a),delete a.ancestors[this.id],this},removeDescendants:function(a){var b;delete this.descendants[a.id];for(b in a.childElements)a.childElements.hasOwnProperty(b)&&this.removeDescendants(a.childElements[b]);return this},countChildren:function(){var a,b,c=0;b=this.childElements;for(a in b)b.hasOwnProperty(a)&&a.indexOf("Label")<0&&c++;return c},getName:function(){return this.name},addTransform:function(a){return this},draggable:function(){return this.isDraggable&&!j.evaluate(this.visProp.fixed)&&this.type!==b.OBJECT_TYPE_GLIDER},setPosition:function(a,c){var d,e,f,g,h=[];if(!j.exists(this.parents))return this;
for(f=this.parents.length,e=0;e<f;++e)if(d=this.board.select(this.parents[e]),j.isPoint(d)){if(!d.draggable())return this;h.push(d)}for(3===c.length&&(c=c.slice(1)),g=this.board.create("transform",c,{type:"translate"}),f=h.length,f>0?g.applyOnce(h):this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(g):this.addTransform(g),e=0;e<f;++e)h[e].type===b.OBJECT_TYPE_GLIDER&&h[e].updateGlider();return this},setPositionDirectly:function(a,d,f){var g=new c(a,d,this.board,(!1)),h=new c(a,f,this.board,(!1)),i=e.subtract(g.usrCoords,h.usrCoords);return this.setPosition(b.COORDS_BY_USER,i),this},generatePolynomial:function(){return[]},animate:function(a,b,c){c=c||{};var d,e,f,g=this.board.attr.animationdelay,h=Math.ceil(b/g),k=this,l=function(a,b,c){var d,e,g,j,l;for(d=i.rgb2hsv(a),e=i.rgb2hsv(b),g=(e[0]-d[0])/h,j=(e[1]-d[1])/h,l=(e[2]-d[2])/h,k.animationData[c]=[],f=0;f<h;f++)k.animationData[c][h-f-1]=i.hsv2rgb(d[0]+(f+1)*g,d[1]+(f+1)*j,d[2]+(f+1)*l)},m=function(a,b,c,d){var e,g;if(a=parseFloat(a),b=parseFloat(b),!isNaN(a)&&!isNaN(b))for(g=(b-a)/h,k.animationData[c]=[],f=0;f<h;f++)e=a+(f+1)*g,k.animationData[c][h-f-1]=d?Math.floor(e):e};this.animationData={};for(d in a)if(a.hasOwnProperty(d))switch(e=d.toLowerCase()){case"strokecolor":case"fillcolor":l(this.visProp[e],a[d],e);break;case"size":if(!j.isPoint(this))break;m(this.visProp[e],a[d],e,!0);break;case"strokeopacity":case"strokewidth":case"fillopacity":m(this.visProp[e],a[d],e,!1)}return this.animationCallback=c.callback,this.board.addAnimation(this),this},update:function(){return j.evaluate(this.visProp.trace)&&this.cloneToBackground(),this},updateRenderer:function(){return this},fullUpdate:function(a){return this.prepareUpdate().update().updateVisibility(a).updateRenderer()},setDisplayRendNode:function(a){var b,c,d,e,f;if(void 0===a&&(a=this.visPropCalc.visible),a===this.visPropOld.visible)return this;for(this.board.renderer.display(this,a),c=this.inherits.length,d=0;d<c;d++)if(f=this.inherits[d],j.isArray(f))for(e=f.length,b=0;b<e;b++)j.exists(f[b])&&j.exists(f[b].rendNode)&&"inherit"===j.evaluate(f[b].visProp.visible)&&f[b].setDisplayRendNode(a);else j.exists(f)&&j.exists(f.rendNode)&&"inherit"===j.evaluate(f.visProp.visible)&&f.setDisplayRendNode(a);return this.hasLabel&&j.exists(this.label)&&j.exists(this.label.rendNode)&&"inherit"===j.evaluate(this.label.visProp.visible)&&this.label.setDisplayRendNode(a),this},hideElement:function(){return a.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=this.visProp.visible=!1,this.board.renderer.display(this,!1),j.exists(this.label)&&this.hasLabel&&(this.label.hiddenByParent=!0,this.label.visPropCalc.visible&&this.label.hideElement()),this},showElement:function(){return a.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=this.visProp.visible=!0,this.board.renderer.display(this,!0),j.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.visPropCalc.visible||this.label.showElement().updateRenderer()),this},updateVisibility:function(a){var b,c,d,e,f,g;if(this.needsUpdate){for(void 0!==a?this.visPropCalc.visible=a:(g=j.evaluate(this.visProp.visible),j.exists(this.hiddenByParent)&&this.hiddenByParent&&(g=!1),"inherit"!==g&&(this.visPropCalc.visible=g)),c=this.inherits.length,d=0;d<c;d++)if(f=this.inherits[d],j.isArray(f))for(e=f.length,b=0;b<e;b++)j.exists(f[b])&&"inherit"===j.evaluate(f[b].visProp.visible)&&f[b].prepareUpdate().updateVisibility(this.visPropCalc.visible);else j.exists(f)&&"inherit"===j.evaluate(f.visProp.visible)&&f.prepareUpdate().updateVisibility(this.visPropCalc.visible);j.exists(this.label)&&j.exists(this.label.visProp)&&j.evaluate(this.label.visProp.visible)&&this.label.prepareUpdate().updateVisibility(this.visPropCalc.visible)}return this},_set:function(a,b){a=a.toLocaleLowerCase(),this.visProp.hasOwnProperty(a)&&a.indexOf("color")>=0&&j.isString(b)&&9===b.length&&"#"===b.charAt(0)?(b=i.rgba2rgbo(b),this.visProp[a]=b[0],this.visProp[a.replace("color","opacity")]=b[1]):this.visProp[a]=b},resolveShortcuts:function(a){var b,c;for(b in f.shortcuts)if(f.shortcuts.hasOwnProperty(b)&&j.exists(a[b]))for(c=0;c<f.shortcuts[b].length;c++)j.exists(a[f.shortcuts[b][c]])||(a[f.shortcuts[b][c]]=a[b]);return a},setLabel:function(a){this.hasLabel||this.setAttribute({withlabel:!0}),this.setLabelText(a)},setLabelText:function(a){return j.exists(this.label)&&(a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.label.setText(a)),this},setName:function(a){a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;"),"slider"!==this.elType&&this.setLabelText(a),this.setAttribute({name:a})},setProperty:function(){a.deprecated("setProperty()","setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(c){var d,e,f,g,h,k,l,m,n,o={};for(d=0;d<arguments.length;d++)k=arguments[d],j.isString(k)?(m=k.split(":"),o[j.trim(m[0])]=j.trim(m[1])):j.isArray(k)?o[k[0]]=k[1]:a.extend(o,k);o=this.resolveShortcuts(o);for(d in o)if(o.hasOwnProperty(d)){if(g=d.replace(/\s+/g,"").toLowerCase(),h=o[d],n=this.visProp[g],j.isObject(h)&&j.exists(this.visProp[g])){if(this.visProp[g]=j.merge(this.visProp[g],h),this.type===b.OBJECT_TYPE_TICKS&&j.exists(this.labels))for(f=this.labels.length,e=0;e<f;e++)this.labels[e].setAttribute(h);continue}switch(g){case"name":n=this.name,delete this.board.elementsByName[this.name],this.name=h,this.board.elementsByName[this.name]=this;break;case"needsregularupdate":this.needsRegularUpdate=!("false"===h||h===!1),this.board.renderer.setBuffering(this,this.needsRegularUpdate?"auto":"static");break;case"labelcolor":h=i.rgba2rgbo(h),l=h[1],h=h[0],0===l&&j.exists(this.label)&&this.hasLabel&&this.label.hideElement(),j.exists(this.label)&&this.hasLabel&&(this.label.visProp.strokecolor=h,this.board.renderer.setObjectStrokeColor(this.label,h,l)),this.elementClass===b.OBJECT_CLASS_TEXT&&(this.visProp.strokecolor=h,this.visProp.strokeopacity=l,this.board.renderer.setObjectStrokeColor(this,h,l));break;case"infoboxtext":j.isString(h)?this.infoboxText=h:this.infoboxText=!1;break;case"visible":"false"===h?this.visProp.visible=!1:"true"===h?this.visProp.visible=!0:this.visProp.visible=h,this.setDisplayRendNode(j.evaluate(this.visProp.visible));break;case"face":j.isPoint(this)&&(this.visProp.face=h,this.board.renderer.changePointStyle(this));break;case"trace":"false"===h||h===!1?(this.clearTrace(),this.visProp.trace=!1):this.visProp.trace=!0;break;case"gradient":this.visProp.gradient=h,this.board.renderer.setGradient(this);break;case"gradientsecondcolor":h=i.rgba2rgbo(h),this.visProp.gradientsecondcolor=h[0],this.visProp.gradientsecondopacity=h[1],this.board.renderer.updateGradient(this);break;case"gradientsecondopacity":this.visProp.gradientsecondopacity=h,this.board.renderer.updateGradient(this);break;case"withlabel":this.visProp.withlabel=h,j.evaluate(h)?(this.label||this.createLabel(),this.label.setAttribute({visible:"inherit"})):this.label&&this.hasLabel&&this.label.setAttribute({visible:!1}),this.hasLabel=h;break;case"radius":this.type!==b.OBJECT_TYPE_ANGLE&&this.type!==b.OBJECT_TYPE_SECTOR||this.setRadius(h);break;case"rotate":(this.elementClass===b.OBJECT_CLASS_TEXT&&"internal"===j.evaluate(this.visProp.display)||this.type===b.OBJECT_TYPE_IMAGE)&&this.addRotation(h);break;case"ticksdistance":this.type===b.OBJECT_TYPE_TICKS&&j.isNumber(h)&&(this.ticksFunction=this.makeTicksFunction(h));break;case"generatelabelvalue":this.type===b.OBJECT_TYPE_TICKS&&j.isFunction(h)&&(this.generateLabelValue=h);break;case"onpolygon":this.type===b.OBJECT_TYPE_GLIDER&&(this.onPolygon=!!h);break;case"disabled":j.exists(this.rendNodeTag)&&(this.rendNodeTag.disabled=!!h);break;case"checked":j.exists(this.rendNodeTag)&&(this.rendNodeCheckbox.checked=!!h);break;case"maxlength":j.exists(this.rendNodeTag)&&(this.rendNodeTag.maxlength=!!h);break;default:j.exists(this.visProp[g])&&(!a.Validator[g]||a.Validator[g]&&a.Validator[g](h)||a.Validator[g]&&j.isFunction(h)&&a.Validator[g](h()))&&(h=(!h.toLowerCase||"false"!==h.toLowerCase())&&h,this._set(g,h))}this.triggerEventHandlers(["attribute:"+g],[n,h,this])}return this.triggerEventHandlers(["attribute"],[o,this]),j.evaluate(this.visProp.needsregularupdate)?this.board.update(this):this.board.fullUpdate(),this},getProperty:function(){a.deprecated("getProperty()","getAttribute()"),this.getProperty.apply(this,arguments)},getAttribute:function(a){var b;switch(a=a.toLowerCase()){case"needsregularupdate":b=this.needsRegularUpdate;break;case"labelcolor":b=this.label.visProp.strokecolor;break;case"infoboxtext":b=this.infoboxText;break;case"withlabel":b=this.hasLabel;break;default:b=this.visProp[a]}return b},setDash:function(a){return this.setAttribute({dash:a}),this},prepareUpdate:function(){return this.needsUpdate=!0,this},remove:function(){return this.board.renderer.remove(this.board.renderer.getElementById(this.id)),this.hasLabel&&this.board.renderer.remove(this.board.renderer.getElementById(this.label.id)),this},getTextAnchor:function(){return new c(b.COORDS_BY_USER,[0,0],this.board)},getLabelAnchor:function(){return new c(b.COORDS_BY_USER,[0,0],this.board)},setArrow:function(a,c){return this.visProp.firstarrow=a,this.visProp.lastarrow=c,c&&(this.type=b.OBJECT_TYPE_VECTOR,this.elType="arrow"),this.prepareUpdate().update().updateVisibility().updateRenderer(),this},createGradient:function(){var a=j.evaluate(this.visProp.gradient);"linear"!==a&&"radial"!==a||this.board.renderer.setGradient(this)},createLabel:function(){var b,c=this;return a.elements.text?(b=j.deepCopy(this.visProp.label,null),b.id=this.id+"Label",b.isLabel=!0,b.anchor=this,b.priv=this.visProp.priv,this.visProp.withlabel&&(this.label=a.elements.text(this.board,[0,0,function(){return j.isFunction(c.name)?c.name():c.name}],b),this.label.needsUpdate=!0,this.label.dump=!1,this.label.update(),this.hasLabel=!0)):a.debug("JSXGraph: Can't create label: text element is not available. Make sure you include base/text"),this},highlight:function(a){return a=j.def(a,!1),!j.evaluate(this.visProp.highlight)||this.highlighted&&!a||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this)),this},noHighlight:function(){return this.highlighted&&(this.highlighted=!1,delete this.board.highlightedObjects[this.id],this.board.renderer.noHighlight(this)),this},clearTrace:function(){var a;for(a in this.traces)this.traces.hasOwnProperty(a)&&this.board.renderer.remove(this.traces[a]);return this.numTraces=0,this},cloneToBackground:function(){return this},bounds:function(){return[0,0,0,0]},normalize:function(){return this.stdform=d.normalize(this.stdform),this},toJSON:function(){var a,b,c=['{"name":',this.name];c.push(', "id":'+this.id),a=[];for(b in this.visProp)this.visProp.hasOwnProperty(b)&&j.exists(this.visProp[b])&&a.push('"'+b+'":'+this.visProp[b]);return c.push(', "visProp":{'+a.toString()+"}"),c.push("}"),c.join("")},addRotation:function(a){var c,d,e,f,g,h=this;return(this.elementClass===b.OBJECT_CLASS_TEXT&&"internal"===j.evaluate(this.visProp.display)||this.type===b.OBJECT_TYPE_IMAGE)&&0!==a&&(c=this.board.create("transform",[function(){return-h.X()},function(){return-h.Y()}],{type:"translate"}),d=this.board.create("transform",[function(){return h.X()},function(){return h.Y()}],{type:"translate"}),e=this.board.create("transform",[function(){return h.board.unitX/h.board.unitY},function(){return 1}],{type:"scale"}),f=this.board.create("transform",[function(){return h.board.unitY/h.board.unitX},function(){return 1}],{type:"scale"}),g=this.board.create("transform",[a*Math.PI/180],{type:"rotate"}),c.bindTo(this),e.bindTo(this),g.bindTo(this),f.bindTo(this),d.bindTo(this)),this},highlightStrokeColor:function(b){return a.deprecated("highlightStrokeColor()","setAttribute()"),this.setAttribute({highlightStrokeColor:b}),this},strokeColor:function(b){return a.deprecated("strokeColor()","setAttribute()"),this.setAttribute({strokeColor:b}),this},strokeWidth:function(b){return a.deprecated("strokeWidth()","setAttribute()"),this.setAttribute({strokeWidth:b}),this},fillColor:function(b){return a.deprecated("fillColor()","setAttribute()"),this.setAttribute({fillColor:b}),this},highlightFillColor:function(b){return a.deprecated("highlightFillColor()","setAttribute()"),this.setAttribute({highlightFillColor:b}),this},labelColor:function(b){return a.deprecated("labelColor()","setAttribute()"),this.setAttribute({labelColor:b}),this},dash:function(b){return a.deprecated("dash()","setAttribute()"),this.setAttribute({dash:b}),this},visible:function(b){return a.deprecated("visible()","setAttribute()"),this.setAttribute({visible:b}),this},shadow:function(b){return a.deprecated("shadow()","setAttribute()"),this.setAttribute({shadow:b}),this},getType:function(){return this.elType},getParents:function(){return j.isArray(this.parents)?this.parents:[]},snapToGrid:function(){return this},snapToPoints:function(){return this},getAttributes:function(){var a,b=j.deepCopy(this.visProp),c=[],d=c.length;for(b.id=this.id,b.name=this.name,a=0;a<d;a++)delete b[c[a]];return b},hasPoint:function(a,b){return!1},handleSnapToGrid:function(a,c){var d,e,f,g,h=!1,i=j.evaluate(this.visProp.snapsizex),k=j.evaluate(this.visProp.snapsizey);return j.exists(this.coords)?(h=j.evaluate(this.visProp.snaptogrid)||a===!0,h&&(d=this.coords.usrCoords[1],e=this.coords.usrCoords[2],i<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(f=this.board.defaultAxes.x.defaultTicks,i=f.ticksDelta*(j.evaluate(f.visProp.minorticks)+1)),k<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(f=this.board.defaultAxes.y.defaultTicks,k=f.ticksDelta*(j.evaluate(f.visProp.minorticks)+1)),i>0&&k>0&&(g=this.board.getBoundingBox(),d=Math.round(d/i)*i,e=Math.round(e/k)*k,c||(d<g[0]?d+=i:d>g[2]&&(d-=i),e<g[3]?e+=k:e>g[1]&&(e-=k)),this.coords.setCoordinates(b.COORDS_BY_USER,[d,e]))),this):this},addEvent:a.shortcut(a.GeometryElement.prototype,"on"),removeEvent:a.shortcut(a.GeometryElement.prototype,"off"),__evt__over:function(a){},__evt__mouseover:function(a){},__evt__out:function(a){},__evt__mouseout:function(a){},__evt__move:function(a){},__evt__mousemove:function(a){},__evt__drag:function(a){},__evt__mousedrag:function(a){},__evt__touchdrag:function(a){},__evt__down:function(a){},__evt__mousedown:function(a){},__evt__touchdown:function(a){},__evt__up:function(a){},__evt__mouseup:function(a){},__evt__touchup:function(a){},__evt__attribute:function(a,b){},__evt__attribute_:function(a,b,c){},__evt:function(){}}),a.GeometryElement}),define("base/transformation",["jxg","base/constants","math/math","utils/type"],function(a,b,c,d){"use strict";return a.Transformation=function(a,c,d){this.elementClass=b.OBJECT_CLASS_OTHER,this.type=b.OBJECT_TYPE_TRANSFORMATION,this.matrix=[[1,0,0],[0,1,0],[0,0,1]],this.board=a,this.isNumericMatrix=!1,this.setMatrix(a,c,d),this.methodMap={apply:"apply",applyOnce:"applyOnce",bindTo:"bindTo",bind:"bind",melt:"melt"}},a.Transformation.prototype={},a.extend(a.Transformation.prototype,{update:function(){return this},setMatrix:function(a,b,e){var f;for(this.isNumericMatrix=!0,f=0;f<e.length;f++)if("number"!=typeof e[f]){this.isNumericMatrix=!1;break}if("translate"===b){if(2!==e.length)throw new Error("JSXGraph: translate transformation needs 2 parameters.");this.evalParam=d.createEvalFunction(a,e,2),this.update=function(){this.matrix[1][0]=this.evalParam(0),this.matrix[2][0]=this.evalParam(1)}}else if("scale"===b){if(2!==e.length)throw new Error("JSXGraph: scale transformation needs 2 parameters.");this.evalParam=d.createEvalFunction(a,e,2),this.update=function(){this.matrix[1][1]=this.evalParam(0),this.matrix[2][2]=this.evalParam(1)}}else if("reflect"===b)e.length<4&&(e[0]=a.select(e[0])),2===e.length&&(e[1]=a.select(e[1])),4===e.length&&(this.evalParam=d.createEvalFunction(a,e,4)),this.update=function(){var a,b,d,f,g,h,i,j;1===e.length?i=e[0].stdform:2===e.length?i=c.crossProduct(e[1].coords.usrCoords,e[0].coords.usrCoords):4===e.length&&(i=c.crossProduct([1,this.evalParam(2),this.evalParam(3)],[1,this.evalParam(0),this.evalParam(1)])),a=i[1],b=i[2],d=i[0],j=[-d*a,-d*b,a*a+b*b],h=j[2],f=j[0]/j[2],g=j[1]/j[2],a=-i[2],b=i[1],this.matrix[1][1]=(a*a-b*b)/h,this.matrix[1][2]=2*a*b/h,this.matrix[2][1]=this.matrix[1][2],this.matrix[2][2]=-this.matrix[1][1],this.matrix[1][0]=f*(1-this.matrix[1][1])-g*this.matrix[1][2],this.matrix[2][0]=g*(1-this.matrix[2][2])-f*this.matrix[2][1]};else if("rotate"===b)3===e.length?this.evalParam=d.createEvalFunction(a,e,3):e.length>0&&e.length<=2&&(this.evalParam=d.createEvalFunction(a,e,1),2!==e.length||d.isArray(e[1])||(e[1]=a.select(e[1]))),this.update=function(){var a,b,c=this.evalParam(0),f=Math.cos(c),g=Math.sin(c);this.matrix[1][1]=f,this.matrix[1][2]=-g,this.matrix[2][1]=g,this.matrix[2][2]=f,e.length>1&&(3===e.length?(a=this.evalParam(1),b=this.evalParam(2)):d.isArray(e[1])?(a=e[1][0],b=e[1][1]):(a=e[1].X(),b=e[1].Y()),this.matrix[1][0]=a*(1-f)+b*g,this.matrix[2][0]=b*(1-f)-a*g)};else if("shear"===b){if(2!==e.length)throw new Error("JSXGraph: shear transformation needs 2 parameters.");this.evalParam=d.createEvalFunction(a,e,2),this.update=function(){this.matrix[1][2]=this.evalParam(0),this.matrix[2][1]=this.evalParam(1)}}else if("generic"===b){if(9!==e.length)throw new Error("JSXGraph: generic transformation needs 9 parameters.");this.evalParam=d.createEvalFunction(a,e,9),this.update=function(){this.matrix[0][0]=this.evalParam(0),this.matrix[0][1]=this.evalParam(1),this.matrix[0][2]=this.evalParam(2),this.matrix[1][0]=this.evalParam(3),this.matrix[1][1]=this.evalParam(4),this.matrix[1][2]=this.evalParam(5),this.matrix[2][0]=this.evalParam(6),this.matrix[2][1]=this.evalParam(7),this.matrix[2][2]=this.evalParam(8)}}},apply:function(a,b){return this.update(),d.exists(b)?c.matVecMult(this.matrix,a.initialCoords.usrCoords):c.matVecMult(this.matrix,a.coords.usrCoords)},applyOnce:function(a){var e,f,g;for(d.isArray(a)||(a=[a]),f=a.length,g=0;g<f;g++)this.update(),e=c.matVecMult(this.matrix,a[g].coords.usrCoords),a[g].coords.setCoordinates(b.COORDS_BY_USER,e)},bindTo:function(a){var b,c;if(d.isArray(a))for(c=a.length,b=0;b<c;b++)a[b].transformations.push(this);else a.transformations.push(this)},setProperty:function(b){a.deprecated("Transformation.setProperty()","Transformation.setAttribute()")},setAttribute:function(a){},melt:function(a){var b,c,d,e,f,g,h=[];for(c=a.matrix.length,d=this.matrix[0].length,b=0;b<c;b++)h[b]=[];for(this.update(),a.update(),b=0;b<c;b++)for(g=0;g<d;g++){for(f=0,e=0;e<c;e++)f+=a.matrix[b][e]*this.matrix[e][g];h[b][g]=f}return this.update=function(){var a=this.matrix.length,c=this.matrix[0].length;for(b=0;b<a;b++)for(g=0;g<c;g++)this.matrix[b][g]=h[b][g]},this},getParents:function(){var a=[[].concat.apply([],this.matrix)];return 0!==this.parents.length&&(a=this.parents),a}}),a.createTransform=function(b,c,d){return new a.Transformation(b,d.type,c)},a.registerElement("transform",a.createTransform),{Transformation:a.Transformation,createTransform:a.createTransform}}),define("base/coordselement",["jxg","options","math/math","math/geometry","math/numerics","math/statistics","base/coords","base/constants","base/element","parser/geonext","utils/type","base/transformation"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";return a.CoordsElement=function(a,b){var c;for(k.exists(a)||(a=[1,0,0]),c=0;c<a.length;++c)a[c]=parseFloat(a[c]);this.coords=new g(h.COORDS_BY_USER,a,this.board),this.initialCoords=new g(h.COORDS_BY_USER,a,this.board),this.position=null,this.onPolygon=!1,this.slideObject=null,this.slideObjects=[],this.needsUpdateFromParent=!0,this.updateConstraint=function(){return this},this.groups=[],this.Xjc=null,this.Yjc=null,this.methodMap=k.deepCopy(this.methodMap,{move:"moveTo",moveTo:"moveTo",moveAlong:"moveAlong",visit:"visit",glide:"makeGlider",makeGlider:"makeGlider",intersect:"makeIntersection",makeIntersection:"makeIntersection",X:"X",Y:"Y",free:"free",setPosition:"setGliderPosition",setGliderPosition:"setGliderPosition",addConstraint:"addConstraint",dist:"Dist",onPolygon:"onPolygon"}),k.exists(this.element)&&this.addAnchor(a,b),this.isDraggable=!0},a.extend(a.CoordsElement.prototype,{updateCoords:function(a){return this.needsUpdate?(k.exists(a)||(a=!1),this.type===h.OBJECT_TYPE_GLIDER&&(a?this.updateGliderFromParent():this.updateGlider()),k.evaluate(this.visProp.frozen)||this.updateConstraint(),this.updateTransform(),this):this},updateGlider:function(){var a,b,e,f,i,j,l,m,n,o,p,q,r,s,t,u,v,w,x=2*Math.PI,y=!1,z=this.slideObject;if(this.needsUpdateFromParent=!1,z.elementClass===h.OBJECT_CLASS_CIRCLE)k.evaluate(this.visProp.isgeonext)&&(x=1),u=d.projectPointToCircle(this,z,this.board),v=d.rad([z.center.X()+1,z.center.Y()],z.center,this)/x;else if(z.elementClass===h.OBJECT_CLASS_LINE){if(this.onPolygon){if(b=z.point1.coords.usrCoords,e=z.point2.coords.usrCoords,a=1,f=e[a]-b[a],Math.abs(f)<c.eps&&(a=2,f=e[a]-b[a]),l=d.projectPointToLine(this,z,this.board),m=(l.usrCoords[a]-b[a])/f,j=z.parentPolygon,m<0){for(a=0;a<j.borders.length;a++)if(z===j.borders[a]){z=j.borders[(a-1+j.borders.length)%j.borders.length];break}}else if(m>1)for(a=0;a<j.borders.length;a++)if(z===j.borders[a]){z=j.borders[(a+1+j.borders.length)%j.borders.length];break}z.id!==this.slideObject.id&&(this.slideObject=z)}b=z.point1.coords,e=z.point2.coords,f=b.distance(h.COORDS_BY_USER,e),f<c.eps?(u=b,y=!0,v=0):(u=d.projectPointToLine(this,z,this.board),b=b.usrCoords.slice(0),e=e.usrCoords.slice(0),Math.abs(e[0])<c.eps?(a=1,f=e[a],Math.abs(f)<c.eps&&(a=2,f=e[a]),f=(u.usrCoords[a]-b[a])/f,n=f>=0?1:-1,f=Math.abs(f),v=n*f/(f+1)):Math.abs(b[0])<c.eps?(a=1,f=b[a],Math.abs(f)<c.eps&&(a=2,f=b[a]),f=(u.usrCoords[a]-e[a])/f,v=f<0?(1-2*f)/(1-f):1/(f+1)):(a=1,f=e[a]-b[a],Math.abs(f)<c.eps&&(a=2,f=e[a]-b[a]),v=(u.usrCoords[a]-b[a])/f)),w=k.evaluate(this.visProp.snapwidth),k.evaluate(w)>0&&Math.abs(this._smax-this._smin)>=c.eps&&(v=Math.max(Math.min(v,1),0),i=v*(this._smax-this._smin)+this._smin,i=Math.round(i/w)*w,v=(i-this._smin)/(this._smax-this._smin),this.update(!0)),b=z.point1.coords,!k.evaluate(z.visProp.straightfirst)&&Math.abs(b.usrCoords[0])>c.eps&&v<0&&(u=b,y=!0,v=0),e=z.point2.coords,!k.evaluate(z.visProp.straightlast)&&Math.abs(e.usrCoords[0])>c.eps&&v>1&&(u=e,y=!0,v=1)}else z.type===h.OBJECT_TYPE_TURTLE?(this.updateConstraint(),u=d.projectPointToTurtle(this,z,this.board),v=this.position):z.elementClass===h.OBJECT_CLASS_CURVE?z.type===h.OBJECT_TYPE_ARC||z.type===h.OBJECT_TYPE_SECTOR?(u=d.projectPointToCircle(this,z,this.board),q=d.rad(z.radiuspoint,z.center,this),o=0,p=d.rad(z.radiuspoint,z.center,z.anglepoint),v=q,w=k.evaluate(z.visProp.selection),("minor"===w&&p>Math.PI||"major"===w&&p<Math.PI)&&(o=p,p=2*Math.PI),(q<o||q>p)&&(v=p,(q<o&&q>.5*o||q>p&&q>.5*p+Math.PI)&&(v=o),this.needsUpdateFromParent=!0,this.updateGliderFromParent()),x=p-o,this.visProp.isgeonext&&(x=1),Math.abs(x)>c.eps&&(v/=x)):(this.updateConstraint(),z.transformations.length>0?(z.updateTransformMatrix(),t=c.inverse(z.transformMat),s=c.matVecMult(t,this.coords.usrCoords),r=new g(h.COORDS_BY_USER,s,this.board).usrCoords,s=d.projectCoordsToCurve(r[1],r[2],this.position||0,z,this.board),u=s[0],v=s[1]):(u=d.projectPointToCurve(this,z,this.board),v=this.position)):k.isPoint(z)&&(u=d.projectPointToPoint(this,z,this.board),v=this.position);this.coords.setCoordinates(h.COORDS_BY_USER,u.usrCoords,y),this.position=v},updateGliderFromParent:function(){var a,b,e,f,g,i,j,l,m,n=this.slideObject,o=2*Math.PI;return this.needsUpdateFromParent?(n.elementClass===h.OBJECT_CLASS_CIRCLE?(e=n.Radius(),k.evaluate(this.visProp.isgeonext)&&(o=1),g=[n.center.X()+e*Math.cos(this.position*o),n.center.Y()+e*Math.sin(this.position*o)]):n.elementClass===h.OBJECT_CLASS_LINE?(a=n.point1.coords.usrCoords,b=n.point2.coords.usrCoords,0===a[0]&&0===a[1]&&0===a[2]||0===b[0]&&0===b[1]&&0===b[2]?g=[0,0,0]:Math.abs(b[0])<c.eps?(f=Math.min(Math.abs(this.position),1-c.eps),f/=1-f,this.position<0&&(f=-f),g=[a[0]+f*b[0],a[1]+f*b[1],a[2]+f*b[2]]):Math.abs(a[0])<c.eps?(f=Math.max(this.position,c.eps),f=Math.min(f,2-c.eps),f=f>1?(f-1)/(f-2):(1-f)/f,g=[b[0]+f*a[0],b[1]+f*a[1],b[2]+f*a[2]]):(f=this.position,g=[a[0]+f*(b[0]-a[0]),a[1]+f*(b[1]-a[1]),a[2]+f*(b[2]-a[2])])):n.type===h.OBJECT_TYPE_TURTLE?(this.coords.setCoordinates(h.COORDS_BY_USER,[n.Z(this.position),n.X(this.position),n.Y(this.position)]),this.updateConstraint(),g=d.projectPointToTurtle(this,n,this.board).usrCoords):n.elementClass===h.OBJECT_CLASS_CURVE?(this.coords.setCoordinates(h.COORDS_BY_USER,[n.Z(this.position),n.X(this.position),n.Y(this.position)]),n.type===h.OBJECT_TYPE_ARC||n.type===h.OBJECT_TYPE_SECTOR?(i=d.rad([n.center.X()+1,n.center.Y()],n.center,n.radiuspoint),j=0,m=d.rad(n.radiuspoint,n.center,n.anglepoint),("minor"===n.visProp.selection&&m>Math.PI||"major"===n.visProp.selection&&m<Math.PI)&&(j=m,m=2*Math.PI),o=m-j,k.evaluate(this.visProp.isgeonext)&&(o=1),l=this.position*o,(l<j||l>m)&&(l=m,(l<j&&l>.5*j||l>m&&l>.5*m+Math.PI)&&(l=j),this.position=l,Math.abs(o)>c.eps&&(this.position/=o)),e=n.Radius(),g=[n.center.X()+e*Math.cos(this.position*o+i),n.center.Y()+e*Math.sin(this.position*o+i)]):(this.updateConstraint(),g=d.projectPointToCurve(this,n,this.board).usrCoords)):k.isPoint(n)&&(g=d.projectPointToPoint(this,n,this.board).usrCoords),void this.coords.setCoordinates(h.COORDS_BY_USER,g,!1)):void(this.needsUpdateFromParent=!0)},updateRendererGeneric:function(a){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]),this.isReal=Math.abs(this.coords.usrCoords[0])>c.eps&&this.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer[a](this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},X:function(){return this.coords.usrCoords[1]},Y:function(){return this.coords.usrCoords[2]},Z:function(){return this.coords.usrCoords[0]},XEval:function(){return this.coords.usrCoords[1]},YEval:function(){return this.coords.usrCoords[2]},ZEval:function(){return this.coords.usrCoords[0]},Dist:function(a){return this.isReal&&a.isReal?this.coords.distance(h.COORDS_BY_USER,a.coords):NaN},snapToGrid:function(a){return this.handleSnapToGrid(a)},handleSnapToPoints:function(a){var b,c,e,f,g,i,j,l,m=0,n=1/0,o=null,p=k.evaluate(this.visProp.ignoredsnaptopoints),q=!1;if(f=this.board.objectsList.length,p&&(j=p.length),k.evaluate(this.visProp.snaptopoints)||a){for(g=k.evaluate(this.visProp.attractorunit),i=k.evaluate(this.visProp.attractordistance),b=0;b<f;b++){if(c=this.board.objectsList[b],p){for(q=!1,l=0;l<j;l++)if(c==this.board.select(p[l])){q=!0;break}if(q)continue}k.isPoint(c)&&c!==this&&c.visPropCalc.visible&&(e=d.projectPointToPoint(this,c,this.board),m="screen"===g?e.distance(h.COORDS_BY_SCREEN,this.coords):e.distance(h.COORDS_BY_USER,this.coords),m<i&&m<n&&(n=m,o=e))}null!==o&&this.coords.setCoordinates(h.COORDS_BY_USER,o.usrCoords)}return this},snapToPoints:function(a){return this.handleSnapToPoints(a)},handleAttractors:function(){var a,b,c,e,f=0,i=k.evaluate(this.visProp.attractorunit),j=k.evaluate(this.visProp.attractordistance),l=k.evaluate(this.visProp.snatchdistance),m=k.evaluate(this.visProp.attractors),n=m.length;if(0!==j){for(a=0;a<n;a++)if(b=this.board.select(m[a]),k.exists(b)&&b!==this){if(k.isPoint(b)?c=d.projectPointToPoint(this,b,this.board):b.elementClass===h.OBJECT_CLASS_LINE?(e=d.projectCoordsToSegment(this.coords.usrCoords,b.point1.coords.usrCoords,b.point2.coords.usrCoords),c=!k.evaluate(b.visProp.straightfirst)&&e[1]<0?b.point1.coords:!k.evaluate(b.visProp.straightlast)&&e[1]>1?b.point2.coords:new g(h.COORDS_BY_USER,e[0],this.board)):b.elementClass===h.OBJECT_CLASS_CIRCLE?c=d.projectPointToCircle(this,b,this.board):b.elementClass===h.OBJECT_CLASS_CURVE?c=d.projectPointToCurve(this,b,this.board):b.type===h.OBJECT_TYPE_TURTLE&&(c=d.projectPointToTurtle(this,b,this.board)),f="screen"===i?c.distance(h.COORDS_BY_SCREEN,this.coords):c.distance(h.COORDS_BY_USER,this.coords),f<j){this.type===h.OBJECT_TYPE_GLIDER&&this.slideObject===b||this.makeGlider(b);break}b===this.slideObject&&f>=l&&this.popSlideObject()}return this}},setPositionDirectly:function(a,b){var d,e,i,j,l=this.coords;if(this.relativeCoords)return e=new g(a,b,this.board),k.evaluate(this.visProp.islabel)?(i=f.subtract(e.scrCoords,l.scrCoords),this.relativeCoords.scrCoords[1]+=i[1],this.relativeCoords.scrCoords[2]+=i[2]):(i=f.subtract(e.usrCoords,l.usrCoords),this.relativeCoords.usrCoords[1]+=i[1],this.relativeCoords.usrCoords[2]+=i[2]),this;for(this.coords.setCoordinates(a,b),this.handleSnapToGrid(),this.handleSnapToPoints(),this.handleAttractors(),d=this.transformations.length-1;d>=0;d--)a===h.COORDS_BY_SCREEN?j=new g(a,b,this.board).usrCoords:(2===b.length&&(b=[1].concat(b)),j=b),this.initialCoords.setCoordinates(h.COORDS_BY_USER,c.matVecMult(c.inverse(this.transformations[d].matrix),j));return this.prepareUpdate().update(),this.board.isSuspendedUpdate&&this.type===h.OBJECT_TYPE_GLIDER&&this.updateGlider(),this},setPositionByTransform:function(a,b){var c;return b=new g(a,b,this.board),c=this.board.create("transform",b.usrCoords.slice(1),{type:"translate"}),this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(c):this.addTransform(this,c),this.prepareUpdate().update(),this},setPosition:function(a,b){return this.setPositionDirectly(a,b)},setGliderPosition:function(a){return this.type===h.OBJECT_TYPE_GLIDER&&(this.position=a,this.board.update()),this},makeGlider:function(b){var c,d,e,f=this.board.select(b),g=!1;if(f.type===h.OBJECT_TYPE_POLYGON){for(c=Number.MAX_VALUE,d=0;d<f.borders.length;d++)e=a.Math.Geometry.distPointLine(this.coords.usrCoords,f.borders[d].stdform),e<c&&(c=e,b=f.borders[d]);f=this.board.select(b),g=!0}if(!k.exists(f))throw new Error("JSXGraph: slide object undefined.");if(f.type===h.OBJECT_TYPE_TICKS)throw new Error("JSXGraph: gliders on ticks are not possible.");return this.slideObject=this.board.select(b),this.slideObjects.push(this.slideObject),this.addParents(b),this.type=h.OBJECT_TYPE_GLIDER,this.elType="glider",this.visProp.snapwidth=-1,this.slideObject.addChild(this),this.isDraggable=!0,this.onPolygon=g,this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)},this.updateGlider(),this.needsUpdateFromParent=!0,this.updateGliderFromParent(),this},popSlideObject:function(){this.slideObjects.length>0&&(this.slideObjects.pop(),this.slideObject.removeChild(this),0===this.slideObjects.length?(this.type=this._org_type,this.type===h.OBJECT_TYPE_POINT?this.elType="point":this.elementClass===h.OBJECT_CLASS_TEXT?this.elType="text":this.type===h.OBJECT_TYPE_IMAGE&&(this.elType="image"),this.slideObject=null):this.slideObject=this.slideObjects[this.slideObjects.length-1])},free:function(){var a,b;if(this.type!==h.OBJECT_TYPE_GLIDER){if(this.transformations.length=0,this.isDraggable)return;this.isDraggable=!0,this.elementClass===h.OBJECT_CLASS_POINT&&(this.type=h.OBJECT_TYPE_POINT,this.elType="point"),this.XEval=function(){return this.coords.usrCoords[1]},this.YEval=function(){return this.coords.usrCoords[2]},this.ZEval=function(){return this.coords.usrCoords[0]},this.Xjc=null,this.Yjc=null}for(a in this.board.objects)this.board.objects.hasOwnProperty(a)&&(b=this.board.objects[a],b.descendants&&(delete b.descendants[this.id],delete b.childElements[this.id],this.hasLabel&&(delete b.descendants[this.label.id],delete b.childElements[this.label.id])));this.ancestors={},this.slideObject=null,this.slideObjects=[],this.elementClass===h.OBJECT_CLASS_POINT?(this.type=h.OBJECT_TYPE_POINT,this.elType="point"):this.elementClass===h.OBJECT_CLASS_TEXT?(this.type=this._org_type,
this.elType="text"):this.elementClass===h.OBJECT_CLASS_OTHER&&(this.type=this._org_type,this.elType="image")},addConstraint:function(a){var b,c,d=[],e=["X","Y"],f=function(a){return function(){return a}},g=function(a){return function(){return a.Value()}};for(this.elementClass===h.OBJECT_CLASS_POINT&&(this.type=h.OBJECT_TYPE_CAS),this.isDraggable=!1,b=0;b<a.length;b++)c=a[b],k.isString(c)?(d[b]=this.board.jc.snippet(c,!0,null,!0),2===a.length&&(this[e[b]+"jc"]=a[b])):k.isFunction(c)?d[b]=c:k.isNumber(c)?d[b]=f(c):k.isObject(c)&&k.isFunction(c.Value)&&(d[b]=g(c)),d[b].origin=c;return 1===a.length?this.updateConstraint=function(){var a=d[0]();k.isArray(a)?this.coords.setCoordinates(h.COORDS_BY_USER,a):this.coords=a}:2===a.length?(this.XEval=d[0],this.YEval=d[1],this.setParents([d[0].origin,d[1].origin]),this.updateConstraint=function(){this.coords.setCoordinates(h.COORDS_BY_USER,[this.XEval(),this.YEval()])}):(this.ZEval=d[0],this.XEval=d[1],this.YEval=d[2],this.setParents([d[0].origin,d[1].origin,d[2].origin]),this.updateConstraint=function(){this.coords.setCoordinates(h.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])}),this.prepareUpdate().update(),this.board.isSuspendedUpdate||this.updateVisibility().updateRenderer(),this},addAnchor:function(a,b){b?this.relativeCoords=new g(h.COORDS_BY_SCREEN,a.slice(0,2),this.board):this.relativeCoords=new g(h.COORDS_BY_USER,a,this.board),this.element.addChild(this),b&&this.addParents(this.element),this.XEval=function(){var a,b,c,d=k.evaluate(this.visProp.offset);return k.evaluate(this.visProp.islabel)?(a=parseFloat(d[0]),c=this.element.getLabelAnchor(),b=new g(h.COORDS_BY_SCREEN,[a+this.relativeCoords.scrCoords[1]+c.scrCoords[1],0],this.board),b.usrCoords[1]):(c=this.element.getTextAnchor(),this.relativeCoords.usrCoords[1]+c.usrCoords[1])},this.YEval=function(){var a,b,c,d=k.evaluate(this.visProp.offset);return k.evaluate(this.visProp.islabel)?(a=-parseFloat(d[1]),c=this.element.getLabelAnchor(),b=new g(h.COORDS_BY_SCREEN,[0,a+this.relativeCoords.scrCoords[2]+c.scrCoords[2]],this.board),b.usrCoords[2]):(c=this.element.getTextAnchor(),this.relativeCoords.usrCoords[2]+c.usrCoords[2])},this.ZEval=k.createFunction(1,this.board,""),this.updateConstraint=function(){this.coords.setCoordinates(h.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])},this.coords=new g(h.COORDS_BY_SCREEN,[0,0],this.board)},updateTransform:function(){var a;if(0===this.transformations.length)return this;for(a=0;a<this.transformations.length;a++)this.transformations[a].update();return this},addTransform:function(a,b){var c,d=k.isArray(b)?b:[b],e=d.length;for(0===this.transformations.length&&(this.baseElement=a),c=0;c<e;c++)this.transformations.push(d[c]);return this},startAnimation:function(a,b){var c=this;return this.type!==h.OBJECT_TYPE_GLIDER||k.exists(this.intervalCode)||(this.intervalCode=window.setInterval(function(){c._anim(a,b)},250),k.exists(this.intervalCount)||(this.intervalCount=0)),this},stopAnimation:function(){return k.exists(this.intervalCode)&&(window.clearInterval(this.intervalCode),delete this.intervalCode),this},moveAlong:function(a,b,c){c=c||{};var d,f,g,i,j,l=[],m=[],n=this.board.attr.animationdelay,o=b/n,p=function(b,c){return function(){return a[b][c]}};if(k.isArray(a)){for(g=a.length,d=0;d<g;d++)k.isPoint(a[d])?m[d]=a[d]:m[d]={elementClass:h.OBJECT_CLASS_POINT,X:p(d,0),Y:p(d,1)};if(b=b||0,0===b)return this.setPosition(h.COORDS_BY_USER,[m[m.length-1].X(),m[m.length-1].Y()]),this.board.update(this);if(!k.exists(c.interpolate)||c.interpolate)for(f=e.Neville(m),d=0;d<o;d++)l[d]=[],l[d][0]=f[0]((o-d)/o*f[3]()),l[d][1]=f[1]((o-d)/o*f[3]());else{for(g=a.length-1,d=0;d<o;++d)i=Math.floor(d/o*g),j=d/o*g-i,l[d]=[],l[d][0]=(1-j)*m[i].X()+j*m[i+1].X(),l[d][1]=(1-j)*m[i].Y()+j*m[i+1].Y();l.push([m[g].X(),m[g].Y()]),l.reverse()}this.animationPath=l}else k.isFunction(a)&&(this.animationPath=a,this.animationStart=(new Date).getTime());return this.animationCallback=c.callback,this.board.addAnimation(this),this},moveTo:function(a,b,d){d=d||{},a=new g(h.COORDS_BY_USER,a,this.board);var e,f=this.board.attr.animationdelay,i=Math.ceil(b/f),j=[],l=this.coords.usrCoords[1],m=this.coords.usrCoords[2],n=a.usrCoords[1]-l,o=a.usrCoords[2]-m,p=function(a){return d.effect&&"<>"===d.effect?Math.pow(Math.sin(a/i*Math.PI/2),2):a/i};if(!k.exists(b)||0===b||Math.abs(a.usrCoords[0]-this.coords.usrCoords[0])>c.eps)return this.setPosition(h.COORDS_BY_USER,a.usrCoords),this.board.update(this);if(!k.exists(d.callback)&&Math.abs(n)<c.eps&&Math.abs(o)<c.eps)return this;for(e=i;e>=0;e--)j[i-e]=[a.usrCoords[0],l+n*p(e),m+o*p(e)];return this.animationPath=j,this.animationCallback=d.callback,this.board.addAnimation(this),this},visit:function(a,b,c){a=new g(h.COORDS_BY_USER,a,this.board);var d,e,f,i=this.board.attr.animationdelay,j=[],l=this.coords.usrCoords[1],m=this.coords.usrCoords[2],n=a.usrCoords[1]-l,o=a.usrCoords[2]-m,p=function(a){var b=a<f/2?2*a/f:2*(f-a)/f;return c.effect&&"<>"===c.effect?Math.pow(Math.sin(b*Math.PI/2),2):b};for(k.isNumber(c)?c={repeat:c}:(c=c||{},k.exists(c.repeat)||(c.repeat=1)),f=Math.ceil(b/(i*c.repeat)),e=0;e<c.repeat;e++)for(d=f;d>=0;d--)j[e*(f+1)+f-d]=[a.usrCoords[0],l+n*p(d),m+o*p(d)];return this.animationPath=j,this.animationCallback=c.callback,this.board.addAnimation(this),this},_anim:function(a,b){var c,e,f,g,i,j,k,l,m=1;return this.intervalCount+=1,this.intervalCount>b&&(this.intervalCount=0),this.slideObject.elementClass===h.OBJECT_CLASS_LINE?(c=this.slideObject.point1.coords.distance(h.COORDS_BY_SCREEN,this.slideObject.point2.coords),e=this.slideObject.getSlope(),e!==1/0?(i=Math.atan(e),f=Math.round(this.intervalCount/b*c*Math.cos(i)),g=Math.round(this.intervalCount/b*c*Math.sin(i))):(f=0,g=Math.round(this.intervalCount/b*c)),a<0?(j=this.slideObject.point2,this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]>0?m=-1:this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]===0&&this.slideObject.point2.coords.scrCoords[2]-this.slideObject.point1.coords.scrCoords[2]>0&&(m=-1)):(j=this.slideObject.point1,this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]>0?m=-1:this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]===0&&this.slideObject.point1.coords.scrCoords[2]-this.slideObject.point2.coords.scrCoords[2]>0&&(m=-1)),this.coords.setCoordinates(h.COORDS_BY_SCREEN,[j.coords.scrCoords[1]+m*f,j.coords.scrCoords[2]+m*g])):this.slideObject.elementClass===h.OBJECT_CLASS_CURVE?(k=a>0?Math.round(this.intervalCount/b*this.board.canvasWidth):Math.round((b-this.intervalCount)/b*this.board.canvasWidth),this.coords.setCoordinates(h.COORDS_BY_SCREEN,[k,0]),this.coords=d.projectPointToCurve(this,this.slideObject,this.board)):this.slideObject.elementClass===h.OBJECT_CLASS_CIRCLE&&(i=a<0?this.intervalCount/b*2*Math.PI:(b-this.intervalCount)/b*2*Math.PI,l=this.slideObject.Radius(),this.coords.setCoordinates(h.COORDS_BY_USER,[this.slideObject.center.coords.usrCoords[1]+l*Math.cos(i),this.slideObject.center.coords.usrCoords[2]+l*Math.sin(i)])),this.board.update(this),this},getTextAnchor:function(){return this.coords},getLabelAnchor:function(){return this.coords},getParents:function(){var a=[this.Z(),this.X(),this.Y()];return 0!==this.parents.length&&(a=this.parents),this.type===h.OBJECT_TYPE_GLIDER&&(a=[this.X(),this.Y(),this.slideObject.id]),a}}),a.CoordsElement.create=function(a,b,c,d,e,f){var g,h,i=!1;for(h=0;h<c.length;h++)(k.isFunction(c[h])||k.isString(c[h]))&&(i=!0);if(i)g=new a(b,[0,0],d,e,f),g.addConstraint(c);else if(k.isNumber(c[0])&&k.isNumber(c[1]))g=new a(b,c,d,e,f),k.exists(d.slideobject)?g.makeGlider(d.slideobject):g.baseElement=g,g.isDraggable=!0;else{if(!k.isObject(c[0])||!k.isTransformationOrArray(c[1]))return!1;g=new a(b,[0,0],d,e,f),g.addTransform(c[0],c[1]),g.isDraggable=!1}return g.handleSnapToGrid(),g.handleSnapToPoints(),g.handleAttractors(),g.addParents(c),g},a.CoordsElement}),define("base/text",["jxg","base/constants","base/coords","base/element","parser/geonext","math/statistics","utils/env","utils/type","math/math","base/coordselement"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k={HTMLSliderInputEventHandler:function(){this._val=parseFloat(this.rendNodeRange.value),this.rendNodeOut.value=this.rendNodeRange.value,this.board.update()}};return a.Text=function(a,c,d,e){this.constructor(a,d,b.OBJECT_TYPE_TEXT,b.OBJECT_CLASS_TEXT),this.element=this.board.select(d.anchor),this.coordsConstructor(c,h.evaluate(this.visProp.islabel)),this.content="",this.plaintext="",this.plaintextOld=null,this.orgText="",this.needsSizeUpdate=!1,this.hiddenByParent=!1,this.size=[1,1],this.id=this.board.setId(this,"T"),this._setUpdateText(e),this.updateText(),this.board.renderer.drawText(this),this.board.finalizeAdding(this),h.isString(this.content)&&this.notifyParents(this.content),this.elType="text",this.methodMap=h.deepCopy(this.methodMap,{setText:"setTextJessieCode",move:"setCoords"})},a.Text.prototype=new d,h.copyPrototypeMethods(a.Text,j,"coordsConstructor"),a.extend(a.Text.prototype,{hasPoint:function(a,b){var c,d,e,f,g,j,k=this.board.options.precision.hasPoint;return this.transformations.length>0&&(c=i.matVecMult(i.inverse(this.board.renderer.joinTransforms(this,this.transformations)),[1,a,b]),a=c[1],b=c[2]),g=this.getAnchorX(),c="right"===g?this.coords.scrCoords[1]-this.size[0]:"middle"===g?this.coords.scrCoords[1]-.5*this.size[0]:this.coords.scrCoords[1],d=c+this.size[0],j=this.getAnchorY(),f="top"===j?this.coords.scrCoords[2]+this.size[1]:"middle"===j?this.coords.scrCoords[2]+.5*this.size[1]:this.coords.scrCoords[2],e=f-this.size[1],"all"===h.evaluate(this.visProp.dragarea)?a>=c-k&&a<d+k&&b>=e-k&&b<=f+k:b>=e-k&&b<=f+k&&(a>=c-k&&a<=c+2*k||a>=d-2*k&&a<=d+k)},_setUpdateText:function(a){var b,c,d=h.evaluate(this.visProp.parse),e=h.evaluate(this.visProp.usemathjax);this.orgText=a,h.isFunction(a)?this.updateText=function(){c=a().toString(),d&&!e?this.plaintext=this.replaceSub(this.replaceSup(this.convertGeonext2CSS(c))):this.plaintext=c}:h.isString(a)&&!d?this.updateText=function(){this.plaintext=a}:(h.isNumber(a)?this.content=h.toFixed(a,h.evaluate(this.visProp.digits)):h.evaluate(this.visProp.useasciimathml)?this.content="'`"+a+"`'":e?this.content="'"+a+"'":this.content=this.generateTerm(a,!0,!0),b=this.board.jc.snippet(this.content,!0,"",!1),this.updateText=function(){this.plaintext=b()})},_setText:function(a){return this._setUpdateText(a),this.updateText(),this.fullUpdate(),this.board.infobox&&this.id===this.board.infobox.id||this.updateSize(),this},setTextJessieCode:function(a){var b;return this.visProp.castext=a,b=h.isFunction(a)?function(){return h.sanitizeHTML(a())}:h.isNumber(a)?a:h.sanitizeHTML(a),this._setText(b)},setText:function(a){return this._setText(a)},updateSize:function(){var a,b,c,d,e=h.evaluate(this.visProp.display);if(!g.isBrowser||"no"===this.board.renderer.type)return this;if(d=this.rendNode,"html"===e||"vml"===this.board.renderer.type)h.exists(d.offsetWidth)?(b=[d.offsetWidth,d.offsetHeight],0===b[0]&&0===b[1]?(c=this,window.setTimeout(function(){c.size=[d.offsetWidth,d.offsetHeight],c.needsUpdate=!0,c.updateRenderer()},0)):this.size=b):this.size=this.crudeSizeEstimate();else if("internal"===e)if("svg"===this.board.renderer.type)try{a=d.getBBox(),this.size=[a.width,a.height]}catch(f){}else"canvas"===this.board.renderer.type&&(this.size=this.crudeSizeEstimate());return this},crudeSizeEstimate:function(){var a=parseFloat(h.evaluate(this.visProp.fontsize));return[a*this.plaintext.length*.45,.9*a]},utf8_decode:function(a){return a.replace(/&#x(\w+);/g,function(a,b){return String.fromCharCode(parseInt(b,16))})},replaceSub:function(a){if(!a.indexOf)return a;for(var b,c=a.indexOf("_{");c>=0;)a=a.substr(0,c)+a.substr(c).replace(/_\{/,"<sub>"),b=a.substr(c).indexOf("}"),b>=0&&(a=a.substr(0,b)+a.substr(b).replace(/\}/,"</sub>")),c=a.indexOf("_{");for(c=a.indexOf("_");c>=0;)a=a.substr(0,c)+a.substr(c).replace(/_(.?)/,"<sub>$1</sub>"),c=a.indexOf("_");return a},replaceSup:function(a){if(!a.indexOf)return a;for(var b,c=a.indexOf("^{");c>=0;)a=a.substr(0,c)+a.substr(c).replace(/\^\{/,"<sup>"),b=a.substr(c).indexOf("}"),b>=0&&(a=a.substr(0,b)+a.substr(b).replace(/\}/,"</sup>")),c=a.indexOf("^{");for(c=a.indexOf("^");c>=0;)a=a.substr(0,c)+a.substr(c).replace(/\^(.?)/,"<sup>$1</sup>"),c=a.indexOf("^");return a},getSize:function(){return this.size},setCoords:function(a,c){var d,e,f;return h.isArray(a)&&a.length>1&&(c=a[1],a=a[0]),h.evaluate(this.visProp.islabel)&&h.exists(this.element)?(d=this.element.getLabelAnchor(),e=(a-d.usrCoords[1])*this.board.unitX,f=-(c-d.usrCoords[2])*this.board.unitY,this.relativeCoords.setCoordinates(b.COORDS_BY_SCREEN,[e,f])):this.coords.setCoordinates(b.COORDS_BY_USER,[a,c]),this.fullUpdate(),this},update:function(a){return this.needsUpdate?(this.updateCoords(a),this.updateText(),"internal"===h.evaluate(this.visProp.display)&&h.isString(this.plaintext)&&(this.plaintext=this.utf8_decode(this.plaintext)),this.checkForSizeUpdate(),this.needsSizeUpdate&&this.updateSize(),this):this},checkForSizeUpdate:function(){this.board.infobox&&this.id===this.board.infobox.id?this.needsSizeUpdate=!1:(this.needsSizeUpdate=this.plaintextOld!==this.plaintext,this.needsSizeUpdate&&(this.plaintextOld=this.plaintext))},updateRenderer:function(){return this.updateRendererGeneric("updateText")},expandShortMath:function(a){var b=/([\)0-9\.])\s*([\(a-zA-Z_])/g;return a.replace(b,"$1*$2")},generateTerm:function(a,b,c){var d,f,g,i,j='""';if(a=a||"",a=a.replace(/\r/g,""),a=a.replace(/\n/g,""),a=a.replace(/"/g,"'"),a=a.replace(/'/g,"\\'"),a=a.replace(/&amp;arc;/g,"&ang;"),a=a.replace(/<arc\s*\/>/g,"&ang;"),a=a.replace(/&lt;arc\s*\/&gt;/g,"&ang;"),a=a.replace(/&lt;sqrt\s*\/&gt;/g,"&radic;"),a=a.replace(/&lt;value&gt;/g,"<value>"),a=a.replace(/&lt;\/value&gt;/g,"</value>"),g=a.indexOf("<value>"),i=a.indexOf("</value>"),g>=0)for(;g>=0;)j+=' + "'+this.replaceSub(this.replaceSup(a.slice(0,g)))+'"',f=a.slice(g+7,i),f=f.replace(/\s+/g,""),b===!0&&(f=this.expandShortMath(f)),d=c?f:e.geonext2JS(f,this.board),d=d.replace(/\\"/g,"'"),d=d.replace(/\\'/g,"'"),j+=d.indexOf("toFixed")<0&&h.isNumber(h.bind(this.board.jc.snippet(d,!0,"",!1),this)())?"+("+d+").toFixed("+h.evaluate(this.visProp.digits)+")":"+("+d+")",a=a.slice(i+8),g=a.indexOf("<value>"),i=a.indexOf("</value>");return j+=' + "'+this.replaceSub(this.replaceSup(a))+'"',j=this.convertGeonext2CSS(j),j=j.replace(/&amp;/g,"&"),j=j.replace(/"/g,"'")},convertGeonext2CSS:function(a){return h.isString(a)&&(a=a.replace(/<overline>/g,"<span style=text-decoration:overline>"),a=a.replace(/&lt;overline&gt;/g,"<span style=text-decoration:overline>"),a=a.replace(/<\/overline>/g,"</span>"),a=a.replace(/&lt;\/overline&gt;/g,"</span>"),a=a.replace(/<arrow>/g,"<span style=text-decoration:overline>"),a=a.replace(/&lt;arrow&gt;/g,"<span style=text-decoration:overline>"),a=a.replace(/<\/arrow>/g,"</span>"),a=a.replace(/&lt;\/arrow&gt;/g,"</span>")),a},notifyParents:function(a){var b,c=null;a=a.replace(/&lt;value&gt;/g,"<value>"),a=a.replace(/&lt;\/value&gt;/g,"</value>");do b=/<value>([\w\s\*\/\^\-\+\(\)\[\],<>=!]+)<\/value>/,c=b.exec(a),null!==c&&(e.findDependencies(this,c[1],this.board),a=a.substr(c.index),a=a.replace(b,""));while(null!==c);return this},getParents:function(){var a;return a=void 0!==this.relativeCoords?[this.relativeCoords.usrCoords[1],this.relativeCoords.usrCoords[2],this.orgText]:[this.Z(),this.X(),this.Y(),this.orgText],0!==this.parents.length&&(a=this.parents),a},bounds:function(){var a=this.coords.usrCoords;return h.evaluate(this.visProp.islabel)||0===this.board.unitY||0===this.board.unitX?[0,0,0,0]:[a[1],a[2]+this.size[1]/this.board.unitY,a[1]+this.size[0]/this.board.unitX,a[2]]},getAnchorX:function(){var a=h.evaluate(this.visProp.anchorx);if("auto"==a)switch(this.visProp.position){case"top":case"bot":return"middle";case"rt":case"lrt":case"urt":return"left";case"lft":case"llft":case"ulft":default:return"right"}return a},getAnchorY:function(){var a=h.evaluate(this.visProp.anchory);if("auto"==a)switch(this.visProp.position){case"top":case"ulft":case"urt":return"bottom";case"bot":case"lrt":case"llft":return"top";case"rt":case"lft":default:return"middle"}return a}}),a.createText=function(b,c,d){var e,f=h.copyAttributes(d,b.options,"text"),g=c.slice(0,-1),i=c[c.length-1];if(f.anchor=f.parent||f.anchor,e=j.create(a.Text,b,g,f,i),!e)throw new Error("JSXGraph: Can't create text with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [x,y], [z,x,y], [element,transformation]");return 0!==h.evaluate(f.rotate)&&"internal"===f.display&&e.addRotation(h.evaluate(f.rotate)),e},a.registerElement("text",a.createText),a.createHTMLSlider=function(b,c,d){var e,f,i=h.copyAttributes(d,b.options,"htmlslider");if(2!==c.length||2!==c[0].length||3!==c[1].length)throw new Error("JSXGraph: Can't create htmlslider with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parents are: [[x,y], [min, start, max]]");i.anchor=i.parent||i.anchor,i.fixed=i.fixed||!0,f=[c[0][0],c[0][1],'<form style="display:inline"><input type="range" /><span></span><input type="text" /></form>'],e=a.createText(b,f,i),e.type=h.OBJECT_TYPE_HTMLSLIDER,e.rendNodeForm=e.rendNode.childNodes[0],e.rendNodeRange=e.rendNodeForm.childNodes[0],e.rendNodeRange.min=c[1][0],e.rendNodeRange.max=c[1][2],e.rendNodeRange.step=i.step,e.rendNodeRange.value=c[1][1],e.rendNodeLabel=e.rendNodeForm.childNodes[1],e.rendNodeLabel.id=e.rendNode.id+"_label",i.withlabel&&(e.rendNodeLabel.innerHTML=e.name+"="),e.rendNodeOut=e.rendNodeForm.childNodes[2],e.rendNodeOut.value=c[1][1];try{e.rendNodeForm.id=e.rendNode.id+"_form",e.rendNodeRange.id=e.rendNode.id+"_range",e.rendNodeOut.id=e.rendNode.id+"_out"}catch(j){a.debug(j)}return e.rendNodeRange.style.width=i.widthrange+"px",e.rendNodeRange.style.verticalAlign="middle",e.rendNodeOut.style.width=i.widthout+"px",e._val=c[1][1],a.supportsVML()?g.addEvent(e.rendNodeForm,"change",k.HTMLSliderInputEventHandler,e):g.addEvent(e.rendNodeForm,"input",k.HTMLSliderInputEventHandler,e),e.Value=function(){return this._val},e},a.registerElement("htmlslider",a.createHTMLSlider),{Text:a.Text,createText:a.createText,createHTMLSlider:a.createHTMLSlider}}),define("utils/uuid",["jxg"],function(a){"use strict";var b="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",c=b.split("");return a.Util=a.Util||{},a.Util.genUUID=function(){var a,b,d=[],e=0;for(b=0;b<36;b++)8===b||13===b||18===b||23===b?d[b]="-":14===b?d[b]="4":(e<=2&&(e=33554432+16777216*Math.random()|0),a=15&e,e>>=4,d[b]=c[19===b?3&a|8:a]);return d.join("")},a.Util}),define("parser/jessiecode",["jxg","base/constants","base/text","math/math","math/geometry","math/statistics","utils/type","utils/uuid","utils/env"],function(JXG,Const,Text,Mat,Geometry,Statistics,Type,UUID,Env){Object.create||(Object.create=function(a,b){function c(){}if("object"!=typeof a&&"function"!=typeof a)throw new TypeError("Object prototype may only be an Object: "+a);if(null===a)throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");if("undefined"!=typeof b)throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");return c.prototype=a,new c});var priv={modules:{math:Mat,"math/geometry":Geometry,"math/statistics":Statistics,"math/numerics":Mat.Numerics}};JXG.JessieCode=function(a,b){this.scope={id:0,hasChild:!0,args:[],locals:{},context:null,previous:null},this.scopes=[],this.scopes.push(this.scope),this.dpstack=[[]],this.pscope=0,this.propstack=[{}],this.propscope=0,this.lhs=[],this.isLHS=!1,this.warnLog="jcwarn",this.$log=[],this.builtIn=this.defineBuiltIn(),this.board=null,this.lineToElement={},this.parCurLine=1,this.parCurColumn=0,this.line=1,this.col=1,JXG.CA&&(this.CA=new JXG.CA(this.node,this.createNode,this)),this.code="","string"==typeof a&&this.parse(a,b)},JXG.extend(JXG.JessieCode.prototype,{node:function(a,b,c){return{type:a,value:b,children:c}},createNode:function(a,b,c){var d,e=this.node(a,b,[]);for(d=2;d<arguments.length;d++)e.children.push(arguments[d]);return"node_const"==e.type&&Type.isNumber(e.value)&&(e.isMath=!0),e.line=this.parCurLine,e.col=this.parCurColumn,e},pushScope:function(a){var b={args:a,locals:{},context:null,previous:this.scope};return this.scope.hasChild=!0,this.scope=b,b.id=this.scopes.push(b)-1,b},popScope:function(){var a=this.scope.previous;return this.scope=null!==a?a:this.scope,this.scope},getElementById:function(a){return this.board.objects[a]},log:function(){this.$log.push(arguments),"object"==typeof console&&console.log&&console.log.apply(console,arguments)},creator:function(){var a,b={};return a=function(a){var c;return"function"==typeof b[this.board.id+a]?c=b[this.board.id+a]:(c=function(b){return function(c,d){var e;return e=Type.exists(d)?d:{name:0!==b.lhs[b.scope]?b.lhs[b.scope]:""},b.board.create(a,c,e)}}(this),c.creator=!0,b[this.board.id+a]=c),c},a.clearCache=function(){b={}},a}(),letvar:function(a,b){this.builtIn[a]&&this._warn('"'+a+'" is a predefined value.'),this.scope.locals[a]=b},isLocalVariable:function(a){for(var b=this.scope;null!==b;){if(Type.exists(b.locals[a]))return b;b=b.previous}return null},isParameter:function(a){for(var b=this.scope;null!==b;){if(Type.indexOf(b.args,a)>-1)return b;b=b.previous}return null},isCreator:function(a){return!!JXG.elements[a]},isMathMethod:function(a){return"E"!==a&&!!Math[a]},isBuiltIn:function(a){return!!this.builtIn[a]},getvar:function(a,b){var c;return b=Type.def(b,!1),c=this.isLocalVariable(a),null!==c?c.locals[a]:this.isCreator(a)?this.creator(a):this.isBuiltIn(a)?this.builtIn[a]:this.isMathMethod(a)?Math[a]:b||(c=this.board.select(a),c===a)?void 0:c},resolve:function(a){for(var b=this.scope;null!==b;){if(Type.exists(b.locals[a]))return b.locals[a];b=b.previous}},getvarJS:function(a,b,c){var d,e="";return b=Type.def(b,!1),c=Type.def(c,!1),d=this.isParameter(a),null!==d?a:(d=this.isLocalVariable(a),null===d||c?this.isCreator(a)?"(function () { var a = Array.prototype.slice.call(arguments, 0), props = "+(c?"a.pop()":"{}")+"; return $jc$.board.create.apply($jc$.board, ['"+a+"'].concat([a, props])); })":(c&&this._error("Syntax error (attribute values are allowed with element creators only)"),this.isBuiltIn(a)?this.builtIn[a].src||this.builtIn[a]:this.isMathMethod(a)?"Math."+a:b?"":(Type.isId(this.board,a)?e="$jc$.board.objects['"+a+"']":Type.isName(this.board,a)?e="$jc$.board.elementsByName['"+a+"']":Type.isGroup(this.board,a)&&(e="$jc$.board.groups['"+a+"']"),e)):"$jc$.resolve('"+a+"')")},makeMap:function(a){return a.isMap=!0,a},functionCodeJS:function(a){var b=a.children[0].join(", "),c="",d="";return"op_map"===a.value&&(c="{ return  ",d=" }"),"function ("+b+") {\nvar $oldscope$ = $jc$.scope;\n$jc$.scope = $jc$.scopes["+this.scope.id+"];\nvar r = (function () "+c+this.compile(a.children[1],!0)+d+")();\n$jc$.scope = $oldscope$;\nreturn r;\n}"},defineFunction:function(node){var fun,i,list=node.children[0],scope=this.pushScope(list);if(this.board.options.jc.compile){for(this.isLHS=!1,i=0;i<list.length;i++)scope.locals[list[i]]=list[i];this.replaceNames(node.children[1]),fun=function($jc$){var fun,str="var f = "+$jc$.functionCodeJS(node)+"; f;";try{return fun=eval(str)}catch(e){return $jc$._warn("error compiling function\n\n"+str+"\n\n"+e.toString()),function(){}}}(this),this.popScope()}else fun=function(a,b,c){return function(){var d,e;for(e=b.scope,b.scope=b.scopes[c],d=0;d<a.length;d++)b.scope.locals[a[d]]=arguments[d];return d=b.execute(node.children[1]),b.scope=e,d}}(list,this,scope.id);return fun.node=node,fun.scope=scope,fun.toJS=fun.toString,fun.toString=function(a){return function(){return a.compile(a.replaceIDs(Type.deepCopy(node)))}}(this),fun.deps={},this.collectDependencies(node.children[1],fun.deps),fun},mergeAttributes:function(a){var b,c={};for(b=0;b<arguments.length;b++)c=Type.deepCopy(c,arguments[b],!0);return c},setProp:function(a,b,c){var d,e,f={};a.elementClass!==Const.OBJECT_CLASS_POINT||"X"!==b&&"Y"!==b?a.elementClass!==Const.OBJECT_CLASS_TEXT||"X"!==b&&"Y"!==b?a.type&&a.elementClass&&a.visProp?Type.exists(a[a.methodMap[b]])&&"function"!=typeof a[a.methodMap[b]]?a[a.methodMap[b]]=c:(f[b]=c,a.setAttribute(f)):a[b]=c:("number"==typeof c?a[b]=function(){return c}:"function"==typeof c?(a.isDraggable=!1,a[b]=c):"string"==typeof c&&(a.isDraggable=!1,a[b]=Type.createFunction(c,this.board,null,!0),a[b+"jc"]=c),a[b].origin=c,this.board.update()):(b=b.toLowerCase(),a.isDraggable&&"number"==typeof c?(d="x"===b?c:a.X(),e="y"===b?c:a.Y(),a.setPosition(Const.COORDS_BY_USER,[d,e])):!a.isDraggable||"function"!=typeof c&&"string"!=typeof c?a.isDraggable||(d="x"===b?c:a.XEval.origin,e="y"===b?c:a.YEval.origin,a.addConstraint([d,e])):(d="x"===b?c:a.coords.usrCoords[1],e="y"===b?c:a.coords.usrCoords[2],a.addConstraint([d,e])),this.board.update())},_genericParse:function(a,b,c,d){var e,f,g,h,i=a.replace(/\r\n/g,"\n").split("\n"),j=[];d||(this.code+=a+"\n"),Text&&(f=Text.Text.prototype.setText,Text.Text.prototype.setText=Text.Text.prototype.setTextJessieCode);try{for(Type.exists(c)||(c=!1),e=0;e<i.length;e++)c&&(i[e]=JXG.GeonextParser.geonext2JS(i[e],this.board)),j.push(i[e]);switch(a=j.join("\n"),g=parser.parse(a),this.CA&&(g=this.CA.expandDerivatives(g,null,g),g=this.CA.removeTrivialNodes(g)),b){case"parse":h=this.execute(g);break;case"manipulate":h=this.compile(g);break;case"getAst":h=g;break;default:h=!1}}catch(k){console.log(k)}finally{Text&&(Text.Text.prototype.setText=f)}return h},parse:function(a,b,c){return this._genericParse(a,"parse",b,c)},manipulate:function(a,b,c){return this._genericParse(a,"manipulate",b,c)},getAST:function(a,b,c){return this._genericParse(a,"getAst",b,c)},snippet:function(a,b,c,d){var e;return b=Type.def(b,!0),c=Type.def(c,""),d=Type.def(d,!1),e=(b?" function ("+c+") { return ":"")+a+(b?"; }":"")+";",this.parse(e,d,!0)},replaceIDs:function(a){var b,c;if(a.replaced&&(c=this.board.objects[a.children[1][0].value],Type.exists(c)&&""!==c.name&&(a.type="node_var",a.value=c.name,a.children.length=0,delete a.replaced)),a.children)for(b=a.children.length;b>0;b--)Type.exists(a.children[b-1])&&(a.children[b-1]=this.replaceIDs(a.children[b-1]));return a},replaceNames:function(a){var b,c;if(c=a.value,"node_op"===a.type&&"op_lhs"===c&&1===a.children.length?this.isLHS=!0:"node_var"===a.type&&(this.isLHS?this.letvar(c,!0):!Type.exists(this.getvar(c,!0))&&Type.exists(this.board.elementsByName[c])&&(a=this.createReplacementNode(a))),a.children)for(b=a.children.length;b>0;b--)Type.exists(a.children[b-1])&&(a.children[b-1]=this.replaceNames(a.children[b-1]));return"node_op"===a.type&&"op_lhs"===a.value&&1===a.children.length&&(this.isLHS=!1),a},createReplacementNode:function(a){var b=a.value,c=this.board.elementsByName[b];return a=this.createNode("node_op","op_execfun",this.createNode("node_var","$"),[this.createNode("node_str",c.id)]),a.replaced=!0,a},collectDependencies:function(a,b){var c,d,e,f;if(Type.isArray(a))for(f=a.length,c=0;c<f;c++)this.collectDependencies(a[c],b);else if(d=a.value,"node_var"===a.type&&(e=this.getvar(d),e&&e.visProp&&e.type&&e.elementClass&&e.id&&(b[e.id]=e)),"node_op"===a.type&&"op_execfun"===a.value&&a.children.length>1&&"$"===a.children[0].value&&a.children[1].length>0&&(e=a.children[1][0].value,b[e]=this.board.objects[e]),a.children)for(c=a.children.length;c>0;c--)Type.exists(a.children[c-1])&&this.collectDependencies(a.children[c-1],b)},resolveProperty:function(a,b,c){return c=Type.def(c,!1),a&&a.methodMap&&(Type.exists(a.subs)&&Type.exists(a.subs[b])?a=a.subs:Type.exists(a.methodMap[b])?b=a.methodMap[b]:(a=a.visProp,b=b.toLowerCase())),Type.isFunction(a)&&this._error("Accessing function properties is not allowed."),Type.exists(a)||this._error(a+" is not an object"),Type.exists(a[b])||this._error("unknown property "+b),c&&"function"==typeof a[b]?function(){return a[b].apply(a,arguments)}:a[b]},getLHS:function(a){var b;if("node_var"===a.type)b={o:this.scope.locals,what:a.value};else if("node_op"===a.type&&"op_property"===a.value)b={o:this.execute(a.children[0]),what:a.children[1]};else{if("node_op"!==a.type||"op_extvalue"!==a.value)throw new Error("Syntax error: Invalid left-hand side of assignment.");b={o:this.execute(a.children[0]),what:this.execute(a.children[1])}}return b},getLHSCompiler:function(a,b){var c;if("node_var"===a.type)c=a.value;else if("node_op"===a.type&&"op_property"===a.value)c=[this.compile(a.children[0],b),"'"+a.children[1]+"'"];else{if("node_op"!==a.type||"op_extvalue"!==a.value)throw new Error("Syntax error: Invalid left-hand side of assignment.");c=[this.compile(a.children[0],b),"node_const"===a.children[1].type?a.children[1].value:this.compile(a.children[1],b)]}return c},execute:function(a){var b,c,d,e,f,g,h,i,j,k,l,m=[];if(b=0,!a)return b;switch(this.line=a.line,this.col=a.col,a.type){case"node_op":switch(a.value){case"op_none":a.children[0]&&this.execute(a.children[0]),a.children[1]&&(b=this.execute(a.children[1]));break;case"op_assign":c=this.getLHS(a.children[0]),this.lhs[this.scope.id]=c[1],c.o.type&&c.o.elementClass&&c.o.methodMap&&"label"===c.what&&this._error("Left-hand side of assignment is read-only."),b=this.execute(a.children[1]),c.o!==this.scope.locals||Type.isArray(c.o)&&"number"==typeof c.what?this.setProp(c.o,c.what,b):this.letvar(c.what,b),this.lhs[this.scope.id]=0;break;case"op_if":this.execute(a.children[0])&&(b=this.execute(a.children[1]));break;case"op_conditional":case"op_if_else":b=this.execute(a.children[0])?this.execute(a.children[1]):this.execute(a.children[2]);break;case"op_while":for(;this.execute(a.children[0]);)this.execute(a.children[1]);break;case"op_do":do this.execute(a.children[0]);while(this.execute(a.children[1]));break;case"op_for":for(this.execute(a.children[0]);this.execute(a.children[1]);this.execute(a.children[2]))this.execute(a.children[3]);break;case"op_proplst":a.children[0]&&this.execute(a.children[0]),a.children[1]&&this.execute(a.children[1]);break;case"op_emptyobject":b={};break;case"op_proplst_val":this.propstack.push({}),this.propscope++,this.execute(a.children[0]),b=this.propstack[this.propscope],this.propstack.pop(),this.propscope--;break;case"op_prop":this.propstack[this.propscope][a.children[0]]=this.execute(a.children[1]);break;case"op_array":for(b=[],f=a.children[0].length,d=0;d<f;d++)b.push(this.execute(a.children[0][d]));break;case"op_extvalue":b=this.execute(a.children[0]),d=this.execute(a.children[1]),b="number"==typeof d&&Math.abs(Math.round(d)-d)<Mat.eps?b[d]:g;break;case"op_return":if(0!==this.scope)return this.execute(a.children[0]);this._error("Unexpected return.");break;case"op_map":a.children[1].isMath||"node_var"===a.children[1].type||this._error("execute: In a map only function calls and mathematical expressions are allowed."),j=this.defineFunction(a),j.isMap=!0,b=j;break;case"op_function":j=this.defineFunction(a),j.isMap=!1,b=j;break;case"op_execfun":if(this.dpstack.push([]),this.pscope++,h=a.children[1],Type.exists(a.children[2]))if(a.children[3])for(i=a.children[2],k={},d=0;d<i.length;d++)k=Type.deepCopy(k,this.execute(i[d]),!0);else k=this.execute(a.children[2]);for(j=this.execute(a.children[0]),l=j&&j.sc?j.sc:this,!j.creator&&Type.exists(a.children[2])&&this._error("Unexpected value. Only element creators are allowed to have a value after the function call."),d=0;d<h.length;d++)m[d]=this.execute(h[d]),this.dpstack[this.pscope].push({line:a.children[1][d].line,col:a.children[1][d].ecol});if("function"!=typeof j||j.creator)if("function"==typeof j&&j.creator){e=this.line;try{for(b=j(m,k),b.jcLineStart=e,b.jcLineEnd=a.eline,d=e;d<=a.line;d++)this.lineToElement[d]=b;b.debugParents=this.dpstack[this.pscope]}catch(n){this._error(n.toString())}}else this._error("Function '"+j+"' is undefined.");else b=j.apply(l,m);this.dpstack.pop(),this.pscope--;break;case"op_property":e=this.execute(a.children[0]),
c=a.children[1],b=this.resolveProperty(e,c,!1),Type.exists(b)&&(b.sc=e);break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),this.use(a.children[0].toString());break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),c=this.getvar(a.children[0]),b=this.del(c);break;case"op_equ":b=this.execute(a.children[0])==this.execute(a.children[1]);break;case"op_neq":b=this.execute(a.children[0])!=this.execute(a.children[1]);break;case"op_approx":b=Math.abs(this.execute(a.children[0])-this.execute(a.children[1]))<Mat.eps;break;case"op_grt":b=this.execute(a.children[0])>this.execute(a.children[1]);break;case"op_lot":b=this.execute(a.children[0])<this.execute(a.children[1]);break;case"op_gre":b=this.execute(a.children[0])>=this.execute(a.children[1]);break;case"op_loe":b=this.execute(a.children[0])<=this.execute(a.children[1]);break;case"op_or":b=this.execute(a.children[0])||this.execute(a.children[1]);break;case"op_and":b=this.execute(a.children[0])&&this.execute(a.children[1]);break;case"op_not":b=!this.execute(a.children[0]);break;case"op_add":b=this.add(this.execute(a.children[0]),this.execute(a.children[1]));break;case"op_sub":b=this.sub(this.execute(a.children[0]),this.execute(a.children[1]));break;case"op_div":b=this.div(this.execute(a.children[0]),this.execute(a.children[1]));break;case"op_mod":b=this.mod(this.execute(a.children[0]),this.execute(a.children[1]),!0);break;case"op_mul":b=this.mul(this.execute(a.children[0]),this.execute(a.children[1]));break;case"op_exp":b=this.pow(this.execute(a.children[0]),this.execute(a.children[1]));break;case"op_neg":b=this.neg(this.execute(a.children[0]))}break;case"node_var":b=this.getvar(a.value);break;case"node_const":b=Number(a.value);break;case"node_const_bool":b=a.value;break;case"node_str":b=a.value.replace(/\\(.)/,"$1")}return b},compile:function(a,b){var c,d,e,f,g="";if(Type.exists(b)||(b=!1),!a)return g;switch(a.type){case"node_op":switch(a.value){case"op_none":a.children[0]&&(g=this.compile(a.children[0],b)),a.children[1]&&(g+=this.compile(a.children[1],b));break;case"op_assign":b?(c=this.getLHSCompiler(a.children[0],b),Type.isArray(c)?g="$jc$.setProp("+c[0]+", "+c[1]+", "+this.compile(a.children[1],b)+");\n":(this.isLocalVariable(c)!==this.scope&&(this.scope.locals[c]=!0),g="$jc$.scopes["+this.scope.id+"].locals['"+c+"'] = "+this.compile(a.children[1],b)+";\n")):(c=this.compile(a.children[0]),g=c+" = "+this.compile(a.children[1],b)+";\n");break;case"op_if":g=" if ("+this.compile(a.children[0],b)+") "+this.compile(a.children[1],b);break;case"op_if_else":g=" if ("+this.compile(a.children[0],b)+")"+this.compile(a.children[1],b),g+=" else "+this.compile(a.children[2],b);break;case"op_conditional":g="(("+this.compile(a.children[0],b)+")?("+this.compile(a.children[1],b),g+="):("+this.compile(a.children[2],b)+"))";break;case"op_while":g=" while ("+this.compile(a.children[0],b)+") {\n"+this.compile(a.children[1],b)+"}\n";break;case"op_do":g=" do {\n"+this.compile(a.children[0],b)+"} while ("+this.compile(a.children[1],b)+");\n";break;case"op_for":g=" for ("+this.compile(a.children[0],b)+"; "+this.compile(a.children[1],b)+"; "+this.compile(a.children[2],b)+") {\n"+this.compile(a.children[3],b)+"\n}\n";break;case"op_proplst":a.children[0]&&(g=this.compile(a.children[0],b)+", "),g+=this.compile(a.children[1],b);break;case"op_prop":g=a.children[0]+": "+this.compile(a.children[1],b);break;case"op_emptyobject":g=b?"{}":"<< >>";break;case"op_proplst_val":g=this.compile(a.children[0],b);break;case"op_array":for(e=[],d=0;d<a.children[0].length;d++)e.push(this.compile(a.children[0][d],b));g="["+e.join(", ")+"]";break;case"op_extvalue":g=this.compile(a.children[0],b)+"["+this.compile(a.children[1],b)+"]";break;case"op_return":g=" return "+this.compile(a.children[0],b)+";\n";break;case"op_map":a.children[1].isMath||"node_var"===a.children[1].type||this._error("compile: In a map only function calls and mathematical expressions are allowed."),e=a.children[0],g=b?" $jc$.makeMap(function ("+e.join(", ")+") { return "+this.compile(a.children[1],b)+"; })":"map ("+e.join(", ")+") -> "+this.compile(a.children[1],b);break;case"op_function":e=a.children[0],f=this.pushScope(e),g=b?this.functionCodeJS(a):" function ("+e.join(", ")+") "+this.compile(a.children[1],b),this.popScope();break;case"op_execfunmath":console.log("TODO"),g="-1";break;case"op_execfun":if(a.children[2]){for(e=[],d=0;d<a.children[2].length;d++)e.push(this.compile(a.children[2][d],b));b&&(c="$jc$.mergeAttributes("+e.join(", ")+")")}for(a.children[0].withProps=!!a.children[2],e=[],d=0;d<a.children[1].length;d++)e.push(this.compile(a.children[1][d],b));g=this.compile(a.children[0],b)+"("+e.join(", ")+(a.children[2]&&b?", "+c:"")+")"+(a.children[2]&&!b?c:""),b&&"$"===a.children[0].value&&(g="$jc$.board.objects["+this.compile(a.children[1][0],b)+"]");break;case"op_property":g=b&&"X"!==a.children[1]&&"Y"!==a.children[1]?"$jc$.resolveProperty("+this.compile(a.children[0],b)+", '"+a.children[1]+"', true)":this.compile(a.children[0],b)+"."+a.children[1];break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),g=b?"$jc$.use('":"use('",g+=a.children[0].toString()+"');";break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),g=b?"$jc$.del(":"remove(",g+=this.compile(a.children[0],b)+")";break;case"op_equ":g="("+this.compile(a.children[0],b)+" == "+this.compile(a.children[1],b)+")";break;case"op_neq":g="("+this.compile(a.children[0],b)+" != "+this.compile(a.children[1],b)+")";break;case"op_approx":g="("+this.compile(a.children[0],b)+" ~= "+this.compile(a.children[1],b)+")";break;case"op_grt":g="("+this.compile(a.children[0],b)+" > "+this.compile(a.children[1],b)+")";break;case"op_lot":g="("+this.compile(a.children[0],b)+" < "+this.compile(a.children[1],b)+")";break;case"op_gre":g="("+this.compile(a.children[0],b)+" >= "+this.compile(a.children[1],b)+")";break;case"op_loe":g="("+this.compile(a.children[0],b)+" <= "+this.compile(a.children[1],b)+")";break;case"op_or":g="("+this.compile(a.children[0],b)+" || "+this.compile(a.children[1],b)+")";break;case"op_and":g="("+this.compile(a.children[0],b)+" && "+this.compile(a.children[1],b)+")";break;case"op_not":g="!("+this.compile(a.children[0],b)+")";break;case"op_add":g=b?"$jc$.add("+this.compile(a.children[0],b)+", "+this.compile(a.children[1],b)+")":"("+this.compile(a.children[0],b)+" + "+this.compile(a.children[1],b)+")";break;case"op_sub":g=b?"$jc$.sub("+this.compile(a.children[0],b)+", "+this.compile(a.children[1],b)+")":"("+this.compile(a.children[0],b)+" - "+this.compile(a.children[1],b)+")";break;case"op_div":g=b?"$jc$.div("+this.compile(a.children[0],b)+", "+this.compile(a.children[1],b)+")":"("+this.compile(a.children[0],b)+" / "+this.compile(a.children[1],b)+")";break;case"op_mod":g=b?"$jc$.mod("+this.compile(a.children[0],b)+", "+this.compile(a.children[1],b)+", true)":"("+this.compile(a.children[0],b)+" % "+this.compile(a.children[1],b)+")";break;case"op_mul":g=b?"$jc$.mul("+this.compile(a.children[0],b)+", "+this.compile(a.children[1],b)+")":"("+this.compile(a.children[0],b)+" * "+this.compile(a.children[1],b)+")";break;case"op_exp":g=b?"$jc$.pow("+this.compile(a.children[0],b)+", "+this.compile(a.children[1],b)+")":"("+this.compile(a.children[0],b)+"^"+this.compile(a.children[1],b)+")";break;case"op_neg":g=b?"$jc$.neg("+this.compile(a.children[0],b)+")":"(-"+this.compile(a.children[0],b)+")"}break;case"node_var":g=b?this.getvarJS(a.value,!1,a.withProps):a.value;break;case"node_const":g=a.value;break;case"node_const_bool":g=a.value;break;case"node_str":g="'"+a.value+"'"}return a.needsBrackets&&(g="{\n"+g+"}\n"),g},X:function(a){return a.X()},Y:function(a){return a.Y()},V:function(a){return a.Value()},L:function(a){return a.L()},dist:function(a,b){return Type.exists(a)&&Type.exists(a.Dist)||this._error("Error: Can't calculate distance."),a.Dist(b)},add:function(a,b){var c,d,e;if(a=Type.evalSlider(a),b=Type.evalSlider(b),Type.isArray(a)&&Type.isArray(b))for(d=Math.min(a.length,b.length),e=[],c=0;c<d;c++)e[c]=a[c]+b[c];else Type.isNumber(a)&&Type.isNumber(b)?e=a+b:Type.isString(a)||Type.isString(b)?e=a.toString()+b.toString():this._error("Operation + not defined on operands "+typeof a+" and "+typeof b);return e},sub:function(a,b){var c,d,e;if(a=Type.evalSlider(a),b=Type.evalSlider(b),Type.isArray(a)&&Type.isArray(b))for(d=Math.min(a.length,b.length),e=[],c=0;c<d;c++)e[c]=a[c]-b[c];else Type.isNumber(a)&&Type.isNumber(b)?e=a-b:this._error("Operation - not defined on operands "+typeof a+" and "+typeof b);return e},neg:function(a){var b,c,d;if(a=Type.evalSlider(a),Type.isArray(a))for(c=a.length,d=[],b=0;b<c;b++)d[b]=-a[b];else Type.isNumber(a)?d=-a:this._error("Unary operation - not defined on operand "+typeof a);return d},mul:function(a,b){var c,d,e;if(a=Type.evalSlider(a),b=Type.evalSlider(b),Type.isArray(a)&&Type.isNumber(b)&&(c=a,a=b,b=a),Type.isArray(a)&&Type.isArray(b))d=Math.min(a.length,b.length),e=Mat.innerProduct(a,b,d);else if(Type.isNumber(a)&&Type.isArray(b))for(d=b.length,e=[],c=0;c<d;c++)e[c]=a*b[c];else Type.isNumber(a)&&Type.isNumber(b)?e=a*b:this._error("Operation * not defined on operands "+typeof a+" and "+typeof b);return e},div:function(a,b){var c,d,e;if(a=Type.evalSlider(a),b=Type.evalSlider(b),Type.isArray(a)&&Type.isNumber(b))for(d=a.length,e=[],c=0;c<d;c++)e[c]=a[c]/b;else Type.isNumber(a)&&Type.isNumber(b)?e=a/b:this._error("Operation * not defined on operands "+typeof a+" and "+typeof b);return e},mod:function(a,b){var c,d,e;if(a=Type.evalSlider(a),b=Type.evalSlider(b),Type.isArray(a)&&Type.isNumber(b))for(d=a.length,e=[],c=0;c<d;c++)e[c]=Mat.mod(a[c],b,!0);else Type.isNumber(a)&&Type.isNumber(b)?e=Mat.mod(a,b,!0):this._error("Operation * not defined on operands "+typeof a+" and "+typeof b);return e},pow:function(a,b){return a=Type.evalSlider(a),b=Type.evalSlider(b),Math.pow(a,b)},DDD:function(a){console.log("Dummy derivative function. This should never appear!")},ifthen:function(a,b,c){return a?b:c},del:function(a){"object"==typeof a&&JXG.exists(a.type)&&JXG.exists(a.elementClass)&&this.board.removeObject(a)},use:function(a){var b,c,d=!1;if("string"==typeof a){for(b in JXG.boards)if(JXG.boards.hasOwnProperty(b)&&JXG.boards[b].container===a){c=JXG.boards[b],d=!0;break}}else c=a,d=!0;d?(this.board=c,this.builtIn.$board=c,this.builtIn.$board.src="$jc$.board"):this._error("Board '"+a+"' not found!")},findSymbol:function(a,b){var c,d;for(b=Type.def(b,-1),d=b===-1?this.scope:this.scopes[b];null!==d;){for(c in d.locals)if(d.locals.hasOwnProperty(c)&&d.locals[c]===a)return[c,d];d=d.previous}return[]},importModule:function(a){return priv.modules[a.toLowerCase()]},defineBuiltIn:function(){var a=this,b={PI:Math.PI,EULER:Math.E,X:a.X,Y:a.Y,V:a.V,L:a.L,dist:a.dist,rad:Geometry.rad,deg:Geometry.trueAngle,factorial:Mat.factorial,trunc:Type.trunc,log:Mat.log,ln:Math.log,log10:Mat.log10,lg:Mat.log10,log2:Mat.log2,lb:Mat.log2,ld:Mat.log2,cosh:Mat.cosh,sinh:Mat.sinh,IfThen:a.ifthen,"import":a.importModule,use:a.use,remove:a.del,$:a.getElementById,$board:a.board,$log:a.log,D:a.DDD};return b.rad.sc=Geometry,b.deg.sc=Geometry,b.factorial.sc=Mat,b.X.src="$jc$.X",b.Y.src="$jc$.Y",b.V.src="$jc$.V",b.L.src="$jc$.L",b.dist.src="$jc$.dist",b.rad.src="JXG.Math.Geometry.rad",b.deg.src="JXG.Math.Geometry.trueAngle",b.factorial.src="JXG.Math.factorial",b.trunc.src="JXG.trunc",b.ln.src="Math.log",b.log10.src="JXG.Math.log10",b.lg.src="JXG.Math.log10",b.log2.src="JXG.Math.log2",b.lb.src="JXG.Math.log2",b.ld.src="JXG.Math.log2",b.cosh.src="JXG.Math.cosh",b.sinh.src="JXG.Math.sinh",b["import"].src="$jc$.importModule",b.use.src="$jc$.use",b.remove.src="$jc$.del",b.IfThen.src="$jc$.ifthen",b.$.src="(function (n) { return $jc$.board.select(n); })",b.$board&&(b.$board.src="$jc$.board"),b.$log.src="$jc$.log",b},_debug:function(a){"object"==typeof console?console.log(a):Env.isBrowser&&document&&null!==document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=a+"<br />")},_error:function(a){var b=new Error("Error("+this.line+"): "+a);throw b.line=this.line,b},_warn:function(a){"object"==typeof console?console.log("Warning("+this.line+"): "+a):Env.isBrowser&&document&&null!==document.getElementById(this.warnLog)&&(document.getElementById(this.warnLog).innerHTML+="Warning("+this.line+"): "+a+"<br />")},_log:function(a){"object"!=typeof window&&"object"==typeof self&&self.postMessage?self.postMessage({type:"log",msg:"Log: "+a.toString()}):console.log("Log: ",arguments)}});var parser=function(){function a(){this.yy={}}var b=function(a,b,c,d){for(c=c||{},d=a.length;d--;c[a[d]]=b);return c},c=[2,14],d=[1,13],e=[1,37],f=[1,14],g=[1,15],h=[1,21],i=[1,16],j=[1,17],k=[1,33],l=[1,18],m=[1,19],n=[1,12],o=[1,59],p=[1,60],q=[1,58],r=[1,46],s=[1,48],t=[1,49],u=[1,50],v=[1,51],w=[1,52],x=[1,53],y=[1,54],z=[1,45],A=[1,38],B=[1,39],C=[5,7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],D=[5,7,8,12,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],E=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],F=[2,48],G=[1,72],H=[10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,66,83,86],I=[1,78],J=[8,10,16,32,34,35,37,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],K=[1,82],L=[8,10,16,32,34,35,37,39,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],M=[1,83],N=[1,84],O=[1,85],P=[8,10,16,32,34,35,37,39,41,42,43,50,51,53,54,55,57,64,65,66,83,86],Q=[1,89],R=[1,90],S=[1,91],T=[1,92],U=[1,97],V=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,53,54,55,57,64,65,66,83,86],W=[1,103],X=[1,104],Y=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,57,64,65,66,83,86],Z=[1,105],$=[1,106],_=[1,107],aa=[1,126],ba=[1,139],ca=[83,86],da=[1,149],ea=[10,66,86],fa=[8,10,16,20,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,82,83,86],ga=[1,166],ha=[10,86],ia={trace:function(){},yy:{},symbols_:{error:2,Program:3,StatementList:4,EOF:5,IfStatement:6,IF:7,"(":8,Expression:9,")":10,Statement:11,ELSE:12,LoopStatement:13,WHILE:14,FOR:15,";":16,DO:17,UnaryStatement:18,USE:19,IDENTIFIER:20,DELETE:21,ReturnStatement:22,RETURN:23,EmptyStatement:24,StatementBlock:25,"{":26,"}":27,ExpressionStatement:28,AssignmentExpression:29,ConditionalExpression:30,LeftHandSideExpression:31,"=":32,LogicalORExpression:33,"?":34,":":35,LogicalANDExpression:36,"||":37,EqualityExpression:38,"&&":39,RelationalExpression:40,"==":41,"!=":42,"~=":43,AdditiveExpression:44,"<":45,">":46,"<=":47,">=":48,MultiplicativeExpression:49,"+":50,"-":51,UnaryExpression:52,"*":53,"/":54,"%":55,ExponentExpression:56,"^":57,"!":58,MemberExpression:59,CallExpression:60,PrimaryExpression:61,FunctionExpression:62,MapExpression:63,".":64,"[":65,"]":66,BasicLiteral:67,ObjectLiteral:68,ArrayLiteral:69,NullLiteral:70,BooleanLiteral:71,StringLiteral:72,NumberLiteral:73,NULL:74,TRUE:75,FALSE:76,STRING:77,NUMBER:78,NAN:79,INFINITY:80,ElementList:81,"<<":82,">>":83,PropertyList:84,Property:85,",":86,PropertyName:87,Arguments:88,AttributeList:89,Attribute:90,FUNCTION:91,ParameterDefinitionList:92,MAP:93,"->":94,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"IF",8:"(",10:")",12:"ELSE",14:"WHILE",15:"FOR",16:";",17:"DO",19:"USE",20:"IDENTIFIER",21:"DELETE",23:"RETURN",26:"{",27:"}",32:"=",34:"?",35:":",37:"||",39:"&&",41:"==",42:"!=",43:"~=",45:"<",46:">",47:"<=",48:">=",50:"+",51:"-",53:"*",54:"/",55:"%",57:"^",58:"!",64:".",65:"[",66:"]",74:"NULL",75:"TRUE",76:"FALSE",77:"STRING",78:"NUMBER",79:"NAN",80:"INFINITY",82:"<<",83:">>",86:",",91:"FUNCTION",93:"MAP",94:"->"},productions_:[0,[3,2],[6,5],[6,7],[13,5],[13,9],[13,7],[18,2],[18,2],[22,2],[22,3],[24,1],[25,3],[4,2],[4,0],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[28,2],[9,1],[29,1],[29,3],[30,1],[30,5],[33,1],[33,3],[36,1],[36,3],[38,1],[38,3],[38,3],[38,3],[40,1],[40,3],[40,3],[40,3],[40,3],[44,1],[44,3],[44,3],[49,1],[49,3],[49,3],[49,3],[56,1],[56,3],[52,1],[52,2],[52,2],[52,2],[31,1],[31,1],[59,1],[59,1],[59,1],[59,3],[59,4],[61,1],[61,1],[61,1],[61,1],[61,3],[67,1],[67,1],[67,1],[67,1],[70,1],[71,1],[71,1],[72,1],[73,1],[73,1],[73,1],[69,2],[69,3],[68,2],[68,3],[84,1],[84,3],[85,3],[87,1],[87,1],[87,1],[60,2],[60,3],[60,2],[60,4],[60,3],[88,2],[88,3],[89,1],[89,3],[90,1],[90,1],[81,1],[81,3],[62,4],[62,5],[63,6],[92,1],[92,3]],performAction:function(a,b,c,d,e,f,g){var h=f.length-1;switch(e){case 1:return f[h-1];case 2:this.$=ja.createNode(ka(g[h-4]),"node_op","op_if",f[h-2],f[h]);break;case 3:this.$=ja.createNode(ka(g[h-6]),"node_op","op_if_else",f[h-4],f[h-2],f[h]);break;case 4:this.$=ja.createNode(ka(g[h-4]),"node_op","op_while",f[h-2],f[h]);break;case 5:this.$=ja.createNode(ka(g[h-8]),"node_op","op_for",f[h-6],f[h-4],f[h-2],f[h]);break;case 6:this.$=ja.createNode(ka(g[h-6]),"node_op","op_do",f[h-5],f[h-2]);break;case 7:this.$=ja.createNode(ka(g[h-1]),"node_op","op_use",f[h]);break;case 8:this.$=ja.createNode(ka(g[h-1]),"node_op","op_delete",f[h]);break;case 9:this.$=ja.createNode(ka(g[h-1]),"node_op","op_return",void 0);break;case 10:this.$=ja.createNode(ka(g[h-2]),"node_op","op_return",f[h-1]);break;case 11:case 14:this.$=ja.createNode(ka(g[h]),"node_op","op_none");break;case 12:this.$=f[h-1],this.$.needsBrackets=!0;break;case 13:this.$=ja.createNode(ka(g[h-1]),"node_op","op_none",f[h-1],f[h]);break;case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 23:case 24:case 26:case 28:case 30:case 32:case 36:case 41:case 44:case 48:case 50:case 52:case 54:case 55:case 56:case 58:case 62:case 81:case 84:case 85:case 86:this.$=f[h];break;case 22:case 65:case 93:this.$=f[h-1];break;case 25:this.$=ja.createNode(ka(g[h-2]),"node_op","op_assign",f[h-2],f[h]),this.$.isMath=!1;break;case 27:this.$=ja.createNode(ka(g[h-4]),"node_op","op_conditional",f[h-4],f[h-2],f[h]),this.$.isMath=!1;break;case 29:this.$=ja.createNode(ka(g[h-2]),"node_op","op_or",f[h-2],f[h]),this.$.isMath=!1;break;case 31:this.$=ja.createNode(ka(g[h-2]),"node_op","op_and",f[h-2],f[h]),this.$.isMath=!1;break;case 33:this.$=ja.createNode(ka(g[h-2]),"node_op","op_equ",f[h-2],f[h]),this.$.isMath=!1;break;case 34:this.$=ja.createNode(ka(g[h-2]),"node_op","op_neq",f[h-2],f[h]),this.$.isMath=!1;break;case 35:this.$=ja.createNode(ka(g[h-2]),"node_op","op_approx",f[h-2],f[h]),this.$.isMath=!1;break;case 37:this.$=ja.createNode(ka(g[h-2]),"node_op","op_lot",f[h-2],f[h]),this.$.isMath=!1;break;case 38:this.$=ja.createNode(ka(g[h-2]),"node_op","op_grt",f[h-2],f[h]),this.$.isMath=!1;break;case 39:this.$=ja.createNode(ka(g[h-2]),"node_op","op_loe",f[h-2],f[h]),this.$.isMath=!1;break;case 40:this.$=ja.createNode(ka(g[h-2]),"node_op","op_gre",f[h-2],f[h]),this.$.isMath=!1;break;case 42:this.$=ja.createNode(ka(g[h-2]),"node_op","op_add",f[h-2],f[h]),this.$.isMath=!0;break;case 43:this.$=ja.createNode(ka(g[h-2]),"node_op","op_sub",f[h-2],f[h]),this.$.isMath=!0;break;case 45:this.$=ja.createNode(ka(g[h-2]),"node_op","op_mul",f[h-2],f[h]),this.$.isMath=!0;break;case 46:this.$=ja.createNode(ka(g[h-2]),"node_op","op_div",f[h-2],f[h]),this.$.isMath=!0;break;case 47:this.$=ja.createNode(ka(g[h-2]),"node_op","op_mod",f[h-2],f[h]),this.$.isMath=!0;break;case 49:this.$=ja.createNode(ka(g[h-2]),"node_op","op_exp",f[h-2],f[h]),this.$.isMath=!0;break;case 51:this.$=ja.createNode(ka(g[h-1]),"node_op","op_not",f[h]),this.$.isMath=!1;break;case 53:this.$=ja.createNode(ka(g[h-1]),"node_op","op_neg",f[h]),this.$.isMath=!0;break;case 57:case 63:case 64:case 66:case 67:case 68:case 97:this.$=f[h],this.$.isMath=!1;break;case 59:case 91:this.$=ja.createNode(ka(g[h-2]),"node_op","op_property",f[h-2],f[h]),this.$.isMath=!0;break;case 60:case 90:this.$=ja.createNode(ka(g[h-3]),"node_op","op_extvalue",f[h-3],f[h-1]),this.$.isMath=!0;break;case 61:this.$=ja.createNode(ka(g[h]),"node_var",f[h]);break;case 69:this.$=f[h],this.$.isMath=!0;break;case 70:this.$=ja.createNode(ka(g[h]),"node_const",null);break;case 71:this.$=ja.createNode(ka(g[h]),"node_const_bool",!0);break;case 72:this.$=ja.createNode(ka(g[h]),"node_const_bool",!1);break;case 73:this.$=ja.createNode(ka(g[h]),"node_str",f[h].substring(1,f[h].length-1));break;case 74:this.$=ja.createNode(ka(g[h]),"node_const",parseFloat(f[h]));break;case 75:this.$=ja.createNode(ka(g[h]),"node_const",NaN);break;case 76:this.$=ja.createNode(ka(g[h]),"node_const",1/0);break;case 77:this.$=ja.createNode(ka(g[h-1]),"node_op","op_array",[]);break;case 78:this.$=ja.createNode(ka(g[h-2]),"node_op","op_array",f[h-1]);break;case 79:this.$=ja.createNode(ka(g[h-1]),"node_op","op_emptyobject",{});break;case 80:this.$=ja.createNode(ka(g[h-2]),"node_op","op_proplst_val",f[h-1]);break;case 82:this.$=ja.createNode(ka(g[h-2]),"node_op","op_proplst",f[h-2],f[h]);break;case 83:this.$=ja.createNode(ka(g[h-2]),"node_op","op_prop",f[h-2],f[h]);break;case 87:case 89:this.$=ja.createNode(ka(g[h-1]),"node_op","op_execfun",f[h-1],f[h]),this.$.isMath=!0;break;case 88:this.$=ja.createNode(ka(g[h-2]),"node_op","op_execfun",f[h-2],f[h-1],f[h],!0),this.$.isMath=!1;break;case 92:this.$=[];break;case 94:case 98:case 103:this.$=[f[h]];break;case 95:case 99:case 104:this.$=f[h-2].concat(f[h]);break;case 96:this.$=ja.createNode(ka(g[h]),"node_var",f[h]),this.$.isMath=!0;break;case 100:this.$=ja.createNode(ka(g[h-3]),"node_op","op_function",[],f[h]),this.$.isMath=!1;break;case 101:this.$=ja.createNode(ka(g[h-4]),"node_op","op_function",f[h-2],f[h]),this.$.isMath=!1;break;case 102:this.$=ja.createNode(ka(g[h-5]),"node_op","op_map",f[h-3],f[h])}},table:[b([5,7,8,14,15,16,17,19,20,21,23,26,50,51,58,65,74,75,76,77,78,79,80,82,91,93],c,{3:1,4:2}),{1:[3]},{5:[1,3],6:6,7:d,8:e,9:20,11:4,13:7,14:f,15:g,16:h,17:i,18:8,19:j,20:k,21:l,22:9,23:m,24:11,25:5,26:n,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{1:[2,1]},b(C,[2,13]),b(D,[2,15]),b(D,[2,16]),b(D,[2,17]),b(D,[2,18]),b(D,[2,19]),b(D,[2,20]),b(D,[2,21]),b([7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],c,{4:61}),{8:[1,62]},{8:[1,63]},{8:[1,64]},{6:6,7:d,8:e,9:20,11:65,13:7,14:f,15:g,16:h,17:i,18:8,19:j,20:k,21:l,22:9,23:m,24:11,25:5,26:n,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{20:[1,66]},{20:[1,67]},{8:e,9:69,16:[1,68],20:k,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{16:[1,70]},b(D,[2,11]),b(E,[2,23]),b(E,[2,24]),b([8,10,16,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],F,{32:[1,71],57:G}),b([8,10,16,32,35,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],[2,26],{34:[1,73],37:[1,74]}),b(H,[2,54],{88:77,8:I,64:[1,75],65:[1,76]}),b(H,[2,55],{88:79,8:I,64:[1,81],65:[1,80]}),b(J,[2,28],{39:K}),b(E,[2,56]),b(E,[2,57]),b(E,[2,58]),b(L,[2,30],{41:M,42:N,43:O}),b(E,[2,61]),b(E,[2,62]),b(E,[2,63]),b(E,[2,64]),{8:e,9:86,20:k,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:[1,87]},{8:[1,88]},b(P,[2,32],{45:Q,46:R,47:S,48:T}),b(E,[2,66]),b(E,[2,67]),b(E,[2,68]),b(E,[2,69]),{20:U,72:98,73:99,77:v,78:w,79:x,80:y,83:[1,93],84:94,85:95,87:96},{8:e,20:k,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,66:[1,100],67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,81:101,82:z,91:A,93:B},b(V,[2,36],{50:W,51:X}),b(E,[2,70]),b(E,[2,71]),b(E,[2,72]),b(E,[2,73]),b(E,[2,74]),b(E,[2,75]),b(E,[2,76]),b(Y,[2,41],{53:Z,54:$,55:_}),b(E,[2,44]),b(E,[2,50]),{8:e,20:k,31:109,50:o,51:p,52:108,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,20:k,31:109,50:o,51:p,52:110,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,20:k,31:109,50:o,51:p,52:111,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{6:6,7:d,8:e,9:20,11:4,13:7,14:f,15:g,16:h,17:i,18:8,19:j,20:k,21:l,22:9,23:m,24:11,25:5,26:n,27:[1,112],28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,9:113,20:k,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,9:114,20:k,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,9:115,20:k,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{14:[1,116]},b(D,[2,7]),b(D,[2,8]),b(D,[2,9]),{16:[1,117]},b(D,[2,22]),{8:e,20:k,29:118,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,20:k,31:109,50:o,51:p,52:119,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,20:k,29:120,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,20:k,31:109,36:121,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{20:[1,122]},{8:e,9:123,20:k,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},b(E,[2,87],{89:124,90:125,68:127,20:aa,82:z}),{8:e,10:[1,128],20:k,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,81:129,82:z,91:A,93:B},b(E,[2,89]),{8:e,9:130,20:k,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{20:[1,131]},{8:e,20:k,31:109,38:132,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,20:k,31:109,40:133,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,20:k,31:109,40:134,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,20:k,31:109,40:135,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{10:[1,136]},{10:[1,137],20:ba,92:138},{20:ba,92:140},{8:e,20:k,31:109,44:141,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,20:k,31:109,44:142,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,20:k,31:109,44:143,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,20:k,31:109,44:144,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},b(E,[2,79]),{83:[1,145],86:[1,146]},b(ca,[2,81]),{35:[1,147]},{35:[2,84]},{35:[2,85]},{35:[2,86]},b(E,[2,77]),{66:[1,148],86:da},b(ea,[2,98]),{8:e,20:k,31:109,49:150,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,20:k,31:109,49:151,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,20:k,31:109,50:o,51:p,52:152,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,20:k,31:109,50:o,51:p,52:153,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,20:k,31:109,50:o,51:p,52:154,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},b(E,[2,51]),b([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],F,{57:G}),b(E,[2,52]),b(E,[2,53]),b([5,7,8,10,12,14,15,16,17,19,20,21,23,26,27,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,58,64,65,66,74,75,76,77,78,79,80,82,83,86,91,93],[2,12]),{10:[1,155]},{10:[1,156]},{16:[1,157]},{8:[1,158]},b(D,[2,10]),b(E,[2,25]),b(E,[2,49]),{35:[1,159]},b(J,[2,29],{39:K}),b(E,[2,59]),{66:[1,160]},b([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83],[2,88],{86:[1,161]}),b(E,[2,94]),b(E,[2,96]),b(E,[2,97]),b(fa,[2,92]),{10:[1,162],86:da},{66:[1,163]},b(E,[2,91]),b(L,[2,31],{41:M,42:N,43:O}),b(P,[2,33],{45:Q,46:R,47:S,48:T}),b(P,[2,34],{45:Q,46:R,47:S,48:T}),b(P,[2,35],{45:Q,46:R,47:S,48:T}),b(E,[2,65]),{25:164,26:n},{10:[1,165],86:ga},b(ha,[2,103]),{10:[1,167],86:ga},b(V,[2,37],{50:W,51:X}),b(V,[2,38],{50:W,51:X}),b(V,[2,39],{50:W,51:X}),b(V,[2,40],{50:W,51:X}),b(E,[2,80]),{20:U,72:98,73:99,77:v,78:w,79:x,80:y,85:168,87:96},{8:e,20:k,29:169,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},b(E,[2,78]),{8:e,20:k,29:170,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},b(Y,[2,42],{53:Z,54:$,55:_}),b(Y,[2,43],{53:Z,54:$,55:_}),b(E,[2,45]),b(E,[2,46]),b(E,[2,47]),{6:6,7:d,8:e,9:20,11:171,13:7,14:f,15:g,16:h,17:i,18:8,19:j,20:k,21:l,22:9,23:m,24:11,25:5,26:n,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{6:6,7:d,8:e,9:20,11:172,13:7,14:f,15:g,16:h,17:i,18:8,19:j,20:k,21:l,22:9,23:m,24:11,25:5,26:n,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,9:173,20:k,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,
56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,9:174,20:k,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,20:k,29:175,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},b(E,[2,60]),{20:aa,68:127,82:z,90:176},b(fa,[2,93]),b(E,[2,90]),b(E,[2,100]),{25:177,26:n},{20:[1,178]},{94:[1,179]},b(ca,[2,82]),b(ca,[2,83]),b(ea,[2,99]),b(C,[2,2],{12:[1,180]}),b(D,[2,4]),{16:[1,181]},{10:[1,182]},b(E,[2,27]),b(E,[2,95]),b(E,[2,101]),b(ha,[2,104]),{8:e,9:183,20:k,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{6:6,7:d,8:e,9:20,11:184,13:7,14:f,15:g,16:h,17:i,18:8,19:j,20:k,21:l,22:9,23:m,24:11,25:5,26:n,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{8:e,9:185,20:k,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},{16:[1,186]},b(E,[2,102]),b(D,[2,3]),{10:[1,187]},b(D,[2,6]),{6:6,7:d,8:e,9:20,11:188,13:7,14:f,15:g,16:h,17:i,18:8,19:j,20:k,21:l,22:9,23:m,24:11,25:5,26:n,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:o,51:p,52:56,56:57,58:q,59:26,60:27,61:29,62:30,63:31,65:r,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:s,75:t,76:u,77:v,78:w,79:x,80:y,82:z,91:A,93:B},b(D,[2,5])],defaultActions:{3:[2,1],97:[2,84],98:[2,85],99:[2,86]},parseError:function(a,b){if(!b.recoverable){var c=new Error(a);throw c.hash=b,c}this.trace(a)},parse:function(a){var b=this,c=[0],d=[null],e=[],f=this.table,g="",h=0,i=0,j=0,k=2,l=1,m=e.slice.call(arguments,1),n=Object.create(this.lexer),o={yy:{}};for(var p in this.yy)Object.prototype.hasOwnProperty.call(this.yy,p)&&(o.yy[p]=this.yy[p]);n.setInput(a,o.yy),o.yy.lexer=n,o.yy.parser=this,"undefined"==typeof n.yylloc&&(n.yylloc={});var q=n.yylloc;e.push(q);var r=n.options&&n.options.ranges;"function"==typeof o.yy.parseError?this.parseError=o.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var s,t,u,v,w,x,y,z,A,B=function(){var a;return a=n.lex()||l,"number"!=typeof a&&(a=b.symbols_[a]||a),a},C={};;){if(u=c[c.length-1],this.defaultActions[u]?v=this.defaultActions[u]:(null!==s&&"undefined"!=typeof s||(s=B()),v=f[u]&&f[u][s]),"undefined"==typeof v||!v.length||!v[0]){var D="";A=[];for(x in f[u])this.terminals_[x]&&x>k&&A.push("'"+this.terminals_[x]+"'");D=n.showPosition?"Parse error on line "+(h+1)+":\n"+n.showPosition()+"\nExpecting "+A.join(", ")+", got '"+(this.terminals_[s]||s)+"'":"Parse error on line "+(h+1)+": Unexpected "+(s==l?"end of input":"'"+(this.terminals_[s]||s)+"'"),this.parseError(D,{text:n.match,token:this.terminals_[s]||s,line:n.yylineno,loc:q,expected:A})}if(v[0]instanceof Array&&v.length>1)throw new Error("Parse Error: multiple actions possible at state: "+u+", token: "+s);switch(v[0]){case 1:c.push(s),d.push(n.yytext),e.push(n.yylloc),c.push(v[1]),s=null,t?(s=t,t=null):(i=n.yyleng,g=n.yytext,h=n.yylineno,q=n.yylloc,j>0&&j--);break;case 2:if(y=this.productions_[v[1]][1],C.$=d[d.length-y],C._$={first_line:e[e.length-(y||1)].first_line,last_line:e[e.length-1].last_line,first_column:e[e.length-(y||1)].first_column,last_column:e[e.length-1].last_column},r&&(C._$.range=[e[e.length-(y||1)].range[0],e[e.length-1].range[1]]),w=this.performAction.apply(C,[g,i,h,o.yy,v[1],d,e].concat(m)),"undefined"!=typeof w)return w;y&&(c=c.slice(0,-1*y*2),d=d.slice(0,-1*y),e=e.slice(0,-1*y)),c.push(this.productions_[v[1]][0]),d.push(C.$),e.push(C._$),z=f[c[c.length-2]][c[c.length-1]],c.push(z);break;case 3:return!0}}return!0}},ja={node:function(a,b,c){return{type:a,value:b,children:c}},createNode:function(a,b,c,d){var e,f=this.node(b,c,[]);for(e=3;e<arguments.length;e++)f.children.push(arguments[e]);return f.line=a[0],f.col=a[1],f.eline=a[2],f.ecol=a[3],f}},ka=function(a){return[a.first_line,a.first_column,a.last_line,a.last_column]},la=function(){var a={EOF:1,parseError:function(a,b){if(!this.yy.parser)throw new Error(a);this.yy.parser.parseError(a,b)},setInput:function(a,b){return this.yy=b||this.yy||{},this._input=a,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var a=this._input[0];this.yytext+=a,this.yyleng++,this.offset++,this.match+=a,this.matched+=a;var b=a.match(/(?:\r\n?|\n).*/g);return b?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),a},unput:function(a){var b=a.length,c=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-b),this.offset-=b;var d=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),c.length-1&&(this.yylineno-=c.length-1);var e=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===d.length?this.yylloc.first_column:0)+d[d.length-c.length].length-c[0].length:this.yylloc.first_column-b},this.options.ranges&&(this.yylloc.range=[e[0],e[0]+this.yyleng-b]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=new Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},test_match:function(a,b){var c,d,e;if(this.options.backtrack_lexer&&(e={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(e.yylloc.range=this.yylloc.range.slice(0))),d=a[0].match(/(?:\r\n?|\n).*/g),d&&(this.yylineno+=d.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:d?d[d.length-1].length-d[d.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+a[0].length},this.yytext+=a[0],this.match+=a[0],this.matches=a,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(a[0].length),this.matched+=a[0],c=this.performAction.call(this,this.yy,this,b,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),c)return c;if(this._backtrack){for(var f in e)this[f]=e[f];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c,d;this._more||(this.yytext="",this.match="");for(var e=this._currentRules(),f=0;f<e.length;f++)if(c=this._input.match(this.rules[e[f]]),c&&(!b||c[0].length>b[0].length)){if(b=c,d=f,this.options.backtrack_lexer){if(a=this.test_match(c,e[f]),a!==!1)return a;if(this._backtrack){b=!1;continue}return!1}if(!this.options.flex)break}return b?(a=this.test_match(b,e[d]),a!==!1&&a):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){var a=this.conditionStack.length-1;return a>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(a){return a=this.conditionStack.length-1-Math.abs(a||0),a>=0?this.conditionStack[a]:"INITIAL"},pushState:function(a){this.begin(a)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(a,b,c,d){switch(c){case 0:break;case 1:return 78;case 2:return 78;case 3:return 77;case 4:return 77;case 5:break;case 6:break;case 7:return 7;case 8:return 12;case 9:return 14;case 10:return 17;case 11:return 15;case 12:return 91;case 13:return 93;case 14:return 19;case 15:return 23;case 16:return 21;case 17:return 75;case 18:return 76;case 19:return 74;case 20:return 80;case 21:return 94;case 22:return 82;case 23:return 83;case 24:return 26;case 25:return 27;case 26:return 16;case 27:return"#";case 28:return 34;case 29:return 35;case 30:return 79;case 31:return 64;case 32:return 65;case 33:return 66;case 34:return 8;case 35:return 10;case 36:return 58;case 37:return 57;case 38:return 53;case 39:return 54;case 40:return 55;case 41:return 50;case 42:return 51;case 43:return 47;case 44:return 45;case 45:return 48;case 46:return 46;case 47:return 41;case 48:return 43;case 49:return 42;case 50:return 39;case 51:return 37;case 52:return 32;case 53:return 86;case 54:return 5;case 55:return 20;case 56:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:[0-9]+\.[0-9]*|[0-9]*\.[0-9]+\b)/,/^(?:[0-9]+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:\/\/.*)/,/^(?:\/\*(.|\n|\r)*?\*\/)/,/^(?:if\b)/,/^(?:else\b)/,/^(?:while\b)/,/^(?:do\b)/,/^(?:for\b)/,/^(?:function\b)/,/^(?:map\b)/,/^(?:use\b)/,/^(?:return\b)/,/^(?:delete\b)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:Infinity\b)/,/^(?:->)/,/^(?:<<)/,/^(?:>>)/,/^(?:\{)/,/^(?:\})/,/^(?:;)/,/^(?:#)/,/^(?:\?)/,/^(?::)/,/^(?:NaN\b)/,/^(?:\.)/,/^(?:\[)/,/^(?:\])/,/^(?:\()/,/^(?:\))/,/^(?:!)/,/^(?:\^)/,/^(?:\*)/,/^(?:\/)/,/^(?:%)/,/^(?:\+)/,/^(?:-)/,/^(?:<=)/,/^(?:<)/,/^(?:>=)/,/^(?:>)/,/^(?:==)/,/^(?:~=)/,/^(?:!=)/,/^(?:&&)/,/^(?:\|\|)/,/^(?:=)/,/^(?:,)/,/^(?:$)/,/^(?:[A-Za-z_\$][A-Za-z0-9_]*)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56],inclusive:!0}}};return a}();return ia.lexer=la,a.prototype=ia,ia.Parser=a,new a}();return"undefined"!=typeof require&&"undefined"!=typeof exports&&(exports.parser=parser,exports.Parser=parser.Parser,exports.parse=function(){return parser.parse.apply(parser,arguments)},exports.main=function(a){a[1]||(console.log("Usage: "+a[0]+" FILE"),process.exit(1));var b=require("fs").readFileSync(require("path").normalize(a[1]),"utf8");return exports.parser.parse(b)},"undefined"!=typeof module&&require.main===module&&exports.main(process.argv.slice(1))),parser.yy.parseError=parser.parseError,JXG.JessieCode}),define("base/point",["jxg","options","math/math","math/geometry","math/numerics","base/coords","base/constants","base/element","parser/geonext","utils/type","base/transformation","base/coordselement"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";return a.Point=function(a,b,c){this.constructor(a,c,g.OBJECT_TYPE_POINT,g.OBJECT_CLASS_POINT),this.element=this.board.select(c.anchor),this.coordsConstructor(b),this.elType="point",this.id=this.board.setId(this,"P"),this.board.renderer.drawPoint(this),this.board.finalizeAdding(this),this.createLabel()},a.Point.prototype=new h,j.copyPrototypeMethods(a.Point,l,"coordsConstructor"),a.extend(a.Point.prototype,{hasPoint:function(a,b){var c,d=this.coords.scrCoords,e=j.evaluate(this.visProp.sizeunit);return c=parseFloat(j.evaluate(this.visProp.size)),"user"===e&&(c*=Math.sqrt(this.board.unitX*this.board.unitY)),c+=.5*parseFloat(j.evaluate(this.visProp.strokewidth)),c<this.board.options.precision.hasPoint&&(c=this.board.options.precision.hasPoint),Math.abs(d[1]-a)<c+2&&Math.abs(d[2]-b)<c+2},update:function(a){return this.needsUpdate?(this.updateCoords(a),j.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateTransform:function(){var a,b;if(0===this.transformations.length||null===this.baseElement)return this;for(a=this===this.baseElement?this.transformations[0].apply(this.baseElement,"self"):this.transformations[0].apply(this.baseElement),this.coords.setCoordinates(g.COORDS_BY_USER,a),b=1;b<this.transformations.length;b++)this.coords.setCoordinates(g.COORDS_BY_USER,this.transformations[b].apply(this));return this},updateRenderer:function(){return this.updateRendererGeneric("updatePoint"),this},bounds:function(){return this.coords.usrCoords.slice(1).concat(this.coords.usrCoords.slice(1))},makeIntersection:function(a,b,c,e){var f;a=this.board.select(a),b=this.board.select(b),f=d.intersectionFunction(this.board,a,b,c,e,j.evaluate(this.visProp.alwaysintersect)),this.addConstraint([f]);try{a.addChild(this),b.addChild(this)}catch(h){throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof a+"' and '"+typeof b+"'.")}this.type=g.OBJECT_TYPE_INTERSECTION,this.elType="intersection",this.parents=[a.id,b.id,c,e],this.generatePolynomial=function(){var c=a.generatePolynomial(this),d=b.generatePolynomial(this);return 0===c.length||0===d.length?[]:[c[0],d[0]]},this.prepareUpdate().update()},setStyle:function(a){var b=["cross","cross","cross","circle","circle","circle","circle","square","square","square","plus","plus","plus"],c=[2,3,4,1,2,3,4,2,3,4,2,3,4];return this.visProp.face=b[a],this.visProp.size=c[a],this.board.renderer.changePointStyle(this),this},normalizeFace:function(c){return a.deprecated("Point.normalizeFace()","JXG.normalizePointFace()"),b.normalizePointFace(c)},face:function(b){a.deprecated("Point.face()","Point.setAttribute()"),this.setAttribute({face:b})},size:function(b){a.deprecated("Point.size()","Point.setAttribute()"),this.setAttribute({size:b})},cloneToBackground:function(){var a={};return a.id=this.id+"T"+this.numTraces,this.numTraces+=1,a.coords=this.coords,a.visProp=j.deepCopy(this.visProp,this.visProp.traceattributes,!0),a.visProp.layer=this.board.options.layer.trace,a.elementClass=g.OBJECT_CLASS_POINT,a.board=this.board,j.clearVisPropOld(a),a.visPropCalc={visible:j.evaluate(a.visProp.visible)},this.board.renderer.drawPoint(a),this.traces[a.id]=a.rendNode,this}}),a.createPoint=function(b,c,d){var e,f;if(f=j.copyAttributes(d,b.options,"point"),e=l.create(a.Point,b,c,f),!e)throw new Error("JSXGraph: Can't create point with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [x,y], [z,x,y], [element,transformation]");return e},a.createGlider=function(a,b,c){var d,e,f=j.copyAttributes(c,a.options,"glider");return e=1===b.length?[0,0]:b.slice(0,2),d=a.create("point",e,f),d.makeGlider(b[b.length-1]),d},a.createIntersectionPoint=function(a,b,c){var e,f,h,i,k,l,m=j.copyAttributes(c,a.options,"intersection");b.push(0,0),f=a.select(b[0]),h=a.select(b[1]),k=b[2]||0,l=b[3]||0,e=a.create("point",[0,0,0],m),i=d.intersectionFunction(a,f,h,k,l,e.visProp.alwaysintersect),e.addConstraint([i]);try{f.addChild(e),h.addChild(e)}catch(n){throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.")}return e.type=g.OBJECT_TYPE_INTERSECTION,e.elType="intersection",e.setParents([f.id,h.id]),e.intersectionNumbers=[k,l],e.getParents=function(){return this.parents.concat(this.intersectionNumbers)},e.generatePolynomial=function(){var a=f.generatePolynomial(e),b=h.generatePolynomial(e);return 0===a.length||0===b.length?[]:[a[0],b[0]]},e},a.createOtherIntersectionPoint=function(a,b,e){var f,h,i,k;if(3!==b.length||!j.isPoint(b[2])||b[0].elementClass!==g.OBJECT_CLASS_LINE&&b[0].elementClass!==g.OBJECT_CLASS_CIRCLE||b[1].elementClass!==g.OBJECT_CLASS_LINE&&b[1].elementClass!==g.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'other intersection point' with parent types '"+typeof b[0]+"',  '"+typeof b[1]+"'and  '"+typeof b[2]+"'.\nPossible parent types: [circle|line,circle|line,point]");return h=a.select(b[0]),i=a.select(b[1]),k=a.select(b[2]),f=a.create("point",[function(){var a=d.meet(h.stdform,i.stdform,0,h.board);return Math.abs(k.X()-a.usrCoords[1])>c.eps||Math.abs(k.Y()-a.usrCoords[2])>c.eps||Math.abs(k.Z()-a.usrCoords[0])>c.eps?a:d.meet(h.stdform,i.stdform,1,h.board)}],e),f.type=g.OBJECT_TYPE_INTERSECTION,f.elType="otherintersection",f.setParents([h.id,i.id,k]),h.addChild(f),i.addChild(f),f.generatePolynomial=function(){var a=h.generatePolynomial(f),b=i.generatePolynomial(f);return 0===a.length||0===b.length?[]:[a[0],b[0]]},f},a.createPolePoint=function(b,c,d){var e,f,h,i,j,k,l;if(c.length>1&&(i=c[0].type===g.OBJECT_TYPE_CONIC||c[0].elementClass===g.OBJECT_CLASS_CIRCLE,j=c[1].type===g.OBJECT_TYPE_CONIC||c[1].elementClass===g.OBJECT_CLASS_CIRCLE,k=c[0].elementClass===g.OBJECT_CLASS_LINE,l=c[1].elementClass===g.OBJECT_CLASS_LINE),2!==c.length||!(i&&l||k&&j))throw new Error("JSXGraph: Can't create 'pole point' with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent type: [conic|circle,line], [line,conic|circle]");return l?(f=b.select(c[0]),h=b.select(c[1])):(f=b.select(c[1]),h=b.select(c[0])),e=b.create("point",[function(){var b=f.quadraticform,c=h.stdform.slice(0,3);return[a.Math.Numerics.det([c,b[1],b[2]]),a.Math.Numerics.det([b[0],c,b[2]]),a.Math.Numerics.det([b[0],b[1],c])]}],d),e.elType="polepoint",e.setParents([f.id,h.id]),f.addChild(e),h.addChild(e),e},a.registerElement("point",a.createPoint),a.registerElement("glider",a.createGlider),a.registerElement("intersection",a.createIntersectionPoint),a.registerElement("otherintersection",a.createOtherIntersectionPoint),a.registerElement("polepoint",a.createPolePoint),{Point:a.Point,createPoint:a.createPoint,createGlider:a.createGlider,createIntersection:a.createIntersectionPoint,createOtherIntersection:a.createOtherIntersectionPoint,createPolePoint:a.createPolePoint}}),define("base/line",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/constants","base/coords","base/element","utils/type","base/point"],function(a,b,c,d,e,f,g,h,i,j){"use strict";return a.Line=function(b,c,d,e){this.constructor(b,e,f.OBJECT_TYPE_LINE,f.OBJECT_CLASS_LINE),this.point1=this.board.select(c),this.point2=this.board.select(d),this.ticks=[],this.defaultTicks=null,this.parentPolygon=null,this.id=this.board.setId(this,"L"),this.board.renderer.drawLine(this),this.board.finalizeAdding(this),this.elType="line",this.point1.addChild(this),this.point2.addChild(this),this.inherits.push(this.point1,this.point2),this.updateStdform(),this.createLabel(),this.methodMap=a.deepCopy(this.methodMap,{point1:"point1",point2:"point2",getSlope:"getSlope",getRise:"getRise",getYIntersect:"getRise",getAngle:"getAngle",L:"L",length:"L",addTicks:"addTicks",removeTicks:"removeTicks",removeAllTicks:"removeAllTicks"})},a.Line.prototype=new h,a.extend(a.Line.prototype,{hasPoint:function(a,d){var e,h,j,k,l,m,n,o,p=[],q=[1,a,d],r=i.evaluate(this.visProp.strokewidth);return o=this.board.options.precision.hasPoint+.5*r,p[0]=this.stdform[0]-this.stdform[1]*this.board.origin.scrCoords[1]/this.board.unitX+this.stdform[2]*this.board.origin.scrCoords[2]/this.board.unitY,p[1]=this.stdform[1]/this.board.unitX,p[2]=this.stdform[2]/-this.board.unitY,e=c.distPointLine(q,p),!(isNaN(e)||e>o)&&(!(!i.evaluate(this.visProp.straightfirst)||!i.evaluate(this.visProp.straightlast))||(j=this.point1.coords,k=this.point2.coords,h=[0,p[1],p[2]],h=b.crossProduct(h,q),h=b.crossProduct(h,p),h[1]/=h[0],h[2]/=h[0],h[0]=1,h=new g(f.COORDS_BY_SCREEN,h.slice(1),this.board).usrCoords,l=j.distance(f.COORDS_BY_USER,k),j=j.usrCoords.slice(0),k=k.usrCoords.slice(0),l<b.eps?m=0:(l===Number.POSITIVE_INFINITY&&(l=1/b.eps,Math.abs(k[0])<b.eps?(l/=c.distance([0,0,0],k),k=[1,j[1]+k[1]*l,j[2]+k[2]*l]):(l/=c.distance([0,0,0],j),j=[1,k[1]+j[1]*l,k[2]+j[2]*l])),n=1,l=k[n]-j[n],Math.abs(l)<b.eps&&(n=2,l=k[n]-j[n]),m=(h[n]-j[n])/l),!(!i.evaluate(this.visProp.straightfirst)&&m<0)&&!(!i.evaluate(this.visProp.straightlast)&&m>1)))},update:function(){var a;return this.needsUpdate?(this.constrained&&(i.isFunction(this.funps)?(a=this.funps(),a&&a.length&&2===a.length&&(this.point1=a[0],this.point2=a[1])):(i.isFunction(this.funp1)&&(a=this.funp1(),i.isPoint(a)?this.point1=a:a&&a.length&&2===a.length&&this.point1.setPositionDirectly(f.COORDS_BY_USER,a)),i.isFunction(this.funp2)&&(a=this.funp2(),i.isPoint(a)?this.point2=a:a&&a.length&&2===a.length&&this.point2.setPositionDirectly(f.COORDS_BY_USER,a)))),this.updateSegmentFixedLength(),this.updateStdform(),i.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateSegmentFixedLength:function(){var a,c,d,e,g,h,j,k;return this.hasFixedLength?(a=this.point1.Dist(this.point2),c=this.fixedLength(),d=this.fixedLengthOldCoords[0].distance(f.COORDS_BY_USER,this.point1.coords),e=this.fixedLengthOldCoords[1].distance(f.COORDS_BY_USER,this.point2.coords),(d>b.eps||e>b.eps||a!==c)&&(g=this.point1.isDraggable&&this.point1.type!==f.OBJECT_TYPE_GLIDER&&!i.evaluate(this.point1.visProp.fixed),h=this.point2.isDraggable&&this.point2.type!==f.OBJECT_TYPE_GLIDER&&!i.evaluate(this.point2.visProp.fixed),a>b.eps?d>e&&h||d<=e&&h&&!g?(this.point2.setPositionDirectly(f.COORDS_BY_USER,[this.point1.X()+(this.point2.X()-this.point1.X())*c/a,this.point1.Y()+(this.point2.Y()-this.point1.Y())*c/a]),this.point2.fullUpdate()):(d<=e&&g||d>e&&g&&!h)&&(this.point1.setPositionDirectly(f.COORDS_BY_USER,[this.point2.X()+(this.point1.X()-this.point2.X())*c/a,this.point2.Y()+(this.point1.Y()-this.point2.Y())*c/a]),this.point1.fullUpdate()):(j=Math.random()-.5,k=Math.random()-.5,a=Math.sqrt(j*j+k*k),h?(this.point2.setPositionDirectly(f.COORDS_BY_USER,[this.point1.X()+j*c/a,this.point1.Y()+k*c/a]),this.point2.fullUpdate()):g&&(this.point1.setPositionDirectly(f.COORDS_BY_USER,[this.point2.X()+j*c/a,this.point2.Y()+k*c/a]),this.point1.fullUpdate())),this.fixedLengthOldCoords[0].setCoordinates(f.COORDS_BY_USER,this.point1.coords.usrCoords),this.fixedLengthOldCoords[1].setCoordinates(f.COORDS_BY_USER,this.point2.coords.usrCoords)),this):this},updateStdform:function(){var a=b.crossProduct(this.point1.coords.usrCoords,this.point2.coords.usrCoords);this.stdform[0]=a[0],this.stdform[1]=a[1],this.stdform[2]=a[2],this.stdform[3]=0,this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.point1.coords.usrCoords[1]+this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[1]+this.point2.coords.usrCoords[2])&&b.innerProduct(this.stdform,this.stdform,3)>=b.eps*b.eps,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateLine(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},generatePolynomial:function(a){var b=this.point1.symbolic.x,c=this.point1.symbolic.y,d=this.point2.symbolic.x,e=this.point2.symbolic.y,f=a.symbolic.x,g=a.symbolic.y;return[["(",c,")*(",f,")-(",c,")*(",d,")+(",g,")*(",d,")-(",b,")*(",g,")+(",b,")*(",e,")-(",f,")*(",e,")"].join("")]},getRise:function(){return Math.abs(this.stdform[2])>=b.eps?-this.stdform[0]/this.stdform[2]:1/0},getSlope:function(){return Math.abs(this.stdform[2])>=b.eps?-this.stdform[1]/this.stdform[2]:1/0},getAngle:function(){return Math.atan2(-this.stdform[1],this.stdform[2])},setStraight:function(a,b){return this.visProp.straightfirst=a,this.visProp.straightlast=b,this.board.renderer.updateLine(this),this},getTextAnchor:function(){return new g(f.COORDS_BY_USER,[.5*(this.point2.X()+this.point1.X()),.5*(this.point2.Y()+this.point1.Y())],this.board)},setLabelRelativeCoords:function(a){i.exists(this.label)&&(this.label.relativeCoords=new g(f.COORDS_BY_SCREEN,[a[0],-a[1]],this.board))},getLabelAnchor:function(){var a,d,e=0,h=new g(f.COORDS_BY_USER,this.point1.coords.usrCoords,this.board),j=new g(f.COORDS_BY_USER,this.point2.coords.usrCoords,this.board),k=i.evaluate(this.visProp.straightfirst),l=i.evaluate(this.visProp.straightlast);if((k||l)&&c.calcStraight(this,h,j,0),h=h.scrCoords,j=j.scrCoords,!i.exists(this.label))return new g(f.COORDS_BY_SCREEN,[NaN,NaN],this.board);switch(i.evaluate(this.label.visProp.position)){case"lft":case"llft":case"ulft":h[1]<=j[1]?(a=h[1],d=h[2]):(a=j[1],d=j[2]);break;case"rt":case"lrt":case"urt":h[1]>j[1]?(a=h[1],d=h[2]):(a=j[1],d=j[2]);break;default:a=.5*(h[1]+j[1]),d=.5*(h[2]+j[2])}return(k||l)&&(i.exists(this.label)&&(e=i.evaluate(this.label.visProp.fontsize)),Math.abs(a)<b.eps?a=e+0:this.board.canvasWidth+b.eps>a&&a>this.board.canvasWidth-e-b.eps&&(a=this.board.canvasWidth-e),b.eps+e>d&&d>-b.eps?d=e:this.board.canvasHeight+b.eps>d&&d>this.board.canvasHeight-e-b.eps&&(d=this.board.canvasHeight-e)),new g(f.COORDS_BY_SCREEN,[a,d],this.board)},cloneToBackground:function(){var a,b,c,d={};return d.id=this.id+"T"+this.numTraces,d.elementClass=f.OBJECT_CLASS_LINE,this.numTraces++,d.point1=this.point1,d.point2=this.point2,d.stdform=this.stdform,d.board=this.board,d.visProp=i.deepCopy(this.visProp,this.visProp.traceattributes,!0),d.visProp.layer=this.board.options.layer.trace,i.clearVisPropOld(d),d.visPropCalc={visible:i.evaluate(d.visProp.visible)},b=this.getSlope(),a=this.getRise(),d.getSlope=function(){return b},d.getRise=function(){return a},c=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawLine(d),this.board.renderer.enhancedRendering=c,this.traces[d.id]=d.rendNode,this},addTransform:function(a){var b,c=i.isArray(a)?a:[a],d=c.length;for(b=0;b<d;b++)this.point1.transformations.push(c[b]),this.point2.transformations.push(c[b]);return this},snapToGrid:function(a){var b,d,h,j,k,l,m,n,o;return i.evaluate(this.visProp.snaptogrid)?this.parents.length<3?(this.point1.handleSnapToGrid(!0,!0),this.point2.handleSnapToGrid(!0,!0)):i.exists(a)&&(n=i.evaluate(this.visProp.snapsizex),o=i.evaluate(this.visProp.snapsizey),b=new g(f.COORDS_BY_SCREEN,[a.Xprev,a.Yprev],this.board),l=b.usrCoords[1],m=b.usrCoords[2],n<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(k=this.board.defaultAxes.x.defaultTicks,n=k.ticksDelta*(i.evaluate(k.visProp.minorticks)+1)),o<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(k=this.board.defaultAxes.y.defaultTicks,o=k.ticksDelta*(i.evaluate(k.visProp.minorticks)+1)),n>0&&o>0&&(d=c.projectPointToLine({coords:b},this,this.board),h=e.subtract([1,Math.round(l/n)*n,Math.round(m/o)*o],d.usrCoords),j=this.board.create("transform",h.slice(1),{type:"translate"}),j.applyOnce([this.point1,this.point2]))):(this.point1.handleSnapToGrid(!1,!0),this.point2.handleSnapToGrid(!1,!0)),this},snapToPoints:function(){var a=i.evaluate(this.visProp.snaptopoints);return this.parents.length<3&&(this.point1.handleSnapToPoints(a),this.point2.handleSnapToPoints(a)),this},X:function(a){var c,d=this.stdform[2];return c=Math.abs(this.point1.coords.usrCoords[0])>b.eps?this.point1.coords.usrCoords[1]:this.point2.coords.usrCoords[1],a=2*(a-.5),(1-Math.abs(a))*c-a*d},Y:function(a){var c,d=this.stdform[1];return c=Math.abs(this.point1.coords.usrCoords[0])>b.eps?this.point1.coords.usrCoords[2]:this.point2.coords.usrCoords[2],a=2*(a-.5),(1-Math.abs(a))*c+a*d},Z:function(a){var c=Math.abs(this.point1.coords.usrCoords[0])>b.eps?this.point1.coords.usrCoords[0]:this.point2.coords.usrCoords[0];return a=2*(a-.5),(1-Math.abs(a))*c},L:function(){return this.point1.Dist(this.point2)},minX:function(){return 0},maxX:function(){return 1},bounds:function(){var a=this.point1.coords.usrCoords,b=this.point2.coords.usrCoords;return[Math.min(a[1],b[1]),Math.max(a[2],b[2]),Math.max(a[1],b[1]),Math.min(a[2],b[2])]},addTicks:function(a){return""!==a.id&&i.exists(a.id)||(a.id=this.id+"_ticks_"+(this.ticks.length+1)),this.board.renderer.drawTicks(a),this.ticks.push(a),a.id},remove:function(){this.removeAllTicks(),h.prototype.remove.call(this)},removeAllTicks:function(){var a;for(a=this.ticks.length;a>0;a--)this.removeTicks(this.ticks[a-1]);this.ticks=[],this.board.update()},removeTicks:function(a){var b,c;for(i.exists(this.defaultTicks)&&this.defaultTicks===a&&(this.defaultTicks=null),b=this.ticks.length;b>0;b--)if(this.ticks[b-1]===a){if(this.board.removeObject(this.ticks[b-1]),this.ticks[b-1].ticks)for(c=0;c<this.ticks[b-1].ticks.length;c++)i.exists(this.ticks[b-1].labels[c])&&this.board.removeObject(this.ticks[b-1].labels[c]);delete this.ticks[b-1];break}}}),a.createLine=function(b,c,d){var e,f,g,h,k,l,m,n=[],o=!1,p=!1;if(2===c.length){if(i.isArray(c[0])&&c[0].length>1)l=i.copyAttributes(d,b.options,"line","point1"),g=b.create("point",c[0],l);else if(i.isString(c[0])||i.isPoint(c[0]))g=b.select(c[0]);else if(i.isFunction(c[0])&&i.isPoint(c[0]()))g=c[0](),p=!0;else if(i.isFunction(c[0])&&c[0]().length&&c[0]().length>=2)l=i.copyAttributes(d,b.options,"line","point1"),g=j.createPoint(b,c[0](),l),p=!0;else{if(!i.isObject(c[0])||!i.isTransformationOrArray(c[1]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");o=!0,l=i.copyAttributes(d,b.options,"line","point1"),g=b.create("point",[c[0].point1,c[1]],l)}if(o)l=i.copyAttributes(d,b.options,"line","point2"),h=b.create("point",[c[0].point2,c[1]],l);else if(i.isArray(c[1])&&c[1].length>1)l=i.copyAttributes(d,b.options,"line","point2"),h=b.create("point",c[1],l);else if(i.isString(c[1])||i.isPoint(c[1]))h=b.select(c[1]);else if(i.isFunction(c[1])&&i.isPoint(c[1]()))h=c[1](),p=!0;else{if(!(i.isFunction(c[1])&&c[1]().length&&c[1]().length>=2))throw new Error("JSXGraph: Can't create line with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");l=i.copyAttributes(d,b.options,"line","point2"),h=j.createPoint(b,c[1](),l),p=!0}l=i.copyAttributes(d,b.options,"line"),f=new a.Line(b,g,h,l),p?(f.constrained=!0,f.funp1=c[0],f.funp2=c[1]):o||(f.isDraggable=!0),f.setParents([g.id,h.id])}else if(3===c.length){for(m=!0,k=0;k<3;k++)if(i.isNumber(c[k]))n[k]=i.createFunction(c[k]);else{if(!i.isFunction(c[k]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"' and '"+typeof c[2]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");n[k]=c[k],m=!1}l=i.copyAttributes(d,b.options,"line","point1"),g=m?b.create("point",[n[2]()*n[2]()+n[1]()*n[1](),n[2]()-n[1]()*n[0]()+n[2](),-n[1]()-n[2]()*n[0]()-n[1]()],l):b.create("point",[function(){return.5*(n[2]()*n[2]()+n[1]()*n[1]())},function(){return.5*(n[2]()-n[1]()*n[0]()+n[2]())},function(){return.5*(-n[1]()-n[2]()*n[0]()-n[1]())}],l),l=i.copyAttributes(d,b.options,"line","point2"),h=m?b.create("point",[n[2]()*n[2]()+n[1]()*n[1](),-n[1]()*n[0]()+n[2](),-n[2]()*n[0]()-n[1]()],l):b.create("point",[function(){
return n[2]()*n[2]()+n[1]()*n[1]()},function(){return-n[1]()*n[0]()+n[2]()},function(){return-n[2]()*n[0]()-n[1]()}],l),g.prepareUpdate().update(),h.prepareUpdate().update(),l=i.copyAttributes(d,b.options,"line"),f=new a.Line(b,g,h,l),f.isDraggable=m,f.setParents([g,h])}else if(1===c.length&&i.isFunction(c[0])&&2===c[0]().length&&i.isPoint(c[0]()[0])&&i.isPoint(c[0]()[1]))e=c[0](),l=i.copyAttributes(d,b.options,"line"),f=new a.Line(b,e[0],e[1],l),f.constrained=!0,f.funps=c[0],f.setParents(e);else{if(!(1===c.length&&i.isFunction(c[0])&&3===c[0]().length&&i.isNumber(c[0]()[0])&&i.isNumber(c[0]()[1])&&i.isNumber(c[0]()[2])))throw new Error("JSXGraph: Can't create line with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");e=c[0],l=i.copyAttributes(d,b.options,"line","point1"),g=b.create("point",[function(){var a=e();return[.5*(a[2]*a[2]+a[1]*a[1]),.5*(a[2]-a[1]*a[0]+a[2]),.5*(-a[1]-a[2]*a[0]-a[1])]}],l),l=i.copyAttributes(d,b.options,"line","point2"),h=b.create("point",[function(){var a=e();return[a[2]*a[2]+a[1]*a[1],-a[1]*a[0]+a[2],-a[2]*a[0]-a[1]]}],l),l=i.copyAttributes(d,b.options,"line"),f=new a.Line(b,g,h,l),f.constrained=!0,f.funps=c[0],f.setParents([g,h])}return f},a.registerElement("line",a.createLine),a.createSegment=function(a,b,c){var d,e;if(c.straightFirst=!1,c.straightLast=!1,e=i.copyAttributes(c,a.options,"segment"),d=a.create("line",b.slice(0,2),e),3===b.length){if(d.hasFixedLength=!0,i.isNumber(b[2]))d.fixedLength=function(){return b[2]};else{if(!i.isFunction(b[2]))throw new Error("JSXGraph: Can't create segment with third parent type '"+typeof b[2]+"'.\nPossible third parent types: number or function");d.fixedLength=b[2]}d.getParents=function(){return this.parents.concat(this.fixedLength())},d.fixedLengthOldCoords=[],d.fixedLengthOldCoords[0]=new g(f.COORDS_BY_USER,d.point1.coords.usrCoords.slice(1,3),a),d.fixedLengthOldCoords[1]=new g(f.COORDS_BY_USER,d.point2.coords.usrCoords.slice(1,3),a)}return d.elType="segment",d},a.registerElement("segment",a.createSegment),a.createArrow=function(a,b,c){var d;return c.firstArrow=!1,c.lastArrow=!0,d=a.create("line",b,c).setStraight(!1,!1),d.type=f.OBJECT_TYPE_VECTOR,d.elType="arrow",d},a.registerElement("arrow",a.createArrow),a.createAxis=function(a,b,c){var d,e,g,h,j;if(!i.isArray(b[0])&&!i.isPoint(b[0])||!i.isArray(b[1])&&!i.isPoint(b[1]))throw new Error("JSXGraph: Can't create axis with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");d=i.copyAttributes(c,a.options,"axis"),g=a.create("line",b,d),g.type=f.OBJECT_TYPE_AXIS,g.isDraggable=!1,g.point1.isDraggable=!1,g.point2.isDraggable=!1;for(h in g.ancestors)g.ancestors.hasOwnProperty(h)&&(g.ancestors[h].type=f.OBJECT_TYPE_AXISPOINT);return e=i.copyAttributes(c,a.options,"axis","ticks"),j=i.exists(e.ticksdistance)?e.ticksdistance:i.isArray(e.ticks)?e.ticks:1,g.defaultTicks=a.create("ticks",[g,j],e),g.defaultTicks.dump=!1,g.elType="axis",g.subs={ticks:g.defaultTicks},g.inherits.push(g.defaultTicks),g},a.registerElement("axis",a.createAxis),a.createTangent=function(a,c,e){var g,h,j,k,l,m,n;if(1===c.length)g=c[0],h=g.slideObject;else{if(2!==c.length)throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [glider], [point,line|curve|circle|conic]");if(i.isPoint(c[0]))g=c[0],h=c[1];else{if(!i.isPoint(c[1]))throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [glider], [point,line|curve|circle|conic]");h=c[0],g=c[1]}}if(h.elementClass===f.OBJECT_CLASS_LINE?(n=a.create("line",[h.point1,h.point2],e),n.glider=g):h.elementClass===f.OBJECT_CLASS_CURVE&&h.type!==f.OBJECT_TYPE_CONIC?"plot"!==i.evaluate(h.visProp.curvetype)?(j=h.X,k=h.Y,n=a.create("line",[function(){return-g.X()*d.D(k)(g.position)+g.Y()*d.D(j)(g.position)},function(){return d.D(k)(g.position)},function(){return-d.D(j)(g.position)}],e),g.addChild(n),n.glider=g):(n=a.create("line",[function(){var a,b,c=Math.floor(g.position);return c===h.numberPoints-1&&c--,c<0?1:(a=h.points[c].usrCoords,b=h.points[c+1].usrCoords,a[2]*b[1]-a[1]*b[2])},function(){var a,b,c=Math.floor(g.position);return c===h.numberPoints-1&&c--,c<0?0:(a=h.points[c].usrCoords,b=h.points[c+1].usrCoords,b[2]-a[2])},function(){var a,b,c=Math.floor(g.position);return c===h.numberPoints-1&&c--,c<0?0:(a=h.points[c].usrCoords,b=h.points[c+1].usrCoords,a[1]-b[1])}],e),g.addChild(n),n.glider=g):h.type===f.OBJECT_TYPE_TURTLE?(n=a.create("line",[function(){var a=Math.floor(g.position);for(l=0;l<h.objects.length;l++)if(m=h.objects[l],m.type===f.OBJECT_TYPE_CURVE){if(a<m.numberPoints)break;a-=m.numberPoints}return a===m.numberPoints-1&&a--,a<0?1:m.Y(a)*m.X(a+1)-m.X(a)*m.Y(a+1)},function(){var a=Math.floor(g.position);for(l=0;l<h.objects.length;l++)if(m=h.objects[l],m.type===f.OBJECT_TYPE_CURVE){if(a<m.numberPoints)break;a-=m.numberPoints}return a===m.numberPoints-1&&a--,a<0?0:m.Y(a+1)-m.Y(a)},function(){var a=Math.floor(g.position);for(l=0;l<h.objects.length;l++)if(m=h.objects[l],m.type===f.OBJECT_TYPE_CURVE){if(a<m.numberPoints)break;a-=m.numberPoints}return a===m.numberPoints-1&&a--,a<0?0:m.X(a)-m.X(a+1)}],e),g.addChild(n),n.glider=g):h.elementClass!==f.OBJECT_CLASS_CIRCLE&&h.type!==f.OBJECT_TYPE_CONIC||(n=a.create("line",[function(){return b.matVecMult(h.quadraticform,g.coords.usrCoords)[0]},function(){return b.matVecMult(h.quadraticform,g.coords.usrCoords)[1]},function(){return b.matVecMult(h.quadraticform,g.coords.usrCoords)[2]}],e),g.addChild(n),n.glider=g),!i.exists(n))throw new Error("JSXGraph: Couldn't create tangent with the given parents.");return n.elType="tangent",n.type=f.OBJECT_TYPE_TANGENT,n.setParents(c),n},a.createRadicalAxis=function(a,c,d){var e,g,h;if(2!==c.length||c[0].elementClass!==f.OBJECT_CLASS_CIRCLE||c[1].elementClass!==f.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'radical axis' with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent type: [circle,circle]");return g=a.select(c[0]),h=a.select(c[1]),e=a.create("line",[function(){var a=g.stdform,c=h.stdform;return b.matVecMult(b.transpose([a.slice(0,3),c.slice(0,3)]),[c[3],-a[3]])}],d),e.elType="radicalaxis",e.setParents([g.id,h.id]),g.addChild(e),h.addChild(e),e},a.createPolarLine=function(a,b,c){var d,e,g,h,j,k,l;if(b.length>1&&(h=b[0].type===f.OBJECT_TYPE_CONIC||b[0].elementClass===f.OBJECT_CLASS_CIRCLE,j=b[1].type===f.OBJECT_TYPE_CONIC||b[1].elementClass===f.OBJECT_CLASS_CIRCLE,k=i.isPoint(b[0]),l=i.isPoint(b[1])),2!==b.length||!(h&&l||k&&j))throw new Error("JSXGraph: Can't create 'polar line' with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent type: [conic|circle,point], [point,conic|circle]");return l?(e=a.select(b[0]),g=a.select(b[1])):(e=a.select(b[1]),g=a.select(b[0])),d=a.create("tangent",[e,g],c),d.elType="polarline",d},a.registerElement("tangent",a.createTangent),a.registerElement("polar",a.createTangent),a.registerElement("radicalaxis",a.createRadicalAxis),a.registerElement("polarline",a.createPolarLine),{Line:a.Line,createLine:a.createLine,createTangent:a.createTangent,createPolar:a.createTangent,createSegment:a.createSegment,createAxis:a.createAxis,createArrow:a.createArrow,createRadicalAxis:a.createRadicalAxis,createPolarLine:a.createPolarLine}}),define("base/curve",["jxg","base/constants","base/coords","base/element","math/math","math/statistics","math/numerics","math/geometry","parser/geonext","utils/type","base/transformation","math/qdt"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";return a.Curve=function(a,c,d){this.constructor(a,d,b.OBJECT_TYPE_CURVE,b.OBJECT_CLASS_CURVE),this.points=[],this.numberPoints=j.evaluate(this.visProp.numberpointshigh),this.bezierDegree=1,this.dataX=null,this.dataY=null,this.qdt=null,j.exists(c[0])?this.varname=c[0]:this.varname="x",this.xterm=c[1],this.yterm=c[2],this.generateTerm(this.varname,this.xterm,this.yterm,c[3],c[4]),this.updateCurve(),this.id=this.board.setId(this,"G"),this.board.renderer.drawCurve(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="curve",this.createLabel(),j.isString(this.xterm)&&this.notifyParents(this.xterm),j.isString(this.yterm)&&this.notifyParents(this.yterm),this.methodMap=j.deepCopy(this.methodMap,{generateTerm:"generateTerm",setTerm:"generateTerm",move:"moveTo",moveTo:"moveTo"})},a.Curve.prototype=new d,a.extend(a.Curve.prototype,{minX:function(){var a;return"polar"===j.evaluate(this.visProp.curvetype)?0:(a=new c(b.COORDS_BY_SCREEN,[0,0],this.board,(!1)),a.usrCoords[1])},maxX:function(){var a;return"polar"===j.evaluate(this.visProp.curvetype)?2*Math.PI:(a=new c(b.COORDS_BY_SCREEN,[this.board.canvasWidth,0],this.board,(!1)),a.usrCoords[1])},X:function(a){return NaN},Y:function(a){return NaN},Z:function(a){return 1},hasPoint:function(a,d,f){var g,i,k,l,m,n,o,p,q,r,s,t,u,v=[],w=j.evaluate(this.visProp.numberpointslow),x=(this.maxX()-this.minX())/w,y=this.board.options.precision.hasPoint,z=1/0,A=!0;if(i=new c(b.COORDS_BY_SCREEN,[a,d],this.board,(!1)),a=i.usrCoords[1],d=i.usrCoords[2],y+=.5*j.evaluate(this.visProp.strokewidth),y*=y,s=this.board.unitX*this.board.unitX,t=this.board.unitY*this.board.unitY,u=j.evaluate(this.visProp.curvetype),"parameter"===u||"polar"===u)for(this.transformations.length>0&&(this.updateTransformMatrix(),l=e.inverse(this.transformMat),m=e.matVecMult(l,[1,a,d]),a=m[1],d=m[2]),n=0,g=this.minX();n<w;n++){if(o=this.X(g,A),p=this.Y(g,A),z=(a-o)*(a-o)*s+(d-p)*(d-p)*t,z<=y)return!0;g+=x}else if("plot"===u||"functiongraph"===u){for((!j.exists(f)||f<0)&&(f=0),j.exists(this.qdt)&&j.evaluate(this.visProp.useqdt)&&3!==this.bezierDegree?(r=this.qdt.query(new c(b.COORDS_BY_USER,[a,d],this.board)),q=r.points,k=q.length):(q=this.points,k=this.numberPoints-1),n=f;n<k;n++)if(3===this.bezierDegree?v.push(h.projectCoordsToBeziersegment([1,a,d],this,n)):r?(q[n].prev&&(v=h.projectCoordsToSegment([1,a,d],q[n].prev.usrCoords,q[n].usrCoords)),q[n].next&&q[n+1]!==q[n].next&&(v=h.projectCoordsToSegment([1,a,d],q[n].usrCoords,q[n].next.usrCoords))):v=h.projectCoordsToSegment([1,a,d],q[n].usrCoords,q[n+1].usrCoords),v[1]>=0&&v[1]<=1&&(a-v[0][1])*(a-v[0][1])*s+(d-v[0][2])*(d-v[0][2])*t<=y)return!0;return!1}return z<y},allocatePoints:function(){var a,d;if(d=this.numberPoints,this.points.length<this.numberPoints)for(a=this.points.length;a<d;a++)this.points[a]=new c(b.COORDS_BY_USER,[0,0],this.board,(!1))},update:function(){return this.needsUpdate&&(j.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this.updateCurve()),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.checkReal(),this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateCurve(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateDataArray:function(){},updateCurve:function(){var a,c,d,e,f,h,i=!1;if(this.updateTransformMatrix(),this.updateDataArray(),c=this.minX(),d=this.maxX(),j.exists(this.dataX))for(this.numberPoints=this.dataX.length,a=this.numberPoints,this.allocatePoints(),h=0;h<a;h++)e=h,j.exists(this.dataY)?(f=h,this.points[h].setCoordinates(b.COORDS_BY_USER,[this.dataX[h],this.dataY[h]],!1)):(f=this.X(e),this.points[h].setCoordinates(b.COORDS_BY_USER,[this.dataX[h],this.Y(f,i)],!1)),this.points[h]._t=h,this.updateTransform(this.points[h]),i=!0;else{if(j.evaluate(this.visProp.doadvancedplot)?this.updateParametricCurve(c,d):j.evaluate(this.visProp.doadvancedplotold)?this.updateParametricCurveOld(c,d):(this.board.updateQuality===this.board.BOARD_QUALITY_HIGH?this.numberPoints=j.evaluate(this.visProp.numberpointshigh):this.numberPoints=j.evaluate(this.visProp.numberpointslow),this.allocatePoints(),this.updateParametricCurveNaive(c,d,this.numberPoints)),a=this.numberPoints,j.evaluate(this.visProp.useqdt)&&this.board.updateQuality===this.board.BOARD_QUALITY_HIGH)for(this.qdt=new l(this.board.getBoundingBox()),h=0;h<this.points.length;h++)this.qdt.insert(this.points[h]),h>0&&(this.points[h].prev=this.points[h-1]),h<a-1&&(this.points[h].next=this.points[h+1]);for(h=0;h<a;h++)this.updateTransform(this.points[h])}return"plot"!==j.evaluate(this.visProp.curvetype)&&j.evaluate(this.visProp.rdpsmoothing)&&(this.points=g.RamerDouglasPeucker(this.points,.2),this.numberPoints=this.points.length),this},updateTransformMatrix:function(){var a,b,c=this.transformations.length;for(this.transformMat=[[1,0,0],[0,1,0],[0,0,1]],b=0;b<c;b++)a=this.transformations[b],a.update(),this.transformMat=e.matMatMult(a.matrix,this.transformMat);return this},checkReal:function(){var a,b,c=!1,d=this.numberPoints;for(a=0;a<d;a++)if(b=this.points[a].usrCoords,!isNaN(b[1])&&!isNaN(b[2])&&Math.abs(b[0])>e.eps){c=!0;break}this.isReal=c},updateParametricCurveNaive:function(a,c,d){var e,f,g=!1,h=(c-a)/d;for(e=0;e<d;e++)f=a+e*h,this.points[e].setCoordinates(b.COORDS_BY_USER,[this.X(f,g),this.Y(f,g)],!1),this.points[e]._t=f,g=!0;return this},updateParametricCurveOld:function(d,f){var g,h,i,j,k,l,m,n,o,p,q,r,s=!1,t=new c(b.COORDS_BY_USER,[0,0],this.board,(!1)),u=[],v=[],w=[],x=[],y=!1,z=0,A=function(a,b,c){var d,f,g=c[1]-a[1],h=c[2]-a[2],i=b[0]-a[1],j=b[1]-a[2],k=i*i+j*j;return k>=e.eps&&(d=(g*i+h*j)/k,d>0&&(d<=1?(g-=d*i,h-=d*j):(g-=i,h-=j))),f=g*g+h*h,Math.sqrt(f)};for(a.deprecated("Curve.updateParametricCurveOld()"),this.board.updateQuality===this.board.BOARD_QUALITY_LOW?(p=15,q=10,r=10):(p=21,q=.7,r=.7),x[0]=f-d,g=1;g<p;g++)x[g]=.5*x[g-1];g=1,u[0]=1,v[0]=0,h=d,t.setCoordinates(b.COORDS_BY_USER,[this.X(h,s),this.Y(h,s)],!1),s=!0,l=t.scrCoords[1],m=t.scrCoords[2],t0=h,h=f,t.setCoordinates(b.COORDS_BY_USER,[this.X(h,s),this.Y(h,s)],!1),j=t.scrCoords[1],k=t.scrCoords[2],w[0]=[j,k],n=1,o=0,this.points=[],this.points[z++]=new c(b.COORDS_BY_SCREEN,[l,m],this.board,(!1));do{for(y=this.isDistOK(j-l,k-m,q,r)||this.isSegmentOutside(l,m,j,k);o<p&&(!y||o<6)&&(o<=7||this.isSegmentDefined(l,m,j,k));)u[n]=g,v[n]=o,w[n]=[j,k],n+=1,g=2*g-1,o++,h=d+g*x[o],t.setCoordinates(b.COORDS_BY_USER,[this.X(h,s),this.Y(h,s)],!1,!0),j=t.scrCoords[1],k=t.scrCoords[2],y=this.isDistOK(j-l,k-m,q,r)||this.isSegmentOutside(l,m,j,k);z>1&&(i=A(this.points[z-2].scrCoords,[j,k],this.points[z-1].scrCoords),i<.015&&(z-=1)),this.points[z]=new c(b.COORDS_BY_SCREEN,[j,k],this.board,(!1)),this.points[z]._t=h,z+=1,l=j,m=k,t0=h,n-=1,j=w[n][0],k=w[n][1],o=v[n]+1,g=2*u[n]}while(n>0&&z<5e5);return this.numberPoints=this.points.length,this},isSegmentOutside:function(a,b,c,d){return b<0&&d<0||b>this.board.canvasHeight&&d>this.board.canvasHeight||a<0&&c<0||a>this.board.canvasWidth&&c>this.board.canvasWidth},isDistOK:function(a,b,c,d){return Math.abs(a)<c&&Math.abs(b)<d&&!isNaN(a+b)},isSegmentDefined:function(a,b,c,d){return!(isNaN(a+b)&&isNaN(c+d))},_insertPoint:function(a,b){var c=!isNaN(this._lastCrds[1]+this._lastCrds[2]),d=!isNaN(a.scrCoords[1]+a.scrCoords[2]),e=this.board.canvasWidth,f=this.board.canvasHeight,g=500;d=d&&a.scrCoords[1]>-g&&a.scrCoords[2]>-g&&a.scrCoords[1]<e+g&&a.scrCoords[2]<f+g,(!d&&c||d&&(!c||Math.abs(a.scrCoords[1]-this._lastCrds[1])>.7||Math.abs(a.scrCoords[2]-this._lastCrds[2])>.7))&&(a._t=b,this.points.push(a),this._lastCrds=a.copy("scrCoords"))},_intersectWithBorder:function(a,b,c){var d,f,g,h;return c<=0?(d=[-b[0],1,0],f=e.crossProduct(d,a),0!==f[0]?(g=f[1]/f[0],h=f[2]/f[0]):h=1/0,h<b[3]?(d=[-b[3],0,1],f=e.crossProduct(d,a),0!==f[0]?(g=f[1]/f[0],h=f[2]/f[0]):g=1/0):h>b[1]&&(d=[-b[1],0,1],f=e.crossProduct(d,a),0!==f[0]?(g=f[1]/f[0],h=f[2]/f[0]):g=1/0)):(d=[-b[2],1,0],f=e.crossProduct(d,a),0!==f[0]?(g=f[1]/f[0],h=f[2]/f[0]):h=1/0,h<b[3]?(d=[-b[3],0,1],f=e.crossProduct(d,a),0!==f[0]?(g=f[1]/f[0],h=f[2]/f[0]):g=1/0):h>b[1]&&(d=[-b[1],0,1],f=e.crossProduct(d,a),0!==f[0]?(g=f[1]/f[0],h=f[2]/f[0]):g=1/0)),[1,g,h]},_borderCase:function(a,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=null,z=30,A=!1;if(i<=1){k=new c(b.COORDS_BY_USER,[0,0],this.board,(!1)),m=0;do{if(isNaN(a[1]+a[2])&&!isNaN(e[1]+e[2]))n=f,o=h,p=g;else if(isNaN(d[1]+d[2])&&!isNaN(e[1]+e[2]))n=g,o=h,p=f;else if(isNaN(e[1]+e[2])&&!isNaN(d[1]+d[2]))n=h,o=g,p=g+(g-h);else{if(!isNaN(e[1]+e[2])||isNaN(a[1]+a[2]))return!1;n=h,o=f,p=f-(h-f)}j=.5*(n+o),k.setCoordinates(b.COORDS_BY_USER,[this.X(j,!0),this.Y(j,!0)],!1),l=k.usrCoords,A=isNaN(l[1]+l[2]),A?n=j:(p=o,o=j),++m}while(A&&m<z);if(m<z&&(y=l.slice(),e=l.slice(),o=j),r=this.X(o,!0),t=this.X(p,!0),v=(r-t)/(o-p),s=this.Y(o,!0),u=this.Y(p,!0),w=(s-u)/(o-p),q=this.board.getBoundingBox(),Math.sqrt(v*v+w*w)>500&&(x=[v*s-w*r,w,-v],y=this._intersectWithBorder(x,q,r-t)),null!==y)return this._insertPoint(new c(b.COORDS_BY_USER,y,this.board,(!1))),!0}return!1},_triangleDists:function(a,b,c){var d,e,f,g,i;return d=[a[0]*b[0],.5*(a[1]+b[1]),.5*(a[2]+b[2])],e=h.distance(a,b,3),f=h.distance(a,c,3),g=h.distance(c,b,3),i=h.distance(c,d,3),[e,f,g,i]},_isUndefined:function(a,d,e,f){var g,h,i;if(!isNaN(a[1]+a[2])||!isNaN(e[1]+e[2]))return!1;for(i=new c(b.COORDS_BY_USER,[0,0],this.board,(!1)),h=0;h<20;++h)if(g=d+Math.random()*(f-d),i.setCoordinates(b.COORDS_BY_USER,[this.X(g,!0),this.Y(g,!0)],!1),!isNaN(i.scrCoords[0]+i.scrCoords[1]+i.scrCoords[2]))return!1;return!0},_isOutside:function(a,b,c,d){var e=500,f=this.board.canvasWidth,g=this.board.canvasHeight;return!!(a[1]<-e&&c[1]<-e||a[2]<-e&&c[2]<-e||a[1]>f+e&&c[1]>f+e||a[2]>g+e&&c[2]>g+e)},_plotRecursive:function(a,d,e,f,g,h){var i,j,k,l,m,n,o=0,p=.5,q=new c(b.COORDS_BY_USER,[0,0],this.board,(!1));if(!(this.numberPoints>65536))return g<this.nanLevel&&this._isUndefined(a,d,e,f)?this:g<this.nanLevel&&this._isOutside(a,d,e,f)?this:(i=.5*(d+f),q.setCoordinates(b.COORDS_BY_USER,[this.X(i,!0),this.Y(i,!0)],!1),j=q.scrCoords,this._borderCase(a,e,j,d,f,i,g)?this:(k=this._triangleDists(a,e,j),l=g<this.smoothLevel&&k[3]<h,m=g<this.jumpLevel&&(k[2]>.99*k[0]||k[1]>.99*k[0]||k[0]===1/0||k[1]===1/0||k[2]===1/0),n=g<this.smoothLevel+2&&k[0]<p*(k[1]+k[2]),n&&(o=0,l=!1),--g,m?this._insertPoint(new c(b.COORDS_BY_SCREEN,[NaN,NaN],this.board,(!1)),i):g<=o||l?this._insertPoint(q,i):(this._plotRecursive(a,d,j,i,g,h),this._insertPoint(q,i),this._plotRecursive(j,i,e,f,g,h)),this))},updateParametricCurve:function(a,d){var e,f,g,h,i,k,l=!1,m=new c(b.COORDS_BY_USER,[0,0],this.board,(!1)),n=new c(b.COORDS_BY_USER,[0,0],this.board,(!1));return this.board.updateQuality===this.board.BOARD_QUALITY_LOW?(i=j.evaluate(this.visProp.recursiondepthlow)||13,k=2,this.smoothLevel=5,this.jumpLevel=5):(i=j.evaluate(this.visProp.recursiondepthhigh)||17,k=2,this.smoothLevel=3,this.jumpLevel=3),this.nanLevel=i-4,this.points=[],e=a,m.setCoordinates(b.COORDS_BY_USER,[this.X(e,l),this.Y(e,l)],!1),g=m.copy("scrCoords"),l=!0,f=d,n.setCoordinates(b.COORDS_BY_USER,[this.X(f,l),this.Y(f,l)],!1),h=n.copy("scrCoords"),m._t=e,this.points.push(m),this._lastCrds=m.copy("scrCoords"),this._plotRecursive(g,e,h,f,i,k),n._t=f,this.points.push(n),this.numberPoints=this.points.length,this},updateTransform:function(a){var c,d=this.transformations.length;return d>0&&(c=e.matVecMult(this.transformMat,a.usrCoords),a.setCoordinates(b.COORDS_BY_USER,[c[1],c[2]],!1,!0)),a},addTransform:function(a){var b,c=j.isArray(a)?a:[a],d=c.length;for(b=0;b<d;b++)this.transformations.push(c[b]);return this},interpolationFunctionFromArray:function(a){var b="data"+a;return function(a,c){var d,e,f,g,h=this[b],i=h.length,k=[];if(isNaN(a))return NaN;if(a<0)return j.isFunction(h[0])?h[0]():h[0];if(3===this.bezierDegree){if(i/=3,a>=i)return j.isFunction(h[h.length-1])?h[h.length-1]():h[h.length-1];for(d=3*Math.floor(a),f=a%1,g=1-f,e=0;e<4;e++)j.isFunction(h[d+e])?k[e]=h[d+e]():k[e]=h[d+e];return g*g*(g*k[0]+3*f*k[1])+(3*g*k[2]+f*k[3])*f*f}if(d=a>i-2?i-2:parseInt(Math.floor(a),10),d===a)return j.isFunction(h[d])?h[d]():h[d];for(e=0;e<2;e++)j.isFunction(h[d+e])?k[e]=h[d+e]():k[e]=h[d+e];return k[0]+(k[1]-k[0])*(a-d)}},generateTerm:function(a,b,c,d,e){var f,g;j.isArray(b)?(this.dataX=b,this.numberPoints=this.dataX.length,this.X=this.interpolationFunctionFromArray("X"),this.visProp.curvetype="plot",this.isDraggable=!0):(this.X=j.createFunction(b,this.board,a),j.isString(b)?this.visProp.curvetype="functiongraph":(j.isFunction(b)||j.isNumber(b))&&(this.visProp.curvetype="parameter"),this.isDraggable=!0),j.isArray(c)?(this.dataY=c,this.Y=this.interpolationFunctionFromArray("Y")):this.Y=j.createFunction(c,this.board,a),j.isFunction(b)&&j.isArray(c)&&(f=j.createFunction(c[0],this.board,""),g=j.createFunction(c[1],this.board,""),this.X=function(a){return b(a)*Math.cos(a)+f()},this.Y=function(a){return b(a)*Math.sin(a)+g()},this.visProp.curvetype="polar"),j.exists(d)&&(this.minX=j.createFunction(d,this.board,"")),j.exists(e)&&(this.maxX=j.createFunction(e,this.board,""))},notifyParents:function(a){var b,c,d,e=!1;d={xterm:1,yterm:1};for(b in d)if(d.hasOwnProperty(b)&&this.hasOwnProperty(b)&&this[b].origin){e=!0;for(c in this[b].origin.deps)this[b].origin.deps.hasOwnProperty(c)&&this[b].origin.deps[c].addChild(this)}e||i.findDependencies(this,a,this.board)},getLabelAnchor:function(){var a,d,e,f=.05*this.board.canvasWidth,g=.05*this.board.canvasHeight,i=.95*this.board.canvasWidth,k=.95*this.board.canvasHeight;switch(j.evaluate(this.visProp.label.position)){case"ulft":d=f,e=g;break;case"llft":d=f,e=k;break;case"rt":d=i,e=.5*k;break;case"lrt":d=i,e=k;break;case"urt":d=i,e=g;break;case"top":d=.5*i,e=g;break;case"bot":d=.5*i,e=k;break;default:d=f,e=.5*k}return a=new c(b.COORDS_BY_SCREEN,[d,e],this.board,(!1)),h.projectCoordsToCurve(a.usrCoords[1],a.usrCoords[2],0,this,this.board)[0]},cloneToBackground:function(){var a,c={id:this.id+"T"+this.numTraces,elementClass:b.OBJECT_CLASS_CURVE,points:this.points.slice(0),bezierDegree:this.bezierDegree,numberPoints:this.numberPoints,board:this.board,visProp:j.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return c.visProp.layer=this.board.options.layer.trace,c.visProp.curvetype=this.visProp.curvetype,this.numTraces++,j.clearVisPropOld(c),c.visPropCalc={visible:j.evaluate(c.visProp.visible)},a=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawCurve(c),this.board.renderer.enhancedRendering=a,this.traces[c.id]=c.rendNode,this},bounds:function(){var a,b,c,d=1/0,e=-(1/0),f=1/0,h=-(1/0),i=this.points.length;if(3===this.bezierDegree){for(a=0;a<i;a++)this.points[a].X=j.bind(function(){return this.usrCoords[1]},this.points[a]),this.points[a].Y=j.bind(function(){return this.usrCoords[2]},this.points[a]);return b=g.bezier(this.points),c=b[3](),d=g.fminbr(function(a){return b[0](a)},[0,c]),e=g.fminbr(function(a){return-b[0](a)},[0,c]),f=g.fminbr(function(a){return b[1](a)},[0,c]),h=g.fminbr(function(a){return-b[1](a)},[0,c]),d=b[0](d),e=b[0](e),f=b[1](f),h=b[1](h),[d,h,e,f]}for(a=0;a<i;a++)d>this.points[a].usrCoords[1]&&(d=this.points[a].usrCoords[1]),e<this.points[a].usrCoords[1]&&(e=this.points[a].usrCoords[1]),f>this.points[a].usrCoords[2]&&(f=this.points[a].usrCoords[2]),h<this.points[a].usrCoords[2]&&(h=this.points[a].usrCoords[2]);return[d,h,e,f]},getParents:function(){var a=[this.xterm,this.yterm,this.minX(),this.maxX()];return 0!==this.parents.length&&(a=this.parents),a},moveTo:function(a){var c,d=[];return this.points.length>0&&!j.evaluate(this.visProp.fixed)&&(c=this.points[0],d=3===a.length?[a[0]-c.usrCoords[0],a[1]-c.usrCoords[1],a[2]-c.usrCoords[2]]:[a[0]-c.usrCoords[1],a[1]-c.usrCoords[2]],this.setPosition(b.COORDS_BY_USER,d)),this}}),a.createCurve=function(c,d,e){var f,g,h=j.copyAttributes(e,c.options,"curve");return f=c.select(d[0]),j.isObject(f)&&(f.type===b.OBJECT_TYPE_CURVE||f.type===b.OBJECT_TYPE_ANGLE||f.type===b.OBJECT_TYPE_ARC||f.type===b.OBJECT_TYPE_CONIC||f.type===b.OBJECT_TYPE_SECTOR)&&j.isTransformationOrArray(d[1])?(f.type===b.OBJECT_TYPE_SECTOR?h=j.copyAttributes(e,c.options,"sector"):f.type===b.OBJECT_TYPE_ARC?h=j.copyAttributes(e,c.options,"arc"):f.type===b.OBJECT_TYPE_ANGLE?(j.exists(e.withLabel)||(e.withLabel=!1),h=j.copyAttributes(e,c.options,"angle")):h=j.copyAttributes(e,c.options,"curve"),h=j.copyAttributes(h,c.options,"curve"),g=new a.Curve(c,["x",[],[]],h),g.updateDataArray=function(){var a,b=f.numberPoints;for(this.bezierDegree=f.bezierDegree,this.dataX=[],this.dataY=[],a=0;a<b;a++)this.dataX.push(f.points[a].usrCoords[1]),this.dataY.push(f.points[a].usrCoords[2]);return this},g.addTransform(d[1]),g):(h=j.copyAttributes(e,c.options,"curve"),new a.Curve(c,["x"].concat(d),h))},a.registerElement("curve",a.createCurve),a.createFunctiongraph=function(b,c,d){var e,f=["x","x"].concat(c);return e=j.copyAttributes(d,b.options,"curve"),e.curvetype="functiongraph",new a.Curve(b,f,e)},a.registerElement("functiongraph",a.createFunctiongraph),a.registerElement("plot",a.createFunctiongraph),a.createSpline=function(b,c,d){var e,f;return f=function(){var a,b=[],d=[];return function(e,f){var h,i,k;if(!f){if(b=[],d=[],2===c.length&&j.isArray(c[0])&&j.isArray(c[1])&&c[0].length===c[1].length)for(h=0;h<c[0].length;h++)j.isFunction(c[0][h])?b.push(c[0][h]()):b.push(c[0][h]),j.isFunction(c[1][h])?d.push(c[1][h]()):d.push(c[1][h]);else for(h=0;h<c.length;h++)if(j.isPoint(c[h]))b.push(c[h].X()),d.push(c[h].Y());else if(j.isArray(c[h])&&2===c[h].length)for(i=0;i<c.length;i++)j.isFunction(c[i][0])?b.push(c[i][0]()):b.push(c[i][0]),j.isFunction(c[i][1])?d.push(c[i][1]()):d.push(c[i][1]);else j.isFunction(c[h])&&2===c[h]().length&&(k=c[h](),b.push(k[0]),d.push(k[1]));a=g.splineDef(b,d)}return g.splineEval(e,b,d,a)}},d=j.copyAttributes(d,b.options,"curve"),d.curvetype="functiongraph",e=new a.Curve(b,["x","x",f()],d),e.setParents(c),e.elType="spline",e},a.registerElement("spline",a.createSpline),a.createCardinalSpline=function(b,c,d){var e,f,h,i,k,l,m,n,o,p="\nPossible parent types: [points:array, tau:number|function, type:string]";if(!j.exists(c[0])||!j.isArray(c[0]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 1 'points' has to be array of points or coordinate pairs"+p);if(!j.exists(c[1])||!j.isNumber(c[1])&&!j.isFunction(c[1]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 2 'tau' has to be number between [0,1] or function'"+p);if(!j.exists(c[2])||!j.isString(c[2]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 3 'type' has to be string 'uniform' or 'centripetal'"+p);if(d=j.copyAttributes(d,b.options,"curve"),d=j.copyAttributes(d,b.options,"cardinalspline"),d.curvetype="parameter",k=c[0],l=[],!d.isarrayofcoordinates&&2===k.length&&j.isArray(k[0])&&j.isArray(k[1])&&k[0].length===k[1].length)for(m=0;m<k[0].length;m++)l[m]=[],j.isFunction(k[0][m])?l[m].push(k[0][m]()):l[m].push(k[0][m]),j.isFunction(k[1][m])?l[m].push(k[1][m]()):l[m].push(k[1][m]);else for(m=0;m<k.length;m++)j.isString(k[m])?l.push(b.select(k[m])):j.isPoint(k[m])?l.push(k[m]):j.isArray(k[m])&&2===k[m].length?(l[m]=[],j.isFunction(k[m][0])?l[m].push(k[m][0]()):l[m].push(k[m][0]),j.isFunction(k[m][1])?l[m].push(k[m][1]()):l[m].push(k[m][1])):j.isFunction(k[m])&&2===k[m]().length&&l.push(c[m]());if(d.createpoints===!0)f=j.providePoints(b,l,d,"cardinalspline",["points"]);else for(f=[],m=0;m<l.length;m++)j.isPoint(l[m])?f.push(l[m]):f.push(function(a){return{X:function(){return l[a][0]},Y:function(){return l[a][1]}}}(m));for(h=c[1],i=c[2],o=["x"].concat(g.CardinalSpline(f,h)),e=new a.Curve(b,o,d),n=f.length,e.setParents(f),m=0;m<n;m++)j.isPoint(f[m])&&f[m].addChild(e);return e.elType="cardinalspline",e},a.registerElement("cardinalspline",a.createCardinalSpline),a.createRiemannsum=function(a,b,c){var d,e,f,h,i,k;if(k=j.copyAttributes(c,a.options,"riemannsum"),k.curvetype="plot",f=b[0],d=j.createFunction(b[1],a,""),!j.exists(d))throw new Error("JSXGraph: JXG.createRiemannsum: argument '2' n has to be number or function.\nPossible parent types: [function,n:number|function,type,start:number|function,end:number|function]");if(e=j.createFunction(b[2],a,"",!1),!j.exists(e))throw new Error("JSXGraph: JXG.createRiemannsum: argument 3 'type' has to be string or function.\nPossible parent types: [function,n:number|function,type,start:number|function,end:number|function]");return h=[[0],[0]].concat(b.slice(3)),i=a.create("curve",h,k),i.sum=0,i.Value=function(){return this.sum},i.updateDataArray=function(){var a=g.riemann(f,d(),e(),this.minX(),this.maxX());this.dataX=a[0],this.dataY=a[1],this.sum=a[2]},i},a.registerElement("riemannsum",a.createRiemannsum),a.createTracecurve=function(a,c,d){var e,f,g,h;if(2!==c.length)throw new Error("JSXGraph: Can't create trace curve with given parent'\nPossible parent types: [glider, point]");if(f=a.select(c[0]),g=a.select(c[1]),f.type!==b.OBJECT_TYPE_GLIDER||!j.isPoint(g))throw new Error("JSXGraph: Can't create trace curve with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [glider, point]");return h=j.copyAttributes(d,a.options,"tracecurve"),h.curvetype="plot",e=a.create("curve",[[0],[0]],h),e.updateDataArray=function(){var a,c,d,e,i,j,k,l,m,n=h.numberpoints,o=f.position,p=f.slideObject,q=p.minX(),r=p.maxX();for(c=(r-q)/n,this.dataX=[],this.dataY=[],p.elementClass!==b.OBJECT_CLASS_CURVE&&n++,a=0;a<n;a++){d=q+a*c,j=p.X(d)/p.Z(d),k=p.Y(d)/p.Z(d),f.setPositionDirectly(b.COORDS_BY_USER,[j,k]),l=!1;for(e in this.board.objects)if(this.board.objects.hasOwnProperty(e)&&(i=this.board.objects[e],i===f&&(l=!0),l&&i.needsRegularUpdate&&(m=i.visProp.trace,i.visProp.trace=!1,i.needsUpdate=!0,i.update(!0),i.visProp.trace=m,i===g)))break;this.dataX[a]=g.X(),this.dataY[a]=g.Y()}f.position=o,l=!1;for(e in this.board.objects)if(this.board.objects.hasOwnProperty(e)&&(i=this.board.objects[e],i===f&&(l=!0),l&&i.needsRegularUpdate&&(m=i.visProp.trace,i.visProp.trace=!1,i.needsUpdate=!0,i.update(!0),i.visProp.trace=m,i===g)))break},e},a.registerElement("tracecurve",a.createTracecurve),a.createStepfunction=function(a,b,c){var d,e;if(2!==b.length)throw new Error("JSXGraph: Can't create step function with given parent'\nPossible parent types: [array, array|function]");return e=j.copyAttributes(c,a.options,"stepfunction"),d=a.create("curve",b,e),d.updateDataArray=function(){var a,b=0,c=this.xterm.length;if(this.dataX=[],this.dataY=[],0!==c)for(this.dataX[b]=this.xterm[0],this.dataY[b]=this.yterm[0],++b,a=1;a<c;++a)this.dataX[b]=this.xterm[a],this.dataY[b]=this.dataY[b-1],++b,this.dataX[b]=this.xterm[a],this.dataY[b]=this.yterm[a],++b},d},a.registerElement("stepfunction",a.createStepfunction),a.createDerivative=function(a,c,d){var e,f,h,i,k;if(1!==c.length&&c[0]["class"]!==b.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create derivative curve with given parent'\nPossible parent types: [curve]");return k=j.copyAttributes(d,a.options,"curve"),f=c[0],h=g.D(f.X),i=g.D(f.Y),e=a.create("curve",[function(a){return f.X(a)},function(a){return i(a)/h(a)},f.minX(),f.maxX()],k),e.setParents(f),e},a.registerElement("derivative",a.createDerivative),{Curve:a.Curve,createCurve:a.createCurve,createFunctiongraph:a.createFunctiongraph,createPlot:a.createPlot,createSpline:a.createSpline,createRiemannsum:a.createRiemannsum,createTracecurve:a.createTracecurve,createStepfunction:a.createStepfunction}}),define("element/conic",["jxg","base/constants","base/coords","math/math","math/numerics","math/geometry","utils/type","base/point","base/curve"],function(a,b,c,d,e,f,g,h,i){"use strict";return a.createEllipse=function(a,d,e){var f,h,i,j,k,l,m,n=[],o=g.copyAttributes(e,a.options,"conic","foci"),p=g.copyAttributes(e,a.options,"conic","center"),q=g.copyAttributes(e,a.options,"conic");for(l=0;l<2;l++)if(d[l].length>1)n[l]=a.create("point",d[l],o);else if(g.isPoint(d[l]))n[l]=a.select(d[l]);else if(g.isFunction(d[l])&&g.isPoint(d[l]()))n[l]=d[l]();else{if(!g.isString(d[l]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof d[0]+"' and '"+typeof d[1]+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");n[l]=a.select(d[l]);
}if(g.isNumber(d[2]))k=g.createFunction(d[2],a);else if(g.isFunction(d[2])&&g.isNumber(d[2]()))k=d[2];else{if(g.isPoint(d[2]))j=a.select(d[2]);else if(d[2].length>1)j=a.create("point",d[2],o);else if(g.isFunction(d[2])&&g.isPoint(d[2]()))j=d[2]();else{if(!g.isString(d[2]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof d[0]+"' and '"+typeof d[1]+"' and '"+typeof d[2]+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");j=a.select(d[2])}k=function(){return j.Dist(n[0])+j.Dist(n[1])}}for(g.exists(d[4])||(d[4]=2*Math.PI),g.exists(d[3])||(d[3]=0),i=a.create("point",[function(){return.5*(n[0].X()+n[1].X())},function(){return.5*(n[0].Y()+n[1].Y())}],p),h=a.create("curve",[function(a){return 0},function(a){return 0},d[3],d[4]],q),h.majorAxis=k,m=h.hasPoint,f=function(a,b){var c,d,e,f,g,i,j,l,m;b||(c=k(),d=c*c,e=n[0].X(),f=n[0].Y(),g=n[1].X(),i=n[1].Y(),j=e-g,l=f-i,m=(d-e*e-f*f+g*g+i*i)/(2*c),h.quadraticform=[[m*m-g*g-i*i,m*j/c+g,m*l/c+i],[m*j/c+g,j*j/d-1,j*l/d],[m*l/c+i,j*l/d,l*l/d-1]])},h.X=function(a,b){var c=k(),d=n[1].Dist(n[0]),e=.5*(d*d-c*c)/(d*Math.cos(a)-c),g=Math.atan2(n[1].Y()-n[0].Y(),n[1].X()-n[0].X());return b||f(a,b),n[0].X()+Math.cos(g+a)*e},h.Y=function(a,b){var c=k(),d=n[1].Dist(n[0]),e=.5*(d*d-c*c)/(d*Math.cos(a)-c),f=Math.atan2(n[1].Y()-n[0].Y(),n[1].X()-n[0].X());return n[0].Y()+Math.sin(f+a)*e},h.midpoint=h.center=i,h.type=b.OBJECT_TYPE_CONIC,h.subs={center:h.center},h.inherits.push(h.center,n[0],n[1]),g.isPoint(j)&&h.inherits.push(j),h.hasPoint=function(a,d){var e,f,h,i,j;return g.evaluate(this.visProp.hasinnerpoints)?(e=n[0].coords,f=n[1].coords,h=this.majorAxis(),i=new c(b.COORDS_BY_SCREEN,[a,d],this.board),j=i.distance(b.COORDS_BY_USER,e)+i.distance(b.COORDS_BY_USER,f),j<=h):m.apply(this,arguments)},i.addChild(h),l=0;l<2;l++)g.isPoint(n[l])&&n[l].addChild(h);return g.isPoint(j)&&j.addChild(h),h.setParents(d),h},a.createHyperbola=function(a,c,d){var e,f,h,i,j,k,l=[],m=g.copyAttributes(d,a.options,"conic","foci"),n=g.copyAttributes(d,a.options,"conic","center"),o=g.copyAttributes(d,a.options,"conic");for(k=0;k<2;k++)if(c[k].length>1)l[k]=a.create("point",c[k],m);else if(g.isPoint(c[k]))l[k]=a.select(c[k]);else if(g.isFunction(c[k])&&g.isPoint(c[k]()))l[k]=c[k]();else{if(!g.isString(c[k]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");l[k]=a.select(c[k])}if(g.isNumber(c[2]))j=g.createFunction(c[2],a);else if(g.isFunction(c[2])&&g.isNumber(c[2]()))j=c[2];else{if(g.isPoint(c[2]))i=a.select(c[2]);else if(c[2].length>1)i=a.create("point",c[2],m);else if(g.isFunction(c[2])&&g.isPoint(c[2]()))i=c[2]();else{if(!g.isString(c[2]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"' and '"+typeof c[2]+"'.\nPossible parent types: [point,point,point], [point,point,number|function]");i=a.select(c[2])}j=function(){return i.Dist(l[0])-i.Dist(l[1])}}for(g.exists(c[4])||(c[4]=1.0001*Math.PI),g.exists(c[3])||(c[3]=-1.0001*Math.PI),h=a.create("point",[function(){return.5*(l[0].X()+l[1].X())},function(){return.5*(l[0].Y()+l[1].Y())}],n),f=a.create("curve",[function(a){return 0},function(a){return 0},c[3],c[4]],o),f.majorAxis=j,e=function(a,b){var c,d,e,g,h,i,k,m,n;b||(c=j(),d=c*c,e=l[0].X(),g=l[0].Y(),h=l[1].X(),i=l[1].Y(),k=e-h,m=g-i,n=(d-e*e-g*g+h*h+i*i)/(2*c),f.quadraticform=[[n*n-h*h-i*i,n*k/c+h,n*m/c+i],[n*k/c+h,k*k/d-1,k*m/d],[n*m/c+i,k*m/d,m*m/d-1]])},f.X=function(a,b){var c=j(),d=l[1].Dist(l[0]),f=.5*(d*d-c*c)/(d*Math.cos(a)+c),g=Math.atan2(l[1].Y()-l[0].Y(),l[1].X()-l[0].X());return b||e(a,b),l[0].X()+Math.cos(g+a)*f},f.Y=function(a,b){var c=j(),d=l[1].Dist(l[0]),e=.5*(d*d-c*c)/(d*Math.cos(a)+c),f=Math.atan2(l[1].Y()-l[0].Y(),l[1].X()-l[0].X());return l[0].Y()+Math.sin(f+a)*e},f.midpoint=f.center=h,f.subs={center:f.center},f.inherits.push(f.center,l[0],l[1]),g.isPoint(i)&&f.inherits.push(i),f.type=b.OBJECT_TYPE_CONIC,h.addChild(f),k=0;k<2;k++)g.isPoint(l[k])&&l[k].addChild(f);return g.isPoint(i)&&i.addChild(f),f.setParents(c),f},a.createParabola=function(a,c,d){var e,h,i,j=c[0],k=c[1],l=g.copyAttributes(d,a.options,"conic","foci"),m=g.copyAttributes(d,a.options,"conic","center"),n=g.copyAttributes(d,a.options,"conic");if(c[0].length>1)j=a.create("point",c[0],l);else if(g.isPoint(c[0]))j=a.select(c[0]);else if(g.isFunction(c[0])&&g.isPoint(c[0]()))j=c[0]();else{if(!g.isString(c[0]))throw new Error("JSXGraph: Can't create Parabola with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [point,line]");j=a.select(c[0])}return g.exists(c[3])||(c[3]=10),g.exists(c[2])||(c[2]=-10),i=a.create("point",[function(){return f.projectPointToLine(j,k,a).usrCoords}],m),h=a.create("curve",[function(a){return 0},function(a){return 0},c[2],c[3]],n),h.midpoint=h.center=i,h.subs={center:h.center},h.inherits.push(h.center),e=function(a,b){var c,d,e,f,g,i;b||(c=k.stdform[1],d=k.stdform[2],e=k.stdform[0],f=c*c+d*d,g=j.X(),i=j.Y(),h.quadraticform=[[e*e-f*(g*g+i*i),e*c+f*g,e*d+f*i],[e*c+f*g,-d*d,c*d],[e*d+f*i,c*d,-c*c]])},h.X=function(a,b){var c,d,g=k.getAngle(),h=f.distPointLine(j.coords.usrCoords,k.stdform),i=k.point1.coords.usrCoords,l=k.point2.coords.usrCoords,m=j.coords.usrCoords;return 0===i[0]?i=[1,l[1]+k.stdform[2],l[2]-k.stdform[1]]:0===l[0]&&(l=[1,i[1]+k.stdform[2],i[2]-k.stdform[1]]),d=(l[1]-i[1])*(m[2]-i[2])-(l[2]-i[2])*(m[1]-i[1])>=0?1:-1,c=d*h/(1-Math.sin(a)),b||e(a,b),j.X()+Math.cos(a+g)*c},h.Y=function(a,b){var c,d,e=k.getAngle(),g=f.distPointLine(j.coords.usrCoords,k.stdform),h=k.point1.coords.usrCoords,i=k.point2.coords.usrCoords,l=j.coords.usrCoords;return 0===h[0]?h=[1,i[1]+k.stdform[2],i[2]-k.stdform[1]]:0===i[0]&&(i=[1,h[1]+k.stdform[2],h[2]-k.stdform[1]]),d=(i[1]-h[1])*(l[2]-h[2])-(i[2]-h[2])*(l[1]-h[1])>=0?1:-1,c=d*g/(1-Math.sin(a)),j.Y()+Math.sin(a+e)*c},h.type=b.OBJECT_TYPE_CONIC,i.addChild(h),g.isPoint(j)&&(j.addChild(h),h.inherits.push(j)),k.addChild(h),h.setParents(c),h},a.createConic=function(a,c,f){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=[[1,0,0],[0,1,0],[0,0,1]],w=[[1,0,0],[0,1,0],[0,0,1]],x=[],y=[],z=g.copyAttributes(f,a.options,"conic","point"),A=g.copyAttributes(f,a.options,"conic","center"),B=g.copyAttributes(f,a.options,"conic");if(5===c.length)u=!0;else{if(6!==c.length)throw new Error("JSXGraph: Can't create generic Conic with "+c.length+" parameters.");u=!1}if(u)for(s=0;s<5;s++)if(c[s].length>1)x[s]=a.create("point",c[s],z);else if(g.isPoint(c[s]))x[s]=a.select(c[s]);else if(g.isFunction(c[s])&&g.isPoint(c[s]()))x[s]=c[s]();else{if(!g.isString(c[s]))throw new Error("JSXGraph: Can't create Conic section with parent types '"+typeof c[s]+"'.\nPossible parent types: [point,point,point,point,point], [a00,a11,a22,a01,a02,a12]");x[s]=a.select(c[s])}else t=[[0,0,0],[0,0,0],[0,0,0]],t[0][0]=g.isFunction(c[2])?function(){return c[2]()}:function(){return c[2]},t[0][1]=g.isFunction(c[4])?function(){return c[4]()}:function(){return c[4]},t[0][2]=g.isFunction(c[5])?function(){return c[5]()}:function(){return c[5]},t[1][1]=g.isFunction(c[0])?function(){return c[0]()}:function(){return c[0]},t[1][2]=g.isFunction(c[3])?function(){return c[3]()}:function(){return c[3]},t[2][2]=g.isFunction(c[1])?function(){return c[1]()}:function(){return c[1]};if(l=function(a){var b,c;for(b=0;b<3;b++)for(c=b;c<3;c++)a[b][c]+=a[c][b];for(b=0;b<3;b++)for(c=0;c<b;c++)a[b][c]=a[c][b];return a},k=function(a,b){var c,d,e=[[0,0,0],[0,0,0],[0,0,0]];for(c=0;c<3;c++)for(d=0;d<3;d++)e[c][d]=a[c]*b[d];return l(e)},j=function(a,b,c){var e,f,g,h,i,j=[[0,0,0],[0,0,0],[0,0,0]];for(i=d.matVecMult(b,c),g=d.innerProduct(c,i),i=d.matVecMult(a,c),h=d.innerProduct(c,i),e=0;e<3;e++)for(f=0;f<3;f++)j[e][f]=g*a[e][f]-h*b[e][f];return j},i=a.create("curve",[function(a){return 0},function(a){return 0},0,2*Math.PI],B),h=function(a,b){var c,f,h,l;if(!b){if(u){for(c=0;c<5;c++)y[c]=x[c].coords.usrCoords;q=k(d.crossProduct(y[0],y[1]),d.crossProduct(y[2],y[3])),r=k(d.crossProduct(y[0],y[2]),d.crossProduct(y[1],y[3])),w=j(q,r,y[4])}else for(c=0;c<3;c++)for(f=c;f<3;f++)w[c][f]=t[c][f](),f>c&&(w[f][c]=w[c][f]);for(i.quadraticform=w,m=e.Jacobi(w),m[0][0][0]<0&&(m[0][0][0]*=-1,m[0][1][1]*=-1,m[0][2][2]*=-1),c=0;c<3;c++){for(h=0,f=0;f<3;f++)h+=m[1][f][c]*m[1][f][c];h=Math.sqrt(h)}v=m[1],p=Math.sqrt(Math.abs(m[0][0][0])),n=Math.sqrt(Math.abs(m[0][1][1])),o=Math.sqrt(Math.abs(m[0][2][2]))}return m[0][1][1]<=0&&m[0][2][2]<=0?l=d.matVecMult(v,[1/p,Math.cos(a)/n,Math.sin(a)/o]):m[0][1][1]<=0&&m[0][2][2]>0?l=d.matVecMult(v,[Math.cos(a)/p,1/n,Math.sin(a)/o]):m[0][2][2]<0&&(l=d.matVecMult(v,[Math.sin(a)/p,Math.cos(a)/n,1/o])),g.exists(l)?(l[1]/=l[0],l[2]/=l[0],l[0]=1):l=[1,NaN,NaN],l},i.X=function(a,b){return h(a,b)[1]},i.Y=function(a,b){return h(a,b)[2]},i.midpoint=a.create("point",[function(){var a=i.quadraticform;return[a[1][1]*a[2][2]-a[1][2]*a[1][2],a[1][2]*a[0][2]-a[2][2]*a[0][1],a[0][1]*a[1][2]-a[1][1]*a[0][2]]}],A),i.type=b.OBJECT_TYPE_CONIC,i.center=i.midpoint,i.subs={center:i.center},i.inherits.push(i.center),i.inherits=i.inherits.concat(x),u){for(s=0;s<5;s++)g.isPoint(x[s])&&x[s].addChild(i);i.setParents(c)}return i.addChild(i.center),i},a.registerElement("ellipse",a.createEllipse),a.registerElement("hyperbola",a.createHyperbola),a.registerElement("parabola",a.createParabola),a.registerElement("conic",a.createConic),{createEllipse:a.createEllipse,createHyperbola:a.createHyperbola,createParabola:a.createParabola,createConic:a.createConic}}),define("base/circle",["jxg","base/element","base/coords","base/constants","element/conic","parser/geonext","utils/type"],function(a,b,c,d,e,f,g){"use strict";return a.Circle=function(a,b,c,e,f){this.constructor(a,f,d.OBJECT_TYPE_CIRCLE,d.OBJECT_CLASS_CIRCLE),this.method=b,this.midpoint=this.board.select(c),this.center=this.board.select(c),this.point2=null,this.radius=0,this.line=null,this.circle=null,"twoPoints"===b?(this.point2=a.select(e),this.radius=this.Radius()):"pointRadius"===b?(this.gxtterm=e,this.updateRadius=g.createFunction(e,this.board,null,!0),this.updateRadius()):"pointLine"===b?(this.line=a.select(e),this.radius=this.line.point1.coords.distance(d.COORDS_BY_USER,this.line.point2.coords)):"pointCircle"===b&&(this.circle=a.select(e),this.radius=this.circle.Radius()),this.id=this.board.setId(this,"C"),this.board.renderer.drawEllipse(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="circle",this.createLabel(),this.center.addChild(this),"pointRadius"===b?this.notifyParents(e):"pointLine"===b?this.line.addChild(this):"pointCircle"===b?this.circle.addChild(this):"twoPoints"===b&&this.point2.addChild(this),this.methodMap=g.deepCopy(this.methodMap,{setRadius:"setRadius",getRadius:"getRadius",Area:"Area",area:"Area",radius:"Radius",center:"center",line:"line",point2:"point2"})},a.Circle.prototype=new b,a.extend(a.Circle.prototype,{hasPoint:function(a,b){var e,f,h,i=this.board.options.precision.hasPoint,j=this.center.coords.usrCoords,k=new c(d.COORDS_BY_SCREEN,[a,b],this.board),l=this.Radius();return e=j[1]-k.usrCoords[1],f=j[2]-k.usrCoords[2],h=Math.sqrt(e*e+f*f),i+=.5*g.evaluate(this.visProp.strokewidth),i/=Math.sqrt(this.board.unitX*this.board.unitY),g.evaluate(this.visProp.hasinnerpoints)?h<l+i:Math.abs(h-l)<i},generatePolynomial:function(a){var b=this.center.symbolic.x,c=this.center.symbolic.y,d=a.symbolic.x,e=a.symbolic.y,f=this.generateRadiusSquared();return""===f?[]:["(("+d+")-("+b+"))^2 + (("+e+")-("+c+"))^2 - ("+f+")"]},generateRadiusSquared:function(){var a,b,c,d,e,f,h="";return"twoPoints"===this.method?(a=this.center.symbolic.x,b=this.center.symbolic.y,c=this.point2.symbolic.x,d=this.point2.symbolic.y,h="(("+c+")-("+a+"))^2 + (("+d+")-("+b+"))^2"):"pointRadius"===this.method?g.isNumber(this.radius)&&(h=(this.radius*this.radius).toString()):"pointLine"===this.method?(c=this.line.point1.symbolic.x,d=this.line.point1.symbolic.y,e=this.line.point2.symbolic.x,f=this.line.point2.symbolic.y,h="(("+c+")-("+e+"))^2 + (("+d+")-("+f+"))^2"):"pointCircle"===this.method&&(h=this.circle.Radius()),h},update:function(){return this.needsUpdate&&(g.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),"pointLine"===this.method?this.radius=this.line.point1.coords.distance(d.COORDS_BY_USER,this.line.point2.coords):"pointCircle"===this.method?this.radius=this.circle.Radius():"pointRadius"===this.method&&(this.radius=this.updateRadius()),this.updateStdform(),this.updateQuadraticform()),this},updateQuadraticform:function(){var a=this.center,b=a.X(),c=a.Y(),d=this.Radius();this.quadraticform=[[b*b+c*c-d*d,-b,-c],[-b,1,0],[-c,0,1]]},updateStdform:function(){this.stdform[3]=.5,this.stdform[4]=this.Radius(),this.stdform[1]=-this.center.coords.usrCoords[1],this.stdform[2]=-this.center.coords.usrCoords[2],isFinite(this.stdform[4])||(this.stdform[0]=g.exists(this.point2)?-(this.stdform[1]*this.point2.coords.usrCoords[1]+this.stdform[2]*this.point2.coords.usrCoords[2]):0),this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.center.coords.usrCoords[1]+this.center.coords.usrCoords[2]+this.Radius())&&this.center.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateEllipse(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},notifyParents:function(a){g.isString(a)&&f.findDependencies(this,a,this.board)},setRadius:function(a){return this.updateRadius=g.createFunction(a,this.board,null,!0),this.board.update(),this},Radius:function(a){return g.exists(a)?(this.setRadius(a),this.Radius()):"twoPoints"===this.method?g.cmpArrays(this.point2.coords.usrCoords,[0,0,0])||g.cmpArrays(this.center.coords.usrCoords,[0,0,0])?NaN:this.center.Dist(this.point2):"pointLine"===this.method||"pointCircle"===this.method?this.radius:"pointRadius"===this.method?this.updateRadius():NaN},getRadius:function(){return a.deprecated("Circle.getRadius()","Circle.Radius()"),this.Radius()},getTextAnchor:function(){return this.center.coords},getLabelAnchor:function(){var a,b,e=this.Radius(),f=this.center.coords.usrCoords;switch(g.evaluate(this.visProp.label.position)){case"lft":a=f[1]-e,b=f[2];break;case"llft":a=f[1]-Math.sqrt(.5)*e,b=f[2]-Math.sqrt(.5)*e;break;case"rt":a=f[1]+e,b=f[2];break;case"lrt":a=f[1]+Math.sqrt(.5)*e,b=f[2]-Math.sqrt(.5)*e;break;case"urt":a=f[1]+Math.sqrt(.5)*e,b=f[2]+Math.sqrt(.5)*e;break;case"top":a=f[1],b=f[2]+e;break;case"bot":a=f[1],b=f[2]-e;break;default:a=f[1]-Math.sqrt(.5)*e,b=f[2]+Math.sqrt(.5)*e}return new c(d.COORDS_BY_USER,[a,b],this.board)},cloneToBackground:function(){var a,b=this.Radius(),c={id:this.id+"T"+this.numTraces,elementClass:d.OBJECT_CLASS_CIRCLE,center:{coords:this.center.coords},Radius:function(){return b},getRadius:function(){return b},board:this.board,visProp:g.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return c.visProp.layer=this.board.options.layer.trace,this.numTraces++,g.clearVisPropOld(c),c.visPropCalc={visible:g.evaluate(c.visProp.visible)},a=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawEllipse(c),this.board.renderer.enhancedRendering=a,this.traces[c.id]=c.rendNode,this},addTransform:function(a){var b,c=g.isArray(a)?a:[a],d=c.length;for(b=0;b<d;b++)this.center.transformations.push(c[b]),"twoPoints"===this.method&&this.point2.transformations.push(c[b]);return this},snapToGrid:function(){var a=g.evaluate(this.visProp.snaptogrid);return this.center.handleSnapToGrid(a,!0),"twoPoints"===this.method&&this.point2.handleSnapToGrid(a,!0),this},snapToPoints:function(){var a=g.evaluate(this.visProp.snaptopoints);return this.center.handleSnapToPoints(a),"twoPoints"===this.method&&this.point2.handleSnapToPoints(a),this},X:function(a){return this.Radius()*Math.cos(2*a*Math.PI)+this.center.coords.usrCoords[1]},Y:function(a){return this.Radius()*Math.sin(2*a*Math.PI)+this.center.coords.usrCoords[2]},Z:function(a){return 1},minX:function(){return 0},maxX:function(){return 1},Area:function(){var a=this.Radius();return a*a*Math.PI},bounds:function(){var a=this.center.coords.usrCoords,b=this.Radius();return[a[1]-b,a[2]+b,a[1]+b,a[2]-b]},getParents:function(){return 1===this.parents.length?this.parents.concat(this.radius):this.parents}}),a.createCircle=function(b,c,f){var h,i,j,k,l,m=!0;if(i=[],l=b.select(c[0]),g.isObject(l)&&l.elementClass===d.OBJECT_CLASS_CIRCLE&&g.isTransformationOrArray(c[1]))return k=g.copyAttributes(f,b.options,"circle"),h=e.createEllipse(b,[l.center,l.center,function(){return 2*l.Radius()}],k),h.addTransform(c[1]),h;for(j=0;j<c.length;j++)if(g.isPointType(b,c[j])){if(i=i.concat(g.providePoints(b,[c[j]],f,"circle",["center"])),i[i.length-1]===!1)throw new Error("JSXGraph: Can't create circle from this type. Please provide a point type.")}else i.push(c[j]);if(k=g.copyAttributes(f,b.options,"circle"),2===i.length&&g.isPoint(i[0])&&g.isPoint(i[1]))h=new a.Circle(b,"twoPoints",i[0],i[1],k);else if((g.isNumber(i[0])||g.isFunction(i[0])||g.isString(i[0]))&&g.isPoint(i[1]))h=new a.Circle(b,"pointRadius",i[1],i[0],k);else if((g.isNumber(i[1])||g.isFunction(i[1])||g.isString(i[1]))&&g.isPoint(i[0]))h=new a.Circle(b,"pointRadius",i[0],i[1],k);else if(i[0].elementClass===d.OBJECT_CLASS_CIRCLE&&g.isPoint(i[1]))h=new a.Circle(b,"pointCircle",i[1],i[0],k);else if(i[1].elementClass===d.OBJECT_CLASS_CIRCLE&&g.isPoint(i[0]))h=new a.Circle(b,"pointCircle",i[0],i[1],k);else if(i[0].elementClass===d.OBJECT_CLASS_LINE&&g.isPoint(i[1]))h=new a.Circle(b,"pointLine",i[1],i[0],k);else if(i[1].elementClass===d.OBJECT_CLASS_LINE&&g.isPoint(i[0]))h=new a.Circle(b,"pointLine",i[0],i[1],k);else{if(!(3===c.length&&g.isPoint(i[0])&&g.isPoint(i[1])&&g.isPoint(i[2])))throw new Error("JSXGraph: Can't create circle with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [point,point], [point,number], [point,function], [point,circle], [point,point,point], [circle,transformation]");if(!a.elements.circumcircle)throw new Error("JSXGraph: Can't create circle with three points. Please include the circumcircle element (element/composition).");h=a.elements.circumcircle(b,i,k)}for(h.isDraggable=m,h.setParents(i),h.elType="circle",j=0;j<i.length;j++)g.isPoint(i[j])&&h.inherits.push(i[j]);return h},a.registerElement("circle",a.createCircle),{Circle:a.Circle,createCircle:a.createCircle}}),define("base/composition",["jxg","utils/type"],function(a,b){"use strict";return a.Composition=function(a){var c,d=this,e=["setAttribute","setParents","prepareUpdate","updateRenderer","update","fullUpdate","highlight","noHighlight"],f=function(a){return function(){var c;for(c in d.elements)d.elements.hasOwnProperty(c)&&b.exists(d.elements[c][a])&&d.elements[c][a].apply(d.elements[c],arguments);return d}};for(c=0;c<e.length;c++)this[e[c]]=f(e[c]);this.elements={},this.objects=this.elements,this.elementsByName={},this.objectsList=[],this.groups={},this.methodMap={setAttribute:"setAttribute",setProperty:"setAttribute",setParents:"setParents",add:"add",remove:"remove",select:"select"};for(c in a)a.hasOwnProperty(c)&&this.add(c,a[c]);this.dump=!0,this.subs={}},a.extend(a.Composition.prototype,{add:function(a,c){return!(b.exists(this[a])||!b.exists(c))&&(b.exists(c.id)?this.elements[c.id]=c:this.elements[a]=c,b.exists(c.name)&&(this.elementsByName[c.name]=c),c.on("attribute:name",this.nameListener,this),this.objectsList.push(c),this[a]=c,this.methodMap[a]=c,!0)},remove:function(a){var b,c=!1;for(b in this.elements)if(this.elements.hasOwnProperty(b)&&this.elements[b].id===this[a].id){c=!0;break}return c&&(delete this.elements[this[a].id],delete this[a]),c},nameListener:function(a,b,c){delete this.elementsByName[a],this.elementsByName[b]=c},select:function(c){return b.exists(a.Board)?a.Board.prototype.select.call(this,c):new a.Composition},getParents:function(){return this.parents},getType:function(){return this.elType},getAttributes:function(){var a,b={};for(a in this.subs)this.subs.hasOwnProperty(a)&&(b[a]=this.subs[a].visProp);return this.attr}}),a.Composition}),define("base/polygon",["jxg","base/constants","base/coords","math/statistics","math/geometry","utils/type","base/element","base/line","base/transformation"],function(a,b,c,d,e,f,g,h,i){"use strict";return a.Polygon=function(c,d,e){this.constructor(c,e,b.OBJECT_TYPE_POLYGON,b.OBJECT_CLASS_AREA);var g,h,i,j,k=f.copyAttributes(e,c.options,"polygon","borders");for(this.withLines=e.withlines,this.attr_line=k,this.vertices=[],g=0;g<d.length;g++)this.vertices[g]=this.board.select(d[g]);if(this.vertices.length>0&&this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.borders=[],this.withLines)for(i=this.vertices.length-1,j=0;j<i;j++)g=(j+1)%i,k.id=k.ids&&k.ids[g],k.name=k.names&&k.names[g],k.strokecolor=f.isArray(k.colors)&&k.colors[g%k.colors.length]||k.strokecolor,k.visible=f.exists(e.borders.visible)?e.borders.visible:e.visible,k.strokecolor===!1&&(k.strokecolor="none"),h=c.create("segment",[this.vertices[g],this.vertices[g+1]],k),h.dump=!1,this.borders[g]=h,h.parentPolygon=this;for(this.inherits.push(this.vertices,this.borders),this.id=this.board.setId(this,"Py"),g=0;g<this.vertices.length-1;g++)this.board.select(this.vertices[g]).addChild(this);this.board.renderer.drawPolygon(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="polygon",this.createLabel(),this.methodMap=a.deepCopy(this.methodMap,{borders:"borders",vertices:"vertices",A:"Area",Area:"Area",Perimeter:"Perimeter",L:"Perimeter",Length:"Perimeter",boundingBox:"boundingBox",bounds:"bounds",addPoints:"addPoints",insertPoints:"insertPoints",removePoints:"removePoints"})},a.Polygon.prototype=new g,a.extend(a.Polygon.prototype,{hasPoint:function(a,b){var c,d,e,g=!1;if(f.evaluate(this.visProp.hasinnerpoints)){for(e=this.vertices.length,c=0,d=e-2;c<e-1;d=c++)this.vertices[c].coords.scrCoords[2]>b!=this.vertices[d].coords.scrCoords[2]>b&&a<(this.vertices[d].coords.scrCoords[1]-this.vertices[c].coords.scrCoords[1])*(b-this.vertices[c].coords.scrCoords[2])/(this.vertices[d].coords.scrCoords[2]-this.vertices[c].coords.scrCoords[2])+this.vertices[c].coords.scrCoords[1]&&(g=!g);if(g)return!0}for(e=this.borders.length,c=0;c<e;c++)if(this.borders[c].hasPoint(a,b)){g=!0;break}return g},updateRenderer:function(){var a,b;if(!this.needsUpdate)return this;if(this.visPropCalc.visible){for(b=this.vertices.length,this.isReal=!0,a=0;a<b;++a)if(!this.vertices[a].isReal){this.isReal=!1;break}this.isReal||this.updateVisibility(!1)}return this.visPropCalc.visible&&this.board.renderer.updatePolygon(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this},getTextAnchor:function(){var a,d,e,f,g;if(0===this.vertices.length)return new c(b.COORDS_BY_USER,[1,0,0],this.board);for(a=this.vertices[0].X(),d=this.vertices[0].Y(),e=a,f=d,g=0;g<this.vertices.length;g++)this.vertices[g].X()<a&&(a=this.vertices[g].X()),this.vertices[g].X()>e&&(e=this.vertices[g].X()),this.vertices[g].Y()>d&&(d=this.vertices[g].Y()),this.vertices[g].Y()<f&&(f=this.vertices[g].Y());return new c(b.COORDS_BY_USER,[.5*(a+e),.5*(d+f)],this.board)},getLabelAnchor:a.shortcut(a.Polygon.prototype,"getTextAnchor"),cloneToBackground:function(){var a,b={};return b.id=this.id+"T"+this.numTraces,this.numTraces++,b.vertices=this.vertices,b.visProp=f.deepCopy(this.visProp,this.visProp.traceattributes,!0),b.visProp.layer=this.board.options.layer.trace,b.board=this.board,f.clearVisPropOld(b),b.visPropCalc={visible:f.evaluate(b.visProp.visible)},a=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawPolygon(b),this.board.renderer.enhancedRendering=a,this.traces[b.id]=b.rendNode,this},hideElement:function(b){var c;if(a.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),!b)for(c=0;c<this.borders.length;c++)this.borders[c].hideElement();this.hasLabel&&f.exists(this.label)&&(this.label.hiddenByParent=!0,this.label.visPropCalc.visible&&this.label.hideElement())},showElement:function(b){var c;if(a.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!0),!b)for(c=0;c<this.borders.length;c++)this.borders[c].showElement().updateRenderer();return f.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.visPropCalc.visible||this.label.showElement().updateRenderer()),this},Area:function(){return Math.abs(e.signedPolygon(this.vertices,!0))},Perimeter:function(){var a,b=this.vertices.length,c=0;for(a=1;a<b;++a)c+=this.vertices[a].Dist(this.vertices[a-1]);return c},boundingBox:function(){var a,b,c=[0,0,0,0],d=this.vertices.length-1;if(0===d)return c;for(c[0]=this.vertices[0].X(),c[2]=c[0],c[1]=this.vertices[0].Y(),c[3]=c[1],a=1;a<d;++a)b=this.vertices[a].X(),b<c[0]?c[0]=b:b>c[2]&&(c[2]=b),b=this.vertices[a].Y(),b>c[1]?c[1]=b:b<c[3]&&(c[3]=b);return c},bounds:function(){return this.boundingBox()},remove:function(){var a;for(a=0;a<this.borders.length;a++)this.board.removeObject(this.borders[a]);g.prototype.remove.call(this)},findPoint:function(a){var b;if(!f.isPoint(a))return-1;for(b=0;b<this.vertices.length;b++)if(this.vertices[b].id===a.id)return b;return-1},addPoints:function(a){var b=Array.prototype.slice.call(arguments);return this.insertPoints.apply(this,[this.vertices.length-2].concat(b))},insertPoints:function(a,b){var c,d,e=[];if(0===arguments.length)return this;if(a<0||a>this.vertices.length-2)return this;for(c=1;c<arguments.length;c++)f.isPoint(arguments[c])&&e.push(arguments[c]);if(d=this.vertices.slice(0,a+1).concat(e),this.vertices=d.concat(this.vertices.slice(a+1)),this.withLines){for(d=this.borders.slice(0,a),this.board.removeObject(this.borders[a]),c=0;c<e.length;c++)d.push(this.board.create("segment",[this.vertices[a+c],this.vertices[a+c+1]],this.attr_line));d.push(this.board.create("segment",[this.vertices[a+e.length],this.vertices[a+e.length+1]],this.attr_line)),this.borders=d.concat(this.borders.slice(a+1))}return this.board.update(),this},removePoints:function(a){var b,c,d,e=[],g=[],h=[],i=[];for(this.vertices=this.vertices.slice(0,this.vertices.length-1),b=0;b<arguments.length;b++)d=arguments[b],f.isPoint(d)&&(d=this.findPoint(d)),f.isNumber(d)&&d>-1&&d<this.vertices.length&&f.indexOf(h,d)===-1&&h.push(d);for(b=0;b<h.length;b++)this.vertices[h[b]].removeChild(this);for(h=h.sort(),e=this.vertices.slice(),g=this.borders.slice(),this.withLines&&i.push([h[h.length-1]]),b=h.length-1;b>-1;b--)e[h[b]]=-1,this.withLines&&h[b]-1>h[b-1]&&(i[i.length-1][1]=h[b],i.push([h[b-1]]));for(this.withLines&&(i[i.length-1][1]=h[0]),this.vertices=[],b=0;b<e.length;b++)f.isPoint(e[b])&&this.vertices.push(e[b]);if(this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.withLines){for(b=0;b<i.length;b++){for(c=i[b][1]-1;c<i[b][0]+1;c++)c<0?(c=0,this.board.removeObject(this.borders[g.length-1]),g[g.length-1]=-1):c>g.length-1&&(c=g.length-1),this.board.removeObject(this.borders[c]),g[c]=-1;0!==i[b][1]&&i[b][0]!==e.length-1&&(g[i[b][0]-1]=this.board.create("segment",[e[Math.max(i[b][1]-1,0)],e[Math.min(i[b][0]+1,this.vertices.length-1)]],this.attr_line))}for(this.borders=[],b=0;b<g.length;b++)g[b]!==-1&&this.borders.push(g[b]);i[0][1]!==this.vertices.length-1&&0!==i[i.length-1][1]||this.borders.push(this.board.create("segment",[this.vertices[0],this.vertices[this.vertices.length-2]],this.attr_line))}return this.board.update(),this},getParents:function(){return this.setParents(this.vertices),this.parents},getAttributes:function(){var a,b=g.prototype.getAttributes.call(this);if(this.withLines)for(b.lines=b.lines||{},b.lines.ids=[],b.lines.colors=[],a=0;a<this.borders.length;a++)b.lines.ids.push(this.borders[a].id),b.lines.colors.push(this.borders[a].visProp.strokecolor);return b},snapToGrid:function(){var a,b;for(b=!!f.evaluate(this.visProp.snaptogrid),a=0;a<this.vertices.length;a++)this.vertices[a].handleSnapToGrid(b,!0)},setPositionDirectly:function(a,b,e){var f,g,h,i,j=new c(a,b,this.board),k=new c(a,e,this.board);for(i=this.vertices.length-1,h=0;h<i;h++)if(!this.vertices[h].draggable())return this;return f=d.subtract(j.usrCoords,k.usrCoords),g=this.board.create("transform",f.slice(1),{type:"translate"}),g.applyOnce(this.vertices.slice(0,-1)),this},sutherlandHodgman:function(b){var c,d,e,f,g,h,i,j=a.Math.Geometry.sortVertices(this.vertices),k=a.Math.Geometry.sortVertices(b.vertices),l=j.length-1,m=k.length-1,n=[],o=function(a,b,c){return(b[1]-a[1])*(c[2]-a[2])-(b[2]-a[2])*(c[1]-a[1])>=0};for(e=0;e<m;e++)n.push(k[e]);for(e=0;e<l;e++)for(d=n.slice(0),c=d.length,n=[],g=d[c-1],f=0;f<c;f++)h=d[f],o(j[e],j[e+1],h)?(o(j[e],j[e+1],g)||(i=a.Math.Geometry.meetSegmentSegment(g,h,j[e],j[e+1]),i[0][1]/=i[0][0],i[0][2]/=i[0][0],i[0][0]=1,n.push(i[0])),n.push(h)):o(j[e],j[e+1],g)&&(i=a.Math.Geometry.meetSegmentSegment(g,h,j[e],j[e+1]),i[0][1]/=i[0][0],i[0][2]/=i[0][0],i[0][0]=1,n.push(i[0])),g=h;return n},intersect:function(a){return this.sutherlandHodgman(a)}}),a.createPolygon=function(c,d,e){var g,h,i,j,k,l,m=[],n=!1;if(k=f.copyAttributes(e,c.options,"polygon"),j=c.select(d[0]),f.isObject(j)&&j.type===b.OBJECT_TYPE_POLYGON&&f.isTransformationOrArray(d[1]))for(n=!0,i=j.vertices.length-1,l=f.copyAttributes(e,c.options,"polygon","vertices"),h=0;h<i;h++)l.withlabel&&(l.name=""===j.vertices[h].name?"":j.vertices[h].name+"'"),m.push(c.create("point",[j.vertices[h],d[1]],l));else if(m=f.providePoints(c,d,e,"polygon",["vertices"]),m===!1)throw new Error("JSXGraph: Can't create polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates. Alternatively, a polygon and a transformation can be supplied");if(k=f.copyAttributes(e,c.options,"polygon"),g=new a.Polygon(c,m,k),g.isDraggable=!0,n)for(i=j.vertices.length-1,h=0;h<i;h++)m[h].prepareUpdate().update().updateVisibility(f.evaluate(g.visProp.visible)).updateRenderer();return g},a.createRegularPolygon=function(a,c,d){var e,g,h,i,j,k,l,m=[];if(j=c.length,h=c[j-1],f.isNumber(h)&&(3!==c.length||h<3))throw new Error("JSXGraph: A regular polygon needs two point types and a number > 2 as input.");if(f.isNumber(a.select(h))?(j--,k=!1):(h=j,k=!0),m=f.providePoints(a,c.slice(0,j),d,"regularpolygon",["vertices"]),m===!1)throw new Error("JSXGraph: Can't create regular polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates");for(l=f.copyAttributes(d,a.options,"regularpolygon","vertices"),g=2;g<h;g++)i=a.create("transform",[Math.PI*(2-(h-2)/h),m[g-1]],{type:"rotate"}),k?(m[g].addTransform(m[g-2],i),m[g].fullUpdate()):(f.isArray(l.ids)&&l.ids.length>=h-2&&(l.id=l.ids[g-2]),m[g]=a.create("point",[m[g-2],i],l),m[g].type=b.OBJECT_TYPE_CAS,m[g].isDraggable=!0,m[g].visProp.fixed=!1);return l=f.copyAttributes(d,a.options,"regularpolygon"),e=a.create("polygon",m,l),e.elType="regularpolygon",e},a.registerElement("polygon",a.createPolygon),a.registerElement("regularpolygon",a.createRegularPolygon),{Polygon:a.Polygon,createPolygon:a.createPolygon,createRegularPolygon:a.createRegularPolygon}}),define("element/arc",["jxg","math/geometry","math/math","base/coords","base/circle","utils/type","base/constants","base/curve","element/composition"],function(a,b,c,d,e,f,g,h,i){"use strict";return a.createArc=function(h,i,j){var k,l,m;if(m=f.providePoints(h,i,j,"arc",["center","radiuspoint","anglepoint"]),m===!1||m.length<3)throw new Error("JSXGraph: Can't create Arc with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"' and '"+typeof i[2]+"'.\nPossible parent types: [point,point,point], [arc, transformation]");
return l=f.copyAttributes(j,h.options,"arc"),k=h.create("curve",[[0],[0]],l),k.elType="arc",k.setParents(m),k.type=g.OBJECT_TYPE_ARC,k.center=m[0],k.radiuspoint=m[1],k.point2=k.radiuspoint,k.anglepoint=m[2],k.point3=k.anglepoint,k.center.addChild(k),k.radiuspoint.addChild(k),k.anglepoint.addChild(k),k.useDirection=l.usedirection,k.updateDataArray=function(){var a,c,d,e,g,h,i=1,j=this.radiuspoint,k=this.center,l=this.anglepoint,n=f.evaluate(this.visProp.selection);c=b.rad(j,k,l),("minor"===n&&c>Math.PI||"major"===n&&c<Math.PI)&&(i=-1),this.useDirection&&(e=m[1].coords.usrCoords,g=m[3].coords.usrCoords,h=m[2].coords.usrCoords,d=(e[1]-h[1])*(e[2]-g[2])-(e[2]-h[2])*(e[1]-g[1]),d<0?(this.radiuspoint=m[1],this.anglepoint=m[2]):(this.radiuspoint=m[2],this.anglepoint=m[1])),j=j.coords.usrCoords,k=k.coords.usrCoords,l=l.coords.usrCoords,a=b.bezierArc(j,k,l,!1,i),this.dataX=a[0],this.dataY=a[1],this.bezierDegree=3,this.updateStdform(),this.updateQuadraticform()},k.Radius=function(){return this.radiuspoint.Dist(this.center)},k.getRadius=function(){return a.deprecated("Arc.getRadius()","Arc.Radius()"),this.Radius()},k.Value=function(){return this.Radius()*b.rad(this.radiuspoint,this.center,this.anglepoint)},k.hasPoint=function(a,e){var h,i,j,k,l,m,n,o,p,q=this.Radius(),r=f.evaluate(this.visProp.selection);return f.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(a,e):(p=this.board.options.precision.hasPoint/Math.min(this.board.unitX,this.board.unitY),i=new d(g.COORDS_BY_SCREEN,[a,e],this.board),this.transformations.length>0&&(this.updateTransformMatrix(),n=c.inverse(this.transformMat),o=c.matVecMult(n,i.usrCoords),i=new d(g.COORDS_BY_USER,o,this.board)),h=this.center.coords.distance(g.COORDS_BY_USER,i),j=Math.abs(h-q)<p,j&&(k=b.rad(this.radiuspoint,this.center,i.usrCoords.slice(1)),l=0,m=b.rad(this.radiuspoint,this.center,this.anglepoint),("minor"===r&&m>Math.PI||"major"===r&&m<Math.PI)&&(l=m,m=2*Math.PI),(k<l||k>m)&&(j=!1)),j)},k.hasPointSector=function(a,c){var e,h,i,j=new d(g.COORDS_BY_SCREEN,[a,c],this.board),k=this.Radius(),l=this.center.coords.distance(g.COORDS_BY_USER,j),m=l<k,n=f.evaluate(this.visProp.selection);return m&&(e=b.rad(this.radiuspoint,this.center,j.usrCoords.slice(1)),h=0,i=b.rad(this.radiuspoint,this.center,this.anglepoint),("minor"===n&&i>Math.PI||"major"===n&&i<Math.PI)&&(h=i,i=2*Math.PI),(e<h||e>i)&&(m=!1)),m},k.getTextAnchor=function(){return this.center.coords},k.getLabelAnchor=function(){var a,c,e,h,i,j=b.rad(this.radiuspoint,this.center,this.anglepoint),k=10/this.board.unitX,l=10/this.board.unitY,m=this.point2.coords.usrCoords,n=this.center.coords.usrCoords,o=m[1]-n[1],p=m[2]-n[2],q=f.evaluate(this.visProp.selection),r=this.label?this.label.visProp:this.visProp.label;return("minor"===q&&j>Math.PI||"major"===q&&j<Math.PI)&&(j=-(2*Math.PI-j)),a=new d(g.COORDS_BY_USER,[n[1]+Math.cos(.5*j)*o-Math.sin(.5*j)*p,n[2]+Math.sin(.5*j)*o+Math.cos(.5*j)*p],this.board),e=a.usrCoords[1]-n[1],h=a.usrCoords[2]-n[2],i=Math.sqrt(e*e+h*h),e=e*(i+k)/i,h=h*(i+l)/i,c=[n[1]+e,n[2]+h],r.position=b.calcLabelQuadrant(b.rad([1,0],[0,0],c)),new d(g.COORDS_BY_USER,c,this.board)},k.updateQuadraticform=e.Circle.prototype.updateQuadraticform,k.updateStdform=e.Circle.prototype.updateStdform,k.methodMap=a.deepCopy(k.methodMap,{getRadius:"getRadius",radius:"Radius",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",Value:"Value"}),k.prepareUpdate().update(),k},a.registerElement("arc",a.createArc),a.createSemicircle=function(a,b,c){var d,e,g,h;if(h=f.providePoints(a,b,c,"point"),h===!1||2!==h.length)throw new Error("JSXGraph: Can't create Semicircle with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,point]");return g=f.copyAttributes(c,a.options,"semicircle","center"),e=a.create("midpoint",h,g),e.dump=!1,g=f.copyAttributes(c,a.options,"semicircle"),d=a.create("arc",[e,h[1],h[0]],g),d.elType="semicircle",d.setParents([h[0].id,h[1].id]),d.subs={midpoint:e},d.inherits.push(e),d.midpoint=d.center=e,d},a.registerElement("semicircle",a.createSemicircle),a.createCircumcircleArc=function(a,b,c){var d,e,g,h;if(h=f.providePoints(a,b,c,"point"),h===!1||3!==h.length)throw new Error("JSXGraph: create Circumcircle Arc with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"' and '"+typeof b[2]+"'.\nPossible parent types: [point,point,point]");return g=f.copyAttributes(c,a.options,"circumcirclearc","center"),e=a.create("circumcenter",h,g),e.dump=!1,g=f.copyAttributes(c,a.options,"circumcirclearc"),g.usedirection=!0,d=a.create("arc",[e,h[0],h[2],h[1]],g),d.elType="circumcirclearc",d.setParents([h[0].id,h[1].id,h[2].id]),d.subs={center:e},d.inherits.push(e),d.center=e,d},a.registerElement("circumcirclearc",a.createCircumcircleArc),a.createMinorArc=function(b,c,d){return d.selection="minor",a.createArc(b,c,d)},a.registerElement("minorarc",a.createMinorArc),a.createMajorArc=function(b,c,d){return d.selection="major",a.createArc(b,c,d)},a.registerElement("majorarc",a.createMajorArc),{createArc:a.createArc,createSemicircle:a.createSemicircle,createCircumcircleArc:a.createCircumcircleArc,createMinorArc:a.createMinorArc,createMajorArc:a.createMajorArc}}),define("element/sector",["jxg","math/geometry","math/math","math/statistics","base/coords","base/constants","utils/type","base/point","base/curve","base/transformation","element/composition"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";return a.createSector=function(h,i,j){var k,l,m,n,o,p="invalid",q=["center","radiuspoint","anglepoint"];if(i[0].elementClass===f.OBJECT_CLASS_LINE&&i[1].elementClass===f.OBJECT_CLASS_LINE&&(g.isArray(i[2])||g.isNumber(i[2]))&&(g.isArray(i[3])||g.isNumber(i[3]))&&(g.isNumber(i[4])||g.isFunction(i[4])))p="2lines";else{if(o=g.providePoints(h,i,j,"sector",q),o===!1)throw new Error("JSXGraph: Can't create Sector with parent types '"+typeof i[0]+"' and '"+typeof i[1]+"' and '"+typeof i[2]+"'.");p="3points"}return l=g.copyAttributes(j,h.options,"sector"),k=h.create("curve",[[0],[0]],l),k.type=f.OBJECT_TYPE_SECTOR,k.elType="sector","2lines"===p?(k.Radius=function(){return g.evaluate(i[4])},k.line1=h.select(i[0]),k.line2=h.select(i[1]),k.line1.addChild(k),k.line2.addChild(k),k.setParents(i),k.point1={visProp:{}},k.point2={visProp:{}},k.point3={visProp:{}},m=b.meetLineLine(k.line1.stdform,k.line2.stdform,0,h),g.isArray(i[2])?(2===i[2].length&&(i[2]=[1].concat(i[2])),n=b.projectPointToLine({coords:{usrCoords:i[2]}},k.line1,h),n=d.subtract(n.usrCoords,m.usrCoords),k.direction1=c.innerProduct(n,[0,k.line1.stdform[2],-k.line1.stdform[1]],3)>=0?1:-1):k.direction1=i[2]>=0?1:-1,g.isArray(i[3])?(2===i[3].length&&(i[3]=[1].concat(i[3])),n=b.projectPointToLine({coords:{usrCoords:i[3]}},k.line2,h),n=d.subtract(n.usrCoords,m.usrCoords),k.direction2=c.innerProduct(n,[0,k.line2.stdform[2],-k.line2.stdform[1]],3)>=0?1:-1):k.direction2=i[3]>=0?1:-1,k.updateDataArray=function(){var a,g,h,i,j=[0,0,0],l=[0,0,0],m=[0,0,0];return g=this.line1,h=this.line2,l=c.crossProduct(g.stdform,h.stdform),Math.abs(l[0])>c.eps*c.eps&&(l[1]/=l[0],l[2]/=l[0],l[0]/=l[0]),a=this.direction1*this.Radius(),j=d.add(l,[0,a*g.stdform[2],-a*g.stdform[1]]),a=this.direction2*this.Radius(),m=d.add(l,[0,a*h.stdform[2],-a*h.stdform[1]]),this.point2.coords=new e(f.COORDS_BY_USER,j,k.board),this.point1.coords=new e(f.COORDS_BY_USER,l,k.board),this.point3.coords=new e(f.COORDS_BY_USER,m,k.board),Math.abs(j[0])<c.eps||Math.abs(l[0])<c.eps||Math.abs(m[0])<c.eps?(this.dataX=[NaN],void(this.dataY=[NaN])):(i=b.bezierArc(j,l,m,!0,1),this.dataX=i[0],this.dataY=i[1],void(this.bezierDegree=3))},k.methodMap=a.deepCopy(k.methodMap,{radius:"getRadius",getRadius:"getRadius",setRadius:"setRadius"}),k.prepareUpdate().update()):"3points"===p&&(k.point1=o[0],k.point2=o[1],k.point3=o[2],k.point1.addChild(k),k.point2.addChild(k),k.point3.addChild(k),k.useDirection=j.usedirection,k.setParents(o),g.exists(o[3])&&(k.point4=o[3],k.point4.addChild(k)),k.methodMap=a.deepCopy(k.methodMap,{arc:"arc",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",radius:"getRadius",getRadius:"getRadius",setRadius:"setRadius"}),k.updateDataArray=function(){var a,c,d,e,f,h,i=this.point2,j=this.point1,k=this.point3,l=1,m=g.evaluate(this.visProp.selection);return i.isReal&&j.isReal&&k.isReal?(h=b.rad(i,j,k),("minor"===m&&h>Math.PI||"major"===m&&h<Math.PI)&&(l=-1),this.useDirection&&g.exists(this.point4)&&(d=this.point2.coords.usrCoords,e=this.point4.coords.usrCoords,f=this.point3.coords.usrCoords,c=(d[1]-f[1])*(d[2]-e[2])-(d[2]-f[2])*(d[1]-e[1]),c>=0&&(k=this.point2,i=this.point3)),i=i.coords.usrCoords,j=j.coords.usrCoords,k=k.coords.usrCoords,a=b.bezierArc(i,j,k,!0,l),this.dataX=a[0],this.dataY=a[1],void(this.bezierDegree=3)):(this.dataX=[NaN],void(this.dataY=[NaN]))},k.Radius=function(){return this.point2.Dist(this.point1)},l=g.copyAttributes(j,h.options,"sector","arc"),l.withLabel=!1,l.name+="_arc",k.arc=h.create("arc",[k.point1,k.point2,k.point3],l),k.addChild(k.arc)),k.center=k.point1,k.radiuspoint=k.point2,k.anglepoint=k.point3,k.hasPointCurve=function(a,c){var d,h,i,j,k,l=new e(f.COORDS_BY_SCREEN,[a,c],this.board),m=this.Radius(),n=this.center.coords.distance(f.COORDS_BY_USER,l),o=g.evaluate(this.visProp.selection);return j=this.board.options.precision.hasPoint/Math.min(this.board.unitX,this.board.unitY),k=Math.abs(n-m)<j,k&&(d=b.rad(this.point2,this.center,l.usrCoords.slice(1)),h=0,i=b.rad(this.point2,this.center,this.point3),("minor"===o&&i>Math.PI||"major"===o&&i<Math.PI)&&(h=i,i=2*Math.PI),(d<h||d>i)&&(k=!1)),k},k.hasPointSector=function(a,c){var d,h,i,j=new e(f.COORDS_BY_SCREEN,[a,c],this.board),k=this.Radius(),l=this.point1.coords.distance(f.COORDS_BY_USER,j),m=l<k,n=g.evaluate(this.visProp.selection);return m&&(d=b.rad(this.radiuspoint,this.center,j.usrCoords.slice(1)),h=0,i=b.rad(this.radiuspoint,this.center,this.anglepoint),("minor"===n&&i>Math.PI||"major"===n&&i<Math.PI)&&(h=i,i=2*Math.PI),(d<h||d>i)&&(m=!1)),m},k.hasPoint=function(a,b){return g.evaluate(this.visProp.highlightonsector)||g.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(a,b):this.hasPointCurve(a,b)},k.getTextAnchor=function(){return this.point1.coords},k.getLabelAnchor=function(){var a,c,d,h,i,j=b.rad(this.point2,this.point1,this.point3),k=13/this.board.unitX,l=13/this.board.unitY,m=this.point2.coords.usrCoords,n=this.point1.coords.usrCoords,o=m[1]-n[1],p=m[2]-n[2],q=g.evaluate(this.visProp.selection),r=this.label?this.label.visProp:this.visProp.label;return("minor"===q&&j>Math.PI||"major"===q&&j<Math.PI)&&(j=-(2*Math.PI-j)),a=new e(f.COORDS_BY_USER,[n[1]+Math.cos(.5*j)*o-Math.sin(.5*j)*p,n[2]+Math.sin(.5*j)*o+Math.cos(.5*j)*p],this.board),d=a.usrCoords[1]-n[1],h=a.usrCoords[2]-n[2],i=Math.sqrt(d*d+h*h),d=d*(i+k)/i,h=h*(i+l)/i,c=[n[1]+d,n[2]+h],r.position=b.calcLabelQuadrant(b.rad([1,0],[0,0],c)),new e(f.COORDS_BY_USER,c,this.board)},k.setRadius=function(a){k.Radius=function(){return g.evaluate(a)}},k.getRadius=function(){return a.deprecated("Sector.getRadius()","Sector.Radius()"),this.Radius()},"3points"===p&&(k.setPositionDirectly=function(a,b,c){var f,g,h=new e(a,b,this.board),i=new e(a,c,this.board);return k.point1.draggable()&&k.point2.draggable()&&k.point3.draggable()?(f=d.subtract(h.usrCoords,i.usrCoords),g=this.board.create("transform",f.slice(1),{type:"translate"}),g.applyOnce([k.point1,k.point2,k.point3]),this):this}),k.prepareUpdate().update(),k},a.registerElement("sector",a.createSector),a.createCircumcircleSector=function(a,b,c){var d,e,f,h;if(h=g.providePoints(a,b,c,"point"),h===!1)throw new Error("JSXGraph: Can't create circumcircle sector with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"' and '"+typeof b[2]+"'.");return e=a.create("circumcenter",h.slice(0,3),f),e.dump=!1,f=g.copyAttributes(c,a.options,"circumcirclesector"),d=a.create("sector",[e,h[0],h[2],h[1]],f),d.elType="circumcirclesector",d.setParents(h),d.center=e,d.subs={center:e},d},a.registerElement("circumcirclesector",a.createCircumcircleSector),a.createMinorSector=function(b,c,d){return d.selection="minor",a.createSector(b,c,d)},a.registerElement("minorsector",a.createMinorSector),a.createMajorSector=function(b,c,d){return d.selection="major",a.createSector(b,c,d)},a.registerElement("majorsector",a.createMajorSector),a.createAngle=function(a,d,h){var i,j,k,l,m,n,o="invalid";if(d[0].elementClass===f.OBJECT_CLASS_LINE&&d[1].elementClass===f.OBJECT_CLASS_LINE&&(g.isArray(d[2])||g.isNumber(d[2]))&&(g.isArray(d[3])||g.isNumber(d[3])))o="2lines";else{if(n=g.providePoints(a,d,h,"point"),n===!1)throw new Error("JSXGraph: Can't create angle with parent types '"+typeof d[0]+"' and '"+typeof d[1]+"' and '"+typeof d[2]+"'.");o="3points"}if(k=g.copyAttributes(h,a.options,"angle"),g.exists(k.name)&&""!==k.name||(k.name=a.generateName({type:f.OBJECT_TYPE_ANGLE})),j=g.exists(k.radius)?k.radius:0,"2lines"===o?(d.push(j),i=a.create("sector",d,k),i.updateDataArraySector=i.updateDataArray,i.setAngle=function(a){},i.free=function(a){}):(i=a.create("sector",[n[1],n[0],n[2]],k),i.arc.visProp.priv=!0,i.point=i.point2=i.radiuspoint=n[0],i.pointsquare=i.point3=i.anglepoint=n[2],i.Radius=function(){return g.evaluate(j)},i.updateDataArraySector=function(){var a,c,d=this.point2,e=this.point1,f=this.point3,h=this.Radius(),i=e.Dist(d),j=1,k=g.evaluate(this.visProp.selection);c=b.rad(d,e,f),("minor"===k&&c>Math.PI||"major"===k&&c<Math.PI)&&(j=-1),d=d.coords.usrCoords,e=e.coords.usrCoords,f=f.coords.usrCoords,d=[1,e[1]+(d[1]-e[1])*h/i,e[2]+(d[2]-e[2])*h/i],f=[1,e[1]+(f[1]-e[1])*h/i,e[2]+(f[2]-e[2])*h/i],a=b.bezierArc(d,e,f,!0,j),this.dataX=a[0],this.dataY=a[1],this.bezierDegree=3},i.setAngle=function(a){var b,c=this.anglepoint,d=this.radiuspoint;return c.draggable()&&(b=this.board.create("transform",[a,this.center],{type:"rotate"}),c.addTransform(d,b),c.isDraggable=!1,c.setParents(d)),this},i.free=function(){var a=this.anglepoint;return a.transformations.length>0&&(a.transformations.pop(),a.isDraggable=!0,a.parents=[]),this},i.setParents(n)),g.exists(i.visProp.text)&&i.label.setText(g.evaluate(i.visProp.text)),i.elType="angle",i.type=f.OBJECT_TYPE_ANGLE,i.subs={},i.updateDataArraySquare=function(){var a,d,e,f,g,h,i,j,k=this.Radius();"2lines"===o&&this.updateDataArraySector(),a=this.point2,d=this.point1,e=this.point3,a=a.coords.usrCoords,d=d.coords.usrCoords,e=e.coords.usrCoords,f=b.distance(a,d,3),g=b.distance(e,d,3),a=[1,d[1]+(a[1]-d[1])*k/f,d[2]+(a[2]-d[2])*k/f],e=[1,d[1]+(e[1]-d[1])*k/g,d[2]+(e[2]-d[2])*k/g],h=c.crossProduct(e,d),i=[-a[1]*h[1]-a[2]*h[2],a[0]*h[1],a[0]*h[2]],h=c.crossProduct(a,d),j=[-e[1]*h[1]-e[2]*h[2],e[0]*h[1],e[0]*h[2]],h=c.crossProduct(i,j),h[1]/=h[0],h[2]/=h[0],this.dataX=[d[1],a[1],h[1],e[1],d[1]],this.dataY=[d[2],a[2],h[2],e[2],d[2]],this.bezierDegree=1},i.updateDataArrayNone=function(){this.dataX=[NaN],this.dataY=[NaN],this.bezierDegree=1},i.updateDataArray=function(){var a=g.evaluate(this.visProp.type),d=b.trueAngle(this.point2,this.point1,this.point3),e=g.evaluate(this.visProp.selection);("minor"===e&&d>180||"major"===e&&d<180)&&(d=360-d),Math.abs(d-90)<g.evaluate(this.visProp.orthosensitivity)+c.eps&&(a=g.evaluate(this.visProp.orthotype)),"none"===a?this.updateDataArrayNone():"square"===a?this.updateDataArraySquare():"sector"===a?this.updateDataArraySector():"sectordot"===a&&(this.updateDataArraySector(),this.dot.visProp.visible||this.dot.setAttribute({visible:!0})),(!this.visProp.visible||"sectordot"!==a&&this.dot.visProp.visible)&&this.dot.setAttribute({visible:!1})},l=g.copyAttributes(h,a.options,"angle","dot"),i.dot=a.create("point",[function(){var a,d,e,f,h,j,k,l,m;return g.exists(i.dot)&&!i.dot.visProp.visible?[0,0]:(a=i.point2.coords.usrCoords,d=i.point1.coords.usrCoords,e=i.Radius(),f=b.distance(a,d,3),h=b.rad(i.point2,i.point1,i.point3),m=g.evaluate(i.visProp.selection),("minor"===m&&h>Math.PI||"major"===m&&h<Math.PI)&&(h=-(2*Math.PI-h)),h*=.5,j=Math.cos(h),k=Math.sin(h),a=[1,d[1]+(a[1]-d[1])*e/f,d[2]+(a[2]-d[2])*e/f],l=[[1,0,0],[d[1]-.5*d[1]*j+.5*d[2]*k,.5*j,.5*-k],[d[2]-.5*d[1]*k-.5*d[2]*j,.5*k,.5*j]],c.matVecMult(l,a))}],l),i.dot.dump=!1,i.subs.dot=i.dot,"2lines"===o)for(m=0;m<2;m++)a.select(d[m]).addChild(i.dot);else for(m=0;m<3;m++)a.select(n[m]).addChild(i.dot);return i.getLabelAnchor=function(){var a,d,h,j,k,l,m,n,o,p=12,q=g.evaluate(i.visProp.selection),r=this.label?this.label.visProp:this.visProp.label;return g.exists(this.label.visProp.fontSize)&&(p=dy=g.evaluate(this.label.visProp.fontSize)),p/=this.board.unitX,d=i.point2.coords.usrCoords,h=i.point1.coords.usrCoords,j=i.Radius(),k=b.distance(d,h,3),l=b.rad(i.point2,i.point1,i.point3),("minor"===q&&l>Math.PI||"major"===q&&l<Math.PI)&&(l=-(2*Math.PI-l)),l*=.5,m=Math.cos(l),n=Math.sin(l),d=[1,h[1]+(d[1]-h[1])*j/k,h[2]+(d[2]-h[2])*j/k],o=[[1,0,0],[h[1]-.5*h[1]*m+.5*h[2]*n,.5*m,.5*-n],[h[2]-.5*h[1]*n-.5*h[2]*m,.5*n,.5*m]],a=c.matVecMult(o,d),a[1]/=a[0],a[2]/=a[0],a[0]/=a[0],k=b.distance(a,h,3),a=[a[0],h[1]+(a[1]-h[1])*(j+p)/k,h[2]+(a[2]-h[2])*(j+p)/k],r.position=b.calcLabelQuadrant(b.rad([1,0],[0,0],a)),new e(f.COORDS_BY_USER,a,this.board)},i.Value=function(){return b.rad(this.point2,this.point1,this.point3)},i.methodMap=g.deepCopy(i.methodMap,{Value:"Value",setAngle:"setAngle",free:"free"}),i},a.registerElement("angle",a.createAngle),a.createNonreflexAngle=function(c,d,e){var f;return e.selection="minor",f=a.createAngle(c,d,e),f.Value=function(){var a=b.rad(this.point2,this.point1,this.point3);return a<Math.PI?a:2*Math.PI-a},f},a.registerElement("nonreflexangle",a.createNonreflexAngle),a.createReflexAngle=function(c,d,e){var f;return e.selection="major",f=a.createAngle(c,d,e),f.Value=function(){var a=b.rad(this.point2,this.point1,this.point3);return a>=Math.PI?a:2*Math.PI-a},f},a.registerElement("reflexangle",a.createReflexAngle),{createSector:a.createSector,createCircumcircleSector:a.createCircumcircleSector,createMinorSector:a.createMinorSector,createMajorSector:a.createMajorSector,createAngle:a.createAngle,createReflexAngle:a.createReflexAngle,createNonreflexAngle:a.createNonreflexAngle}}),define("element/composition",["jxg","math/math","math/geometry","math/numerics","math/statistics","base/coords","utils/type","base/constants","base/point","base/line","base/circle","base/transformation","base/composition","base/curve","base/text","base/polygon","element/arc","element/sector"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){"use strict";return a.createOrthogonalProjection=function(a,b,d){var e,f,i,j;if(b[0]=a.select(b[0]),b[1]=a.select(b[1]),g.isPointType(a,b[0])&&b[1].elementClass===h.OBJECT_CLASS_LINE)f=g.providePoints(a,[b[0]],d,"point")[0],e=b[1];else{if(!g.isPointType(a,b[1])||b[0].elementClass!==h.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,line]");f=g.providePoints(a,[b[1]],d,"point")[0],e=b[0]}return j=g.copyAttributes(d,a.options,"orthogonalprojection"),i=a.create("point",[function(){return c.projectPointToLine(f,e,a)}],j),f.addChild(i),e.addChild(i),i.elType="orthogonalprojection",i.setParents([f.id,i.id]),i.update(),i.generatePolynomial=function(){var a=e.point1.symbolic.x,b=e.point1.symbolic.y,c=e.point2.symbolic.x,d=e.point2.symbolic.y,g=f.symbolic.x,h=f.symbolic.y,j=i.symbolic.x,k=i.symbolic.y,l="("+b+")*("+j+")-("+b+")*("+c+")+("+k+")*("+c+")-("+a+")*("+k+")+("+a+")*("+d+")-("+j+")*("+d+")",m="("+h+")*("+b+")-("+h+")*("+d+")-("+k+")*("+b+")+("+k+")*("+d+")+("+g+")*("+a+")-("+g+")*("+c+")-("+j+")*("+a+")+("+j+")*("+c+")";return[l,m]},i},a.createPerpendicular=function(a,b,c){var d,e,f,i;if(b[0]=a.select(b[0]),b[1]=a.select(b[1]),g.isPointType(a,b[0])&&b[1].elementClass===h.OBJECT_CLASS_LINE)e=b[1],d=g.providePoints(a,[b[0]],c,"point")[0];else{if(!g.isPointType(a,b[1])||b[0].elementClass!==h.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [line,point]");e=b[0],d=g.providePoints(a,[b[1]],c,"point")[0]}return i=g.copyAttributes(c,a.options,"perpendicular"),f=j.createLine(a,[function(){return e.stdform[2]*d.X()-e.stdform[1]*d.Y()},function(){return-e.stdform[2]*d.Z()},function(){return e.stdform[1]*d.Z()}],i),f.elType="perpendicular",f.setParents([e.id,d.id]),f},a.createPerpendicularPoint=function(a,b,d){var e,f,i;if(b[0]=a.select(b[0]),b[1]=a.select(b[1]),g.isPointType(a,b[0])&&b[1].elementClass===h.OBJECT_CLASS_LINE)f=g.providePoints(a,[b[0]],d,"point")[0],e=b[1];else{if(!g.isPointType(a,b[1])||b[0].elementClass!==h.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,line]");f=g.providePoints(a,[b[1]],d,"point")[0],e=b[0]}return i=a.create("point",[function(){return c.perpendicular(e,f,a)[0]}],d),f.addChild(i),e.addChild(i),i.elType="perpendicularpoint",i.setParents([f.id,e.id]),i.update(),i.generatePolynomial=function(){var a=e.point1.symbolic.x,b=e.point1.symbolic.y,c=e.point2.symbolic.x,d=e.point2.symbolic.y,g=f.symbolic.x,h=f.symbolic.y,j=i.symbolic.x,k=i.symbolic.y,l="("+b+")*("+j+")-("+b+")*("+c+")+("+k+")*("+c+")-("+a+")*("+k+")+("+a+")*("+d+")-("+j+")*("+d+")",m="("+h+")*("+b+")-("+h+")*("+d+")-("+k+")*("+b+")+("+k+")*("+d+")+("+g+")*("+a+")-("+g+")*("+c+")-("+j+")*("+a+")+("+j+")*("+c+")";return[l,m]},i},a.createPerpendicularSegment=function(b,d,e){var f,i,k,l,m;if(d[0]=b.select(d[0]),d[1]=b.select(d[1]),g.isPointType(b,d[0])&&d[1].elementClass===h.OBJECT_CLASS_LINE)i=d[1],f=g.providePoints(b,[d[0]],e,"point")[0];else{if(!g.isPointType(b,d[1])||d[0].elementClass!==h.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof d[0]+"' and '"+typeof d[1]+"'.\nPossible parent types: [line,point]");i=d[0],f=g.providePoints(b,[d[1]],e,"point")[0]}return m=g.copyAttributes(e,b.options,"perpendicularsegment","point"),l=a.createPerpendicularPoint(b,[i,f],m),l.dump=!1,g.exists(e.layer)||(e.layer=b.options.layer.line),m=g.copyAttributes(e,b.options,"perpendicularsegment"),k=j.createLine(b,[function(){return c.perpendicular(i,f,b)[1]?[l,f]:[f,l]}],m),k.point=l,k.elType="perpendicularsegment",k.setParents([f.id,i.id]),k.subs={point:l},k.inherits.push(l),k},a.createMidpoint=function(a,c,d){var e,f,i,j,k;for(j=0;j<c.length;++j)c[j]=a.select(c[j]);if(2===c.length&&g.isPointType(a,c[0])&&g.isPointType(a,c[1]))c=g.providePoints(a,c,d,"point"),e=c[0],f=c[1];else{if(1!==c.length||c[0].elementClass!==h.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create midpoint.\nPossible parent types: [point,point], [line]");e=c[0].point1,f=c[0].point2}return k=g.copyAttributes(d,a.options,"midpoint"),i=a.create("point",[function(){var a=e.coords.usrCoords[1]+f.coords.usrCoords[1];return isNaN(a)||Math.abs(e.coords.usrCoords[0])<b.eps||Math.abs(f.coords.usrCoords[0])<b.eps?NaN:.5*a},function(){var a=e.coords.usrCoords[2]+f.coords.usrCoords[2];return isNaN(a)||Math.abs(e.coords.usrCoords[0])<b.eps||Math.abs(f.coords.usrCoords[0])<b.eps?NaN:.5*a}],k),e.addChild(i),f.addChild(i),i.elType="midpoint",i.setParents([e.id,f.id]),i.prepareUpdate().update(),i.generatePolynomial=function(){var a=e.symbolic.x,b=e.symbolic.y,c=f.symbolic.x,d=f.symbolic.y,g=i.symbolic.x,h=i.symbolic.y,j="("+b+")*("+g+")-("+b+")*("+c+")+("+h+")*("+c+")-("+a+")*("+h+")+("+a+")*("+d+")-("+g+")*("+d+")",k="("+a+")^2 - 2*("+a+")*("+g+")+("+b+")^2-2*("+b+")*("+h+")-("+c+")^2+2*("+c+")*("+g+")-("+d+")^2+2*("+d+")*("+h+")";return[j,k]},i},a.createParallelPoint=function(a,b,c){var d,e,f,i,j;for(j=0;j<b.length;++j)b[j]=a.select(b[j]);if(3===b.length&&g.isPointType(a,b[0])&&g.isPointType(a,b[1])&&g.isPointType(a,b[2]))b=g.providePoints(a,b,c,"point"),d=b[0],e=b[1],f=b[2];else if(g.isPointType(a,b[0])&&b[1].elementClass===h.OBJECT_CLASS_LINE)f=g.providePoints(a,[b[0]],c,"point")[0],d=b[1].point1,e=b[1].point2;else{if(!g.isPointType(a,b[1])||b[0].elementClass!==h.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create parallel point with parent types '"+typeof b[0]+"', '"+typeof b[1]+"' and '"+typeof b[2]+"'.\nPossible parent types: [line,point], [point,point,point]");f=g.providePoints(a,[b[1]],c,"point")[0],d=b[0].point1,e=b[0].point2}return i=a.create("point",[function(){return f.coords.usrCoords[1]+e.coords.usrCoords[1]-d.coords.usrCoords[1]},function(){return f.coords.usrCoords[2]+e.coords.usrCoords[2]-d.coords.usrCoords[2]}],c),d.addChild(i),e.addChild(i),f.addChild(i),i.elType="parallelpoint",i.setParents([d.id,e.id,f.id]),i.prepareUpdate().update(),i.generatePolynomial=function(){var a=d.symbolic.x,b=d.symbolic.y,c=e.symbolic.x,g=e.symbolic.y,h=f.symbolic.x,j=f.symbolic.y,k=i.symbolic.x,l=i.symbolic.y,m="("+g+")*("+k+")-("+g+")*("+h+")-("+b+")*("+k+")+("+b+")*("+h+")-("+l+")*("+c+")+("+l+")*("+a+")+("+j+")*("+c+")-("+j+")*("+a+")",n="("+l+")*("+a+")-("+l+")*("+h+")-("+g+")*("+a+")+("+g+")*("+h+")-("+k+")*("+b+")+("+k+")*("+j+")+("+c+")*("+b+")-("+c+")*("+j+")";return[m,n]},i},a.createParallel=function(a,c,d){var e,f,h,i,j,k;for(j=0;j<c.length;++j)c[j]=a.select(c[j]);return e=null,3===c.length?(c=g.providePoints(a,c,d,"point"),e=c[2],i=function(){return b.crossProduct(c[0].coords.usrCoords,c[1].coords.usrCoords)}):g.isPointType(a,c[0])?(e=g.providePoints(a,[c[0]],d,"point")[0],i=function(){return c[1].stdform}):g.isPointType(a,c[1])&&(e=g.providePoints(a,[c[1]],d,"point")[0],i=function(){return c[0].stdform}),g.exists(d.layer)||(d.layer=a.options.layer.line),k=g.copyAttributes(d,a.options,"parallel","point"),f=a.create("point",[function(){return b.crossProduct([1,0,0],i())}],k),f.isDraggable=!0,k=g.copyAttributes(d,a.options,"parallel"),h=a.create("line",[e,f],k),h.elType="parallel",h.subs={point:f},h.inherits.push(f),h.setParents([c[0].id,c[1].id]),3===c.length&&h.addParents(c[2].id),h.point=f,h},a.createArrowParallel=function(b,c,d){var e;try{return d.firstArrow=!1,d.lastArrow=!0,e=a.createParallel(b,c,d).setAttribute({straightFirst:!1,straightLast:!1}),e.elType="arrowparallel",e}catch(f){throw new Error("JSXGraph: Can't create arrowparallel with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [line,point], [point,point,point]")}},a.createNormal=function(a,c,e){var f,i,j,k,l,m,n,o,p;for(k=0;k<c.length;++k)c[k]=a.select(c[k]);if(1===c.length)f=c[0],i=f.slideObject;else{if(2!==c.length)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [point,line], [point,circle], [glider]");if(g.isPointType(a,c[0]))f=g.providePoints(a,[c[0]],e,"point")[0],i=c[1];else{if(!g.isPointType(a,c[1]))throw new Error("JSXGraph: Can't create normal with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [point,line], [point,circle], [glider]");i=c[0],f=g.providePoints(a,[c[1]],e,"point")[0]}}if(n=g.copyAttributes(e,a.options,"normal"),i.elementClass===h.OBJECT_CLASS_LINE)p=g.copyAttributes(e,a.options,"normal","point"),o=a.create("point",[function(){var a=b.crossProduct([1,0,0],i.stdform);return[a[0],-a[2],a[1]]}],p),o.isDraggable=!0,j=a.create("line",[f,o],n),j.point=o,j.subs={point:o},j.inherits.push(o);else if(i.elementClass===h.OBJECT_CLASS_CIRCLE)j=a.create("line",[i.midpoint,f],n);else if(i.elementClass===h.OBJECT_CLASS_CURVE)"plot"!==g.evaluate(i.visProp.curvetype)?(l=i.X,m=i.Y,j=a.create("line",[function(){return-f.X()*d.D(l)(f.position)-f.Y()*d.D(m)(f.position)},function(){return d.D(l)(f.position)},function(){return d.D(m)(f.position)}],n)):j=a.create("line",[function(){var a=Math.floor(f.position),b=f.position-a;return a===i.numberPoints-1&&(a-=1,b=1),a<0?1:(i.Y(a)+b*(i.Y(a+1)-i.Y(a)))*(i.Y(a)-i.Y(a+1))-(i.X(a)+b*(i.X(a+1)-i.X(a)))*(i.X(a+1)-i.X(a))},function(){var a=Math.floor(f.position);return a===i.numberPoints-1&&(a-=1),a<0?0:i.X(a+1)-i.X(a)},function(){var a=Math.floor(f.position);return a===i.numberPoints-1&&(a-=1),a<0?0:i.Y(a+1)-i.Y(a)}],n);else{if(i.type!==h.OBJECT_TYPE_TURTLE)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [point,line], [point,circle], [glider]");j=a.create("line",[function(){var a,b,c=Math.floor(f.position),d=f.position-c;for(b=0;b<i.objects.length;b++)if(a=i.objects[b],a.type===h.OBJECT_TYPE_CURVE){if(c<a.numberPoints)break;c-=a.numberPoints}return c===a.numberPoints-1&&(c-=1,d=1),c<0?1:(a.Y(c)+d*(a.Y(c+1)-a.Y(c)))*(a.Y(c)-a.Y(c+1))-(a.X(c)+d*(a.X(c+1)-a.X(c)))*(a.X(c+1)-a.X(c))},function(){var a,b,c=Math.floor(f.position);for(b=0;b<i.objects.length;b++)if(a=i.objects[b],a.type===h.OBJECT_TYPE_CURVE){if(c<a.numberPoints)break;c-=a.numberPoints}return c===a.numberPoints-1&&(c-=1),c<0?0:a.X(c+1)-a.X(c)},function(){var a,b,c=Math.floor(f.position);for(b=0;b<i.objects.length;b++)if(a=i.objects[b],a.type===h.OBJECT_TYPE_CURVE){if(c<a.numberPoints)break;c-=a.numberPoints}return c===a.numberPoints-1&&(c-=1),c<0?0:a.Y(c+1)-a.Y(c)}],n)}return j.elType="normal",j.setParents(c),j},a.createBisector=function(a,b,d){var e,f,h,i;if(b=g.providePoints(a,b,d,"point"),g.isPoint(b[0])&&g.isPoint(b[1])&&g.isPoint(b[2])){for(i=g.copyAttributes(d,a.options,"bisector","point"),i.snapToGrid=!1,e=a.create("point",[function(){return c.angleBisector(b[0],b[1],b[2],a)}],i),e.dump=!1,h=0;h<3;h++)b[h].addChild(e);return g.exists(d.layer)||(d.layer=a.options.layer.line),i=g.copyAttributes(d,a.options,"bisector"),f=j.createLine(a,[b[1],e],i),f.point=e,f.elType="bisector",f.setParents(b),f.subs={point:e},f.inherits.push(e),f}throw new Error("JSXGraph: Can't create angle bisector with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,point,point]")},a.createAngularBisectorsOfTwoLines=function(a,b,c){var d,e,f,i,j=a.select(b[0]),k=a.select(b[1]);if(j.elementClass!==h.OBJECT_CLASS_LINE||k.elementClass!==h.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create angle bisectors of two lines with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [line,line]");return g.exists(c.layer)||(c.layer=a.options.layer.line),f=g.copyAttributes(c,a.options,"bisectorlines","line1"),d=a.create("line",[function(){var a=Math.sqrt(j.stdform[1]*j.stdform[1]+j.stdform[2]*j.stdform[2]),b=Math.sqrt(k.stdform[1]*k.stdform[1]+k.stdform[2]*k.stdform[2]);return j.stdform[0]/a-k.stdform[0]/b},function(){var a=Math.sqrt(j.stdform[1]*j.stdform[1]+j.stdform[2]*j.stdform[2]),b=Math.sqrt(k.stdform[1]*k.stdform[1]+k.stdform[2]*k.stdform[2]);return j.stdform[1]/a-k.stdform[1]/b},function(){var a=Math.sqrt(j.stdform[1]*j.stdform[1]+j.stdform[2]*j.stdform[2]),b=Math.sqrt(k.stdform[1]*k.stdform[1]+k.stdform[2]*k.stdform[2]);return j.stdform[2]/a-k.stdform[2]/b}],f),g.exists(c.layer)||(c.layer=a.options.layer.line),f=g.copyAttributes(c,a.options,"bisectorlines","line2"),e=a.create("line",[function(){var a=Math.sqrt(j.stdform[1]*j.stdform[1]+j.stdform[2]*j.stdform[2]),b=Math.sqrt(k.stdform[1]*k.stdform[1]+k.stdform[2]*k.stdform[2]);return j.stdform[0]/a+k.stdform[0]/b},function(){var a=Math.sqrt(j.stdform[1]*j.stdform[1]+j.stdform[2]*j.stdform[2]),b=Math.sqrt(k.stdform[1]*k.stdform[1]+k.stdform[2]*k.stdform[2]);return j.stdform[1]/a+k.stdform[1]/b},function(){var a=Math.sqrt(j.stdform[1]*j.stdform[1]+j.stdform[2]*j.stdform[2]),b=Math.sqrt(k.stdform[1]*k.stdform[1]+k.stdform[2]*k.stdform[2]);return j.stdform[2]/a+k.stdform[2]/b}],f),i=new m({line1:d,line2:e}),d.dump=!1,e.dump=!1,i.elType="bisectorlines",i.setParents([j.id,k.id]),i.subs={line1:d,line2:e},i},a.createCircumcenter=function(a,b,d){var e,f,h,j,k;if(b=g.providePoints(a,b,d,"point"),g.isPoint(b[0])&&g.isPoint(b[1])&&g.isPoint(b[2])){for(h=b[0],j=b[1],k=b[2],e=i.createPoint(a,[function(){return c.circumcenter(h,j,k,a)}],d),f=0;f<3;f++)b[f].addChild(e);return e.elType="circumcenter",e.setParents(b),e.generatePolynomial=function(){var a=h.symbolic.x,b=h.symbolic.y,c=j.symbolic.x,d=j.symbolic.y,f=k.symbolic.x,g=k.symbolic.y,i=e.symbolic.x,l=e.symbolic.y,m=["((",i,")-(",a,"))^2+((",l,")-(",b,"))^2-((",i,")-(",c,"))^2-((",l,")-(",d,"))^2"].join(""),n=["((",i,")-(",a,"))^2+((",l,")-(",b,"))^2-((",i,")-(",f,"))^2-((",l,")-(",g,"))^2"].join("");
return[m,n]},e}throw new Error("JSXGraph: Can't create circumcircle midpoint with parent types '"+typeof b[0]+"', '"+typeof b[1]+"' and '"+typeof b[2]+"'.\nPossible parent types: [point,point,point]")},a.createIncenter=function(a,b,c){var d,e,i,j;if(b=g.providePoints(a,b,c,"point"),!(b.length>=3&&g.isPoint(b[0])&&g.isPoint(b[1])&&g.isPoint(b[2])))throw new Error("JSXGraph: Can't create incenter with parent types '"+typeof b[0]+"', '"+typeof b[1]+"' and '"+typeof b[2]+"'.\nPossible parent types: [point,point,point]");return e=b[0],i=b[1],j=b[2],d=a.create("point",[function(){var b,c,d;return b=Math.sqrt((i.X()-j.X())*(i.X()-j.X())+(i.Y()-j.Y())*(i.Y()-j.Y())),c=Math.sqrt((e.X()-j.X())*(e.X()-j.X())+(e.Y()-j.Y())*(e.Y()-j.Y())),d=Math.sqrt((i.X()-e.X())*(i.X()-e.X())+(i.Y()-e.Y())*(i.Y()-e.Y())),new f(h.COORDS_BY_USER,[(b*e.X()+c*i.X()+d*j.X())/(b+c+d),(b*e.Y()+c*i.Y()+d*j.Y())/(b+c+d)],a)}],c),d.elType="incenter",d.setParents(b),d},a.createCircumcircle=function(b,c,d){var e,f,h;if(c=g.providePoints(b,c,d,"point"),c===!1)throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof c[0]+"', '"+typeof c[1]+"' and '"+typeof c[2]+"'.\nPossible parent types: [point,point,point]");try{h=g.copyAttributes(d,b.options,"circumcircle","center"),e=a.createCircumcenter(b,c,h),e.dump=!1,g.exists(d.layer)||(d.layer=b.options.layer.circle),h=g.copyAttributes(d,b.options,"circumcircle"),f=k.createCircle(b,[e,c[0]],h),f.elType="circumcircle",f.setParents(c),f.subs={center:e},f.inherits.push(f)}catch(i){throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof c[0]+"', '"+typeof c[1]+"' and '"+typeof c[2]+"'.\nPossible parent types: [point,point,point]")}return f},a.createIncircle=function(b,c,d){var e,f,h;if(c=g.providePoints(b,c,d,"point"),c===!1)throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof c[0]+"', '"+typeof c[1]+"' and '"+typeof c[2]+"'.\nPossible parent types: [point,point,point]");try{h=g.copyAttributes(d,b.options,"incircle","center"),e=a.createIncenter(b,c,h),e.dump=!1,g.exists(d.layer)||(d.layer=b.options.layer.circle),h=g.copyAttributes(d,b.options,"incircle"),f=k.createCircle(b,[e,function(){var a=Math.sqrt((c[1].X()-c[2].X())*(c[1].X()-c[2].X())+(c[1].Y()-c[2].Y())*(c[1].Y()-c[2].Y())),b=Math.sqrt((c[0].X()-c[2].X())*(c[0].X()-c[2].X())+(c[0].Y()-c[2].Y())*(c[0].Y()-c[2].Y())),d=Math.sqrt((c[1].X()-c[0].X())*(c[1].X()-c[0].X())+(c[1].Y()-c[0].Y())*(c[1].Y()-c[0].Y())),e=(a+b+d)/2;return Math.sqrt((e-a)*(e-b)*(e-d)/e)}],h),f.elType="incircle",f.setParents(c),f.center=e,f.subs={center:f.center},f.inherits.push(e)}catch(i){throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof c[0]+"', '"+typeof c[1]+"' and '"+typeof c[2]+"'.\nPossible parent types: [point,point,point]")}return f},a.createReflection=function(a,b,c){var d,e,f,m,o,q="\nPossible parent types: [point|line|curve|polygon|circle|arc|sector, line]";for(o=0;o<b.length;++o)b[o]=a.select(b[o]);if(g.isPoint(b[0]))e=g.providePoints(a,[b[0]],c,"point")[0];else{if(b[0].elementClass!==h.OBJECT_CLASS_CURVE&&b[0].elementClass!==h.OBJECT_CLASS_LINE&&b[0].type!==h.OBJECT_TYPE_POLYGON&&b[0].elementClass!==h.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflection element with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'."+q);e=b[0]}if(b[1].elementClass!==h.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'."+q);if(d=b[1],m=l.createTransform(a,[d],{type:"reflect"}),g.isPoint(e))f=i.createPoint(a,[e,m],c);else if(e.elementClass===h.OBJECT_CLASS_CURVE)f=n.createCurve(a,[e,m],c);else if(e.elementClass===h.OBJECT_CLASS_LINE)f=j.createLine(a,[e,m],c);else if(e.type===h.OBJECT_TYPE_POLYGON)f=p.createPolygon(a,[e,m],c);else{if(e.elementClass!==h.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'."+q);f=k.createCircle(a,[e,m],c)}return e.addChild(f),d.addChild(f),f.elType="reflection",f.setParents([e,d]),f.prepareUpdate().update(),g.isPoint(f)&&(f.generatePolynomial=function(){var a=d.point1.symbolic.x,b=d.point1.symbolic.y,c=d.point2.symbolic.x,g=d.point2.symbolic.y,h=e.symbolic.x,i=e.symbolic.y,j=f.symbolic.x,k=f.symbolic.y,l=["((",k,")-(",i,"))*((",b,")-(",g,"))+((",a,")-(",c,"))*((",j,")-(",h,"))"].join(""),m=["((",j,")-(",a,"))^2+((",k,")-(",b,"))^2-((",h,")-(",a,"))^2-((",i,")-(",b,"))^2"].join("");return[l,m]}),f},a.createMirrorElement=function(a,b,c){var d,e,f,m,o="\nPossible parent types: [point|line|curve|polygon|circle|arc|sector, point]";if(g.isPoint(b[0]))d=g.providePoints(a,[b[0]],c,"point")[0];else{if(b[0].elementClass!==h.OBJECT_CLASS_CURVE&&b[0].elementClass!==h.OBJECT_CLASS_LINE&&b[0].type!==h.OBJECT_TYPE_POLYGON&&b[0].elementClass!==h.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'."+o);d=b[0]}if(!g.isPoint(b[1]))throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'."+o);if(e=g.providePoints(a,[b[1]],c,"point")[0],m=l.createTransform(a,[Math.PI,e],{type:"rotate"}),g.isPoint(d))f=i.createPoint(a,[d,m],c);else if(d.elementClass===h.OBJECT_CLASS_CURVE)f=n.createCurve(a,[d,m],c);else if(d.elementClass===h.OBJECT_CLASS_LINE)f=j.createLine(a,[d,m],c);else if(d.type===h.OBJECT_TYPE_POLYGON)f=p.createPolygon(a,[d,m],c);else{if(d.elementClass!==h.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'."+o);f=k.createCircle(a,[d,m],c)}return d.addChild(f),e.addChild(f),f.elType="mirrorpoint",f.setParents([d,e]),f.prepareUpdate().update(),f},a.createMirrorPoint=function(b,c,d){return a.createMirrorElement(b,c,d)},a.createIntegral=function(b,c,e){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=null;if(g.isArray(c[0])&&c[1].elementClass===h.OBJECT_CLASS_CURVE)i=c[0],j=c[1];else{if(!g.isArray(c[1])||c[0].elementClass!==h.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create integral with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [[number|function,number|function],curve]");i=c[1],j=c[0]}return k=g.copyAttributes(e,b.options,"integral"),k.withLabel=!1,v=b.create("curve",[[0],[0]],k),l=i[0],m=i[1],g.isFunction(l)?(n=l,o=function(){return j.Y(n())},l=n()):(n=l,o=j.Y(l)),g.isFunction(m)?(p=m,q=function(){return j.Y(p())},m=p()):(p=m,q=j.Y(m)),k=g.copyAttributes(e,b.options,"integral","curveLeft"),r=b.create("glider",[n,o,j],k),g.isFunction(n)&&r.hideElement(),k=g.copyAttributes(e,b.options,"integral","baseLeft"),s=b.create("point",[function(){return"y"===g.evaluate(v.visProp.axis)?0:r.X()},function(){return"y"===g.evaluate(v.visProp.axis)?r.Y():0}],k),k=g.copyAttributes(e,b.options,"integral","curveRight"),t=b.create("glider",[p,q,j],k),g.isFunction(p)&&t.hideElement(),k=g.copyAttributes(e,b.options,"integral","baseRight"),u=b.create("point",[function(){return"y"===g.evaluate(v.visProp.axis)?0:t.X()},function(){return"y"===g.evaluate(v.visProp.axis)?t.Y():0}],k),k=g.copyAttributes(e,b.options,"integral"),k.withlabel!==!1&&"y"!==k.axis&&(k=g.copyAttributes(e,b.options,"integral","label"),k=g.copyAttributes(k,b.options,"label"),w=b.create("text",[function(){var a=new f(h.COORDS_BY_SCREEN,[g.evaluate(this.visProp.offset[0])+this.board.origin.scrCoords[1],0],this.board,(!1)),b=this.board.getBoundingBox(),c=.1*(b[2]-b[0]),d=t.X();return d<b[0]?d=b[0]+c:d>b[2]&&(d=b[2]-c),d+a.usrCoords[1]},function(){var a=new f(h.COORDS_BY_SCREEN,[0,g.evaluate(this.visProp.offset[1])+this.board.origin.scrCoords[2]],this.board,(!1)),b=this.board.getBoundingBox(),c=.1*(b[1]-b[3]),d=t.Y();return d>b[1]?d=b[1]-c:d<b[3]&&(d=b[3]+c),d+a.usrCoords[2]},function(){var a=d.NewtonCotes([s.X(),u.X()],j.Y);return"&int; = "+g.toFixed(a,4)}],k),w.dump=!1,r.addChild(w),t.addChild(w)),r.dump=!1,s.dump=!1,t.dump=!1,u.dump=!1,v.elType="integral",v.setParents([j.id,i]),v.subs={curveLeft:r,baseLeft:s,curveRight:t,baseRight:u},v.inherits.push(r,s,t,u),k.withLabel&&(v.subs.label=w,v.inherits.push(w)),v.Value=function(){return d.I([s.X(),u.X()],j.Y)},v.updateDataArray=function(){var a,b,c,d,e,f,h,i,k;if("y"===g.evaluate(this.visProp.axis)){for(r.Y()<t.Y()?(f=r.X(),i=r.Y(),h=t.X(),k=t.Y()):(f=t.X(),i=t.Y(),h=r.X(),k=r.Y()),d=Math.min(f,h),e=Math.max(f,h),a=[0,f],b=[i,i],c=0;c<j.numberPoints;c++)i<=j.points[c].usrCoords[2]&&d<=j.points[c].usrCoords[1]&&j.points[c].usrCoords[2]<=k&&j.points[c].usrCoords[1]<=e&&(a.push(j.points[c].usrCoords[1]),b.push(j.points[c].usrCoords[2]));a.push(h),b.push(k),a.push(0),b.push(k),a.push(0),b.push(i)}else{for(s.X()<u.X()?(d=s.X(),e=u.X()):(d=u.X(),e=s.X()),a=[d,d],b=[0,j.Y(d)],c=0;c<j.numberPoints;c++)d<=j.points[c].usrCoords[1]&&j.points[c].usrCoords[1]<=e&&(a.push(j.points[c].usrCoords[1]),b.push(j.points[c].usrCoords[2]));a.push(e),b.push(j.Y(e)),a.push(e),b.push(0),a.push(d),b.push(0)}this.dataX=a,this.dataY=b},r.addChild(v),t.addChild(v),s.addChild(v),u.addChild(v),v.baseLeft=s,v.baseRight=u,v.curveLeft=r,v.curveRight=t,v.methodMap=a.deepCopy(v.methodMap,{curveLeft:"curveLeft",baseLeft:"baseLeft",curveRight:"curveRight",baseRight:"baseRight",Value:"Value"}),v.label=w,v},a.createGrid=function(a,b,c){var d,e;return e=g.copyAttributes(c,a.options,"grid"),d=a.create("curve",[[null],[null]],e),d.elType="grid",d.type=h.OBJECT_TYPE_GRID,d.updateDataArray=function(){var b,c,e,i,j,k=g.evaluate(this.visProp.gridx),l=g.evaluate(this.visProp.gridy);for(i=g.isArray(this.visProp.topleft)?new f(g.evaluate(this.visProp.tltype)||h.COORDS_BY_USER,this.visProp.topleft,a):new f(h.COORDS_BY_SCREEN,[0,0],a),j=g.isArray(this.visProp.bottomright)?new f(g.evaluate(this.visProp.brtype)||h.COORDS_BY_USER,this.visProp.bottomright,a):new f(h.COORDS_BY_SCREEN,[a.canvasWidth,a.canvasHeight],a),a.options.grid.hasGrid=!0,d.dataX=[],d.dataY=[],b=Math.floor(i.usrCoords[2]/l)*l,c=Math.ceil(j.usrCoords[2]/l)*l,i.usrCoords[2]<j.usrCoords[2]&&(b=Math.ceil(j.usrCoords[2]/l)*l,c=Math.floor(i.usrCoords[2]/l)*l),e=b;e>c-l;e-=l)d.dataX.push(i.usrCoords[1],j.usrCoords[1],NaN),d.dataY.push(e,e,NaN);for(b=Math.ceil(i.usrCoords[1]/k)*k,c=Math.floor(j.usrCoords[1]/k)*k,i.usrCoords[1]>j.usrCoords[1]&&(b=Math.floor(j.usrCoords[1]/k)*k,c=Math.ceil(i.usrCoords[1]/k)*k),e=b;e<c+k;e+=k)d.dataX.push(e,e,NaN),d.dataY.push(i.usrCoords[2],j.usrCoords[2],NaN)},d.hasPoint=function(){return!1},a.grids.push(d),d},a.createInequality=function(a,d,e){var f,i,j;if(j=g.copyAttributes(e,a.options,"inequality"),d[0].elementClass===h.OBJECT_CLASS_LINE)i=a.create("curve",[[],[]],j),i.hasPoint=function(){return!1},i.updateDataArray=function(){var e,f,g,i=a.getBoundingBox(),k=j.inverse?-1:1,l=1.5,m=l*Math.max(i[2]-i[0],i[1]-i[3]),n={coords:{usrCoords:[1,(i[0]+i[2])/2,j.inverse?i[1]:i[3]]}},o=d[0].stdform.slice(1),p=o;g=l*Math.max(c.perpendicular(d[0],n,a)[0].distance(h.COORDS_BY_USER,n.coords),m),g*=k,n={coords:{usrCoords:[1,(i[0]+i[2])/2,(i[1]+i[3])/2]}},n=Math.abs(b.innerProduct(n.coords.usrCoords,d[0].stdform,3))>=b.eps?c.perpendicular(d[0],n,a)[0].usrCoords:n.coords.usrCoords,e=[1,n[1]+o[1]*m,n[2]-o[0]*m],f=[1,n[1]-p[1]*m,n[2]+p[0]*m],this.dataX=[e[1],e[1]+o[0]*g,f[1]+p[0]*g,f[1],e[1]],this.dataY=[e[2],e[2]+o[1]*g,f[2]+p[1]*g,f[2],e[2]]};else if(d[0].elementClass===h.OBJECT_CLASS_CURVE&&"functiongraph"===d[0].visProp.curvetype)i=a.create("curve",[[],[]],j),i.hasPoint=function(){return!1},i.updateDataArray=function(){var a,b,c=this.board.getBoundingBox(),e=1.5,f=e*(j.inverse?c[1]:c[3]);if(this.dataX=[],this.dataY=[],b=d[0].points.length,!(b<=0)){for(this.dataX.push(d[0].points[0].usrCoords[1]),this.dataY.push(f),a=0;a<b;a++)this.dataX.push(d[0].points[a].usrCoords[1]),this.dataY.push(d[0].points[a].usrCoords[2]);this.dataX.push(d[0].points[b-1].usrCoords[1]),this.dataY.push(f)}};else if(f=g.createFunction(d[0]),!g.exists(f))throw new Error("JSXGraph: Can't create area with the given parents.\nPossible parent types: [line], [function]");return i.addParents(d[0]),i},a.registerElement("arrowparallel",a.createArrowParallel),a.registerElement("bisector",a.createBisector),a.registerElement("bisectorlines",a.createAngularBisectorsOfTwoLines),a.registerElement("msector",a.createMsector),a.registerElement("circumcircle",a.createCircumcircle),a.registerElement("circumcirclemidpoint",a.createCircumcenter),a.registerElement("circumcenter",a.createCircumcenter),a.registerElement("incenter",a.createIncenter),a.registerElement("incircle",a.createIncircle),a.registerElement("integral",a.createIntegral),a.registerElement("midpoint",a.createMidpoint),a.registerElement("mirrorelement",a.createMirrorElement),a.registerElement("mirrorpoint",a.createMirrorPoint),a.registerElement("normal",a.createNormal),a.registerElement("orthogonalprojection",a.createOrthogonalProjection),a.registerElement("parallel",a.createParallel),a.registerElement("parallelpoint",a.createParallelPoint),a.registerElement("perpendicular",a.createPerpendicular),a.registerElement("perpendicularpoint",a.createPerpendicularPoint),a.registerElement("perpendicularsegment",a.createPerpendicularSegment),a.registerElement("reflection",a.createReflection),a.registerElement("grid",a.createGrid),a.registerElement("inequality",a.createInequality),{createArrowParallel:a.createArrowParallel,createBisector:a.createBisector,createAngularBisectorOfTwoLines:a.createAngularBisectorsOfTwoLines,createCircumcircle:a.createCircumcircle,createCircumcenter:a.createCircumcenter,createIncenter:a.createIncenter,createIncircle:a.createIncircle,createIntegral:a.createIntegral,createMidpoint:a.createMidpoint,createMirrorElement:a.createMirrorElement,createMirrorPoint:a.createMirrorPoint,createNormal:a.createNormal,createOrthogonalProjection:a.createOrthogonalProjection,createParallel:a.createParallel,createParallelPoint:a.createParallelPoint,createPerpendicular:a.createPerpendicular,createPerpendicularPoint:a.createPerpendicularPoint,createPerpendicularSegmen:a.createPerpendicularSegment,createReflection:a.createReflection,createGrid:a.createGrid,createInequality:a.createInequality}}),define("base/board",["jxg","base/constants","base/coords","options","math/numerics","math/math","math/geometry","math/complex","math/statistics","parser/jessiecode","parser/geonext","utils/color","utils/type","utils/event","utils/env","base/transformation","base/point","base/line","base/text","element/composition","base/composition"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){"use strict";return a.Board=function(a,c,e,f,g,h,i,k,l,p,q){if(this.BOARD_MODE_NONE=0,this.BOARD_MODE_DRAG=1,this.BOARD_MODE_MOVE_ORIGIN=2,this.BOARD_QUALITY_LOW=1,this.BOARD_QUALITY_HIGH=2,this.BOARD_MODE_ZOOM=17,m.exists(q.document)&&q.document!==!1?this.document=q.document:void 0!==document&&m.isObject(document)&&(this.document=document),this.container=a,this.containerObj=o.isBrowser?this.document.getElementById(this.container):null,o.isBrowser&&"no"!==c.type&&null===this.containerObj)throw new Error("\nJSXGraph: HTML container element '"+a+"' not found.");this.renderer=c,this.grids=[],this.options=m.deepCopy(d),this.attr=q,this.dimension=2,this.jc=new j,this.jc.use(this),this.origin={},this.origin.usrCoords=[1,0,0],this.origin.scrCoords=[1,f[0],f[1]],this.zoomX=g,this.zoomY=h,this.unitX=i*this.zoomX,this.unitY=k*this.zoomY,this.keepaspectratio=!1,this.canvasWidth=l,this.canvasHeight=p,m.exists(e)&&""!==e&&o.isBrowser&&!m.exists(this.document.getElementById(e))?this.id=e:this.id=this.generateId(),n.eventify(this),this.hooks=[],this.dependentBoards=[],this.inUpdate=!1,this.objects={},this.objectsList=[],this.groups={},this.animationObjects={},this.highlightedObjects={},this.numObjects=0,this.elementsByName={},this.mode=this.BOARD_MODE_NONE,this.updateQuality=this.BOARD_QUALITY_HIGH,this.isSuspendedRedraw=!1,this.calculateSnapSizes(),this.drag_dx=0,this.drag_dy=0,this.drag_position=[0,0],this.mouse={},this.touches=[],this.xmlString="",this.cPos=[],this.positionAccessLast=0,this.downObjects=[],this.attr.showcopyright&&this.renderer.displayCopyright(b.licenseText,parseInt(this.options.text.fontSize,10)),this.needsFullUpdate=!1,this.reducedUpdate=!1,this.currentCBDef="none",this.geonextCompatibilityMode=!1,this.options.text.useASCIIMathML&&translateASCIIMath?init():this.options.text.useASCIIMathML=!1,this.hasMouseHandlers=!1,this.hasTouchHandlers=!1,this.hasPointerHandlers=!1,this.hasMouseUp=!1,this.hasTouchEnd=!1,this.hasPointerUp=!1,this._drag_offset=[0,0],this._board_touches=[],this.selectingMode=!1,this.isSelecting=!1,this.selectingBox=[[0,0],[0,0]],this.attr.registerevents&&this.addEventHandlers(),this.methodMap={update:"update",fullUpdate:"fullUpdate",on:"on",off:"off",trigger:"trigger",setView:"setBoundingBox",setBoundingBox:"setBoundingBox",migratePoint:"migratePoint",colorblind:"emulateColorblindness",suspendUpdate:"suspendUpdate",unsuspendUpdate:"unsuspendUpdate",clearTraces:"clearTraces",left:"clickLeftArrow",right:"clickRightArrow",up:"clickUpArrow",down:"clickDownArrow",zoomIn:"zoomIn",zoomOut:"zoomOut",zoom100:"zoom100",zoomElements:"zoomElements",remove:"removeObject",removeObject:"removeObject"}},a.extend(a.Board.prototype,{generateName:function(a){var c,d,e=this.attr.maxnamelength,f="",g="",h=[],i="";if(a.type===b.OBJECT_TYPE_TICKS)return"";for(c=m.isPoint(a)?["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]:a.type===b.OBJECT_TYPE_ANGLE?["","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"]:["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],m.isPoint(a)||a.elementClass===b.OBJECT_CLASS_LINE||a.type===b.OBJECT_TYPE_ANGLE||(f=a.type===b.OBJECT_TYPE_POLYGON?"P_{":a.elementClass===b.OBJECT_CLASS_CIRCLE?"k_{":a.elementClass===b.OBJECT_CLASS_TEXT?"t_{":"s_{",g="}"),d=0;d<e;d++)h[d]=0;for(;h[e-1]<c.length;){for(h[0]=1;h[0]<c.length;h[0]++){for(i=f,d=e;d>0;d--)i+=c[h[d-1]];if(!m.exists(this.elementsByName[i+g]))return i+g}for(h[0]=c.length,d=1;d<e;d++)h[d-1]===c.length&&(h[d-1]=1,h[d]+=1)}return""},generateId:function(){for(var b=1;m.exists(a.boards["jxgBoard"+b]);)b=Math.round(65535*Math.random());return"jxgBoard"+b},setId:function(a,b){var c,d=this.numObjects,e=a.id;if(this.numObjects+=1,""===e||!m.exists(e))for(e=this.id+b+d;m.exists(this.objects[e]);)c=Math.round(65535*Math.random()),e=this.id+b+d+"-"+c;return a.id=e,this.objects[e]=a,a._pos=this.objectsList.length,this.objectsList[this.objectsList.length]=a,e},finalizeAdding:function(a){m.evaluate(a.visProp.visible)===!1&&this.renderer.display(a,!1)},finalizeLabel:function(a){a.hasLabel&&!m.evaluate(a.label.visProp.islabel)&&m.evaluate(a.label.visProp.visible)===!1&&this.renderer.display(a.label,!1)},getCoordsTopLeftCorner:function(){var a,b,c,d,e,f=this.document.documentElement||this.document.body.parentNode,g=this.document.body,h=this.containerObj;if(this.cPos.length>0&&(this.mode===this.BOARD_MODE_DRAG||this.mode===this.BOARD_MODE_MOVE_ORIGIN||(new Date).getTime()-this.positionAccessLast<1e3))return this.cPos;if(this.positionAccessLast=(new Date).getTime(),h.getBoundingClientRect){for(c=h.getBoundingClientRect(),d=1,e=h;e&&m.exists(e.parentNode);)m.exists(e.style)&&m.exists(e.style.zoom)&&""!==e.style.zoom&&(d*=parseFloat(e.style.zoom)),e=e.parentNode;return a=[c.left*d,c.top*d],a[0]+=o.getProp(h,"border-left-width"),a[1]+=o.getProp(h,"border-top-width"),"vml"!==this.renderer.type&&(a[0]+=o.getProp(h,"padding-left"),a[1]+=o.getProp(h,"padding-top")),this.cPos=a.slice(),this.cPos}return a=o.getOffset(h),b=this.document.documentElement.ownerDocument,!this.containerObj.currentStyle&&b.defaultView&&(a[0]+=o.getProp(f,"margin-left"),a[1]+=o.getProp(f,"margin-top"),a[0]+=o.getProp(f,"border-left-width"),a[1]+=o.getProp(f,"border-top-width"),a[0]+=o.getProp(f,"padding-left"),a[1]+=o.getProp(f,"padding-top")),g&&(a[0]+=o.getProp(g,"left"),a[1]+=o.getProp(g,"top")),"object"==typeof google&&google.translate&&(a[0]+=10,a[1]+=25),a[0]+=o.getProp(h,"border-left-width"),a[1]+=o.getProp(h,"border-top-width"),"vml"!==this.renderer.type&&(a[0]+=o.getProp(h,"padding-left"),a[1]+=o.getProp(h,"padding-top")),a[0]+=this.attr.offsetx,a[1]+=this.attr.offsety,this.cPos=a.slice(),this.cPos},getMousePosition:function(a,b){var c,d,e=this.getCoordsTopLeftCorner();return c=o.getPosition(a,b,this.document),m.exists(this.cssTransMat)||this.updateCSSTransforms(),d=[1,c[0]-e[0],c[1]-e[1]],d=f.matVecMult(this.cssTransMat,d),d[1]/=d[0],d[2]/=d[0],[d[1],d[2]]},initMoveOrigin:function(a,b){this.drag_dx=a-this.origin.scrCoords[1],this.drag_dy=b-this.origin.scrCoords[2],this.mode=this.BOARD_MODE_MOVE_ORIGIN,this.updateQuality=this.BOARD_QUALITY_LOW},initMoveObject:function(a,c,d,e){var f,g,h,j=[],k=[],l=this.objectsList.length,n={visProp:{layer:-1e4}};for(g=0;g<l;g++)f=this.objectsList[g],h=f.hasPoint&&f.hasPoint(a,c),f.visPropCalc.visible&&h&&(f.triggerEventHandlers([e+"down","down"],[d]),this.downObjects.push(f)),(this.geonextCompatibilityMode&&(m.isPoint(f)||f.elementClass===b.OBJECT_CLASS_TEXT)||!this.geonextCompatibilityMode)&&f.isDraggable&&f.visPropCalc.visible&&!m.evaluate(f.visProp.fixed)&&h&&(f.visProp.layer>n.visProp.layer||f.visProp.layer===n.visProp.layer&&f.lastDragTime.getTime()>=n.lastDragTime.getTime())&&(this.attr.ignorelabels&&m.exists(n.label)&&f===n.label||(n=f,j.push(n),m.exists(n.coords)?k.push(i.subtract(n.coords.scrCoords.slice(1),[a,c])):k.push([0,0])));return j.length>0&&(this.mode=this.BOARD_MODE_DRAG),this.attr.takefirst?(j.length=1,this._drag_offset=k[0]):(j=j.slice(-1),this._drag_offset=k[k.length-1]),this._drag_offset||(this._drag_offset=[0,0]),"svg"===this.renderer.type&&m.exists(j[0])&&m.evaluate(j[0].visProp.dragtotopoflayer)&&1===j.length&&m.exists(j[0].rendNode)&&j[0].rendNode.parentNode.appendChild(j[0].rendNode),j},moveObject:function(a,d,e,f,g){var h,j,k,l=new c(b.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(a,d),this);e&&e.obj&&(h=e.obj,h.coords&&(j=h.coords.scrCoords.slice()),this.drag_position=[l.scrCoords[1],l.scrCoords[2]],this.drag_position=i.add(this.drag_position,this._drag_offset),m.exists(h.coords)?h.setPositionDirectly(b.COORDS_BY_SCREEN,this.drag_position):(this.showInfobox(!1),isNaN(e.targets[0].Xprev+e.targets[0].Yprev)||h.setPositionDirectly(b.COORDS_BY_SCREEN,[l.scrCoords[1],l.scrCoords[2]],[e.targets[0].Xprev,e.targets[0].Yprev]),e.targets[0].Xprev=l.scrCoords[1],e.targets[0].Yprev=l.scrCoords[2]),h.prepareUpdate().update(!1).updateRenderer(),this.updateInfobox(h),h.prepareUpdate().update(!0).updateRenderer(),h.coords&&(k=h.coords.scrCoords),h.coords&&j[1]===k[1]&&j[2]===k[2]||(h.triggerEventHandlers([g+"drag","drag"],[f]),this.update()),h.highlight(!0),h.lastDragTime=new Date)},twoFingerMove:function(a,d,e,f){var g,h,i;m.exists(e)&&m.exists(e.obj)&&(i=e.obj,g=new c(b.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(a[0],a[1]),this),h=new c(b.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(d[0],d[1]),this),i.elementClass===b.OBJECT_CLASS_LINE||i.type===b.OBJECT_TYPE_POLYGON?this.twoFingerTouchObject(g,h,e,i):i.elementClass===b.OBJECT_CLASS_CIRCLE&&this.twoFingerTouchCircle(g,h,e,i),i.triggerEventHandlers(["touchdrag","drag"],[f]),e.targets[0].Xprev=g.scrCoords[1],e.targets[0].Yprev=g.scrCoords[2],e.targets[1].Xprev=h.scrCoords[1],e.targets[1].Yprev=h.scrCoords[2])},twoFingerTouchObject:function(a,d,e,h){var i,j,k,l,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;if(m.exists(e.targets[0])&&m.exists(e.targets[1])&&!isNaN(e.targets[0].Xprev+e.targets[0].Yprev+e.targets[1].Xprev+e.targets[1].Yprev)){if(i=a.usrCoords,j=d.usrCoords,k=new c(b.COORDS_BY_SCREEN,[e.targets[0].Xprev,e.targets[0].Yprev],this).usrCoords,l=new c(b.COORDS_BY_SCREEN,[e.targets[1].Xprev,e.targets[1].Yprev],this).usrCoords,o=[1,.5*(k[1]+l[1]),.5*(k[2]+l[2])],n=[1,.5*(i[1]+j[1]),.5*(i[2]+j[2])],q=f.crossProduct(k,l),p=f.crossProduct(i,j),s=f.crossProduct(q,p),Math.abs(s[0])<f.eps)return;if(s[1]/=s[0],s[2]/=s[0],t=g.rad(o.slice(1),s.slice(1),n.slice(1)),u=this.create("transform",[t,s[1],s[2]],{type:"rotate"}),u.update(),o=f.matVecMult(u.matrix,o),o[1]/=o[0],o[2]/=o[0],v=this.create("transform",[n[1]-o[1],n[2]-o[2]],{type:"translate"}),v.update(),u.melt(v),m.evaluate(h.visProp.scalable)&&(r=g.distance(i,j)/g.distance(k,l),w=this.create("transform",[-n[1],-n[2]],{type:"translate"}),x=this.create("transform",[r,r],{type:"scale"}),y=this.create("transform",[n[1],n[2]],{type:"translate"}),u.melt(w).melt(x).melt(y)),h.elementClass===b.OBJECT_CLASS_LINE)z=[],h.point1.draggable()&&z.push(h.point1),h.point2.draggable()&&z.push(h.point2),u.applyOnce(z);else if(h.type===b.OBJECT_TYPE_POLYGON){for(z=[],B=h.vertices.length-1,A=0;A<B;++A)h.vertices[A].draggable()&&z.push(h.vertices[A]);u.applyOnce(z)}this.update(),h.highlight(!0)}},twoFingerTouchCircle:function(a,d,e,f){var h,i,j,k,l,n,o,p,q,r,s;"pointCircle"!==f.method&&"pointLine"!==f.method&&m.exists(e.targets[0])&&m.exists(e.targets[1])&&!isNaN(e.targets[0].Xprev+e.targets[0].Yprev+e.targets[1].Xprev+e.targets[1].Yprev)&&(h=a.usrCoords,i=d.usrCoords,j=new c(b.COORDS_BY_SCREEN,[e.targets[0].Xprev,e.targets[0].Yprev],this).usrCoords,k=new c(b.COORDS_BY_SCREEN,[e.targets[1].Xprev,e.targets[1].Yprev],this).usrCoords,o=this.create("transform",[h[1]-j[1],h[2]-j[2]],{type:"translate"}),n=g.rad(k.slice(1),h.slice(1),i.slice(1)),p=this.create("transform",[-h[1],-h[2]],{type:"translate"}),q=this.create("transform",[n],{type:"rotate"}),o.melt(p).melt(q),m.evaluate(f.visProp.scalable)&&(l=g.distance(h,i)/g.distance(j,k),r=this.create("transform",[l,l],{type:"scale"}),o.melt(r)),s=this.create("transform",[h[1],h[2]],{type:"translate"}),o.melt(s),f.center.draggable()&&o.applyOnce([f.center]),"twoPoints"===f.method?f.point2.draggable()&&o.applyOnce([f.point2]):"pointRadius"===f.method&&m.isNumber(f.updateRadius.origin)&&f.setRadius(f.radius*l),this.update(f.center),f.highlight(!0))},highlightElements:function(a,b,c,d){var e,f,g,h={},i=this.objectsList.length;for(e=0;e<i;e++)f=this.objectsList[e],g=f.id,m.exists(f.hasPoint)&&f.visPropCalc.visible&&f.hasPoint(a,b)&&(this.updateInfobox(f),m.exists(this.highlightedObjects[g])||(h[g]=f,f.highlight(),f.triggerEventHandlers(["mousehit","hit"],[c,f,d])),f.mouseover?f.triggerEventHandlers(["mousemove","move"],[c]):(f.triggerEventHandlers(["mouseover","over"],[c]),f.mouseover=!0));for(e=0;e<i;e++)f=this.objectsList[e],g=f.id,f.mouseover&&(h[g]||(f.triggerEventHandlers(["mouseout","out"],[c]),f.mouseover=!1))},saveStartPos:function(c,d){var e,f,g=[];if(c.type===b.OBJECT_TYPE_TICKS)g.push([1,NaN,NaN]);else if(c.elementClass===b.OBJECT_CLASS_LINE)g.push(c.point1.coords.usrCoords),g.push(c.point2.coords.usrCoords);else if(c.elementClass===b.OBJECT_CLASS_CIRCLE)g.push(c.center.coords.usrCoords),"twoPoints"===c.method&&g.push(c.point2.coords.usrCoords);else if(c.type===b.OBJECT_TYPE_POLYGON)for(f=c.vertices.length-1,e=0;e<f;e++)g.push(c.vertices[e].coords.usrCoords);else if(c.type===b.OBJECT_TYPE_SECTOR)g.push(c.point1.coords.usrCoords),g.push(c.point2.coords.usrCoords),g.push(c.point3.coords.usrCoords);else if(m.isPoint(c)||c.type===b.OBJECT_TYPE_GLIDER)g.push(c.coords.usrCoords);else if(c.elementClass===b.OBJECT_CLASS_CURVE)c.points.length>0&&g.push(c.points[0].usrCoords);else try{g.push(c.coords.usrCoords)}catch(h){a.debug("JSXGraph+ saveStartPos: obj.coords.usrCoords not available: "+h)}for(f=g.length,e=0;e<f;e++)d.Zstart.push(g[e][0]),d.Xstart.push(g[e][1]),d.Ystart.push(g[e][2])},mouseOriginMoveStart:function(a){var b,c;return b=this._isRequiredKeyPressed(a,"pan"),b&&(c=this.getMousePosition(a),this.initMoveOrigin(c[0],c[1])),b},mouseOriginMove:function(a){var b,c=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return c&&(b=this.getMousePosition(a),this.moveOrigin(b[0],b[1],!0)),c},touchOriginMoveStart:function(b){var c,d,e=b[a.touchProperty];return c=this.attr.pan.enabled&&!this.attr.pan.needtwofingers&&1==e.length,c&&(d=this.getMousePosition(b,0),this.initMoveOrigin(d[0],d[1])),c},touchOriginMove:function(a){var b,c=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return c&&(b=this.getMousePosition(a,0),this.moveOrigin(b[0],b[1],!0)),c},originMoveEnd:function(){this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE},addEventHandlers:function(){o.supportsPointerEvents()?this.addPointerEventHandlers():(this.addMouseEventHandlers(),this.addTouchEventHandlers()),null!==this.containerObj&&(this.containerObj.oncontextmenu=function(a){return m.exists(a)&&a.preventDefault(),!1})},addPointerEventHandlers:function(){!this.hasPointerHandlers&&o.isBrowser&&(window.navigator.msPointerEnabled?(o.addEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),o.addEvent(this.containerObj,"MSPointerMove",this.pointerMoveListener,this)):(o.addEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),o.addEvent(this.containerObj,"pointermove",this.pointerMoveListener,this)),o.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),o.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),null!==this.containerObj&&(this.containerObj.style.touchAction="none"),this.hasPointerHandlers=!0)},addMouseEventHandlers:function(){!this.hasMouseHandlers&&o.isBrowser&&(o.addEvent(this.containerObj,"mousedown",this.mouseDownListener,this),o.addEvent(this.containerObj,"mousemove",this.mouseMoveListener,this),o.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),o.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!0)},addTouchEventHandlers:function(a){!this.hasTouchHandlers&&o.isBrowser&&(o.addEvent(this.containerObj,"touchstart",this.touchStartListener,this),o.addEvent(this.containerObj,"touchmove",this.touchMoveListener,this),this.hasTouchHandlers=!0)},removePointerEventHandlers:function(){this.hasPointerHandlers&&o.isBrowser&&(window.navigator.msPointerEnabled?(o.removeEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),o.removeEvent(this.containerObj,"MSPointerMove",this.pointerMoveListener,this)):(o.removeEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),o.removeEvent(this.containerObj,"pointermove",this.pointerMoveListener,this)),o.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),o.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasPointerUp&&(window.navigator.msPointerEnabled?o.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):o.removeEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!1),this.hasPointerHandlers=!1)},removeMouseEventHandlers:function(){this.hasMouseHandlers&&o.isBrowser&&(o.removeEvent(this.containerObj,"mousedown",this.mouseDownListener,this),o.removeEvent(this.containerObj,"mousemove",this.mouseMoveListener,this),this.hasMouseUp&&(o.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),o.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),o.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!1)},removeTouchEventHandlers:function(){this.hasTouchHandlers&&o.isBrowser&&(o.removeEvent(this.containerObj,"touchstart",this.touchStartListener,this),o.removeEvent(this.containerObj,"touchmove",this.touchMoveListener,this),this.hasTouchEnd&&(o.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.hasTouchHandlers=!1)},removeEventHandlers:function(){this.removeMouseEventHandlers(),this.removeTouchEventHandlers(),this.removePointerEventHandlers()},clickLeftArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]+.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickRightArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]-.1*this.canvasWidth,this.origin.scrCoords[2]),
this},clickUpArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]-.1*this.canvasHeight),this},clickDownArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]+.1*this.canvasHeight),this},gestureChangeListener:function(a){var d,e,f,h,i,j,k,l,m,n=this.attr.zoom.factorx,o=this.attr.zoom.factory;return this.mode!==this.BOARD_MODE_ZOOM||(a.preventDefault(),d=new c(b.COORDS_BY_SCREEN,this.getMousePosition(a,0),this),f=g.distance([a.touches[0].clientX,a.touches[0].clientY],[a.touches[1].clientX,a.touches[1].clientY],2),void 0===a.scale&&(a.scale=f/this.prevDist),e=a.scale/this.prevScale,this.prevScale=a.scale,this.attr.pan.enabled&&this.attr.pan.needtwofingers&&Math.abs(a.scale-1)<.4&&this._num_pan>=.8*this._num_zoom?(this._num_pan++,this.moveOrigin(d.scrCoords[1],d.scrCoords[2],!0)):this.attr.zoom.enabled&&Math.abs(e-1)<.5&&(this._num_zoom++,(this.attr.zoom.pinchhorizontal||this.attr.zoom.pinchvertical)&&(h=Math.abs(a.touches[0].clientX-a.touches[1].clientX),i=Math.abs(a.touches[0].clientY-a.touches[1].clientY),j=Math.abs(Math.atan2(i,h)),m=Math.PI*this.attr.zoom.pinchsensitivity/90),this.attr.zoom.pinchhorizontal&&j<m?(this.attr.zoom.factorx=e,this.attr.zoom.factory=1,k=0,l=0):this.attr.zoom.pinchvertical&&Math.abs(j-.5*Math.PI)<m?(this.attr.zoom.factorx=1,this.attr.zoom.factory=e,k=0,l=0):(this.attr.zoom.factorx=e,this.attr.zoom.factory=e,k=d.usrCoords[1],l=d.usrCoords[2]),this.zoomIn(k,l),this.attr.zoom.factorx=n,this.attr.zoom.factory=o),!1)},gestureStartListener:function(a){var b;return a.preventDefault(),this.prevScale=1,this.prevDist=g.distance([a.touches[0].clientX,a.touches[0].clientY],[a.touches[1].clientX,a.touches[1].clientY],2),b=this.getMousePosition(a,0),this.initMoveOrigin(b[0],b[1]),this._num_zoom=this._num_pan=0,this.mode=this.BOARD_MODE_ZOOM,!1},_isRequiredKeyPressed:function(a,b){var c=this.attr[b];return!!c.enabled&&!(!(c.needshift&&a.shiftKey||!c.needshift&&!a.shiftKey)||!(c.needctrl&&a.ctrlKey||!c.needctrl&&!a.ctrlKey))},_pointerAddBoardTouches:function(a){var b,c;for(b=0,c=!1;b<this._board_touches.length;b++)if(this._board_touches[b].pointerId===a.pointerId){this._board_touches[b].clientX=a.clientX,this._board_touches[b].clientY=a.clientY,c=!0;break}return c||this._board_touches.push({pointerId:a.pointerId,clientX:a.clientX,clientY:a.clientY}),this},_pointerRemoveBoardTouches:function(a){var b;for(b=0;b<this._board_touches.length;b++)if(this._board_touches[b].pointerId===a.pointerId){this._board_touches.splice(b,1);break}return this},pointerDownListener:function(a,b){var c,d,e,f,g,h,i,j,k=this.options.precision.touch;if(this.hasPointerUp||(window.navigator.msPointerEnabled?o.addEvent(this.document,"MSPointerUp",this.pointerUpListener,this):o.addEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!0),this.hasMouseHandlers&&this.removeMouseEventHandlers(),this.hasTouchHandlers&&this.removeTouchEventHandlers(),this.document.selection&&m.isFunction(this.document.selection.empty))this.document.selection.empty();else if(window.getSelection&&(h=window.getSelection(),h.removeAllRanges))try{h.removeAllRanges()}catch(l){}if(o.isBrowser&&("touch"===a.pointerType||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1)&&(this.options.precision.hasPoint=k),f=this.getMousePosition(a),this._testForSelection(a),this.selectingMode)return this._startSelecting(f),void this.triggerEventHandlers(["touchstartselecting","pointerstartselecting","startselecting"],[a]);if(b?(g=[b],this.mode=this.BOARD_MODE_DRAG):g=this.initMoveObject(f[0],f[1],a,"mouse"),g.length>0){for(j=g[g.length-1],i=!1,c=0;c<this.touches.length;c++)if(this.touches[c].obj===j){d=c,e=this.touches[c].targets.push({num:a.pointerId,X:f[0],Y:f[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]})-1,i=!0;break}i||(e=0,d=this.touches.push({obj:j,targets:[{num:a.pointerId,X:f[0],Y:f[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}]})-1),this.dehighlightAll(),j.highlight(!0),this.saveStartPos(j,this.touches[d].targets[e]),a&&a.preventDefault?a.preventDefault():window.event&&(window.event.returnValue=!1)}return this.touches.length>0&&(a.preventDefault(),a.stopPropagation()),this.options.precision.hasPoint=this.options.precision.mouse,o.isBrowser&&"touch"!==a.pointerType?this.mode===this.BOARD_MODE_NONE&&this.mouseOriginMoveStart(a):(this._pointerAddBoardTouches(a),a.touches=this._board_touches,this.mode===this.BOARD_MODE_NONE&&this.touchOriginMoveStart(a)||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||2!=a.touches.length||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(a))),this.triggerEventHandlers(["touchstart","down","pointerdown","MSPointerDown"],[a]),!1},pointerMoveListener:function(a){var b,c,d;if(this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.showInfobox(!1)),this.mode!==this.BOARD_MODE_NONE&&(a.preventDefault(),a.stopPropagation()),o.isBrowser&&("touch"===a.pointerType||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1)&&(this.options.precision.hasPoint=this.options.precision.touch),this.updateQuality=this.BOARD_QUALITY_LOW,this.selectingMode)d=this.getMousePosition(a),this._moveSelecting(d),this.triggerEventHandlers(["touchmoveselecting","moveselecting","pointermoveselecting"],[a,this.mode]);else if(!this.mouseOriginMove(a))if(this.mode===this.BOARD_MODE_DRAG){for(b=0;b<this.touches.length;b++)for(c=0;c<this.touches[b].targets.length;c++)if(this.touches[b].targets[c].num===a.pointerId){1===this.touches[b].targets.length?(this.touches[b].targets[c].X=a.pageX,this.touches[b].targets[c].Y=a.pageY,d=this.getMousePosition(a),this.moveObject(d[0],d[1],this.touches[b],a,"touch")):2===this.touches[b].targets.length&&this.touches[b].targets[0].num>-1&&this.touches[b].targets[1].num>-1&&(this.touches[b].targets[c].X=a.pageX,this.touches[b].targets[c].Y=a.pageY,this.twoFingerMove(this.getMousePosition({clientX:this.touches[b].targets[0].X,clientY:this.touches[b].targets[0].Y}),this.getMousePosition({clientX:this.touches[b].targets[1].X,clientY:this.touches[b].targets[1].Y}),this.touches[b],a));break}}else"touch"==a.pointerType?(this._pointerAddBoardTouches(a),2==this._board_touches.length&&(a.touches=this._board_touches,this.gestureChangeListener(a))):(d=this.getMousePosition(a),this.highlightElements(d[0],d[1],a,-1));return this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchmove","move","pointermove","MSPointerMove"],[a,this.mode]),this.mode===this.BOARD_MODE_NONE},pointerUpListener:function(a){var b,c,d;if(this.triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[a]),this.showInfobox(!1),a)for(b=0;b<this.touches.length;b++)for(c=0;c<this.touches[b].targets.length;c++)if(this.touches[b].targets[c].num===a.pointerId){this.touches[b].targets.splice(c,1),0===this.touches[b].targets.length&&this.touches.splice(b,1);break}if(this.selectingMode)this._stopSelecting(a),this.triggerEventHandlers(["touchstopselecting","pointerstopselecting","stopselecting"],[a]);else for(b=this.downObjects.length-1;b>-1;b--){for(d=!1,c=0;c<this.touches.length;c++)this.touches[c].obj.id===this.downObjects[b].id&&(d=!0);d||(this.downObjects[b].triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[a]),this.downObjects[b].snapToGrid(),this.downObjects[b].snapToPoints(),this.downObjects.splice(b,1))}return this._pointerRemoveBoardTouches(a),0===this._board_touches.length&&(this.hasPointerUp&&(window.navigator.msPointerEnabled?o.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):o.removeEvent(this.document,"pointerup",this.pointerUpListener,this),this.hasPointerUp=!1),this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE,this.originMoveEnd(),this.update()),!0},touchStartListener:function(c){var e,f,g,h,i,j,k,l,n,p=this.options.precision.touch,q=c[a.touchProperty];for(this.hasTouchEnd||(o.addEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!0),this.document.selection&&m.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this.options.precision.hasPoint=this.options.precision.touch,e=0;e<q.length;e++)q[e].jxg_isused=!1;for(e=0;e<this.touches.length;e++)for(h=0;h<this.touches[e].targets.length;h++){this.touches[e].targets[h].num=-1,p=this.options.precision.touch;do{for(i=0;i<q.length;i++)if(Math.abs(Math.pow(q[i].screenX-this.touches[e].targets[h].X,2)+Math.pow(q[i].screenY-this.touches[e].targets[h].Y,2))<p*p){this.touches[e].targets[h].num=i,this.touches[e].targets[h].X=q[i].screenX,this.touches[e].targets[h].Y=q[i].screenY,q[i].jxg_isused=!0;break}p*=2}while(this.touches[e].targets[h].num===-1&&p<this.options.precision.touchMax);this.touches[e].targets[h].num===-1&&(a.debug("i couldn't find a targettouches for target no "+h+" on "+this.touches[e].obj.name+" ("+this.touches[e].obj.id+"). Removed the target."),a.debug("eps = "+p+", touchMax = "+d.precision.touchMax),this.touches[e].targets.splice(e,1))}for(e=0;e<q.length;e++)if(!q[e].jxg_isused){if(f=this.getMousePosition(c,e),this.selectingMode)return this._startSelecting(f),this.triggerEventHandlers(["touchstartselecting","startselecting"],[c]),c.preventDefault(),c.stopPropagation(),this.options.precision.hasPoint=this.options.precision.mouse,this.touches.length>0;if(g=this.initMoveObject(f[0],f[1],c,"touch"),0!==g.length)if(j=g[g.length-1],m.isPoint(j)||j.elementClass===b.OBJECT_CLASS_TEXT||j.type===b.OBJECT_TYPE_TICKS||j.type===b.OBJECT_TYPE_IMAGE)l=[{num:e,X:q[e].screenX,Y:q[e].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}],this.saveStartPos(j,l[0]),this.touches.push({obj:j,targets:l}),j.highlight(!0);else if(j.elementClass===b.OBJECT_CLASS_LINE||j.elementClass===b.OBJECT_CLASS_CIRCLE||j.elementClass===b.OBJECT_CLASS_CURVE||j.type===b.OBJECT_TYPE_POLYGON){for(k=!1,h=0;h<this.touches.length;h++)j.id===this.touches[h].obj.id&&(k=!0,1===this.touches[h].targets.length&&(n={num:e,X:q[e].screenX,Y:q[e].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]},this.saveStartPos(j,n),this.touches[h].targets.push(n)),q[e].jxg_isused=!0);k||(l=[{num:e,X:q[e].screenX,Y:q[e].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]}],this.saveStartPos(j,l[0]),this.touches.push({obj:j,targets:l}),j.highlight(!0))}q[e].jxg_isused=!0}return this.touches.length>0&&(c.preventDefault(),c.stopPropagation()),this.mode===this.BOARD_MODE_NONE&&this.touchOriginMoveStart(c)||2!=q.length||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(c)),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchstart","down"],[c]),!1},touchMoveListener:function(b){var c,d,e,f=b[a.touchProperty];if(this.mode!==this.BOARD_MODE_NONE&&(b.preventDefault(),b.stopPropagation()),this.mode!==this.BOARD_MODE_DRAG&&this.showInfobox(!1),this.options.precision.hasPoint=this.options.precision.touch,this.updateQuality=this.BOARD_QUALITY_LOW,this.selectingMode){for(c=0;c<f.length;c++)if(!f[c].jxg_isused){d=this.getMousePosition(b,c),this._moveSelecting(d),this.triggerEventHandlers(["touchmoves","moveselecting"],[b,this.mode]);break}}else if(!this.touchOriginMove(b))if(this.mode===this.BOARD_MODE_DRAG){for(c=0;c<this.touches.length;c++)if(1===this.touches[c].targets.length){if(f[this.touches[c].targets[0].num]){if(d=this.getMousePosition(b,this.touches[c].targets[0].num),d[0]<0||d[0]>this.canvasWidth||d[1]<0||d[1]>this.canvasHeight)return;this.touches[c].targets[0].X=f[this.touches[c].targets[0].num].screenX,this.touches[c].targets[0].Y=f[this.touches[c].targets[0].num].screenY,this.moveObject(d[0],d[1],this.touches[c],b,"touch")}}else if(2===this.touches[c].targets.length&&this.touches[c].targets[0].num>-1&&this.touches[c].targets[1].num>-1&&f[this.touches[c].targets[0].num]&&f[this.touches[c].targets[1].num]){if(d=this.getMousePosition(b,this.touches[c].targets[0].num),e=this.getMousePosition(b,this.touches[c].targets[1].num),d[0]<0||d[0]>this.canvasWidth||d[1]<0||d[1]>this.canvasHeight||e[0]<0||e[0]>this.canvasWidth||e[1]<0||e[1]>this.canvasHeight)return;this.touches[c].targets[0].X=f[this.touches[c].targets[0].num].screenX,this.touches[c].targets[0].Y=f[this.touches[c].targets[0].num].screenY,this.touches[c].targets[1].X=f[this.touches[c].targets[1].num].screenX,this.touches[c].targets[1].Y=f[this.touches[c].targets[1].num].screenY,this.twoFingerMove(d,e,this.touches[c],b)}}else 2==f.length&&this.gestureChangeListener(b);return this.mode!==this.BOARD_MODE_DRAG&&this.showInfobox(!1),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchmove","move"],[b,this.mode]),this.mode===this.BOARD_MODE_NONE},touchEndListener:function(c){var d,e,f,g,h,i=this.options.precision.touch,j=[],k=c&&c[a.touchProperty];if(this.triggerEventHandlers(["touchend","up"],[c]),this.showInfobox(!1),this.selectingMode)this._stopSelecting(c),this.triggerEventHandlers(["touchstopselecting","stopselecting"],[c]);else if(k&&k.length>0){for(d=0;d<this.touches.length;d++)j[d]=this.touches[d];for(this.touches.length=0,d=0;d<k.length;d++)k[d].jxg_isused=!1;for(d=0;d<j.length;d++){for(g=!1,h=0,e=0;e<j[d].targets.length;e++)for(j[d].targets[e].found=!1,f=0;f<k.length;f++)if(Math.abs(Math.pow(k[f].screenX-j[d].targets[e].X,2)+Math.pow(k[f].screenY-j[d].targets[e].Y,2))<i*i){j[d].targets[e].found=!0,j[d].targets[e].num=f,j[d].targets[e].X=k[f].screenX,j[d].targets[e].Y=k[f].screenY,h+=1;break}if(m.isPoint(j[d].obj)?g=j[d].targets[0]&&j[d].targets[0].found:j[d].obj.elementClass===b.OBJECT_CLASS_LINE?g=j[d].targets[0]&&j[d].targets[0].found||j[d].targets[1]&&j[d].targets[1].found:j[d].obj.elementClass===b.OBJECT_CLASS_CIRCLE&&(g=1===h||3===h),g)for(this.touches.push({obj:j[d].obj,targets:[]}),e=0;e<j[d].targets.length;e++)j[d].targets[e].found&&this.touches[this.touches.length-1].targets.push({num:j[d].targets[e].num,X:j[d].targets[e].screenX,Y:j[d].targets[e].screenY,Xprev:NaN,Yprev:NaN,Xstart:j[d].targets[e].Xstart,Ystart:j[d].targets[e].Ystart,Zstart:j[d].targets[e].Zstart});else j[d].obj.noHighlight()}}else this.touches.length=0;for(d=this.downObjects.length-1;d>-1;d--){for(g=!1,e=0;e<this.touches.length;e++)this.touches[e].obj.id===this.downObjects[d].id&&(g=!0);g||(this.downObjects[d].triggerEventHandlers(["touchup","up"],[c]),this.downObjects[d].snapToGrid(),this.downObjects[d].snapToPoints(),this.downObjects.splice(d,1))}return k&&0!==k.length||(this.hasTouchEnd&&(o.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.originMoveEnd(),this.update()),!0},mouseDownListener:function(a){var b,c,d;if(this.document.selection&&m.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),!this.hasMouseUp)return o.addEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!0,b=this.getMousePosition(a),this._testForSelection(a),this.selectingMode?(this._startSelecting(b),void this.triggerEventHandlers(["mousestartselecting","startselecting"],[a])):(c=this.initMoveObject(b[0],b[1],a,"mouse"),0===c.length?(this.mode=this.BOARD_MODE_NONE,d=!0):(this.mouse={obj:null,targets:[{X:b[0],Y:b[1],Xprev:NaN,Yprev:NaN}]},this.mouse.obj=c[c.length-1],this.dehighlightAll(),this.mouse.obj.highlight(!0),this.mouse.targets[0].Xstart=[],this.mouse.targets[0].Ystart=[],this.mouse.targets[0].Zstart=[],this.saveStartPos(this.mouse.obj,this.mouse.targets[0]),a&&a.preventDefault?a.preventDefault():window.event&&(window.event.returnValue=!1)),this.mode===this.BOARD_MODE_NONE&&(d=this.mouseOriginMoveStart(a)),this.triggerEventHandlers(["mousedown","down"],[a]),d)},mouseMoveListener:function(a){var b;b=this.getMousePosition(a),this.updateQuality=this.BOARD_QUALITY_LOW,this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.showInfobox(!1)),this.selectingMode?(this._moveSelecting(b),this.triggerEventHandlers(["mousemoveselecting","moveselecting"],[a,this.mode])):this.mouseOriginMove(a)||(this.mode===this.BOARD_MODE_DRAG?this.moveObject(b[0],b[1],this.mouse,a,"mouse"):this.highlightElements(b[0],b[1],a,-1),this.triggerEventHandlers(["mousemove","move"],[a,this.mode])),this.updateQuality=this.BOARD_QUALITY_HIGH},mouseUpListener:function(a){var b;if(this.selectingMode===!1&&this.triggerEventHandlers(["mouseup","up"],[a]),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mouse&&this.mouse.obj&&(this.mouse.obj.snapToGrid(this.mouse.targets[0]),this.mouse.obj.snapToPoints()),this.originMoveEnd(),this.dehighlightAll(),this.update(),this.selectingMode)this._stopSelecting(a),this.triggerEventHandlers(["mousestopselecting","stopselecting"],[a]);else for(b=0;b<this.downObjects.length;b++)this.downObjects[b].triggerEventHandlers(["mouseup","up"],[a]);this.downObjects.length=0,this.hasMouseUp&&(o.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),this.mouse=null},mouseWheelListener:function(a){if(!this.attr.zoom.wheel||!this._isRequiredKeyPressed(a,"zoom"))return!0;a=a||window.event;var d=a.detail?-a.detail:a.wheelDelta/40,e=new c(b.COORDS_BY_SCREEN,this.getMousePosition(a),this);return d>0?this.zoomIn(e.usrCoords[1],e.usrCoords[2]):this.zoomOut(e.usrCoords[1],e.usrCoords[2]),this.triggerEventHandlers(["mousewheel"],[a]),a.preventDefault(),!1},initInfobox:function(){var a=m.copyAttributes({},this.options,"infobox");return a.id=this.id+"_infobox",this.infobox=this.create("text",[0,0,"0,0"],a),this.infobox.distanceX=-20,this.infobox.distanceY=25,this.infobox.dump=!1,this.showInfobox(!1),this},updateInfobox:function(a){var b,c,d,e,f;return m.evaluate(a.visProp.showinfobox)?(m.isPoint(a)&&(d=a.coords.usrCoords[1],e=a.coords.usrCoords[2],f=m.evaluate(a.visProp.infoboxdigits),this.infobox.setCoords(d+this.infobox.distanceX/this.unitX,e+this.infobox.distanceY/this.unitY),"string"!=typeof a.infoboxText?("auto"===f?(b=m.autoDigits(d),c=m.autoDigits(e)):m.isNumber(f)?(b=m.toFixed(d,f),c=m.toFixed(e,f)):(b=d,c=e),this.highlightInfobox(b,c,a)):this.highlightCustomInfobox(a.infoboxText,a),this.showInfobox(!0)),this):this},showInfobox:function(a){return this.infobox.hiddenByParent==a&&(this.infobox.hiddenByParent=!a,this.infobox.prepareUpdate().updateVisibility(a).updateRenderer()),this},highlightInfobox:function(a,b,c){return this.highlightCustomInfobox("("+a+", "+b+")",c),this},highlightCustomInfobox:function(a,b){return this.infobox.setText(a),this},dehighlightAll:function(){var a,b,c=!1;for(a in this.highlightedObjects)this.highlightedObjects.hasOwnProperty(a)&&(b=this.highlightedObjects[a],(this.hasMouseHandlers||this.hasPointerHandlers)&&b.noHighlight(),c=!0);return this.highlightedObjects={},"canvas"===this.renderer.type&&c&&(this.prepareUpdate(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw()),this},getScrCoordsOfMouse:function(a,b){return[a,b]},getUsrCoordsOfMouse:function(a){var d=this.getCoordsTopLeftCorner(),e=o.getPosition(a,null,this.document),f=e[0]-d[0],g=e[1]-d[1],h=new c(b.COORDS_BY_SCREEN,[f,g],this);return h.usrCoords.slice(1)},getAllUnderMouse:function(a){var b=this.getAllObjectsUnderMouse(a);return b.push(this.getUsrCoordsOfMouse(a)),b},getAllObjectsUnderMouse:function(a){var b,c,d=this.getCoordsTopLeftCorner(),e=o.getPosition(a,null,this.document),f=e[0]-d[0],g=e[1]-d[1],h=[],i=this.objectsList.length;for(b=0;b<i;b++)c=this.objectsList[b],c.visPropCalc.visible&&c.hasPoint&&c.hasPoint(f,g)&&(h[h.length]=c);return h},updateCoords:function(){var a,b,c=this.objectsList.length;for(b=0;b<c;b++)a=this.objectsList[b],m.exists(a.coords)&&(m.evaluate(a.visProp.frozen)?a.coords.screen2usr():a.coords.usr2screen());return this},moveOrigin:function(a,b,c){return m.exists(a)&&m.exists(b)&&(this.origin.scrCoords[1]=a,this.origin.scrCoords[2]=b,c&&(this.origin.scrCoords[1]-=this.drag_dx,this.origin.scrCoords[2]-=this.drag_dy)),this.updateCoords().clearTraces().fullUpdate(),this.triggerEventHandlers(["boundingbox"]),this},addConditions:function(c){var d,e,f,g,h,i,j,k=[],n="var el, x, y, c, rgbo;\n",o=c.indexOf("<data>"),p=c.indexOf("</data>"),q=function(a,c,d,e){return function(){var f,g;f=a.select(c.id),g=f.coords.usrCoords[e],2===e?f.setPositionDirectly(b.COORDS_BY_USER,[d(),g]):f.setPositionDirectly(b.COORDS_BY_USER,[g,d()]),f.prepareUpdate().update()}},r=function(a,b,c){return function(){var d,e;d=a.select(b.id),e=c(),d.setAttribute({visible:e})}},s=function(a,b,c,d){return function(){var e,f;e=a.select(b.id),f=c(),"strokewidth"===d?e.visProp.strokewidth=f:(f=l.rgba2rgbo(f),e.visProp[d+"color"]=f[0],e.visProp[d+"opacity"]=f[1])}},t=function(a,b,c){return function(){var d=a.select(b.id);d.position=c()}},u=function(a,b,c){return function(){var d=a.select(b.id);d.setStyle(c())}};if(!(o<0)){for(;o>=0;){if(d=c.slice(o+6,p),e=d.indexOf("="),f=d.slice(0,e),g=d.slice(e+1),e=f.indexOf("."),h=f.slice(0,e),i=this.elementsByName[m.unescapeHTML(h)],j=f.slice(e+1).replace(/\s+/g,"").toLowerCase(),g=m.createFunction(g,this,"",!0),m.exists(this.elementsByName[h]))switch(n+='el = this.objects["'+i.id+'"];\n',j){case"x":k.push(q(this,i,g,2));break;case"y":k.push(q(this,i,g,1));break;case"visible":k.push(r(this,i,g));break;case"position":k.push(t(this,i,g));break;case"stroke":k.push(s(this,i,g,"stroke"));break;case"style":k.push(u(this,i,g));break;case"strokewidth":k.push(s(this,i,g,"strokewidth"));break;case"fill":k.push(s(this,i,g,"fill"));break;case"label":break;default:a.debug("property '"+j+"' in conditions not yet implemented:"+g)}else a.debug("debug conditions: |"+h+"| undefined");c=c.slice(p+7),o=c.indexOf("<data>"),p=c.indexOf("</data>")}this.updateConditions=function(){var a;for(a=0;a<k.length;a++)k[a]();return this.prepareUpdate().updateElements(),!0},this.updateConditions()}},updateConditions:function(){return!1},calculateSnapSizes:function(){var a=new c(b.COORDS_BY_USER,[0,0],this),d=new c(b.COORDS_BY_USER,[this.options.grid.gridX,this.options.grid.gridY],this),e=a.scrCoords[1]-d.scrCoords[1],f=a.scrCoords[2]-d.scrCoords[2];for(this.options.grid.snapSizeX=this.options.grid.gridX;Math.abs(e)>25;)this.options.grid.snapSizeX*=2,e/=2;for(this.options.grid.snapSizeY=this.options.grid.gridY;Math.abs(f)>25;)this.options.grid.snapSizeY*=2,f/=2;return this},applyZoom:function(){return this.updateCoords().calculateSnapSizes().clearTraces().fullUpdate(),this},zoomIn:function(a,b){var c=this.getBoundingBox(),d=this.attr.zoom.factorx,e=this.attr.zoom.factory,f=(c[2]-c[0])*(1-1/d),g=(c[1]-c[3])*(1-1/e),h=.5,i=.5,j=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX>this.attr.zoom.max&&d>1||this.zoomY>this.attr.zoom.max&&e>1||this.zoomX<j&&d<1||this.zoomY<j&&e<1?this:(m.isNumber(a)&&m.isNumber(b)&&(h=(a-c[0])/(c[2]-c[0]),i=(c[1]-b)/(c[1]-c[3])),this.setBoundingBox([c[0]+f*h,c[1]-g*i,c[2]-f*(1-h),c[3]+g*(1-i)],!1),this.zoomX*=d,this.zoomY*=e,this.applyZoom())},zoomOut:function(a,b){var c=this.getBoundingBox(),d=this.attr.zoom.factorx,e=this.attr.zoom.factory,f=(c[2]-c[0])*(1-d),g=(c[1]-c[3])*(1-e),h=.5,i=.5,j=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX<j||this.zoomY<j?this:(m.isNumber(a)&&m.isNumber(b)&&(h=(a-c[0])/(c[2]-c[0]),i=(c[1]-b)/(c[1]-c[3])),this.setBoundingBox([c[0]+f*h,c[1]-g*i,c[2]-f*(1-h),c[3]+g*(1-i)],!1),this.zoomX/=d,this.zoomY/=e,this.applyZoom())},zoom100:function(){var a=this.getBoundingBox(),b=(a[2]-a[0])*(1-this.zoomX)*.5,c=(a[1]-a[3])*(1-this.zoomY)*.5;return this.setBoundingBox([a[0]+b,a[1]-c,a[2]-b,a[3]+c],!1),this.zoomX=1,this.zoomY=1,this.applyZoom()},zoomAllPoints:function(){var a,b,c,d,e,f=0,g=0,h=0,i=0,j=this.objectsList.length;for(a=0;a<j;a++)e=this.objectsList[a],m.isPoint(e)&&e.visPropCalc.visible&&(e.coords.usrCoords[1]<f?f=e.coords.usrCoords[1]:e.coords.usrCoords[1]>g&&(g=e.coords.usrCoords[1]),e.coords.usrCoords[2]>i?i=e.coords.usrCoords[2]:e.coords.usrCoords[2]<h&&(h=e.coords.usrCoords[2]));return b=50,c=b/this.unitX,d=b/this.unitY,this.zoomX=1,this.zoomY=1,this.setBoundingBox([f-c,i+d,g+c,h-d],!0),this.applyZoom()},zoomElements:function(a){var b,c,d,e,f=[0,0,0,0],g=[1,-1,-1,1];if(!m.isArray(a)||0===a.length)return this;for(b=0;b<a.length;b++)if(d=this.select(a[b]),e=d.bounds(),m.isArray(e))if(m.isArray(f))for(c=0;c<4;c++)g[c]*e[c]<g[c]*f[c]&&(f[c]=e[c]);else f=e;if(m.isArray(f)){for(c=0;c<4;c++)f[c]-=g[c];this.zoomX=1,this.zoomY=1,this.setBoundingBox(f,!0)}return this},setZoom:function(a,b){var c=this.attr.zoom.factorx,d=this.attr.zoom.factory;return this.attr.zoom.factorx=a/this.zoomX,this.attr.zoom.factory=b/this.zoomY,this.zoomIn(),this.attr.zoom.factorx=c,this.attr.zoom.factory=d,this},removeObject:function(c){var d,e;if(m.isArray(c)){for(e=0;e<c.length;e++)this.removeObject(c[e]);return this}if(c=this.select(c),!m.exists(c)||m.isString(c))return this;try{for(d in c.childElements)c.childElements.hasOwnProperty(d)&&c.childElements[d].board.removeObject(c.childElements[d]);for(d in c.objects)c.objects.hasOwnProperty(d)&&c.objects[d].board.removeObject(c.objects[d]);for(d in this.objects)this.objects.hasOwnProperty(d)&&m.exists(this.objects[d].childElements)&&(delete this.objects[d].childElements[c.id],delete this.objects[d].descendants[c.id]);if(c._pos>-1)for(this.objectsList.splice(c._pos,1),d=c._pos;d<this.objectsList.length;d++)this.objectsList[d]._pos--;else c.type!==b.OBJECT_TYPE_TURTLE&&a.debug("Board.removeObject: object "+c.id+" not found in list.");delete this.objects[c.id],delete this.elementsByName[c.name],c.visProp&&m.evaluate(c.visProp.trace)&&c.clearTrace(),m.exists(c.remove)&&c.remove()}catch(f){a.debug(c.id+": Could not be removed: "+f)}return this.update(),this},removeAncestors:function(a){var b;for(b in a.ancestors)a.ancestors.hasOwnProperty(b)&&this.removeAncestors(a.ancestors[b]);return this.removeObject(a),this},initGeonextBoard:function(){var a,b,c;return a=this.create("point",[0,0],{id:this.id+"g00e0",name:"Ursprung",withLabel:!1,visible:!1,fixed:!0}),b=this.create("point",[1,0],{id:this.id+"gX0e0",name:"Punkt_1_0",withLabel:!1,visible:!1,fixed:!0}),c=this.create("point",[0,1],{id:this.id+"gY0e0",name:"Punkt_0_1",withLabel:!1,visible:!1,fixed:!0}),this.create("line",[a,b],{id:this.id+"gXLe0",name:"X-Achse",withLabel:!1,visible:!1}),this.create("line",[a,c],{id:this.id+"gYLe0",name:"Y-Achse",withLabel:!1,visible:!1}),this},resizeContainer:function(a,b,c,d){var e;return d||(e=this.getBoundingBox()),this.canvasWidth=parseInt(a,10),this.canvasHeight=parseInt(b,10),c||(this.containerObj.style.width=this.canvasWidth+"px",this.containerObj.style.height=this.canvasHeight+"px"),this.renderer.resize(this.canvasWidth,this.canvasHeight),d||this.setBoundingBox(e,this.keepaspectratio),this},showDependencies:function(){var a,b,c,d,e;b="<p>\n";for(a in this.objects)if(this.objects.hasOwnProperty(a)){e=0;for(c in this.objects[a].childElements)this.objects[a].childElements.hasOwnProperty(c)&&(e+=1);e>=0&&(b+="<strong>"+this.objects[a].id+":</strong> ");for(c in this.objects[a].childElements)this.objects[a].childElements.hasOwnProperty(c)&&(b+=this.objects[a].childElements[c].id+"("+this.objects[a].childElements[c].name+"), ");b+="<p>\n"}return b+="</p>\n",d=window.open(),d.document.open(),d.document.write(b),d.document.close(),this},showXML:function(){var a=window.open("");return a.document.open(),a.document.write("<pre>"+m.escapeHTML(this.xmlString)+"</pre>"),a.document.close(),this},prepareUpdate:function(){var a,b,c=this.objectsList.length;for(a=0;a<c;a++)b=this.objectsList[a],b.needsUpdate=b.needsRegularUpdate||this.needsFullUpdate;for(a in this.groups)this.groups.hasOwnProperty(a)&&(b=this.groups[a],b.needsUpdate=b.needsRegularUpdate||this.needsFullUpdate);return this},updateElements:function(a){var b,c;for(a=this.select(a),b=0;b<this.objectsList.length;b++)c=this.objectsList[b],c.update(!m.exists(a)||c.id!==a.id).updateVisibility();for(b in this.groups)this.groups.hasOwnProperty(b)&&this.groups[b].update(a);return this},updateRenderer:function(){var a,b=this.objectsList.length;if("canvas"===this.renderer.type)this.updateRendererCanvas();else for(a=0;a<b;a++)this.objectsList[a].updateRenderer();return this},updateRendererCanvas:function(){var a,b,c,d,e,f=this.objectsList.length,g=this.options.layer,h=this.options.layer.numlayers,i=Number.NEGATIVE_INFINITY;for(c=0;c<h;c++){d=Number.POSITIVE_INFINITY;for(e in g)g.hasOwnProperty(e)&&g[e]>i&&g[e]<d&&(d=g[e]);for(i=d,a=0;a<f;a++)b=this.objectsList[a],b.visProp.layer===d&&b.prepareUpdate().updateRenderer()}return this},addHook:function(b,c,d){return a.deprecated("Board.addHook()","Board.on()"),c=m.def(c,"update"),d=m.def(d,this),this.hooks.push([c,b]),this.on(c,b,d),this.hooks.length-1},addEvent:a.shortcut(a.Board.prototype,"on"),removeHook:function(b){return a.deprecated("Board.removeHook()","Board.off()"),this.hooks[b]&&(this.off(this.hooks[b][0],this.hooks[b][1]),this.hooks[b]=null),this},removeEvent:a.shortcut(a.Board.prototype,"off"),updateHooks:function(b){var c=Array.prototype.slice.call(arguments,0);return a.deprecated("Board.updateHooks()","Board.triggerEventHandlers()"),c[0]=m.def(c[0],"update"),this.triggerEventHandlers([c[0]],arguments),this},addChild:function(a){return m.exists(a)&&m.exists(a.containerObj)&&(this.dependentBoards.push(a),this.update()),this},removeChild:function(a){var b;for(b=this.dependentBoards.length-1;b>=0;b--)this.dependentBoards[b]===a&&this.dependentBoards.splice(b,1);return this},update:function(a){var b,c,d,e;if(this.inUpdate||this.isSuspendedUpdate)return this;for(this.inUpdate=!0,"all"===this.attr.minimizereflow&&this.containerObj&&"vml"!==this.renderer.type&&(e=this.renderer.removeToInsertLater(this.containerObj)),"svg"===this.attr.minimizereflow&&"svg"===this.renderer.type&&(e=this.renderer.removeToInsertLater(this.renderer.svgRoot)),this.prepareUpdate().updateElements(a).updateConditions(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw(),this.triggerEventHandlers(["update"],[]),e&&e(),c=this.dependentBoards.length,b=0;b<c;b++)d=this.dependentBoards[b],m.exists(d)&&d!==this&&(d.updateQuality=this.updateQuality,d.prepareUpdate().updateElements().updateConditions(),d.renderer.suspendRedraw(),d.updateRenderer(),d.renderer.unsuspendRedraw(),d.triggerEventHandlers(["update"],[]));return this.inUpdate=!1,this},fullUpdate:function(){return this.needsFullUpdate=!0,this.update(),this.needsFullUpdate=!1,this},addGrid:function(){return this.create("grid",[]),this},removeGrids:function(){var a;for(a=0;a<this.grids.length;a++)this.removeObject(this.grids[a]);return this.grids.length=0,this.update(),this},create:function(b,c,d){var e,f;for(b=b.toLowerCase(),m.exists(c)||(c=[]),m.exists(d)||(d={}),f=0;f<c.length;f++)m.isString(c[f])&&("text"!==b||2!==f)&&("input"!==b&&"checkbox"!==b&&"button"!==b||2!==f&&3!==f)&&(c[f]=this.select(c[f]));if(!m.isFunction(a.elements[b]))throw new Error("JSXGraph: create: Unknown element type given: "+b);return e=a.elements[b](this,c,d),m.exists(e)?(e.prepareUpdate&&e.update&&e.updateRenderer&&e.fullUpdate(),e):(a.debug("JSXGraph: create: failure creating "+b),e)},createElement:function(){return a.deprecated("Board.createElement()","Board.create()"),this.create.apply(this,arguments)},clearTraces:function(){var a;for(a=0;a<this.objectsList.length;a++)this.objectsList[a].clearTrace();return this.numTraces=0,this},suspendUpdate:function(){return this.inUpdate||(this.isSuspendedUpdate=!0),this},unsuspendUpdate:function(){return this.isSuspendedUpdate&&(this.isSuspendedUpdate=!1,this.fullUpdate()),this},setBoundingBox:function(a,b){var c,d,e=o.getDimensions(this.container,this.document);return m.isArray(a)?(this.plainBB=a,this.canvasWidth=parseInt(e.width,10),this.canvasHeight=parseInt(e.height,10),d=this.canvasWidth,c=this.canvasHeight,
b?(this.unitX=d/(a[2]-a[0]),this.unitY=c/(a[1]-a[3]),Math.abs(this.unitX)<Math.abs(this.unitY)?this.unitY=Math.abs(this.unitX)*this.unitY/Math.abs(this.unitY):this.unitX=Math.abs(this.unitY)*this.unitX/Math.abs(this.unitX),this.keepaspectratio=!0):(this.unitX=d/(a[2]-a[0]),this.unitY=c/(a[1]-a[3]),this.keepaspectratio=!1),this.moveOrigin(-this.unitX*a[0],this.unitY*a[1]),this):this},getBoundingBox:function(){var a=new c(b.COORDS_BY_SCREEN,[0,0],this),d=new c(b.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this);return[a.usrCoords[1],a.usrCoords[2],d.usrCoords[1],d.usrCoords[2]]},addAnimation:function(a){var b=this;return this.animationObjects[a.id]=a,this.animationIntervalCode||(this.animationIntervalCode=window.setInterval(function(){b.animate()},a.board.attr.animationdelay)),this},stopAllAnimation:function(){var a;for(a in this.animationObjects)this.animationObjects.hasOwnProperty(a)&&m.exists(this.animationObjects[a])&&(this.animationObjects[a]=null,delete this.animationObjects[a]);return window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode,this},animate:function(){var a,c,d,e,f,g,h,i,j=0,k=null;for(c in this.animationObjects)if(this.animationObjects.hasOwnProperty(c)&&m.exists(this.animationObjects[c])){if(j+=1,d=this.animationObjects[c],d.animationPath&&(e=m.isFunction(d.animationPath)?d.animationPath((new Date).getTime()-d.animationStart):d.animationPath.pop(),!m.exists(e)||!m.isArray(e)&&isNaN(e)?delete d.animationPath:(d.setPositionDirectly(b.COORDS_BY_USER,e),d.fullUpdate(),k=d)),d.animationData){h=0;for(f in d.animationData)d.animationData.hasOwnProperty(f)&&(g=d.animationData[f].pop(),m.exists(g)?(h+=1,a={},a[f]=g,d.setAttribute(a)):delete d.animationData[g]);0===h&&delete d.animationData}m.exists(d.animationData)||m.exists(d.animationPath)||(this.animationObjects[c]=null,delete this.animationObjects[c],m.exists(d.animationCallback)&&(i=d.animationCallback,d.animationCallback=null,i()))}return 0===j?(window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode):this.update(k),this},migratePoint:function(a,b,c){var d,e,f,g,h,i,j=!1;a=this.select(a),b=this.select(b),m.exists(a.label)&&(i=a.label.id,j=!0,this.removeObject(a.label));for(e in a.childElements)if(a.childElements.hasOwnProperty(e)){d=a.childElements[e],g=!1;for(f in d)d.hasOwnProperty(f)&&d[f]===a&&(d[f]=b,g=!0);for(g&&delete a.childElements[e],h=0;h<d.parents.length;h++)d.parents[h]===a.id&&(d.parents[h]=b.id);b.addChild(d)}return c&&(j&&(delete b.childElements[i],delete b.descendants[i]),b.label&&this.removeObject(b.label),delete this.elementsByName[b.name],b.name=a.name,j&&b.createLabel()),this.removeObject(a),m.exists(b.name)&&""!==b.name&&(this.elementsByName[b.name]=b),this.fullUpdate(),this},emulateColorblindness:function(b){var c,d;if(m.exists(b)||(b="none"),this.currentCBDef===b)return this;for(c in this.objects)this.objects.hasOwnProperty(c)&&(d=this.objects[c],"none"!==b?("none"===this.currentCBDef&&(d.visPropOriginal={strokecolor:d.visProp.strokecolor,fillcolor:d.visProp.fillcolor,highlightstrokecolor:d.visProp.highlightstrokecolor,highlightfillcolor:d.visProp.highlightfillcolor}),d.setAttribute({strokecolor:l.rgb2cb(m.evaluate(d.visPropOriginal.strokecolor),b),fillcolor:l.rgb2cb(m.evaluate(d.visPropOriginal.fillcolor),b),highlightstrokecolor:l.rgb2cb(m.evaluate(d.visPropOriginal.highlightstrokecolor),b),highlightfillcolor:l.rgb2cb(m.evaluate(d.visPropOriginal.highlightfillcolor),b)})):m.exists(d.visPropOriginal)&&a.extend(d.visProp,d.visPropOriginal));return this.currentCBDef=b,this.update(),this},select:function(a){var b,c,d,e,f=a;if(null===f)return f;if(m.isString(f)&&""!==f)m.exists(this.objects[f])?f=this.objects[f]:m.exists(this.elementsByName[f])?f=this.elementsByName[f]:m.exists(this.groups[f])&&(f=this.groups[f]);else if(m.isFunction(f)||m.isObject(f)&&!m.isFunction(f.setAttribute)){for(b=m.filterElements(this.objectsList,f),c={},e=b.length,d=0;d<e;d++)c[b[d].id]=b[d];f=new u(c)}else m.isObject(f)&&m.exists(f.id)&&!m.exists(this.objects[f.id])&&(f=null);return f},hasPoint:function(a,b){var c=a,d=b,e=this.getBoundingBox();return m.exists(a)&&m.isArray(a.usrCoords)&&(c=a.usrCoords[1],d=a.usrCoords[2]),!!(m.isNumber(c)&&m.isNumber(d)&&e[0]<c&&c<e[2]&&e[1]>d&&d>e[3])},updateCSSTransforms:function(){var a=this.containerObj,b=a,c=a;for(this.cssTransMat=o.getCSSTransformMatrix(b),b=b.offsetParent;b;){for(this.cssTransMat=f.matMatMult(o.getCSSTransformMatrix(b),this.cssTransMat),c=c.parentNode;c!==b;)this.cssTransMat=f.matMatMult(o.getCSSTransformMatrix(b),this.cssTransMat),c=c.parentNode;b=b.offsetParent}return this.cssTransMat=f.inverse(this.cssTransMat),this},startSelectionMode:function(){this.selectingMode=!0,this.selectionPolygon.setAttribute({visible:!0}),this.selectingBox=[[0,0],[0,0]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate()},stopSelectionMode:function(){return this.selectingMode=!1,this.selectionPolygon.setAttribute({visible:!1}),[this.selectionPolygon.vertices[0].coords,this.selectionPolygon.vertices[2].coords]},_startSelecting:function(a){this.isSelecting=!0,this.selectingBox=[[a[0],a[1]],[a[0],a[1]]],this._setSelectionPolygonFromBox()},_moveSelecting:function(a){this.isSelecting&&(this.selectingBox[1]=[a[0],a[1]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate())},_stopSelecting:function(a){var b=this.getMousePosition(a);this.isSelecting=!1,this.selectingBox[1]=[b[0],b[1]],this._setSelectionPolygonFromBox()},_setSelectionPolygonFromBox:function(){var b=this.selectingBox[0],c=this.selectingBox[1];this.selectionPolygon.vertices[0].setPositionDirectly(a.COORDS_BY_SCREEN,[b[0],b[1]]),this.selectionPolygon.vertices[1].setPositionDirectly(a.COORDS_BY_SCREEN,[b[0],c[1]]),this.selectionPolygon.vertices[2].setPositionDirectly(a.COORDS_BY_SCREEN,[c[0],c[1]]),this.selectionPolygon.vertices[3].setPositionDirectly(a.COORDS_BY_SCREEN,[c[0],b[1]])},_testForSelection:function(a){this._isRequiredKeyPressed(a,"selection")&&(m.exists(this.selectionPolygon)||this._createSelectionPolygon(this.attr),this.startSelectionMode())},_createSelectionPolygon:function(a){var b;return m.exists(this.selectionPolygon)||(b=m.copyAttributes(a,d,"board","selection"),b.enabled===!0&&(this.selectionPolygon=this.create("polygon",[[0,0],[0,0],[0,0],[0,0]],b))),this},__evt__down:function(a){},__evt__mousedown:function(a){},__evt__pointerdown:function(a){},__evt__touchstart:function(a){},__evt__up:function(a){},__evt__mouseup:function(a){},__evt__pointerup:function(a){},__evt__touchend:function(a){},__evt__move:function(a,b){},__evt__mousemove:function(a,b){},__evt__pointermove:function(a,b){},__evt__touchmove:function(a,b){},__evt__hit:function(a,b,c){},__evt__mousehit:function(a,b,c){},__evt__update:function(){},__evt__boundingbox:function(){},__evt__startselecting:function(){},__evt__mousestartselecting:function(){},__evt__pointerstartselecting:function(){},__evt__touchstartselecting:function(){},__evt__stopselecting:function(){},__evt__mousestopselecting:function(){},__evt__pointerstopselecting:function(){},__evt__touchstopselecting:function(){},__evt__moveselecting:function(){},__evt__mousemoveselecting:function(){},__evt__pointermoveselecting:function(){},__evt__touchmoveselecting:function(){},__evt:function(){},createRoulette:function(a,b,c,d,f,g,i){var j=this,k=function(){var k,l=0,m=0,n=0,o=c,p=e.root(function(c){var d=a.X(o),e=a.Y(o),f=b.X(c),g=b.Y(c);return(d-f)*(d-f)+(e-g)*(e-g)},[0,2*Math.PI]),q=0,r=0,s=j.create("transform",[function(){return l}],{type:"rotate"}),t=j.create("transform",[function(){return l},function(){return a.X(o)},function(){return a.Y(o)}],{type:"rotate"}),u=j.create("transform",[function(){return m},function(){return n}],{type:"translate"}),v=function(a,b,c){var d=e.D(a.X)(b),f=e.D(a.Y)(b),g=e.D(a.X)(c),h=e.D(a.Y)(c),i=e.D(a.X)(.5*(b+c)),j=e.D(a.Y)(.5*(b+c)),k=Math.sqrt(d*d+f*f),l=Math.sqrt(g*g+h*h),m=Math.sqrt(i*i+j*j);return(k+4*m+l)*(c-b)/6},w=function(a){return k-v(b,p,a)},x=Math.PI/18,y=9*x,z=null;return this.rolling=function(){var c,g,z,A,B;q=o+f*d,k=v(a,o,q),r=e.root(w,p),c=new h(a.X(q),a.Y(q)),g=new h(b.X(r),b.Y(r)),z=new h(e.D(a.X)(q),e.D(a.Y)(q)),A=new h(e.D(b.X)(r),e.D(b.Y)(r)),B=h.C.div(z,A),l=Math.atan2(B.imaginary,B.real),B.div(h.C.abs(B)),B.mult(g),m=c.real-B.real,n=c.imaginary-B.imaginary,l<-x&&l>-y?(l=-x,t.applyOnce(i)):l>x&&l<y?(l=x,t.applyOnce(i)):(s.applyOnce(i),u.applyOnce(i),o=q,p=r),j.update()},this.start=function(){return g>0&&(z=window.setInterval(this.rolling,g)),this},this.stop=function(){return window.clearInterval(z),this},this};return new k}}),a.Board}),define("renderer/svg",["jxg","options","renderer/abstract","base/constants","utils/type","utils/env","utils/color","utils/base64","math/numerics"],function(a,b,c,d,e,f,g,h,i){"use strict";return a.SVGRenderer=function(a,c){var d;for(this.type="svg",this.isIE=navigator.appVersion.indexOf("MSIE")!==-1||navigator.userAgent.match(/Trident\//),this.svgRoot=null,this.svgNamespace="http://www.w3.org/2000/svg",this.xlinkNamespace="http://www.w3.org/1999/xlink",this.container=a,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",""===this.container.style.position&&(this.container.style.position="relative"),this.svgRoot=this.container.ownerDocument.createElementNS(this.svgNamespace,"svg"),this.svgRoot.style.overflow="hidden",this.resize(c.width,c.height),this.container.appendChild(this.svgRoot),this.defs=this.container.ownerDocument.createElementNS(this.svgNamespace,"defs"),this.svgRoot.appendChild(this.defs),this.filter=this.container.ownerDocument.createElementNS(this.svgNamespace,"filter"),this.filter.setAttributeNS(null,"id",this.container.id+"_f1"),this.filter.setAttributeNS(null,"width","300%"),this.filter.setAttributeNS(null,"height","300%"),this.filter.setAttributeNS(null,"filterUnits","userSpaceOnUse"),this.feOffset=this.container.ownerDocument.createElementNS(this.svgNamespace,"feOffset"),this.feOffset.setAttributeNS(null,"result","offOut"),this.feOffset.setAttributeNS(null,"in","SourceAlpha"),this.feOffset.setAttributeNS(null,"dx","5"),this.feOffset.setAttributeNS(null,"dy","5"),this.filter.appendChild(this.feOffset),this.feGaussianBlur=this.container.ownerDocument.createElementNS(this.svgNamespace,"feGaussianBlur"),this.feGaussianBlur.setAttributeNS(null,"result","blurOut"),this.feGaussianBlur.setAttributeNS(null,"in","offOut"),this.feGaussianBlur.setAttributeNS(null,"stdDeviation","3"),this.filter.appendChild(this.feGaussianBlur),this.feBlend=this.container.ownerDocument.createElementNS(this.svgNamespace,"feBlend"),this.feBlend.setAttributeNS(null,"in","SourceGraphic"),this.feBlend.setAttributeNS(null,"in2","blurOut"),this.feBlend.setAttributeNS(null,"mode","normal"),this.filter.appendChild(this.feBlend),this.defs.appendChild(this.filter),this.layer=[],d=0;d<b.layer.numlayers;d++)this.layer[d]=this.container.ownerDocument.createElementNS(this.svgNamespace,"g"),this.svgRoot.appendChild(this.layer[d]);this.supportsForeignObject=document.implementation.hasFeature("http://w3.org/TR/SVG11/feature#Extensibility","1.1"),this.supportsForeignObject&&(this.foreignObjLayer=this.container.ownerDocument.createElementNS(this.svgNamespace,"foreignObject"),this.foreignObjLayer.setAttribute("x",0),this.foreignObjLayer.setAttribute("y",0),this.foreignObjLayer.setAttribute("width","100%"),this.foreignObjLayer.setAttribute("height","100%"),this.foreignObjLayer.setAttribute("id",this.container.id+"_foreignObj"),this.svgRoot.appendChild(this.foreignObjLayer)),this.dashArray=["2, 2","5, 5","10, 10","20, 20","20, 10, 10, 10","20, 5, 10, 5"]},a.SVGRenderer.prototype=new c,a.extend(a.SVGRenderer.prototype,{_createArrowHead:function(b,c){var d,f,g=b.id+"Triangle",h=null,i=e.evaluate(b.visProp.firstarrow),j=e.evaluate(b.visProp.lastarrow);return e.exists(c)&&(g+=c),d=this.createPrim("marker",g),d.setAttributeNS(null,"stroke",e.evaluate(b.visProp.strokecolor)),d.setAttributeNS(null,"stroke-opacity",e.evaluate(b.visProp.strokeopacity)),d.setAttributeNS(null,"fill",e.evaluate(b.visProp.strokecolor)),d.setAttributeNS(null,"fill-opacity",e.evaluate(b.visProp.strokeopacity)),d.setAttributeNS(null,"stroke-width",0),d.setAttributeNS(null,"orient","auto"),d.setAttributeNS(null,"markerUnits","strokeWidth"),f=this.container.ownerDocument.createElementNS(this.svgNamespace,"path"),"End"===c?(a.exists(i.type)&&(h=e.evaluate(i.type)),d.setAttributeNS(null,"refY",5),2===h?(d.setAttributeNS(null,"refX",4.9),f.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 L 5,5 z")):3===h?(d.setAttributeNS(null,"refX",3.33),f.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")):(d.setAttributeNS(null,"refX",9.9),f.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 z"))):(a.exists(j.type)&&(h=e.evaluate(j.type)),d.setAttributeNS(null,"refY",5),2===h?(d.setAttributeNS(null,"refX",5.1),f.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 L 5,5 z")):3===h?(d.setAttributeNS(null,"refX",.1),f.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")):(d.setAttributeNS(null,"refX",.1),f.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 z"))),d.appendChild(f),d},_setArrowColor:function(a,b,c,d){a&&(e.isString(b)&&this._setAttribute(function(){a.setAttributeNS(null,"stroke",b),a.setAttributeNS(null,"fill",b),a.setAttributeNS(null,"stroke-opacity",c),a.setAttributeNS(null,"fill-opacity",c)},d.visPropOld.fillcolor),this.isIE&&d.rendNode.parentNode.insertBefore(d.rendNode,d.rendNode))},_setArrowWidth:function(a,b,c,d){var e,f;a&&(0===b?a.setAttributeNS(null,"display","none"):(e=b,f=e*d,a.setAttributeNS(null,"viewBox","0 0 "+10*e+" "+10*e),a.setAttributeNS(null,"markerHeight",f),a.setAttributeNS(null,"markerWidth",f),a.setAttributeNS(null,"display","inherit")),this.isIE&&c.parentNode.insertBefore(c,c))},updateTicks:function(a){var b,c,d,f,g,h="",i=a.ticks.length;for(b=0;b<i;b++)c=a.ticks[b],f=c[0],g=c[1],e.isNumber(f[0])&&e.isNumber(f[1])&&(h+="M "+f[0]+" "+g[0]+" L "+f[1]+" "+g[1]+" ");d=a.rendNode,e.exists(d)||(d=this.createPrim("path",a.id),this.appendChildPrim(d,e.evaluate(a.visProp.layer)),a.rendNode=d),d.setAttributeNS(null,"stroke",e.evaluate(a.visProp.strokecolor)),d.setAttributeNS(null,"stroke-opacity",e.evaluate(a.visProp.strokeopacity)),d.setAttributeNS(null,"stroke-width",e.evaluate(a.visProp.strokewidth)),this.updatePathPrim(d,h,a.board)},displayCopyright:function(a,b){var c,d=this.createPrim("text","licenseText");d.setAttributeNS(null,"x","20px"),d.setAttributeNS(null,"y",2+b+"px"),d.setAttributeNS(null,"style","font-family:Arial,Helvetica,sans-serif; font-size:"+b+"px; fill:#356AA0;  opacity:0.3;"),c=this.container.ownerDocument.createTextNode(a),d.appendChild(c),this.appendChildPrim(d,0)},drawInternalText:function(a){var b=this.createPrim("text",a.id);return b.style.whiteSpace="nowrap",a.rendNodeText=this.container.ownerDocument.createTextNode(""),b.appendChild(a.rendNodeText),this.appendChildPrim(b,e.evaluate(a.visProp.layer)),b},updateInternalText:function(a){var b,c=a.plaintext,d=a.getAnchorX(),f=a.getAnchorY();a.rendNode.getAttributeNS(null,"class")!==a.visProp.cssclass&&(a.rendNode.setAttributeNS(null,"class",e.evaluate(a.visProp.cssclass)),a.needsSizeUpdate=!0),isNaN(a.coords.scrCoords[1]+a.coords.scrCoords[2])||(b=a.coords.scrCoords[1],a.visPropOld.left!==d+b&&(a.rendNode.setAttributeNS(null,"x",b+"px"),"left"===d?a.rendNode.setAttributeNS(null,"text-anchor","start"):"right"===d?a.rendNode.setAttributeNS(null,"text-anchor","end"):"middle"===d&&a.rendNode.setAttributeNS(null,"text-anchor","middle"),a.visPropOld.left=d+b),b=a.coords.scrCoords[2],a.visPropOld.top!==f+b&&(a.rendNode.setAttributeNS(null,"y",b+.5*this.vOffsetText+"px"),"bottom"===f?a.rendNode.setAttributeNS(null,"dominant-baseline","text-after-edge"):"top"===f?a.rendNode.setAttributeNS(null,"dy","1.6ex"):"middle"===f&&a.rendNode.setAttributeNS(null,"dy","0.6ex"),a.visPropOld.top=f+b)),a.htmlStr!==c&&(a.rendNodeText.data=c,a.htmlStr=c),this.transformImage(a,a.transformations)},updateInternalTextStyle:function(a,b,c,d){this.setObjectFillColor(a,b,c)},drawImage:function(a){var b=this.createPrim("image",a.id);b.setAttributeNS(null,"preserveAspectRatio","none"),this.appendChildPrim(b,e.evaluate(a.visProp.layer)),a.rendNode=b,this.updateImage(a)},transformImage:function(a,b){var c,d,e=a.rendNode,f="",g=b.length;g>0&&(d=this.joinTransforms(a,b),c=[d[1][1],d[2][1],d[1][2],d[2][2],d[1][0],d[2][0]].join(","),f+=" matrix("+c+") ",e.setAttributeNS(null,"transform",f))},updateImageURL:function(a){var b=e.evaluate(a.url);a.rendNode.setAttributeNS(this.xlinkNamespace,"xlink:href",b)},updateImageStyle:function(a,b){var c=e.evaluate(b?a.visProp.highlightcssclass:a.visProp.cssclass);a.rendNode.setAttributeNS(null,"class",c)},appendChildPrim:function(a,c){return e.exists(c)?c>=b.layer.numlayers&&(c=b.layer.numlayers-1):c=0,this.layer[c].appendChild(a),a},createPrim:function(a,b){var c=this.container.ownerDocument.createElementNS(this.svgNamespace,a);return c.setAttributeNS(null,"id",this.container.id+"_"+b),c.style.position="absolute","path"===a&&(c.setAttributeNS(null,"stroke-linecap","round"),c.setAttributeNS(null,"stroke-linejoin","round")),c},remove:function(a){e.exists(a)&&e.exists(a.parentNode)&&a.parentNode.removeChild(a)},makeArrows:function(a){var b,c=e.evaluate(a.visProp.firstarrow),d=e.evaluate(a.visProp.lastarrow);return a.visPropOld.firstarrow===c&&a.visPropOld.lastarrow===d?void(this.isIE&&a.visPropCalc.visible&&(c||d)&&a.rendNode.parentNode.insertBefore(a.rendNode,a.rendNode)):(c?(b=a.rendNodeTriangleStart,e.exists(b)?this.defs.appendChild(b):(b=this._createArrowHead(a,"End"),this.defs.appendChild(b),a.rendNodeTriangleStart=b,a.rendNode.setAttributeNS(null,"marker-start","url(#"+this.container.id+"_"+a.id+"TriangleEnd)"))):(b=a.rendNodeTriangleStart,e.exists(b)&&this.remove(b)),d?(b=a.rendNodeTriangleEnd,e.exists(b)?this.defs.appendChild(b):(b=this._createArrowHead(a,"Start"),this.defs.appendChild(b),a.rendNodeTriangleEnd=b,a.rendNode.setAttributeNS(null,"marker-end","url(#"+this.container.id+"_"+a.id+"TriangleStart)"))):(b=a.rendNodeTriangleEnd,e.exists(b)&&this.remove(b)),a.visPropOld.firstarrow=c,void(a.visPropOld.lastarrow=d))},updateEllipsePrim:function(a,b,c,d,e){var f=1e6;f=2e5,b=Math.abs(b)<f?b:f*b/Math.abs(b),c=Math.abs(c)<f?c:f*c/Math.abs(c),d=Math.abs(d)<f?d:f*d/Math.abs(d),e=Math.abs(e)<f?e:f*e/Math.abs(e),a.setAttributeNS(null,"cx",b),a.setAttributeNS(null,"cy",c),a.setAttributeNS(null,"rx",Math.abs(d)),a.setAttributeNS(null,"ry",Math.abs(e))},updateLinePrim:function(a,b,c,d,e){var f=1e6;f=2e5,isNaN(b+c+d+e)||(b=Math.abs(b)<f?b:f*b/Math.abs(b),c=Math.abs(c)<f?c:f*c/Math.abs(c),d=Math.abs(d)<f?d:f*d/Math.abs(d),e=Math.abs(e)<f?e:f*e/Math.abs(e),a.setAttributeNS(null,"x1",b),a.setAttributeNS(null,"y1",c),a.setAttributeNS(null,"x2",d),a.setAttributeNS(null,"y2",e))},updatePathPrim:function(a,b){""===b&&(b="M 0 0"),a.setAttributeNS(null,"d",b)},updatePathStringPoint:function(a,b,c){var d="",e=a.coords.scrCoords,f=b*Math.sqrt(3)*.5,g=.5*b;return"x"===c?d=" M "+(e[1]-b)+" "+(e[2]-b)+" L "+(e[1]+b)+" "+(e[2]+b)+" M "+(e[1]+b)+" "+(e[2]-b)+" L "+(e[1]-b)+" "+(e[2]+b):"+"===c?d=" M "+(e[1]-b)+" "+e[2]+" L "+(e[1]+b)+" "+e[2]+" M "+e[1]+" "+(e[2]-b)+" L "+e[1]+" "+(e[2]+b):"<>"===c?d=" M "+(e[1]-b)+" "+e[2]+" L "+e[1]+" "+(e[2]+b)+" L "+(e[1]+b)+" "+e[2]+" L "+e[1]+" "+(e[2]-b)+" Z ":"^"===c?d=" M "+e[1]+" "+(e[2]-b)+" L "+(e[1]-f)+" "+(e[2]+g)+" L "+(e[1]+f)+" "+(e[2]+g)+" Z ":"v"===c?d=" M "+e[1]+" "+(e[2]+b)+" L "+(e[1]-f)+" "+(e[2]-g)+" L "+(e[1]+f)+" "+(e[2]-g)+" Z ":">"===c?d=" M "+(e[1]+b)+" "+e[2]+" L "+(e[1]-g)+" "+(e[2]-f)+" L "+(e[1]-g)+" "+(e[2]+f)+" Z ":"<"===c&&(d=" M "+(e[1]-b)+" "+e[2]+" L "+(e[1]+g)+" "+(e[2]-f)+" L "+(e[1]+g)+" "+(e[2]+f)+" Z "),d},updatePathStringPrim:function(a){var b,c,d,e=" M ",f=" L ",g=" C ",h=e,i=5e3,j="";if(a.numberPoints<=0)return"";if(d=Math.min(a.points.length,a.numberPoints),1===a.bezierDegree)for(b=0;b<d;b++)c=a.points[b].scrCoords,isNaN(c[1])||isNaN(c[2])?h=e:(c[1]=Math.max(Math.min(c[1],i),-i),c[2]=Math.max(Math.min(c[2],i),-i),j+=h+c[1]+" "+c[2],h=f);else if(3===a.bezierDegree)for(b=0;b<d;)c=a.points[b].scrCoords,isNaN(c[1])||isNaN(c[2])?h=e:(j+=h+c[1]+" "+c[2],h===g&&(b+=1,c=a.points[b].scrCoords,j+=" "+c[1]+" "+c[2],b+=1,c=a.points[b].scrCoords,j+=" "+c[1]+" "+c[2]),h=g),b+=1;return j},updatePathStringBezierPrim:function(a){var b,c,d,f,g,h,j,k=" M ",l=" C ",m=k,n=5e3,o="",p=e.evaluate(a.visProp.strokewidth),q="plot"!==e.evaluate(a.visProp.curvetype);if(a.numberPoints<=0)return"";for(q&&a.board.options.curve.RDPsmoothing&&(a.points=i.RamerDouglasPeucker(a.points,.5)),j=Math.min(a.points.length,a.numberPoints),c=1;c<3;c++)for(m=k,b=0;b<j;b++)f=a.points[b].scrCoords,isNaN(f[1])||isNaN(f[2])?m=k:(f[1]=Math.max(Math.min(f[1],n),-n),f[2]=Math.max(Math.min(f[2],n),-n),m===k?o+=m+f[1]+" "+f[2]:(d=2*c,o+=[m,g+.333*(f[1]-g)+p*(d*Math.random()-c)," ",h+.333*(f[2]-h)+p*(d*Math.random()-c)," ",g+.666*(f[1]-g)+p*(d*Math.random()-c)," ",h+.666*(f[2]-h)+p*(d*Math.random()-c)," ",f[1]," ",f[2]].join("")),m=l,g=f[1],h=f[2]);return o},updatePolygonPrim:function(a,b){var c,d,e="",f=b.vertices.length;for(a.setAttributeNS(null,"stroke","none"),c=0;c<f-1;c++){if(!b.vertices[c].isReal)return void a.setAttributeNS(null,"points","");d=b.vertices[c].coords.scrCoords,e=e+d[1]+","+d[2],c<f-2&&(e+=" ")}e.indexOf("NaN")===-1&&a.setAttributeNS(null,"points",e)},updateRectPrim:function(a,b,c,d,e){a.setAttributeNS(null,"x",b),a.setAttributeNS(null,"y",c),a.setAttributeNS(null,"width",d),a.setAttributeNS(null,"height",e)},setPropertyPrim:function(a,b,c){"stroked"!==b&&a.setAttributeNS(null,b,c)},display:function(a,b){var c;a&&a.rendNode&&(a.visPropOld.visible=b,c=a.rendNode,b?(c.setAttributeNS(null,"display","inline"),c.style.visibility="inherit"):(c.setAttributeNS(null,"display","none"),c.style.visibility="hidden"))},show:function(b){a.deprecated("Board.renderer.show()","Board.renderer.display()"),this.display(b,!0)},hide:function(b){a.deprecated("Board.renderer.hide()","Board.renderer.display()"),this.display(b,!1)},setBuffering:function(a,b){a.rendNode.setAttribute("buffered-rendering",b)},setDashStyle:function(a){var b=e.evaluate(a.visProp.dash),c=a.rendNode;b>0?c.setAttributeNS(null,"stroke-dasharray",this.dashArray[b-1]):c.hasAttributeNS(null,"stroke-dasharray")&&c.removeAttributeNS(null,"stroke-dasharray")},setGradient:function(a){var b,c,d,f,g,h,i,j,k,l=a.rendNode,m=e.evaluate(a.visProp.gradient);c=e.evaluate(a.visProp.fillopacity),c=c>0?c:0,b=e.evaluate(a.visProp.fillcolor),"linear"===m?(d=this.createPrim("linearGradient",a.id+"_gradient"),h="0%",i="100%",j="0%",k="0%",d.setAttributeNS(null,"x1",h),d.setAttributeNS(null,"x2",i),d.setAttributeNS(null,"y1",j),d.setAttributeNS(null,"y2",k),f=this.createPrim("stop",a.id+"_gradient1"),f.setAttributeNS(null,"offset","0%"),f.setAttributeNS(null,"style","stop-color:"+b+";stop-opacity:"+c),g=this.createPrim("stop",a.id+"_gradient2"),g.setAttributeNS(null,"offset","100%"),g.setAttributeNS(null,"style","stop-color:"+e.evaluate(a.visProp.gradientsecondcolor)+";stop-opacity:"+e.evaluate(a.visProp.gradientsecondopacity)),d.appendChild(f),d.appendChild(g),this.defs.appendChild(d),l.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+a.id+"_gradient)"),a.gradNode1=f,a.gradNode2=g):"radial"===m?(d=this.createPrim("radialGradient",a.id+"_gradient"),d.setAttributeNS(null,"cx","50%"),d.setAttributeNS(null,"cy","50%"),d.setAttributeNS(null,"r","50%"),d.setAttributeNS(null,"fx",100*e.evaluate(a.visProp.gradientpositionx)+"%"),d.setAttributeNS(null,"fy",100*e.evaluate(a.visProp.gradientpositiony)+"%"),f=this.createPrim("stop",a.id+"_gradient1"),f.setAttributeNS(null,"offset","0%"),f.setAttributeNS(null,"style","stop-color:"+e.evaluate(a.visProp.gradientsecondcolor)+";stop-opacity:"+e.evaluate(a.visProp.gradientsecondopacity)),g=this.createPrim("stop",a.id+"_gradient2"),g.setAttributeNS(null,"offset","100%"),g.setAttributeNS(null,"style","stop-color:"+b+";stop-opacity:"+c),d.appendChild(f),d.appendChild(g),this.defs.appendChild(d),l.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+a.id+"_gradient)"),a.gradNode1=f,a.gradNode2=g):l.removeAttributeNS(null,"style")},updateGradient:function(a){var b,c,d=a.gradNode1,f=a.gradNode2,g=e.evaluate(a.visProp.gradient);e.exists(d)&&e.exists(f)&&(c=e.evaluate(a.visProp.fillopacity),c=c>0?c:0,b=e.evaluate(a.visProp.fillcolor),"linear"===g?(d.setAttributeNS(null,"style","stop-color:"+b+";stop-opacity:"+c),f.setAttributeNS(null,"style","stop-color:"+e.evaluate(a.visProp.gradientsecondcolor)+";stop-opacity:"+e.evaluate(a.visProp.gradientsecondopacity))):"radial"===g&&(d.setAttributeNS(null,"style","stop-color:"+e.evaluate(a.visProp.gradientsecondcolor)+";stop-opacity:"+e.evaluate(a.visProp.gradientsecondopacity)),f.setAttributeNS(null,"style","stop-color:"+b+";stop-opacity:"+c)))},setObjectTransition:function(a,b){var c,f,g,h,i=["rendNode","rendNodeTriangleStart","rendNodeTriangleEnd"];if(void 0===b&&(b=e.evaluate(a.visProp.transitionduration)),b!==a.visPropOld.transitionduration){for(f=a.elementClass===d.OBJECT_CLASS_TEXT&&"html"===e.evaluate(a.visProp.display)?" color "+b+"ms, opacity "+b+"ms":" fill "+b+"ms, fill-opacity "+b+"ms, stroke "+b+"ms, stroke-opacity "+b+"ms",h=i.length,g=0;g<h;++g)a[i[g]]&&(c=a[i[g]],c.style.transition=f);a.visPropOld.transitionduration=b}},_setAttribute:function(a,b){""===b?a():setTimeout(a,1)},setObjectFillColor:function(b,c,d,f){var h,i,j,k,l=e.evaluate(c),m=e.evaluate(d);m=m>0?m:0,b.visPropOld.fillcolor===l&&b.visPropOld.fillopacity===m||(e.exists(l)&&l!==!1&&(9!==l.length?(i=l,k=m):(j=g.rgba2rgbo(l),i=j[0],k=m*j[1]),h=void 0===f?b.rendNode:f,"none"!==i&&this._setAttribute(function(){h.setAttributeNS(null,"fill",i)},b.visPropOld.fillcolor),b.type===a.OBJECT_TYPE_IMAGE?this._setAttribute(function(){h.setAttributeNS(null,"opacity",k)},b.visPropOld.fillopacity):("none"===i&&(k=0),this._setAttribute(function(){h.setAttributeNS(null,"fill-opacity",k)},b.visPropOld.fillopacity)),e.exists(b.visProp.gradient)&&this.updateGradient(b)),b.visPropOld.fillcolor=l,b.visPropOld.fillopacity=m)},setObjectStrokeColor:function(a,b,c){var f,h,i,j,k=e.evaluate(b),l=e.evaluate(c);l=l>0?l:0,a.visPropOld.strokecolor===k&&a.visPropOld.strokeopacity===l||(e.exists(k)&&k!==!1&&(9!==k.length?(f=k,i=l):(h=g.rgba2rgbo(k),f=h[0],i=l*h[1]),j=a.rendNode,a.elementClass===d.OBJECT_CLASS_TEXT?"html"===e.evaluate(a.visProp.display)?this._setAttribute(function(){j.style.color=f,j.style.opacity=i},a.visPropOld.strokecolor):this._setAttribute(function(){j.setAttributeNS(null,"style","fill:"+f),j.setAttributeNS(null,"style","fill-opacity:"+i)},a.visPropOld.strokecolor):this._setAttribute(function(){j.setAttributeNS(null,"stroke",f),j.setAttributeNS(null,"stroke-opacity",i)},a.visPropOld.strokecolor),a.elementClass!==d.OBJECT_CLASS_CURVE&&a.elementClass!==d.OBJECT_CLASS_LINE||(e.evaluate(a.visProp.firstarrow)&&this._setArrowColor(a.rendNodeTriangleStart,f,i,a),e.evaluate(a.visProp.lastarrow)&&this._setArrowColor(a.rendNodeTriangleEnd,f,i,a))),a.visPropOld.strokecolor=k,a.visPropOld.strokeopacity=l)},setObjectStrokeWidth:function(a,b){var c,d=e.evaluate(b);isNaN(d)||a.visPropOld.strokewidth===d||(c=a.rendNode,this.setPropertyPrim(c,"stroked","true"),e.exists(d)&&this.setPropertyPrim(c,"stroke-width",d+"px"),a.visPropOld.strokewidth=d)},setLineCap:function(a){var b=e.evaluate(a.visProp.linecap);void 0!==b&&""!==b&&a.visPropOld.linecap!==b&&e.exists(a.rendNode)&&(this.setPropertyPrim(a.rendNode,"stroke-linecap",b),a.visPropOld.linecap=b)},setShadow:function(a){var b=e.evaluate(a.visProp.shadow);a.visPropOld.shadow!==b&&(e.exists(a.rendNode)&&(b?a.rendNode.setAttributeNS(null,"filter","url(#"+this.container.id+"_f1)"):a.rendNode.removeAttributeNS(null,"filter")),a.visPropOld.shadow=b)},suspendRedraw:function(){},unsuspendRedraw:function(){},resize:function(a,b){this.svgRoot.style.width=parseFloat(a)+"px",this.svgRoot.style.height=parseFloat(b)+"px",this.svgRoot.setAttribute("width",parseFloat(a)),this.svgRoot.setAttribute("height",parseFloat(b))},createTouchpoints:function(a){var b,c,d,e;for(this.touchpoints=[],b=0;b<a;b++)c="touchpoint1_"+b,e=this.createPrim("path",c),this.appendChildPrim(e,19),e.setAttributeNS(null,"d","M 0 0"),this.touchpoints.push(e),this.setPropertyPrim(e,"stroked","true"),this.setPropertyPrim(e,"stroke-width","1px"),e.setAttributeNS(null,"stroke","#000000"),e.setAttributeNS(null,"stroke-opacity",1),e.setAttributeNS(null,"display","none"),d="touchpoint2_"+b,e=this.createPrim("ellipse",d),this.appendChildPrim(e,19),this.updateEllipsePrim(e,0,0,0,0),this.touchpoints.push(e),this.setPropertyPrim(e,"stroked","true"),this.setPropertyPrim(e,"stroke-width","1px"),e.setAttributeNS(null,"stroke","#000000"),e.setAttributeNS(null,"stroke-opacity",1),e.setAttributeNS(null,"fill","#ffffff"),e.setAttributeNS(null,"fill-opacity",0),e.setAttributeNS(null,"display","none")},showTouchpoint:function(a){this.touchpoints&&a>=0&&2*a<this.touchpoints.length&&(this.touchpoints[2*a].setAttributeNS(null,"display","inline"),this.touchpoints[2*a+1].setAttributeNS(null,"display","inline"))},hideTouchpoint:function(a){this.touchpoints&&a>=0&&2*a<this.touchpoints.length&&(this.touchpoints[2*a].setAttributeNS(null,"display","none"),this.touchpoints[2*a+1].setAttributeNS(null,"display","none"))},updateTouchpoint:function(a,b){var c,d,e=37;this.touchpoints&&a>=0&&2*a<this.touchpoints.length&&(c=b[0],d=b[1],this.touchpoints[2*a].setAttributeNS(null,"d","M "+(c-e)+" "+d+" L "+(c+e)+" "+d+" M "+c+" "+(d-e)+" L "+c+" "+(d+e)),this.updateEllipsePrim(this.touchpoints[2*a+1],b[0],b[1],25,25))},dumpToCanvas:function(a,b,c,d){var f,g,i,j,k,l,m,n,o=this.svgRoot,p=window.btoa||h.encode;if(this.container.hasChildNodes()&&e.exists(this.foreignObjLayer)){for(;o.nextSibling;)this.foreignObjLayer.appendChild(o.nextSibling);d===!0&&(n=this.container.ownerDocument,m=n.createElement("div"),m.appendChild(this.foreignObjLayer))}if(o.setAttribute("xmlns","http://www.w3.org/2000/svg"),k=o.getAttribute("width"),l=o.getAttribute("height"),f=(new XMLSerializer).serializeToString(o),(f.match(/xmlns=\"http:\/\/www.w3.org\/2000\/svg\"/g)||[]).length>1&&(f=f.replace(/xmlns=\"http:\/\/www.w3.org\/2000\/svg\"/g,"")),f=f.replace(/&nbsp;/g," "),i=document.getElementById(a),i.width=i.width,j=i.getContext("2d"),void 0!==b&&void 0!==c&&(i.style.width=parseFloat(b)+"px",i.style.height=parseFloat(c)+"px",i.setAttribute("width",2*parseFloat(k)),i.setAttribute("height",2*parseFloat(l)),j.scale(2*k/b,2*l/c)),g=new Image,g.src="data:image/svg+xml;base64,"+p(unescape(encodeURIComponent(f))),g.onload=function(){setTimeout(function(){j.drawImage(g,0,0,b,c)},200)},e.exists(this.foreignObjLayer)&&this.foreignObjLayer.hasChildNodes())for(d===!0&&o.appendChild(this.foreignObjLayer);this.foreignObjLayer.firstChild;)this.container.appendChild(this.foreignObjLayer.firstChild);return this},screenshot:function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p=this.container.ownerDocument,q=this.container.parentNode,r=a.attr.screenshot,s=!1,t=!1;return"no"===this.type?this:(l=r.scale*parseFloat(this.container.style.width),m=r.scale*parseFloat(this.container.style.height),void 0===b||""===b?(s=!0,i=new Image,i.style.width=l+"px",i.style.height=m+"px"):(s=!1,i=p.getElementById(b)),s&&(d=p.createElement("div"),d.style.cssText=r.css,d.style.width=l+"px",d.style.height=m+"px",d.style.zIndex=this.container.style.zIndex+120,f=a.getCoordsTopLeftCorner(),d.style.position="absolute",d.style.left=f[0]+"px",d.style.top=f[1]+"px"),t?(h="jxgbox_canvas",g=document.getElementById(h)):(g=p.createElement("canvas"),h=Math.random().toString(36).substr(2,5),g.setAttribute("id",h),g.setAttribute("width",l),g.setAttribute("height",m),g.style.width=l+"px",g.style.height=l+"px",g.style.display="none",q.append(g)),s&&(j=p.createElement("span"),k=p.createTextNode("✖"),j.style.cssText=r.cssButton,j.appendChild(k),j.onclick=function(){d.parentNode.removeChild(d);
},d.appendChild(i),d.appendChild(j),q.appendChild(d)),n=document.getElementById(this.container.id+"_navigationbar"),e.exists(n)&&(o=n.style.display,n.style.display="none"),this.dumpToCanvas(h,l,m,c),setTimeout(function(){i.src=g.toDataURL("image/png"),t||q.removeChild(g)},400),e.exists(n)&&(n.style.display=o),this)}}),a.SVGRenderer}),define("renderer/vml",["jxg","renderer/abstract","base/constants","utils/type","utils/color","math/math","math/numerics"],function(a,b,c,d,e,f,g){"use strict";return a.VMLRenderer=function(b){this.type="vml",this.container=b,this.container.style.overflow="hidden",""===this.container.style.position&&(this.container.style.position="relative"),this.container.onselectstart=function(){return!1},this.resolution=10,d.exists(a.vmlStylesheet)||(b.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),a.vmlStylesheet=this.container.ownerDocument.createStyleSheet(),a.vmlStylesheet.addRule(".jxgvml","behavior:url(#default#VML)"));try{b.ownerDocument.namespaces.jxgvml||b.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),this.createNode=function(a){return b.ownerDocument.createElement("<jxgvml:"+a+' class="jxgvml">')}}catch(c){this.createNode=function(a){return b.ownerDocument.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="jxgvml">')}}this.dashArray=["Solid","1 1","ShortDash","Dash","LongDash","ShortDashDot","LongDashDot"]},a.VMLRenderer.prototype=new b,a.extend(a.VMLRenderer.prototype,{_setAttr:function(b,c,d,e){try{8===this.container.ownerDocument.documentMode?b[c]=d:b.setAttribute(c,d,e)}catch(f){a.debug("_setAttr: "+c+" "+d+"<br>\n")}},updateTicks:function(a){var b,c,e,f,g,h=this.resolution,i=[];for(c=a.ticks.length,b=0;b<c;b++)e=a.ticks[b],f=e[0],g=e[1],d.isNumber(f[0])&&d.isNumber(f[1])&&i.push(" m "+Math.round(h*f[0])+", "+Math.round(h*g[0])+" l "+Math.round(h*f[1])+", "+Math.round(h*g[1])+" ");d.exists(a.rendNode)||(a.rendNode=this.createPrim("path",a.id),this.appendChildPrim(a.rendNode,d.evaluate(a.visProp.layer))),this._setAttr(a.rendNode,"stroked","true"),this._setAttr(a.rendNode,"strokecolor",d.evaluate(a.visProp.strokecolor),1),this._setAttr(a.rendNode,"strokeweight",d.evaluate(a.visProp.strokewidth)),this._setAttr(a.rendNodeStroke,"opacity",100*d.evaluate(a.visProp.strokeopacity)+"%"),this.updatePathPrim(a.rendNode,i,a.board)},displayCopyright:function(a,b){var c,d;c=this.createNode("textbox"),c.style.position="absolute",this._setAttr(c,"id",this.container.id+"_licenseText"),c.style.left=20,c.style.top=2,c.style.fontSize=b,c.style.color="#356AA0",c.style.fontFamily="Arial,Helvetica,sans-serif",this._setAttr(c,"opacity","30%"),c.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 30, enabled = true)",d=this.container.ownerDocument.createTextNode(a),c.appendChild(d),this.appendChildPrim(c,0)},drawInternalText:function(a){var b;return b=this.createNode("textbox"),b.style.position="absolute",a.rendNodeText=this.container.ownerDocument.createTextNode(""),b.appendChild(a.rendNodeText),this.appendChildPrim(b,9),b.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",b},updateInternalText:function(a){var b,c,d,e,g,h,i=a.plaintext,j=this.joinTransforms(a,a.transformations),k=[0,0],l=a.rendNode,m=[],n=a.getAnchorX(),o=a.getAnchorY();if(!isNaN(a.coords.scrCoords[1]+a.coords.scrCoords[2])){for("right"===n?k[0]=1:"middle"===n&&(k[0]=.5),"bottom"===o?k[1]=1:"middle"===o&&(k[1]=.5),m[0]=f.matVecMult(j,[1,a.coords.scrCoords[1]-k[0]*a.size[0],a.coords.scrCoords[2]+(1-k[1])*a.size[1]+this.vOffsetText]),m[0][1]/=m[0][0],m[0][2]/=m[0][0],m[1]=f.matVecMult(j,[1,a.coords.scrCoords[1]+(1-k[0])*a.size[0],a.coords.scrCoords[2]+(1-k[1])*a.size[1]+this.vOffsetText]),m[1][1]/=m[1][0],m[1][2]/=m[1][0],m[2]=f.matVecMult(j,[1,a.coords.scrCoords[1]+(1-k[0])*a.size[0],a.coords.scrCoords[2]-k[1]*a.size[1]+this.vOffsetText]),m[2][1]/=m[2][0],m[2][2]/=m[2][0],m[3]=f.matVecMult(j,[1,a.coords.scrCoords[1]-k[0]*a.size[0],a.coords.scrCoords[2]-k[1]*a.size[1]+this.vOffsetText]),m[3][1]/=m[3][0],m[3][2]/=m[3][0],c=m[0][1],e=m[0][1],d=m[0][2],g=m[0][2],h=1;h<4;h++)c=Math.max(c,m[h][1]),e=Math.min(e,m[h][1]),d=Math.max(d,m[h][2]),g=Math.min(g,m[h][2]);b=1===k[0]?Math.floor(a.board.canvasWidth-c):Math.floor(e),a.visPropOld.left!==n+b&&(1===k[0]?(a.rendNode.style.right=b+"px",a.rendNode.style.left="auto"):(a.rendNode.style.left=b+"px",a.rendNode.style.right="auto"),a.visPropOld.left=n+b),b=1===k[1]?Math.floor(a.board.canvasHeight-d):Math.floor(g),a.visPropOld.top!==o+b&&(1===k[1]?(a.rendNode.style.bottom=b+"px",a.rendNode.style.top="auto"):(a.rendNode.style.top=b+"px",a.rendNode.style.bottom="auto"),a.visPropOld.top=o+b)}a.htmlStr!==i&&(a.rendNodeText.data=i,a.htmlStr=i),l.filters.item(0).M11=j[1][1],l.filters.item(0).M12=j[1][2],l.filters.item(0).M21=j[2][1],l.filters.item(0).M22=j[2][2],l.filters.item(0).enabled=!0},drawImage:function(a){var b;b=this.container.ownerDocument.createElement("img"),b.style.position="absolute",this._setAttr(b,"id",this.container.id+"_"+a.id),this.container.appendChild(b),this.appendChildPrim(b,d.evaluate(a.visProp.layer)),b.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand') progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",a.rendNode=b,this.updateImage(a)},transformImage:function(a,b){var c,d,e,g,h,i,j=a.rendNode,k=[],l=b.length;if(l>0){for(c=this.joinTransforms(a,b),k[0]=f.matVecMult(c,a.coords.scrCoords),k[0][1]/=k[0][0],k[0][2]/=k[0][0],k[1]=f.matVecMult(c,[1,a.coords.scrCoords[1]+a.size[0],a.coords.scrCoords[2]]),k[1][1]/=k[1][0],k[1][2]/=k[1][0],k[2]=f.matVecMult(c,[1,a.coords.scrCoords[1]+a.size[0],a.coords.scrCoords[2]-a.size[1]]),k[2][1]/=k[2][0],k[2][2]/=k[2][0],k[3]=f.matVecMult(c,[1,a.coords.scrCoords[1],a.coords.scrCoords[2]-a.size[1]]),k[3][1]/=k[3][0],k[3][2]/=k[3][0],d=k[0][1],g=k[0][1],e=k[0][2],h=k[0][2],i=1;i<4;i++)d=Math.max(d,k[i][1]),g=Math.min(g,k[i][1]),e=Math.max(e,k[i][2]),h=Math.min(h,k[i][2]);j.style.left=Math.floor(g)+"px",j.style.top=Math.floor(h)+"px",j.filters.item(0).M11=c[1][1],j.filters.item(0).M12=c[1][2],j.filters.item(0).M21=c[2][1],j.filters.item(0).M22=c[2][2],j.filters.item(0).enabled=!0}},updateImageURL:function(a){var b=d.evaluate(a.url);this._setAttr(a.rendNode,"src",b)},appendChildPrim:function(a,b){return d.exists(b)||(b=0),a.style.zIndex=b,this.container.appendChild(a),a},appendNodesToElement:function(a,b){"shape"!==b&&"path"!==b&&"polygon"!==b||(a.rendNodePath=this.getElementById(a.id+"_path")),a.rendNodeFill=this.getElementById(a.id+"_fill"),a.rendNodeStroke=this.getElementById(a.id+"_stroke"),a.rendNodeShadow=this.getElementById(a.id+"_shadow"),a.rendNode=this.getElementById(a.id)},createPrim:function(a,b){var c,d,e=this.createNode("fill"),f=this.createNode("stroke"),g=this.createNode("shadow");return this._setAttr(e,"id",this.container.id+"_"+b+"_fill"),this._setAttr(f,"id",this.container.id+"_"+b+"_stroke"),this._setAttr(g,"id",this.container.id+"_"+b+"_shadow"),"circle"===a||"ellipse"===a?(c=this.createNode("oval"),c.appendChild(e),c.appendChild(f),c.appendChild(g)):"polygon"===a||"path"===a||"shape"===a||"line"===a?(c=this.createNode("shape"),c.appendChild(e),c.appendChild(f),c.appendChild(g),d=this.createNode("path"),this._setAttr(d,"id",this.container.id+"_"+b+"_path"),c.appendChild(d)):(c=this.createNode(a),c.appendChild(e),c.appendChild(f),c.appendChild(g)),c.style.position="absolute",c.style.left="0px",c.style.top="0px",this._setAttr(c,"id",this.container.id+"_"+b),c},remove:function(a){d.exists(a)&&a.removeNode(!0)},makeArrows:function(a){var b,c=d.evaluate(a.visProp.firstarrow),e=d.evaluate(a.visProp.lastarrow);a.visPropOld.firstarrow===c&&a.visPropOld.lastarrow===e||(c?(b=a.rendNodeStroke,this._setAttr(b,"startarrow","block"),this._setAttr(b,"startarrowlength","long")):(b=a.rendNodeStroke,d.exists(b)&&this._setAttr(b,"startarrow","none")),e?(b=a.rendNodeStroke,this._setAttr(b,"id",this.container.id+"_"+a.id+"stroke"),this._setAttr(b,"endarrow","block"),this._setAttr(b,"endarrowlength","long")):(b=a.rendNodeStroke,d.exists(b)&&this._setAttr(b,"endarrow","none")),a.visPropOld.firstarrow=c,a.visPropOld.lastarrow=e)},updateEllipsePrim:function(a,b,c,d,e){a.style.left=Math.floor(b-d)+"px",a.style.top=Math.floor(c-e)+"px",a.style.width=Math.floor(2*Math.abs(d))+"px",a.style.height=Math.floor(2*Math.abs(e))+"px"},updateLinePrim:function(a,b,c,d,e,f){var g,h=this.resolution;isNaN(b+c+d+e)||(g=["m ",Math.floor(h*b),", ",Math.floor(h*c)," l ",Math.floor(h*d),", ",Math.floor(h*e)],this.updatePathPrim(a,g,f))},updatePathPrim:function(a,b,c){var d=c.canvasWidth,e=c.canvasHeight;b.length<=0&&(b=["m 0,0"]),a.style.width=d,a.style.height=e,this._setAttr(a,"coordsize",[Math.floor(this.resolution*d),Math.floor(this.resolution*e)].join(",")),this._setAttr(a,"path",b.join(""))},updatePathStringPoint:function(a,b,c){var d=[],e=Math.round,f=a.coords.scrCoords,g=b*Math.sqrt(3)*.5,h=.5*b,i=this.resolution;return"x"===c?d.push([" m ",e(i*(f[1]-b)),", ",e(i*(f[2]-b))," l ",e(i*(f[1]+b)),", ",e(i*(f[2]+b))," m ",e(i*(f[1]+b)),", ",e(i*(f[2]-b))," l ",e(i*(f[1]-b)),", ",e(i*(f[2]+b))].join("")):"+"===c?d.push([" m ",e(i*(f[1]-b)),", ",e(i*f[2])," l ",e(i*(f[1]+b)),", ",e(i*f[2])," m ",e(i*f[1]),", ",e(i*(f[2]-b))," l ",e(i*f[1]),", ",e(i*(f[2]+b))].join("")):"<>"===c?d.push([" m ",e(i*(f[1]-b)),", ",e(i*f[2])," l ",e(i*f[1]),", ",e(i*(f[2]+b))," l ",e(i*(f[1]+b)),", ",e(i*f[2])," l ",e(i*f[1]),", ",e(i*(f[2]-b))," x e "].join("")):"^"===c?d.push([" m ",e(i*f[1]),", ",e(i*(f[2]-b))," l ",e(i*(f[1]-g)),", ",e(i*(f[2]+h))," l ",e(i*(f[1]+g)),", ",e(i*(f[2]+h))," x e "].join("")):"v"===c?d.push([" m ",e(i*f[1]),", ",e(i*(f[2]+b))," l ",e(i*(f[1]-g)),", ",e(i*(f[2]-h))," l ",e(i*(f[1]+g)),", ",e(i*(f[2]-h))," x e "].join("")):">"===c?d.push([" m ",e(i*(f[1]+b)),", ",e(i*f[2])," l ",e(i*(f[1]-h)),", ",e(i*(f[2]-g))," l ",e(i*(f[1]-h)),", ",e(i*(f[2]+g))," l ",e(i*(f[1]+b)),", ",e(i*f[2])].join("")):"<"===c&&d.push([" m ",e(i*(f[1]-b)),", ",e(i*f[2])," l ",e(i*(f[1]+h)),", ",e(i*(f[2]-g))," l ",e(i*(f[1]+h)),", ",e(i*(f[2]+g))," x e "].join("")),d},updatePathStringPrim:function(a){var b,c,d=[],e=this.resolution,f=Math.round,g=" m ",h=" l ",i=" c ",j=g,k=Math.min(a.numberPoints,8192);if(a.numberPoints<=0)return"";if(k=Math.min(k,a.points.length),1===a.bezierDegree)for(b=0;b<k;b++)c=a.points[b].scrCoords,isNaN(c[1])||isNaN(c[2])?j=g:(c[1]>2e4?c[1]=2e4:c[1]<-2e4&&(c[1]=-2e4),c[2]>2e4?c[2]=2e4:c[2]<-2e4&&(c[2]=-2e4),d.push([j,f(e*c[1]),", ",f(e*c[2])].join("")),j=h);else if(3===a.bezierDegree)for(b=0;b<k;)c=a.points[b].scrCoords,isNaN(c[1])||isNaN(c[2])?j=g:(d.push([j,f(e*c[1]),", ",f(e*c[2])].join("")),j===i&&(b+=1,c=a.points[b].scrCoords,d.push([" ",f(e*c[1]),", ",f(e*c[2])].join("")),b+=1,c=a.points[b].scrCoords,d.push([" ",f(e*c[1]),", ",f(e*c[2])].join(""))),j=i),b+=1;return d.push(" e"),d},updatePathStringBezierPrim:function(a){var b,c,e,f,h,i,j=[],k=d.evaluate(a.visProp.strokewidth),l=this.resolution,m=Math.round,n=" m ",o=" c ",p=n,q="plot"!==d.evaluate(a.visProp.curvetype),r=Math.min(a.numberPoints,8192);if(a.numberPoints<=0)return"";for(q&&a.board.options.curve.RDPsmoothing&&(a.points=g.RamerDouglasPeucker(a.points,1)),r=Math.min(r,a.points.length),c=1;c<3;c++)for(p=n,b=0;b<r;b++)f=a.points[b].scrCoords,isNaN(f[1])||isNaN(f[2])?p=n:(f[1]>2e4?f[1]=2e4:f[1]<-2e4&&(f[1]=-2e4),f[2]>2e4?f[2]=2e4:f[2]<-2e4&&(f[2]=-2e4),p===n?j.push([p,m(l*f[1])," ",m(l*f[2])].join("")):(e=2*c,j.push([p,m(l*(h+.333*(f[1]-h)+k*(e*Math.random()-c)))," ",m(l*(i+.333*(f[2]-i)+k*(e*Math.random()-c)))," ",m(l*(h+.666*(f[1]-h)+k*(e*Math.random()-c)))," ",m(l*(i+.666*(f[2]-i)+k*(e*Math.random()-c)))," ",m(l*f[1])," ",m(l*f[2])].join(""))),p=o,h=f[1],i=f[2]);return j.push(" e"),j},updatePolygonPrim:function(a,b){var c,d,e=b.vertices.length,f=this.resolution,g=[];if(this._setAttr(a,"stroked","false"),d=b.vertices[0].coords.scrCoords,!isNaN(d[1]+d[2])){for(g.push(["m ",Math.floor(f*d[1]),",",Math.floor(f*d[2])," l "].join("")),c=1;c<e-1;c++){if(!b.vertices[c].isReal)return void this.updatePathPrim(a,"",b.board);if(d=b.vertices[c].coords.scrCoords,isNaN(d[1]+d[2]))return;g.push(Math.floor(f*d[1])+","+Math.floor(f*d[2])),c<e-2&&g.push(", ")}g.push(" x e"),this.updatePathPrim(a,g,b.board)}},updateRectPrim:function(a,b,c,d,e){a.style.left=Math.floor(b)+"px",a.style.top=Math.floor(c)+"px",d>=0&&(a.style.width=d+"px"),e>=0&&(a.style.height=e+"px")},setPropertyPrim:function(a,b,c){var e,f="";switch(b){case"stroke":f="strokecolor";break;case"stroke-width":f="strokeweight";break;case"stroke-dasharray":f="dashstyle"}""!==f&&(e=d.evaluate(c),this._setAttr(a,f,e))},display:function(a,b){a&&a.rendNode&&(a.visPropOld.visible=b,b?a.rendNode.style.visibility="inherit":a.rendNode.style.visibility="hidden")},show:function(b){a.deprecated("Board.renderer.show()","Board.renderer.display()"),b&&b.rendNode&&(b.rendNode.style.visibility="inherit")},hide:function(b){a.deprecated("Board.renderer.hide()","Board.renderer.display()"),b&&b.rendNode&&(b.rendNode.style.visibility="hidden")},setDashStyle:function(a,b){var c;b.dash>=0&&(c=a.rendNodeStroke,this._setAttr(c,"dashstyle",this.dashArray[b.dash]))},setGradient:function(a){var b=a.rendNodeFill,c=d.evaluate(a.visProp.gradient);"linear"===c?(this._setAttr(b,"type","gradient"),this._setAttr(b,"color2",d.evaluate(a.visProp.gradientsecondcolor)),this._setAttr(b,"opacity2",d.evaluate(a.visProp.gradientsecondopacity)),this._setAttr(b,"angle",d.evaluate(a.visProp.gradientangle))):"radial"===c?(this._setAttr(b,"type","gradientradial"),this._setAttr(b,"color2",d.evaluate(a.visProp.gradientsecondcolor)),this._setAttr(b,"opacity2",d.evaluate(a.visProp.gradientsecondopacity)),this._setAttr(b,"focusposition",100*d.evaluate(a.visProp.gradientpositionx)+"%,"+100*d.evaluate(a.visProp.gradientpositiony)+"%"),this._setAttr(b,"focussize","0,0")):this._setAttr(b,"type","solid")},setObjectFillColor:function(a,b,f){var g,h,i,j=d.evaluate(b),k=d.evaluate(f),l=a.rendNode;k=k>0?k:0,a.visPropOld.fillcolor===j&&a.visPropOld.fillopacity===k||(d.exists(j)&&j!==!1&&(9!==j.length?(g=j,i=k):(h=e.rgba2rgbo(j),g=h[0],i=k*h[1]),"none"===g||g===!1?this._setAttr(a.rendNode,"filled","false"):(this._setAttr(a.rendNode,"filled","true"),this._setAttr(a.rendNode,"fillcolor",g),d.exists(i)&&a.rendNodeFill&&this._setAttr(a.rendNodeFill,"opacity",100*i+"%")),a.type===c.OBJECT_TYPE_IMAGE&&l.filters.length>1&&(l.filters.item(1).opacity=Math.round(100*i),l.filters.item(1).enabled=!0)),a.visPropOld.fillcolor=j,a.visPropOld.fillopacity=k)},setObjectStrokeColor:function(a,b,e){var f,g,h,i,j=d.evaluate(b),k=d.evaluate(e),l=a.rendNode;k=k>0?k:0,a.visPropOld.strokecolor===j&&a.visPropOld.strokeopacity===k||(d.exists(j)&&j!==!1&&(9!==j.length?(f=j,h=k):(g=b.rgba2rgbo(j),f=g[0],h=k*g[1]),a.elementClass===c.OBJECT_CLASS_TEXT?(l.filters.length>1&&(l.filters.item(1).opacity=Math.round(100*h),l.filters.item(1).enabled=!0),l.style.color=f):(f!==!1&&(this._setAttr(l,"stroked","true"),this._setAttr(l,"strokecolor",f)),i=a.rendNodeStroke,d.exists(h)&&a.type!==c.OBJECT_TYPE_IMAGE&&this._setAttr(i,"opacity",100*h+"%"))),a.visPropOld.strokecolor=j,a.visPropOld.strokeopacity=k)},setObjectStrokeWidth:function(a,b){var c,e=d.evaluate(b);isNaN(e)||a.visPropOld.strokewidth===e||(c=a.rendNode,this.setPropertyPrim(c,"stroked","true"),d.exists(e)&&(this.setPropertyPrim(c,"stroke-width",e),0===e&&d.exists(a.rendNodeStroke)&&this._setAttr(c,"stroked","false")),a.visPropOld.strokewidth=e)},setShadow:function(a){var b=a.rendNodeShadow,c=d.evaluate(a.visProp.shadow);b&&a.visPropOld.shadow!==c&&(c?(this._setAttr(b,"On","True"),this._setAttr(b,"Offset","3pt,3pt"),this._setAttr(b,"Opacity","60%"),this._setAttr(b,"Color","#aaaaaa")):this._setAttr(b,"On","False"),a.visPropOld.shadow=c)},suspendRedraw:function(){this.container.style.display="none"},unsuspendRedraw:function(){this.container.style.display=""}}),a.VMLRenderer}),define("renderer/canvas",["jxg","renderer/abstract","base/constants","utils/env","utils/type","utils/uuid","utils/color","base/coords","math/math","math/geometry","math/numerics"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";return a.CanvasRenderer=function(a,b){this.type="canvas",this.canvasRoot=null,this.suspendHandle=null,this.canvasId=f.genUUID(),this.canvasNamespace=null,d.isBrowser?(this.container=a,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",""===this.container.style.position&&(this.container.style.position="relative"),this.container.innerHTML=['<canvas id="',this.canvasId,'" width="',b.width,'px" height="',b.height,'px"><',"/canvas>"].join(""),this.canvasRoot=this.container.ownerDocument.getElementById(this.canvasId),this.context=this.canvasRoot.getContext("2d")):d.isNode()&&(this.canvasId="object"==typeof module?module.require("canvas"):require("canvas"),this.canvasRoot=new this.canvasId(500,500),this.context=this.canvasRoot.getContext("2d")),this.dashArray=[[2,2],[5,5],[10,10],[20,20],[20,10,10,10],[20,5,10,5]]},a.CanvasRenderer.prototype=new b,a.extend(a.CanvasRenderer.prototype,{_drawFilledPolygon:function(a){var b,c=a.length,d=this.context;if(c>0){for(d.beginPath(),d.moveTo(a[0][0],a[0][1]),b=0;b<c;b++)b>0&&d.lineTo(a[b][0],a[b][1]);d.lineTo(a[0][0],a[0][1]),d.fill()}},_fill:function(a){var b=this.context;b.save(),this._setColor(a,"fill")&&b.fill(),b.restore()},_rotatePoint:function(a,b,c){return[b*Math.cos(a)-c*Math.sin(a),b*Math.sin(a)+c*Math.cos(a)]},_rotateShape:function(a,b){var c,d=[],e=a.length;if(e<=0)return a;for(c=0;c<e;c++)d.push(this._rotatePoint(b,a[c][0],a[c][1]));return d},_setColor:function(a,b,c){var d,f,h,i,j,k,l,m=!0,n=!1,o=a.visProp;return b=b||"stroke",c=c||b,e.exists(a.board)&&e.exists(a.board.highlightedObjects)||(n=!0),d=!n&&e.exists(a.board.highlightedObjects[a.id])?"highlight":"",h=e.evaluate(o[d+b+"color"]),"none"!==h&&h!==!1?(k=e.evaluate(o[d+b+"opacity"]),k=k>0?k:0,9!==h.length?(j=h,l=k):(i=g.rgba2rgbo(h),j=i[0],l=k*i[1]),this.context.globalAlpha=l,this.context[c+"Style"]=j):m=!1,f=parseFloat(e.evaluate(o.strokewidth)),"stroke"!==b||isNaN(f)||(0===f?this.context.globalAlpha=0:this.context.lineWidth=f),"stroke"===b&&void 0!==o.linecap&&""!==o.linecap&&(this.context.lineCap=o.linecap),m},_stroke:function(a){var b=this.context,c=e.evaluate(a.visProp.dash);b.save(),c>0?b.setLineDash&&b.setLineDash(this.dashArray[c]):this.context.lineDashArray=[],this._setColor(a,"stroke")&&b.stroke(),b.restore()},_translateShape:function(a,b,c){var d,e=[],f=a.length;if(f<=0)return a;for(d=0;d<f;d++)e.push([a[d][0]+b,a[d][1]+c]);return e},drawPoint:function(a){var b=e.evaluate(a.visProp.face),c=e.evaluate(a.visProp.size),d=a.coords.scrCoords,f=c*Math.sqrt(3)*.5,g=.5*c,h=parseFloat(e.evaluate(a.visProp.strokewidth))/2,i=this.context;if(a.visPropCalc.visible)switch(b){case"cross":case"x":i.beginPath(),i.moveTo(d[1]-c,d[2]-c),i.lineTo(d[1]+c,d[2]+c),i.moveTo(d[1]+c,d[2]-c),i.lineTo(d[1]-c,d[2]+c),i.lineCap="round",i.lineJoin="round",i.closePath(),this._stroke(a);break;case"circle":case"o":i.beginPath(),i.arc(d[1],d[2],c+1+h,0,2*Math.PI,!1),i.closePath(),this._fill(a),this._stroke(a);break;case"square":case"[]":if(c<=0)break;i.save(),this._setColor(a,"stroke","fill")&&i.fillRect(d[1]-c-h,d[2]-c-h,2*c+3*h,2*c+3*h),i.restore(),i.save(),this._setColor(a,"fill"),i.fillRect(d[1]-c+h,d[2]-c+h,2*c-h,2*c-h),i.restore();break;case"plus":case"+":i.beginPath(),i.moveTo(d[1]-c,d[2]),i.lineTo(d[1]+c,d[2]),i.moveTo(d[1],d[2]-c),i.lineTo(d[1],d[2]+c),i.lineCap="round",i.lineJoin="round",i.closePath(),this._stroke(a);break;case"diamond":case"<>":i.beginPath(),i.moveTo(d[1]-c,d[2]),i.lineTo(d[1],d[2]+c),i.lineTo(d[1]+c,d[2]),i.lineTo(d[1],d[2]-c),i.closePath(),this._fill(a),this._stroke(a);break;case"triangleup":case"a":case"^":i.beginPath(),i.moveTo(d[1],d[2]-c),i.lineTo(d[1]-f,d[2]+g),i.lineTo(d[1]+f,d[2]+g),i.closePath(),this._fill(a),this._stroke(a);break;case"triangledown":case"v":i.beginPath(),i.moveTo(d[1],d[2]+c),i.lineTo(d[1]-f,d[2]-g),i.lineTo(d[1]+f,d[2]-g),i.closePath(),this._fill(a),this._stroke(a);break;case"triangleleft":case"<":i.beginPath(),i.moveTo(d[1]-c,d[2]),i.lineTo(d[1]+g,d[2]-f),i.lineTo(d[1]+g,d[2]+f),i.closePath(),this.fill(a),this._stroke(a);break;case"triangleright":case">":i.beginPath(),i.moveTo(d[1]+c,d[2]),i.lineTo(d[1]-g,d[2]-f),i.lineTo(d[1]-g,d[2]+f),i.closePath(),this._fill(a),this._stroke(a)}},updatePoint:function(a){this.drawPoint(a)},drawLine:function(a){var b,d=new h(c.COORDS_BY_USER,a.point1.coords.usrCoords,a.board),f=new h(c.COORDS_BY_USER,a.point2.coords.usrCoords,a.board),g=null,i=e.evaluate(a.visProp.firstarrow),k=e.evaluate(a.visProp.lastarrow);a.visPropCalc.visible&&((i||k)&&(g=-4),j.calcStraight(a,d,f,g),b=this.getPositionArrowHead(a,d,f),this.context.beginPath(),this.context.moveTo(b.c1.scrCoords[1]+b.d1x,b.c1.scrCoords[2]+b.d1y),this.context.lineTo(b.c2.scrCoords[1]-b.d2x,b.c2.scrCoords[2]-b.d2y),this._stroke(a),(i&&b.sFirst>0||k&&b.sLast>0)&&this.makeArrows(a,b.c1,b.c2))},updateLine:function(a){this.drawLine(a)},drawTicks:function(){},updateTicks:function(a){var b,c,d,e,f=a.ticks.length,g=this.context;for(g.beginPath(),b=0;b<f;b++)c=a.ticks[b],d=c[0],e=c[1],g.moveTo(d[0],e[0]),g.lineTo(d[1],e[1]);for(b=0;b<f;b++)c=a.ticks[b].scrCoords,a.ticks[b].major&&(a.board.needsFullUpdate||a.needsRegularUpdate)&&a.labels[b]&&a.labels[b].visPropCalc.visible&&this.updateText(a.labels[b]);g.lineCap="round",this._stroke(a)},drawCurve:function(a){e.evaluate(a.visProp.handdrawing)?this.updatePathStringBezierPrim(a):this.updatePathStringPrim(a),a.numberPoints>1&&this.makeArrows(a)},updateCurve:function(a){this.drawCurve(a)},drawEllipse:function(a){var b=a.center.coords.scrCoords[1],c=a.center.coords.scrCoords[2],d=a.board.unitX,e=a.board.unitY,f=2*a.Radius(),g=2*a.Radius(),h=f*d,i=g*e,j=b-h/2,k=c-i/2,l=h/2*.5522848,m=i/2*.5522848,n=j+h,o=k+i,p=j+h/2,q=k+i/2,r=this.context;f>0&&g>0&&!isNaN(b+c)&&(r.beginPath(),r.moveTo(j,q),r.bezierCurveTo(j,q-m,p-l,k,p,k),r.bezierCurveTo(p+l,k,n,q-m,n,q),r.bezierCurveTo(n,q+m,p+l,o,p,o),r.bezierCurveTo(p-l,o,j,q+m,j,q),r.closePath(),this._fill(a),this._stroke(a))},updateEllipse:function(a){return this.drawEllipse(a)},displayCopyright:function(a,b){var c=this.context;c.save(),c.font=b+"px Arial",c.fillStyle="#aaa",c.lineWidth=.5,c.fillText(a,10,2+b),c.restore()},drawInternalText:function(a){var b=e.evaluate(a.visProp.fontsize),c=a.getAnchorX(),d=a.getAnchorY(),f=this.context;return f.save(),this._setColor(a,"stroke","fill")&&!isNaN(a.coords.scrCoords[1]+a.coords.scrCoords[2])&&(f.font=(b>0?b:0)+"px Arial",this.transformImage(a,a.transformations),"left"===c?f.textAlign="left":"right"===c?f.textAlign="right":"middle"===c&&(f.textAlign="center"),"bottom"===d?f.textBaseline="bottom":"top"===d?f.textBaseline="top":"middle"===d&&(f.textBaseline="middle"),f.fillText(a.plaintext,a.coords.scrCoords[1],a.coords.scrCoords[2])),f.restore(),null},updateInternalText:function(a){this.drawInternalText(a)},setObjectStrokeColor:function(a,b,d){var f,h,i,j,k=e.evaluate(b),l=e.evaluate(d);l=l>0?l:0,a.visPropOld.strokecolor===k&&a.visPropOld.strokeopacity===l||(e.exists(k)&&k!==!1&&(9!==k.length?(f=k,i=l):(h=g.rgba2rgbo(k),f=h[0],i=l*h[1]),j=a.rendNode,a.elementClass===c.OBJECT_CLASS_TEXT&&"html"===e.evaluate(a.visProp.display)&&(j.style.color=f,j.style.opacity=i)),a.visPropOld.strokecolor=k,a.visPropOld.strokeopacity=l)},drawImage:function(a){a.rendNode=new Image,a._src="",this.updateImage(a)},updateImage:function(a){var b=this.context,c=e.evaluate(a.visProp.fillopacity),d=e.bind(function(){a.imgIsLoaded=!0,a.size[0]<=0||a.size[1]<=0||(b.save(),b.globalAlpha=c,this.transformImage(a,a.transformations),b.drawImage(a.rendNode,a.coords.scrCoords[1],a.coords.scrCoords[2]-a.size[1],a.size[0],a.size[1]),b.restore())},this);this.updateImageURL(a)?a.rendNode.onload=d:a.imgIsLoaded&&d()},transformImage:function(a,b){var c,d=b.length,e=this.context;d>0&&(c=this.joinTransforms(a,b),Math.abs(k.det(c))>=i.eps&&e.transform(c[1][1],c[2][1],c[1][2],c[2][2],c[1][0],c[2][0]))},updateImageURL:function(a){var b;return b=e.evaluate(a.url),a._src!==b&&(a.imgIsLoaded=!1,a.rendNode.src=b,a._src=b,!0)},remove:function(a){e.exists(a)&&e.exists(a.parentNode)&&a.parentNode.removeChild(a)},makeArrows:function(a,b,d){var f,g,h,i,j,k,l,m,n,o=e.evaluate(a.visProp.strokewidth),p=this.context,q=e.evaluate(a.visProp.firstarrow),r=e.evaluate(a.visProp.lastarrow);if("none"!==e.evaluate(a.visProp.strokecolor)&&(q||r)){if(a.elementClass!==c.OBJECT_CLASS_LINE)return f=a.points[0].scrCoords[1],g=a.points[0].scrCoords[2],h=a.points[a.points.length-1].scrCoords[1],void(i=a.points[a.points.length-1].scrCoords[2]);f=b.scrCoords[1],g=b.scrCoords[2],h=d.scrCoords[1],i=d.scrCoords[2],q&&e.exists(q.type)&&(k=e.exists(q.size)?e.evaluate(q.size):3,o*=k,n=e.evaluate(q.type),m=2===n?[[o,.5*-o],[0,0],[o,.5*o],[.5*o,0]]:3===n?[[o/3,.5*-o],[0,.5*-o],[0,.5*o],[o/3,.5*o]]:[[o,.5*-o],[0,0],[o,.5*o]]),r&&e.exists(r.type)&&(k=e.exists(r.size)?e.evaluate(r.size):3,o*=k,n=e.evaluate(r.type),l=2===n?[[-o,.5*-o],[0,0],[-o,.5*o],[.5*-o,0]]:3===n?[[-o/3,.5*-o],[0,.5*-o],[0,.5*o],[-o/3,.5*o]]:[[-o,.5*-o],[0,0],[-o,.5*o]]),p.save(),this._setColor(a,"stroke","fill")&&(j=Math.atan2(i-g,h-f),r&&this._drawFilledPolygon(this._translateShape(this._rotateShape(l,j),h,i)),q&&this._drawFilledPolygon(this._translateShape(this._rotateShape(m,j),f,g))),p.restore()}},updatePathStringPrim:function(a){var b,c,d,e,f,g="M",h="L",i="C",j=g,k=5e3,l=this.context;if(!(a.numberPoints<=0)){if(f=Math.min(a.points.length,a.numberPoints),l.beginPath(),1===a.bezierDegree)for(b=0;b<f;b++)c=a.points[b].scrCoords,isNaN(c[1])||isNaN(c[2])?j=g:(c[1]>k?c[1]=k:c[1]<-k&&(c[1]=-k),c[2]>k?c[2]=k:c[2]<-k&&(c[2]=-k),j===g?l.moveTo(c[1],c[2]):l.lineTo(c[1],c[2]),j=h);else if(3===a.bezierDegree)for(b=0;b<f;)c=a.points[b].scrCoords,isNaN(c[1])||isNaN(c[2])?j=g:(j===g?l.moveTo(c[1],c[2]):(b+=1,d=a.points[b].scrCoords,b+=1,e=a.points[b].scrCoords,l.bezierCurveTo(c[1],c[2],d[1],d[2],e[1],e[2])),j=i),b+=1;l.lineCap="round",this._fill(a),this._stroke(a)}},updatePathStringBezierPrim:function(a){var b,c,d,f,g,h,i,j="M",l="C",m=j,n=5e3,o=e.evaluate(a.visProp.strokewidth),p="plot"!==e.evaluate(a.visProp.curvetype),q=this.context;if(!(a.numberPoints<=0)){for(p&&a.board.options.curve.RDPsmoothing&&(a.points=k.RamerDouglasPeucker(a.points,.5)),i=Math.min(a.points.length,a.numberPoints),q.beginPath(),c=1;c<3;c++)for(m=j,b=0;b<i;b++)f=a.points[b].scrCoords,isNaN(f[1])||isNaN(f[2])?m=j:(f[1]>n?f[1]=n:f[1]<-n&&(f[1]=-n),f[2]>n?f[2]=n:f[2]<-n&&(f[2]=-n),m===j?q.moveTo(f[1],f[2]):(d=2*c,q.bezierCurveTo(g+.333*(f[1]-g)+o*(d*Math.random()-c),h+.333*(f[2]-h)+o*(d*Math.random()-c),g+.666*(f[1]-g)+o*(d*Math.random()-c),h+.666*(f[2]-h)+o*(d*Math.random()-c),f[1],f[2])),m=l,g=f[1],h=f[2]);q.lineCap="round",this._fill(a),this._stroke(a)}},updatePolygonPrim:function(a,b){var c,d,e,f=b.vertices.length,g=this.context,h=!0;if(!(f<=0)&&b.visPropCalc.visible){for(g.beginPath(),d=0;!b.vertices[d].isReal&&d<f-1;)d++,h=!1;for(c=b.vertices[d].coords.scrCoords,g.moveTo(c[1],c[2]),e=d;e<f-1;e++)b.vertices[e].isReal||(h=!1),c=b.vertices[e].coords.scrCoords,g.lineTo(c[1],c[2]);g.closePath(),h&&this._fill(b)}},display:function(a,b){a&&a.rendNode&&(a.visPropOld.visible=b,b?a.rendNode.style.visibility="inherit":a.rendNode.style.visibility="hidden")},show:function(b){a.deprecated("Board.renderer.show()","Board.renderer.display()"),e.exists(b.rendNode)&&(b.rendNode.style.visibility="inherit")},hide:function(b){a.deprecated("Board.renderer.hide()","Board.renderer.display()"),e.exists(b.rendNode)&&(b.rendNode.style.visibility="hidden")},setGradient:function(a){var b,c;c=e.evaluate(a.visProp.fillopacity),c=c>0?c:0,b=e.evaluate(a.visProp.fillcolor)},setShadow:function(a){a.visPropOld.shadow!==a.visProp.shadow&&(a.visPropOld.shadow=a.visProp.shadow)},highlight:function(a){return a.elementClass===c.OBJECT_CLASS_TEXT&&"html"===e.evaluate(a.visProp.display)?this.updateTextStyle(a,!0):(a.board.prepareUpdate(),a.board.renderer.suspendRedraw(a.board),a.board.updateRenderer(),a.board.renderer.unsuspendRedraw()),this},noHighlight:function(a){return a.elementClass===c.OBJECT_CLASS_TEXT&&"html"===e.evaluate(a.visProp.display)?this.updateTextStyle(a,!1):(a.board.prepareUpdate(),a.board.renderer.suspendRedraw(a.board),a.board.updateRenderer(),a.board.renderer.unsuspendRedraw()),this},suspendRedraw:function(b){this.context.save(),this.context.clearRect(0,0,this.canvasRoot.width,this.canvasRoot.height),b&&b.attr.showcopyright&&this.displayCopyright(a.licenseText,12)},unsuspendRedraw:function(){this.context.restore()},resize:function(a,b){this.container?(this.canvasRoot.style.width=parseFloat(a)+"px",this.canvasRoot.style.height=parseFloat(b)+"px",this.canvasRoot.setAttribute("width",2*parseFloat(a)+"px"),this.canvasRoot.setAttribute("height",2*parseFloat(b)+"px")):(this.canvasRoot.width=2*parseFloat(a),this.canvasRoot.height=2*parseFloat(b)),this.context=this.canvasRoot.getContext("2d"),this.context.scale(2,2)},removeToInsertLater:function(){return function(){}}}),a.CanvasRenderer}),define("jsxgraph",["jxg","utils/env","utils/type","base/board","reader/file","options","renderer/svg","renderer/vml","renderer/canvas","renderer/no"],function(a,b,c,d,e,f,g,h,i,j){"use strict";return a.JSXGraph={rendererType:function(){return f.board.renderer="no",b.supportsVML()&&(f.board.renderer="vml",document.onmousemove=function(){var a;return document.body&&(a=document.body.scrollLeft,a+=document.body.scrollTop),a}),b.supportsCanvas()&&(f.board.renderer="canvas"),b.supportsSVG()&&(f.board.renderer="svg"),b.isNode()&&b.supportsCanvas()&&(f.board.renderer="canvas"),(b.isNode()||"no"===f.renderer)&&(f.text.display="internal",f.infobox.display="internal"),f.board.renderer}(),initRenderer:function(a,b,d,e){var f,k;if(c.exists(d)&&d!==!1||"object"!=typeof document||(d=document),"object"==typeof d&&null!==a)for(f=d.getElementById(a);f.firstChild;)f.removeChild(f.firstChild);else f=a;return void 0!==e&&"auto"!==e||(e=this.rendererType),k="svg"===e?new g(f,b):"vml"===e?new h(f):"canvas"===e?new i(f,b):new j},initBoard:function(e,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u;return g=g||{},q=c.copyAttributes(g,f,"board"),q.zoom=c.copyAttributes(q,f,"board","zoom"),q.pan=c.copyAttributes(q,f,"board","pan"),q.selection=c.copyAttributes(q,f,"board","selection"),q.navbar=c.copyAttributes(q.navbar,f,"navbar"),o=b.getDimensions(e,q.document),q.unitx||q.unity?(h=c.def(q.originx,150),i=c.def(q.originy,150),j=c.def(q.unitx,50),k=c.def(q.unity,50)):(p=q.boundingbox,m=parseInt(o.width,10),n=parseInt(o.height,10),c.exists(p)&&q.keepaspectratio?(j=m/(p[2]-p[0]),k=n/(p[1]-p[3]),Math.abs(j)<Math.abs(k)?k=Math.abs(j)*k/Math.abs(k):j=Math.abs(k)*j/Math.abs(j)):(j=m/(p[2]-p[0]),k=n/(p[1]-p[3])),h=-j*p[0],i=k*p[1]),l=this.initRenderer(e,o,q.document,q.renderer),u=new d(e,l,q.id,[h,i],q.zoomfactor*q.zoomx,q.zoomfactor*q.zoomy,j,k,o.width,o.height,q),a.boards[u.id]=u,u.keepaspectratio=q.keepaspectratio,u.resizeContainer(o.width,o.height,!0,!0),u.suspendUpdate(),u.initInfobox(),q.axis&&(r="object"==typeof q.axis?q.axis:{},s=c.deepCopy(f.board.defaultAxes.x,r),t=c.deepCopy(f.board.defaultAxes.y,r),q.defaultaxes.x&&(s=c.deepCopy(s,q.defaultaxes.x)),q.defaultaxes.y&&(t=c.deepCopy(t,q.defaultaxes.y)),u.defaultAxes={},u.defaultAxes.x=u.create("axis",[[0,0],[1,0]],s),u.defaultAxes.y=u.create("axis",[[0,0],[0,1]],t)),q.grid&&u.create("grid",[],"object"==typeof q.grid?q.grid:{}),u._createSelectionPolygon(q),u.renderer.drawZoomBar(u,q.navbar),u.unsuspendUpdate(),u},loadBoardFromFile:function(g,h,i,j,k){var l,m,n,o,p;return j=j||{},l=c.copyAttributes(j,f,"board"),l.zoom=c.copyAttributes(j,f,"board","zoom"),l.pan=c.copyAttributes(j,f,"board","pan"),l.selection=c.copyAttributes(l,f,"board","selection"),
l.navbar=c.copyAttributes(l.navbar,f,"navbar"),o=b.getDimensions(g,l.document),m=this.initRenderer(g,o,l.document,l.renderer),n=new d(g,m,"",[150,150],1,1,50,50,o.width,o.height,l),n.initInfobox(),n.resizeContainer(o.width,o.height,!0,!0),e.parseFileContent(h,n,i,!0,k),p=c.copyAttributes(l,f,"board","selection"),n.selectionPolygon=n.create("polygon",[[0,0],[0,0],[0,0],[0,0]],p),n.renderer.drawZoomBar(n,l.navbar),a.boards[n.id]=n,n},loadBoardFromString:function(g,h,i,j,k){var l,m,n,o,p;return j=j||{},l=c.copyAttributes(j,f,"board"),l.zoom=c.copyAttributes(j,f,"board","zoom"),l.pan=c.copyAttributes(j,f,"board","pan"),l.selection=c.copyAttributes(l,f,"board","selection"),l.navbar=c.copyAttributes(l.navbar,f,"navbar"),n=b.getDimensions(g,l.document),m=this.initRenderer(g,n,l.document),o=new d(g,m,"",[150,150],1,1,50,50,n.width,n.height,l),o.initInfobox(),o.resizeContainer(n.width,n.height,!0,!0),e.parseString(h,o,i,!0,k),p=c.copyAttributes(l,f,"board","selection"),o.selectionPolygon=o.create("polygon",[[0,0],[0,0],[0,0],[0,0]],p),o.renderer.drawZoomBar(o,l.navbar),a.boards[o.id]=o,o},freeBoard:function(b){var c;"string"==typeof b&&(b=a.boards[b]),b.removeEventHandlers(),b.suspendUpdate();for(c in b.objects)b.objects.hasOwnProperty(c)&&b.objects[c].remove();for(;b.containerObj.firstChild;)b.containerObj.removeChild(b.containerObj.firstChild);for(c in b.objects)b.objects.hasOwnProperty(c)&&delete b.objects[c];delete b.renderer,b.jc.creator.clearCache(),delete b.jc,delete a.boards[b.id]},registerElement:function(b,c){a.deprecated("JXG.JSXGraph.registerElement()","JXG.registerElement()"),a.registerElement(b,c)}},b.isBrowser&&"object"==typeof window&&"object"==typeof document&&b.addEvent(window,"load",function(){var b,d,e,f,g,h,i,j,k,l,m,n,o=document.getElementsByTagName("script"),p=function(b,c,d){var e=a.JSXGraph.initBoard(g,{boundingbox:d,keepaspectratio:!0,grid:m,axis:l,showReload:!0});if(c.toLowerCase().indexOf("script")>-1)e.construct(b);else try{e.jc.parse(b)}catch(f){a.debug(f)}return e},q=function(b,c,d,e){return function(){var f;a.JSXGraph.freeBoard(b),f=p(c,d,e),f.reload=q(f,c,d,e)}};for(d=0;d<o.length;d++)if(b=o[d].getAttribute("type",!1),c.exists(b)&&("text/jessiescript"===b.toLowerCase()||"jessiescript"===b.toLowerCase()||"text/jessiecode"===b.toLowerCase()||"jessiecode"===b.toLowerCase())){if(i=o[d].getAttribute("width",!1)||"500px",j=o[d].getAttribute("height",!1)||"500px",k=o[d].getAttribute("boundingbox",!1)||"-5, 5, 5, -5",g=o[d].getAttribute("container",!1),k=k.split(","),4!==k.length)k=[-5,5,5,-5];else for(e=0;e<k.length;e++)k[e]=parseFloat(k[e]);if(l=c.str2Bool(o[d].getAttribute("axis",!1)||"false"),m=c.str2Bool(o[d].getAttribute("grid",!1)||"false"),c.exists(g))f=document.getElementById(g);else{g="jessiescript_autgen_jxg_"+d,f=document.createElement("div"),f.setAttribute("id",g),f.setAttribute("style","width:"+i+"; height:"+j+"; float:left"),f.setAttribute("class","jxgbox");try{document.body.insertBefore(f,o[d])}catch(r){"object"==typeof jQuery&&jQuery(f).insertBefore(o[d])}}document.getElementById(g)?(n=o[d].innerHTML,n=n.replace(/<!\[CDATA\[/g,"").replace(/\]\]>/g,""),o[d].innerHTML=n,h=p(n,b,k),h.reload=q(h,n,b,k)):a.debug("JSXGraph: Apparently the div injection failed. Can't create a board, sorry.")}},window),a.JSXGraph}),define("base/group",["jxg","base/constants","math/math","math/geometry","utils/type"],function(a,b,c,d,e){"use strict";return a.Group=function(a,c,d,f,g){var h,i,j,k;for(this.board=a,this.objects={},h=this.board.numObjects,this.board.numObjects+=1,""!==c&&e.exists(c)?this.id=c:this.id=this.board.id+"Group"+h,this.board.groups[this.id]=this,this.type=b.OBJECT_TYPE_POINT,this.elementClass=b.OBJECT_CLASS_POINT,""!==d&&e.exists(d)?this.name=d:this.name="group_"+this.board.generateName(this),delete this.type,this.coords={},this.needsRegularUpdate=g.needsregularupdate,this.rotationCenter="centroid",this.scaleCenter=null,this.rotationPoints=[],this.translationPoints=[],this.scalePoints=[],this.scaleDirections={},this.parents=[],i=e.isArray(f)?f:Array.prototype.slice.call(arguments,3),j=0;j<i.length;j++)k=this.board.select(i[j]),!e.evaluate(k.visProp.fixed)&&e.exists(k.coords)&&this.addPoint(k);this.methodMap={ungroup:"ungroup",add:"addPoint",addPoint:"addPoint",addPoints:"addPoints",addGroup:"addGroup",remove:"removePoint",removePoint:"removePoint",setAttribute:"setAttribute",setProperty:"setAttribute"}},a.extend(a.Group.prototype,{ungroup:function(){var a,b,c;for(a in this.objects)this.objects.hasOwnProperty(a)&&(b=this.objects[a].point,e.isArray(b.groups)&&(c=e.indexOf(b.groups,this.id),c>=0&&delete b.groups[c]));return this.objects={},this},addParents:function(a){var b,c,d;for(d=e.isArray(a)?a:arguments,c=d.length,b=0;b<c;++b)e.isId(this.board,d[b])?this.parents.push(d[b]):e.exists(d[b].id)&&this.parents.push(d[b].id);this.parents=e.uniqueArray(this.parents)},setParents:function(a){this.parents=[],this.addParents(a)},getParents:function(){return e.isArray(this.parents)?this.parents:[]},_updateCoordsCache:function(a){var b;""!==a&&e.exists(this.objects[a])&&(b=this.objects[a].point,this.coords[b.id]={usrCoords:b.coords.usrCoords.slice(0)})},update:function(a){var b,f,g,h,i,j,k,l,m,n=null;if(!this.needsUpdate)return this;if(a=this._update_find_drag_type(),"nothing"===a.action)return this._updateCoordsCache(a.id),this;if(n=this.objects[a.id].point,"translation"===a.action)l=[n.coords.usrCoords[1]-this.coords[a.id].usrCoords[1],n.coords.usrCoords[2]-this.coords[a.id].usrCoords[2]];else if("rotation"===a.action||"scaling"===a.action){if(f="rotation"===a.action?"rotationCenter":"scaleCenter",e.isPoint(this[f]))m=this[f].coords.usrCoords.slice(1);else if("centroid"===this[f])m=this._update_centroid_center();else if(e.isArray(this[f]))m=this[f];else{if(!e.isFunction(this[f]))return this;m=this[f]()}if("rotation"===a.action)k=d.rad(this.coords[a.id].usrCoords.slice(1),m,this.objects[a.id].point),l=this.board.create("transform",[k,m[0],m[1]],{type:"rotate"}),l.update();else{if("scaling"!==a.action)return this;if(h=d.distance(this.coords[a.id].usrCoords.slice(1),m),Math.abs(h)<c.eps)return this;h=d.distance(n.coords.usrCoords.slice(1),m)/h,i=this.scaleDirections[a.id].indexOf("x")>=0?h:1,j=this.scaleDirections[a.id].indexOf("y")>=0?h:1,l=this.board.create("transform",[1,0,0,m[0]*(1-i),i,0,m[1]*(1-j),0,j],{type:"generic"}),l.update()}}this._update_apply_transformation(a,l),this.needsUpdate=!1;for(b in this.objects)if(this.objects.hasOwnProperty(b))for(g in this.objects[b].descendants)this.objects[b].descendants.hasOwnProperty(g)&&(this.objects[b].descendants.needsUpdate=this.objects[b].descendants.needsRegularUpdate||this.board.needsFullUpdate);this.board.updateElements(a);for(b in this.objects)this.objects.hasOwnProperty(b)&&this._updateCoordsCache(b);return this},_update_find_drag_type:function(){var a,d,f,g="nothing",h=[];for(a in this.objects)this.objects.hasOwnProperty(a)&&(d=this.objects[a].point,d.coords.distance(b.COORDS_BY_USER,this.coords[a])>c.eps&&h.push(d.id));return 0===h.length?{action:g,id:"",changed:h}:(f=h[0],d=this.objects[f].point,h.length>1?g="translation":e.isInArray(this.rotationPoints,d)&&e.exists(this.rotationCenter)?g="rotation":e.isInArray(this.scalePoints,d)&&e.exists(this.scaleCenter)?g="scaling":e.isInArray(this.translationPoints,d)&&(g="translation"),{action:g,id:f,changed:h})},_update_centroid_center:function(){var a,b,c;a=[0,0],b=0;for(c in this.coords)this.coords.hasOwnProperty(c)&&(a[0]+=this.coords[c].usrCoords[1],a[1]+=this.coords[c].usrCoords[2],++b);return b>0&&(a[0]/=b,a[1]/=b),a},_update_apply_transformation:function(a,d){var f,g;for(f in this.objects)this.objects.hasOwnProperty(f)&&(e.exists(this.board.objects[f])?(g=this.objects[f].point,g.id!==a.id?"translation"===a.action?e.isInArray(a.changed,g.id)||g.coords.setCoordinates(b.COORDS_BY_USER,[this.coords[f].usrCoords[1]+d[0],this.coords[f].usrCoords[2]+d[1]]):"rotation"!==a.action&&"scaling"!==a.action||d.applyOnce([g]):"rotation"!==a.action&&"scaling"!==a.action||g.coords.setCoordinates(b.COORDS_BY_USER,c.matVecMult(d.matrix,this.coords[g.id].usrCoords))):delete this.objects[f])},addPoint:function(a){return this.objects[a.id]={point:this.board.select(a)},this._updateCoordsCache(a.id),this.translationPoints.push(a),a.groups.push(this.id),a.groups=e.uniqueArray(a.groups),this},addPoints:function(a){var b;for(b=0;b<a.length;b++)this.addPoint(a[b]);return this},addGroup:function(a){var b;for(b in a.objects)a.objects.hasOwnProperty(b)&&this.addPoint(a.objects[b].point);return this},removePoint:function(a){return delete this.objects[a.id],this},setRotationCenter:function(a){return this.rotationCenter=a,this},setRotationPoints:function(a){return this._setActionPoints("rotation",a)},addRotationPoint:function(a){return this._addActionPoint("rotation",a)},removeRotationPoint:function(a){return this._removeActionPoint("rotation",a)},setTranslationPoints:function(a){return this._setActionPoints("translation",a)},addTranslationPoint:function(a){return this._addActionPoint("translation",a)},removeTranslationPoint:function(a){return this._removeActionPoint("translation",a)},setScaleCenter:function(a){return this.scaleCenter=a,this},setScalePoints:function(a,b){var c,d,f;for(c=e.isArray(a)?a:arguments,f=c.length,d=0;d<f;++d)this.scaleDirections[this.board.select(c[d]).id]=b||"xy";return this._setActionPoints("scale",a)},addScalePoint:function(a,b){return this._addActionPoint("scale",a),this.scaleDirections[this.board.select(a).id]=b||"xy",this},removeScalePoint:function(a){return this._removeActionPoint("scale",a)},_setActionPoints:function(a,b){var c,d,f;for(c=e.isArray(b)?b:arguments,f=c.length,this[a+"Points"]=[],d=0;d<f;++d)this._addActionPoint(a,c[d]);return this},_addActionPoint:function(a,b){return this[a+"Points"].push(this.board.select(b)),this},_removeActionPoint:function(a,b){var c=this[a+"Points"].indexOf(this.board.select(b));return c>-1&&this[a+"Points"].splice(c,1),this},setProperty:function(){a.deprecated("Group.setProperty","Group.setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(){var a;for(a in this.objects)this.objects.hasOwnProperty(a)&&this.objects[a].point.setAttribute.apply(this.objects[a].point,arguments);return this}}),a.createGroup=function(b,c,d){var f=e.copyAttributes(d,b.options,"group"),g=new a.Group(b,f.id,f.name,c,f);return g.elType="group",g.setParents(c),g},a.registerElement("group",a.createGroup),{Group:a.Group,createGroup:a.createGroup}}),define("element/locus",["jxg","math/symbolic","utils/type","base/constants","base/curve"],function(a,b,c,d,e){"use strict";return a.createLocus=function(a,d,e){var f,g;if(!c.isArray(d)||1!==d.length||!c.isPoint(d[0]))throw new Error("JSXGraph: Can't create locus with parent of type other than point.\nPossible parent types: [point]");return g=d[0],f=a.create("curve",[[null],[null]],e),f.dontCallServer=!1,f.elType="locus",f.setParents([g.id]),f.updateDataArray=function(){var c,d,e;f.board.mode>0||(c=b.generatePolynomials(a,g,!0).join("|"),c!==f.spe&&(f.spe=c,d=function(a,b,c,d){f.dataX=a,f.dataY=b,f.eq=c,f.ctime=d,f.generatePolynomial=function(a){return function(b){var c,d="("+b.symbolic.x+")",e="("+b.symbolic.y+")",f=[];for(c=0;c<a.length;c++)f[c]=a[c].replace(/\*\*/g,"^").replace(/x/g,d).replace(/y/g,e);return f}}(c)},e=b.geometricLocusByGroebnerBase(a,g,d),d(e.datax,e.datay,e.polynomial,e.exectime)))},f},a.registerElement("locus",a.createLocus),{createLocus:a.createLocus}}),define("base/image",["jxg","base/constants","base/coords","base/element","math/math","math/statistics","utils/type","base/coordselement"],function(a,b,c,d,e,f,g,h){"use strict";return a.Image=function(c,d,e,f,h){this.constructor(c,e,b.OBJECT_TYPE_IMAGE,b.OBJECT_CLASS_OTHER),this.element=this.board.select(e.anchor),this.coordsConstructor(d),this.W=g.createFunction(h[0],this.board,""),this.H=g.createFunction(h[1],this.board,""),this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*c.unitX),Math.abs(this.usrSize[1]*c.unitY)],this.url=f,this.elType="image",this.span=[this.coords.usrCoords.slice(0),[this.coords.usrCoords[0],this.W(),0],[this.coords.usrCoords[0],0,this.H()]],this.id=this.board.setId(this,"Im"),this.board.renderer.drawImage(this),this.board.finalizeAdding(this),this.methodMap=a.deepCopy(this.methodMap,{addTransformation:"addTransform",trans:"addTransform"})},a.Image.prototype=new d,g.copyPrototypeMethods(a.Image,h,"coordsConstructor"),a.extend(a.Image.prototype,{hasPoint:function(a,d){var f,g,h,i,j,k,l,m=this.transformations.length;return 0===m?(f=a-this.coords.scrCoords[1],g=this.coords.scrCoords[2]-d,h=this.board.options.precision.hasPoint,f>=-h&&f-this.size[0]<=h&&g>=-h&&g-this.size[1]<=h):(i=new c(b.COORDS_BY_SCREEN,[a,d],this.board),i=i.usrCoords,j=[i[0]-this.span[0][0],i[1]-this.span[0][1],i[2]-this.span[0][2]],l=e.innerProduct,k=l(j,this.span[1]),0<=k&&k<=l(this.span[1],this.span[1])&&(k=l(j,this.span[2]),0<=k&&k<=l(this.span[2],this.span[2])))},update:function(a){return this.needsUpdate?(this.updateCoords(a),this.updateSize(),this.updateSpan(),this):this},updateRenderer:function(){return this.updateRendererGeneric("updateImage")},updateSize:function(){return this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*this.board.unitX),Math.abs(this.usrSize[1]*this.board.unitY)],this},updateSpan:function(){var a,b,c=this.transformations.length,d=[];if(0===c)this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]];else{for(d[0]=[this.Z(),this.X(),this.Y()],d[1]=[this.Z(),this.X()+this.W(),this.Y()],d[2]=[this.Z(),this.X(),this.Y()+this.H()],a=0;a<c;a++)for(b=0;b<3;b++)d[b]=e.matVecMult(this.transformations[a].matrix,d[b]);for(b=0;b<3;b++)d[b][1]/=d[b][0],d[b][2]/=d[b][0],d[b][0]/=d[b][0];for(b=1;b<3;b++)d[b][0]-=d[0][0],d[b][1]-=d[0][1],d[b][2]-=d[0][2];this.span=d}return this},addTransform:function(a){var b;if(g.isArray(a))for(b=0;b<a.length;b++)this.transformations.push(a[b]);else this.transformations.push(a);return this},getParents:function(){var a=[this.url,[this.Z(),this.X(),this.Y()],this.usrSize];return 0!==this.parents.length&&(a=this.parents),a},setSize:function(a,b){return this.W=g.createFunction(a,this.board,""),this.H=g.createFunction(b,this.board,""),this},W:function(){},H:function(){}}),a.createImage=function(b,c,d){var e,f,i=c[0],j=c[1],k=c[2];if(e=g.copyAttributes(d,b.options,"image"),f=h.create(a.Image,b,j,e,i,k),!f)throw new Error("JSXGraph: Can't create image with parent types '"+typeof c[0]+"' and '"+typeof c[1]+"'.\nPossible parent types: [x,y], [z,x,y], [element,transformation]");return 0!==g.evaluate(e.rotate)&&f.addRotation(g.evaluate(e.rotate)),f},a.registerElement("image",a.createImage),{Image:a.Image,createImage:a.createImage}}),define("base/ticks",["jxg","math/math","math/geometry","base/constants","base/element","base/coords","utils/type","base/text"],function(a,b,c,d,e,f,g,h){"use strict";return a.Ticks=function(a,c,e){if(this.constructor(a.board,e,d.OBJECT_TYPE_TICKS,d.OBJECT_CLASS_OTHER),this.line=a,this.board=this.line.board,this.ticksFunction=null,this.fixedTicks=null,this.equidistant=!1,this.labelsData=[],g.isFunction(c))throw this.ticksFunction=c,new Error("Function arguments are no longer supported.");g.isArray(c)?this.fixedTicks=c:((Math.abs(c)<b.eps||c<0)&&(c=e.defaultdistance),this.ticksFunction=this.makeTicksFunction(c),this.equidistant=!0),this.minTicksDistance=e.minticksdistance,this.ticks=[],this.ticksDelta=1,this.labels=[],this.labelData=[],this.labelCounter=0,this.id=this.line.addTicks(this),this.elType="ticks",this.inherits.push(this.labels),this.board.setId(this,"Ti")},a.Ticks.prototype=new e,a.extend(a.Ticks.prototype,{makeTicksFunction:function(a){return function(){var b,c,d;return g.evaluate(this.visProp.insertticks)?(c=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance"),d=c.upper-c.lower,b=Math.pow(10,Math.floor(Math.log(.6*d)/Math.LN10)),d<=6*b&&(b*=.5),b):a}},hasPoint:function(a,c){var e,f,h=this.ticks&&this.ticks.length||0,i=this.board.options.precision.hasPoint+.5*g.evaluate(this.visProp.strokewidth);if(!g.evaluate(this.line.visProp.scalable))return!1;if(0!==this.line.stdform[1]&&0!==this.line.stdform[2]&&this.line.type!==d.OBJECT_TYPE_AXIS)return!1;for(e=0;e<h;e++)if(f=this.ticks[e],f[2]&&!(0===this.line.stdform[1]&&Math.abs(f[0][0]-this.line.point1.coords.scrCoords[1])<b.eps||0===this.line.stdform[2]&&Math.abs(f[1][0]-this.line.point1.coords.scrCoords[2])<b.eps)&&(Math.abs(f[0][0]-f[0][1])>=1||Math.abs(f[1][0]-f[1][1])>=1))if(0===this.line.stdform[1]){if(Math.abs(c-.5*(f[1][0]+f[1][1]))<2*i&&f[0][0]-i<a&&a<f[0][1]+i)return!0}else if(0===this.line.stdform[2]&&Math.abs(a-.5*(f[0][0]+f[0][1]))<2*i&&f[1][0]-i<c&&c<f[1][1]+i)return!0;return!1},setPositionDirectly:function(a,c,d){var e,h,i=new f(a,c,this.board),j=new f(a,d,this.board),k=this.board.getBoundingBox();return g.evaluate(this.line.visProp.scalable)?(Math.abs(this.line.stdform[1])<b.eps&&Math.abs(i.usrCoords[1]*j.usrCoords[1])>b.eps?(e=j.usrCoords[1]/i.usrCoords[1],k[0]*=e,k[2]*=e,this.board.setBoundingBox(k,!1)):Math.abs(this.line.stdform[2])<b.eps&&Math.abs(i.usrCoords[2]*j.usrCoords[2])>b.eps&&(h=j.usrCoords[2]/i.usrCoords[2],k[3]*=h,k[1]*=h,this.board.setBoundingBox(k,!1)),this):this},calculateTicksCoordinates:function(){var a,c;if(this.setTicksSizeVariables(),!(Math.abs(this.dx)<b.eps&&Math.abs(this.dy)<b.eps))return a=this.getZeroCoordinates(),c=this.getLowerAndUpperBounds(a),this.ticks=[],this.labelsData=[],this.equidistant?this.generateEquidistantTicks(a,c):this.generateFixedTicks(a,c),this},setTicksSizeVariables:function(){var a,b=.5*g.evaluate(this.visProp.majorheight),c=.5*g.evaluate(this.visProp.minorheight);this.dxMaj=this.line.stdform[1],this.dyMaj=this.line.stdform[2],this.dxMin=this.dxMaj,this.dyMin=this.dyMaj,this.dx=this.dxMaj,this.dy=this.dyMaj,a=Math.sqrt(this.dxMaj*this.dxMaj*this.board.unitX*this.board.unitX+this.dyMaj*this.dyMaj*this.board.unitY*this.board.unitY),this.dxMaj*=b/a*this.board.unitX,this.dyMaj*=b/a*this.board.unitY,this.dxMin*=c/a*this.board.unitX,this.dyMin*=c/a*this.board.unitY,this.minStyle=g.evaluate(this.visProp.minorheight)<0?"infinite":"finite",this.majStyle=g.evaluate(this.visProp.majorheight)<0?"infinite":"finite"},getZeroCoordinates:function(){var a,b,e,h,i,j,k=g.evaluate(this.visProp.anchor);return this.line.type===d.OBJECT_TYPE_AXIS?c.projectPointToLine({coords:{usrCoords:[1,0,0]}},this.line,this.board):(e=this.line.point1.coords.usrCoords[0],a=this.line.point1.coords.usrCoords[1],b=this.line.point1.coords.usrCoords[2],j=this.line.point2.coords.usrCoords[0],h=this.line.point2.coords.usrCoords[1],i=this.line.point2.coords.usrCoords[2],"right"===k?this.line.point2.coords:"middle"===k?new f(d.COORDS_BY_USER,[.5*(e+j),.5*(a+h),.5*(b+i)],this.board):g.isNumber(k)?new f(d.COORDS_BY_USER,[e+(j-e)*k,a+(h-a)*k,b+(i-b)*k],this.board):this.line.point1.coords)},getLowerAndUpperBounds:function(a,e){var h,i,j,k,l,m=new f(d.COORDS_BY_USER,this.line.point1.coords.usrCoords,this.board),n=new f(d.COORDS_BY_USER,this.line.point2.coords.usrCoords,this.board),o=Math.abs(m.usrCoords[0])>=b.eps&&m.scrCoords[1]>=0&&m.scrCoords[1]<=this.board.canvasWidth&&m.scrCoords[2]>=0&&m.scrCoords[2]<=this.board.canvasHeight,p=Math.abs(n.usrCoords[0])>=b.eps&&n.scrCoords[1]>=0&&n.scrCoords[1]<=this.board.canvasWidth&&n.scrCoords[2]>=0&&n.scrCoords[2]<=this.board.canvasHeight,q=g.evaluate(this.line.visProp.straightfirst),r=g.evaluate(this.line.visProp.straightlast),s=g.evaluate(this.visProp.includeboundaries);return g.exists(e)||"tickdistance"===e?c.calcStraight(this.line,m,n,g.evaluate(this.line.visProp.margin)):c.calcLineDelimitingPoints(this.line,m,n),l=this.board.renderer.getPositionArrowHead(this.line,m,n,g.evaluate(this.line.visProp.strokewidth)),m.setCoordinates(d.COORDS_BY_SCREEN,[m.scrCoords[1]-l.d1x,m.scrCoords[2]-l.d1y]),n.setCoordinates(d.COORDS_BY_SCREEN,[n.scrCoords[1]-l.d2x,n.scrCoords[2]-l.d2y]),j=this.getDistanceFromZero(a,m),k=this.getDistanceFromZero(a,n),j<k?(h=j,q||!o||s||(h+=b.eps),i=k,r||!p||s||(i-=b.eps)):k<j?(h=k,r||!p||s||(h+=b.eps),i=j,q||!o||s||(i-=b.eps)):(h=0,i=0),{lower:h,upper:i}},getDistanceFromZero:function(a,e){var f=b.eps,h=a.distance(d.COORDS_BY_USER,e);return this.line.type===d.OBJECT_TYPE_AXIS?(b.relDif(a.usrCoords[1],e.usrCoords[1])>f&&a.usrCoords[1]-e.usrCoords[1]>f||b.relDif(a.usrCoords[2],e.usrCoords[2])>f&&a.usrCoords[2]-e.usrCoords[2]>f)&&(h*=-1):"right"===g.evaluate(this.visProp.anchor)?c.isSameDirection(a,this.line.point1.coords,e)&&(h*=-1):c.isSameDirection(a,this.line.point2.coords,e)||(h*=-1),h},generateEquidistantTicks:function(a,c){var d,e=this.getXandYdeltas(),f=this.equidistant?this.ticksFunction(1):this.ticksDelta,h=g.evaluate(this.visProp.insertticks),i=g.evaluate(this.visProp.minorticks);if(f*=g.evaluate(this.visProp.scale),h&&this.minTicksDistance>b.eps?(f=this.adjustTickDistance(f,a,e),f/=i+1):h||(f/=i+1),this.ticksDelta=f,!(f<b.eps)){for(d=0,g.evaluate(this.visProp.drawzero)||(d=f);d<=c.upper;)d>=c.lower&&this.processTickPosition(a,d,f,e),d+=f;for(d=-f;d>=c.lower;)d<=c.upper&&this.processTickPosition(a,d,f,e),d-=f}},adjustTickDistance:function(a,b,c){var e,h,i,j,k=1,l=g.evaluate(this.visProp.minorticks);for(i=this.getLowerAndUpperBounds(b,"ticksdistance"),e=b.usrCoords[1]+c.x*a,h=b.usrCoords[2]+c.y*a,j=b.distance(d.COORDS_BY_SCREEN,new f(d.COORDS_BY_USER,[e,h],this.board));j/(l+1)<this.minTicksDistance;)a*=1===k?2:5,k*=-1,e=b.usrCoords[1]+c.x*a,h=b.usrCoords[2]+c.y*a,j=b.distance(d.COORDS_BY_SCREEN,new f(d.COORDS_BY_USER,[e,h],this.board));return a},processTickPosition:function(a,b,c,e){var h,i,j,k;h=a.usrCoords[1]+b*e.x,i=a.usrCoords[2]+b*e.y,j=new f(d.COORDS_BY_USER,[h,i],this.board),j.major=Math.round(b/c)%(g.evaluate(this.visProp.minorticks)+1)===0,k=this.tickEndings(j,j.major),3===k.length&&(this.ticks.push(k),j.major&&g.evaluate(this.visProp.drawlabels)?this.labelsData.push(this.generateLabelData(this.generateLabelText(j,a),j,this.ticks.length)):this.labelsData.push(null))},generateFixedTicks:function(a,b){var c,e,h,i,j,k,l=g.isArray(this.visProp.labels),m=this.getXandYdeltas(),n=g.evaluate(this.visProp.drawlabels);for(h=0;h<this.fixedTicks.length;h++)j=a.usrCoords[1]+this.fixedTicks[h]*m.x,k=a.usrCoords[2]+this.fixedTicks[h]*m.y,c=new f(d.COORDS_BY_USER,[j,k],this.board),i=this.tickEndings(c,!0),3===i.length&&this.fixedTicks[h]>=b.lower&&this.fixedTicks[h]<=b.upper&&(this.ticks.push(i),n&&(l||g.exists(this.visProp.labels[h]))?(e=l?g.evaluate(this.visProp.labels[h]):this.fixedTicks[h],this.labelsData.push(this.generateLabelData(this.generateLabelText(c,a,e),c,h))):this.labelsData.push(null))},getXandYdeltas:function(){var a,c,e=this.line.point1.Dist(this.line.point2);return this.line.type===d.OBJECT_TYPE_AXIS?(a=this.line.point1.coords.usrCoords,c=this.line.point2.coords.usrCoords,(a[1]>c[1]||Math.abs(a[1]-c[1])<b.eps&&a[2]>c[2])&&(a=this.line.point2.coords.usrCoords,c=this.line.point1.coords.usrCoords)):(a=this.line.point1.coords.usrCoords,c=this.line.point2.coords.usrCoords),{x:(c[1]-a[1])/e,y:(c[2]-a[2])/e}},_isInsideCanvas:function(a,b,c){var d=this.board.canvasWidth,e=this.board.canvasHeight;return void 0===c&&(c=0),a[0]>=c&&a[0]<=d-c&&b[0]>=c&&b[0]<=e-c||a[1]>=c&&a[1]<=d-c&&b[1]>=c&&b[1]<=e-c},tickEndings:function(a,b){var d,e,f,h,i,j,k=[-2e6,-2e6],l=[-2e6,-2e6];return d=a.scrCoords,b?(h=this.dxMaj,i=this.dyMaj,j=this.majStyle):(h=this.dxMin,i=this.dyMin,j=this.minStyle),e=[-i*d[1]-h*d[2],i,h],"infinite"===j?(f=c.meetLineBoard(e,this.board),k[0]=f[0].scrCoords[1],k[1]=f[1].scrCoords[1],l[0]=f[0].scrCoords[2],l[1]=f[1].scrCoords[2]):(k[0]=d[1]+h*g.evaluate(this.visProp.tickendings[0]),l[0]=d[2]-i*g.evaluate(this.visProp.tickendings[0]),k[1]=d[1]-h*g.evaluate(this.visProp.tickendings[1]),l[1]=d[2]+i*g.evaluate(this.visProp.tickendings[1])),this._isInsideCanvas(k,l)?[k,l,b]:[]},formatLabelText:function(a){var b=a.toString(),c=g.evaluate(this.visProp.scalesymbol);return g.isNumber(a)&&((b.length>g.evaluate(this.visProp.maxlabellength)||b.indexOf("e")!==-1)&&(b=a.toPrecision(g.evaluate(this.visProp.precision)).toString()),b.indexOf(".")>-1&&b.indexOf("e")===-1&&(b=b.replace(/0+$/,""),b=b.replace(/\.$/,""))),c.length>0&&("1"===b?b=c:"-1"===b?b="-"+c:"0"!==b&&(b+=c)),g.evaluate(this.visProp.useunicodeminus)&&(b=b.replace(/-/g,"−")),b},generateLabelText:function(a,c,d){var e,f=this.getDistanceFromZero(c,a);return Math.abs(f)<b.eps?e="0":(g.exists(d)||(d=f/g.evaluate(this.visProp.scale)),e=this.formatLabelText(d)),e},generateLabelData:function(a,b,c){var d,e,f,h;return h=g.evaluate(this.visProp.label.fontsize),d=[b.scrCoords[1],b.scrCoords[1]],e=[b.scrCoords[2],b.scrCoords[2]],f=void 0===h?12:h,f*=1.5,this._isInsideCanvas(d,e,f)?(d=g.evaluate(this.visProp.label.offset[0]),e=g.evaluate(this.visProp.label.offset[1]),{x:b.usrCoords[1]+d/this.board.unitX,y:b.usrCoords[2]+e/this.board.unitY,t:a,i:c}):null},update:function(){return this.needsUpdate&&0!==this.board.canvasWidth&&0!==this.board.canvasHeight&&this.calculateTicksCoordinates(),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&this.board.renderer.updateTicks(this),this.updateRendererLabels(),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateRendererLabels:function(){var a,b,c,d,e,f,i,j;for(c=this.labelsData.length,d=this.labels.length,a=0,b=0;a<c;a++)null!==this.labelsData[a]&&(i=this.labelsData[a],b<d?(f=this.labels[b],f.setText(i.t),f.setCoords(i.x,i.y),b++):(this.labelCounter+=1,e={isLabel:!0,layer:this.board.options.layer.line,highlightStrokeColor:this.board.options.text.strokeColor,highlightStrokeWidth:this.board.options.text.strokeWidth,highlightStrokeOpacity:this.board.options.text.strokeOpacity,priv:this.visProp.priv},e=g.deepCopy(e,this.visProp.label),e.id=this.id+i.i+"Label"+this.labelCounter,f=h.createText(this.board,[i.x,i.y,i.t],e),f.isDraggable=!1,f.dump=!1,this.labels.push(f)),j=g.evaluate(this.visProp.label.visible),"inherit"===j&&(j=this.visPropCalc.visible),f.prepareUpdate().updateVisibility(j).updateRenderer(),f.distanceX=g.evaluate(this.visProp.label.offset[0]),f.distanceY=g.evaluate(this.visProp.label.offset[1]));for(c=b,b=c;b<d;b++)this.board.renderer.display(this.labels[b],!1),this.labels[b].visProp.visible=!1;return this},hideElement:function(){var b;for(a.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),b=0;b<this.labels.length;b++)g.exists(this.labels[b])&&this.labels[b].hideElement();return this},showElement:function(){var b;for(a.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!1),b=0;b<this.labels.length;b++)g.exists(this.labels[b])&&this.labels[b].showElement();return this}}),a.createTicks=function(b,c,e){var f,h,i=g.copyAttributes(e,b.options,"ticks");if(h=c.length<2?i.ticksdistance:c[1],c[0].elementClass!==d.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create Ticks with parent types '"+typeof c[0]+"'.");return f=new a.Ticks(c[0],h,i),g.isFunction(i.generatelabelvalue)&&(f.generateLabelText=i.generatelabelvalue),g.isFunction(i.generatelabeltext)&&(f.generateLabelText=i.generatelabeltext),f.setParents(c[0]),f.isDraggable=!0,f.fullUpdate(c[0].visPropCalc.visible),f},a.createHatchmark=function(a,b,c){var e,f,h,i,j,k,l=[],m=g.copyAttributes(c,a.options,"hatch");if(b[0].elementClass!==d.OBJECT_CLASS_LINE||"number"!=typeof b[1])throw new Error("JSXGraph: Can't create Hatch mark with parent types '"+typeof b[0]+"' and '"+typeof b[1]+" and ''"+typeof b[2]+"'.");for(e=b[1],i=m.ticksdistance,j=(e-1)*i,h=.5*-j,f=0;f<e;f++)l[f]=h+f*i;return k=a.create("ticks",[b[0],l],m),k.elType="hatch",k},a.registerElement("ticks",a.createTicks),a.registerElement("hash",a.createHatchmark),a.registerElement("hatch",a.createHatchmark),{Ticks:a.Ticks,createTicks:a.createTicks,createHashmark:a.createHatchmark,createHatchmark:a.createHatchmark}}),define("element/slider",["jxg","math/math","base/constants","utils/type","base/point","base/group","base/element","base/line","base/ticks","base/text"],function(a,b,c,d,e,f,g,h,i,j){"use strict";return a.createSlider=function(a,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;return A=d.copyAttributes(g,a.options,"slider"),y=A.withticks,x=A.withlabel,z=A.snapwidth,B=A.precision,A=d.copyAttributes(g,a.options,"slider","point1"),n=a.create("point",f[0],A),A=d.copyAttributes(g,a.options,"slider","point2"),o=a.create("point",f[1],A),A=d.copyAttributes(g,a.options,"slider","baseline"),p=a.create("segment",[n,o],A),p.updateStdform(),h=n.coords.usrCoords.slice(1),i=o.coords.usrCoords.slice(1),j=f[2][0],k=f[2][1],l=f[2][2],m=l-j,s=h[0]+(i[0]-h[0])*(k-j)/(l-j),t=h[1]+(i[1]-h[1])*(k-j)/(l-j),A=d.copyAttributes(g,a.options,"slider"),A.withLabel=!1,u=a.create("glider",[s,t,p],A),u.setAttribute({snapwidth:z}),A=d.copyAttributes(g,a.options,"slider","highline"),v=a.create("segment",[n,u],A),u.Value=function(){var a=this._smax-this._smin,b=d.evaluate(this.visProp.snapwidth);return b===-1?this.position*a+this._smin:Math.round((this.position*a+this._smin)/b)*b},u.methodMap=d.deepCopy(u.methodMap,{Value:"Value",setValue:"setValue",smax:"_smax",smin:"_smin",setMax:"setMax",setMin:"setMin"}),u._smax=l,u._smin=j,u.setMax=function(a){return this._smax=a,this},u.setValue=function(a){var c=this._smax-this._smin;return Math.abs(c)>b.eps?this.position=(a-this._smin)/c:this.position=0,this.position=Math.max(0,Math.min(1,this.position)),this},u.setMin=function(a){return this._smin=a,this},x&&(A=d.copyAttributes(g,a.options,"slider","label"),w=a.create("text",[function(){return.05*(o.X()-n.X())+o.X()},function(){return.05*(o.Y()-n.Y())+o.Y()},function(){var a,b=d.evaluate(u.visProp.suffixlabel),c=d.evaluate(u.visProp.unitlabel),e=d.evaluate(u.visProp.postlabel);return a=null!==b?b:u.name&&""!==u.name?u.name+" = ":"",a+=d.toFixed(u.Value(),B),null!==c&&(a+=c),null!==e&&(a+=e),a}],A),u.label=w,u.visProp.withlabel=!0,u.hasLabel=!0),u.point1=n,u.point2=o,u.baseline=p,u.highline=v,y&&(A=d.copyAttributes(g,a.options,"slider","ticks"),d.exists(A.generatelabeltext)||(A.generateLabelText=function(a,c,d){var e,f=u.point1.Dist(u.point2),g=u._smin,h=u._smax,i=this.getDistanceFromZero(c,a)*(h-g)/f+g;return e=f<b.eps||Math.abs(i)<b.eps?"0":this.formatLabelText(i)}),q=2,r=a.create("ticks",[u.baseline,u.point1.Dist(n)/q,function(a){var d=u.point1.Dist(u.point2),e=u.point1.coords.distance(c.COORDS_BY_USER,a);return d<b.eps?0:e/d*m+j}],A),u.ticks=r),u.remove=function(){x&&a.removeObject(w),a.removeObject(v),a.removeObject(p),a.removeObject(o),a.removeObject(n),e.Point.prototype.remove.call(u)},n.dump=!1,o.dump=!1,p.dump=!1,v.dump=!1,u.elType="slider",u.parents=f,u.subs={point1:n,point2:o,baseLine:p,highLine:v},u.inherits.push(n,o,p,v),y&&(r.dump=!1,u.subs.ticks=r,u.inherits.push(r)),u},a.registerElement("slider",a.createSlider),{createSlider:a.createSlider}}),define("element/measure",["jxg","utils/type","base/element","base/point","base/line","base/ticks"],function(a,b,c,d,e,f){"use strict";return a.createTapemeasure=function(d,e,f){var g,h,i,j,k,l,m,n,o,p,q;return g=e[0],h=e[1],i=b.copyAttributes(f,d.options,"tapemeasure","point1"),n=d.create("point",g,i),i=b.copyAttributes(f,d.options,"tapemeasure","point2"),o=d.create("point",h,i),n.setAttribute({ignoredSnapToPoints:[o]}),o.setAttribute({ignoredSnapToPoints:[n]}),i=b.copyAttributes(f,d.options,"tapemeasure"),j=i.withticks,k=i.withlabel,l=i.precision,k&&(i.withlabel=!0),m=d.create("segment",[n,o],i),k&&(p=f.name&&""!==f.name?f.name+" = ":"",m.label.setText(function(){return p+b.toFixed(n.Dist(o),l)})),j&&(i=b.copyAttributes(f,d.options,"tapemeasure","ticks"),q=d.create("ticks",[m,.1],i),m.inherits.push(q)),m.remove=function(){j&&m.removeTicks(q),d.removeObject(o),d.removeObject(n),c.prototype.remove.call(this)},m.Value=function(){return n.Dist(o)},n.dump=!1,o.dump=!1,m.elType="tapemeasure",m.getParents=function(){return[[n.X(),n.Y()],[o.X(),o.Y()]];
},m.subs={point1:n,point2:o},j&&(q.dump=!1),m.methodMap=a.deepCopy(m.methodMap,{Value:"Value"}),m.prepareUpdate().update(),d.isSuspendedUpdate||(m.updateVisibility().updateRenderer(),m.point1.updateVisibility().updateRenderer(),m.point2.updateVisibility().updateRenderer()),m},a.registerElement("tapemeasure",a.createTapemeasure),{createTapemeasure:a.createTapemeasure}}),define("parser/datasource",["jxg","utils/type"],function(a,b){"use strict";return a.DataSource=function(){return this.data=[],this.columnHeaders=[],this.rowHeaders=[],this},a.extend(a.DataSource.prototype,{loadFromArray:function(a,c,d){var e,f,g;if(b.isArray(c)&&(this.columnHeaders=c,c=!1),b.isArray(d)&&(this.rowHeaders=d,d=!1),this.data=[],c&&(this.columnHeaders=[]),d&&(this.rowHeaders=[]),b.exists(a)){for(this.data=[],e=0;e<a.length;e++)for(this.data[e]=[],f=0;f<a[e].length;f++)g=a[e][f],parseFloat(g).toString()===g?this.data[e][f]=parseFloat(g):"-"!==g?this.data[e][f]=g:this.data[e][f]=NaN;if(c&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),d)for(this.rowHeaders=[],e=0;e<this.data.length;e++)this.rowHeaders.push(this.data[e][0]),this.data[e]=this.data[e].slice(1)}return this},loadFromTable:function(a,c,d){var e,f,g,h,i;if(b.isArray(c)&&(this.columnHeaders=c,c=!1),b.isArray(d)&&(this.rowHeaders=d,d=!1),this.data=[],c&&(this.columnHeaders=[]),d&&(this.rowHeaders=[]),a=document.getElementById(a),b.exists(a)){for(e=a.getElementsByTagName("tr"),this.data=[],f=0;f<e.length;f++)for(h=e[f].getElementsByTagName("td"),this.data[f]=[],g=0;g<h.length;g++)i=h[g].innerHTML,parseFloat(i).toString()===i?this.data[f][g]=parseFloat(i):"-"!==i?this.data[f][g]=i:this.data[f][g]=NaN;if(c&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),d)for(this.rowHeaders=[],f=0;f<this.data.length;f++)this.rowHeaders.push(this.data[f][0]),this.data[f]=this.data[f].slice(1)}return this},addColumn:function(a,b,c){throw new Error("not implemented")},addRow:function(a,b,c){throw new Error("not implemented")},getColumn:function(a){var c,d=[];if(b.isString(a))for(c=0;c<this.columnHeaders.length;c++)if(a===this.columnHeaders[c]){a=c;break}for(c=0;c<this.data.length;c++)this.data[c].length>a&&(d[c]=parseFloat(this.data[c][a]));return d},getRow:function(a){var c,d;if(b.isString(a))for(d=0;d<this.rowHeaders.length;d++)if(a===this.rowHeaders[d]){a=d;break}for(c=[],d=0;d<this.data[a].length;d++)c[d]=this.data[a][d];return c}}),a.DataSource}),define("base/chart",["jxg","math/numerics","math/statistics","base/constants","base/coords","base/element","parser/datasource","utils/color","utils/type","utils/env","base/curve","base/point","base/text","base/polygon","element/sector","base/transformation","base/line","base/circle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){"use strict";return a.Chart=function(a,b,c){this.constructor(a,c);var d,e,f,g,h,j;if(!i.isArray(b)||0===b.length)throw new Error("JSXGraph: Can't create a chart without data");if(this.elements=[],i.isNumber(b[0]))for(e=b,d=[],f=0;f<e.length;f++)d[f]=f+1;else if(1===b.length&&i.isArray(b[0]))for(e=b[0],d=[],j=i.evaluate(e).length,f=0;f<j;f++)d[f]=f+1;else 2===b.length&&(j=Math.min(b[0].length,b[1].length),d=b[0].slice(0,j),e=b[1].slice(0,j));if(i.isArray(e)&&0===e.length)throw new Error("JSXGraph: Can't create charts without data.");for(h=c.chartstyle.replace(/ /g,"").split(","),f=0;f<h.length;f++){switch(h[f]){case"bar":g=this.drawBar(a,d,e,c);break;case"line":g=this.drawLine(a,d,e,c);break;case"fit":g=this.drawFit(a,d,e,c);break;case"spline":g=this.drawSpline(a,d,e,c);break;case"pie":g=this.drawPie(a,e,c);break;case"point":g=this.drawPoints(a,d,e,c);break;case"radar":g=this.drawRadar(a,b,c)}this.elements.push(g)}return this.id=this.board.setId(this,"Chart"),this.elements},a.Chart.prototype=new f,a.extend(a.Chart.prototype,{drawLine:function(a,b,c,d){return d.fillcolor="none",d.highlightfillcolor="none",a.create("curve",[b,c],d)},drawSpline:function(a,b,c,d){return d.fillColor="none",d.highlightfillcolor="none",a.create("spline",[b,c],d)},drawFit:function(a,c,d,e){var f=e.degree;return f=Math.max(parseInt(f,10),1)||1,e.fillcolor="none",e.highlightfillcolor="none",a.create("functiongraph",[b.regressionPolynomial(f,c,d)],e)},drawBar:function(a,b,c,d){var e,f,g,h,j,k,l,m,n,o,p=[],q=[],r=function(a,c){return function(){return b[a]()-c*g}},s={fixed:!0,withLabel:!1,visible:!1,name:""};if(n=i.copyAttributes(d,a.options,"chart"),n&&n.width)g=n.width;else{if(b.length<=1)g=1;else for(g=b[1]-b[0],e=1;e<b.length-1;e++)g=b[e+1]-b[e]<g?b[e+1]-b[e]:g;g*=.8}for(o=i.copyAttributes(d,a.options,"chart","label"),e=0;e<b.length;e++)i.isFunction(b[e])?(h=r(e,-.5),j=r(e,0),k=r(e,.5)):(h=b[e]-.5*g,j=b[e],k=b[e]+.5*g),l=i.isFunction(c[e])?c[e]():c[e],l=c[e],"horizontal"===n.dir?(q[0]=a.create("point",[0,h],s),q[1]=a.create("point",[l,h],s),q[2]=a.create("point",[l,k],s),q[3]=a.create("point",[0,k],s),i.exists(n.labels)&&i.exists(n.labels[e])&&(o.anchorY="middle",f=a.create("text",[l,j,n.labels[e]],o),f.visProp.anchorx=function(a){return function(){return a.X()>=0?"left":"right"}}(f))):(q[0]=a.create("point",[h,0],s),q[1]=a.create("point",[h,l],s),q[2]=a.create("point",[k,l],s),q[3]=a.create("point",[k,0],s),i.exists(n.labels)&&i.exists(n.labels[e])&&(o.anchorX="middle",f=a.create("text",[j,l,n.labels[e]],o),f.visProp.anchory=function(a){return function(){return a.Y()>=0?"bottom":"top"}}(f))),i.isArray(n.colors)&&(m=n.colors,n.fillcolor=m[e%m.length]),p[e]=a.create("polygon",q,n),i.exists(n.labels)&&i.exists(n.labels[e])&&(p[e].text=f);return p},drawPoints:function(a,b,c,d){var e,f=[],g=d.infoboxarray;for(d.fixed=!0,d.name="",e=0;e<b.length;e++)d.infoboxtext=!!g&&g[e%g.length],f[e]=a.create("point",[b[e],c[e]],d);return f},drawPie:function(a,b,f){var g,h,j=[],k=[],l=(c.sum(b),f.colors),m=f.highlightcolors,n=f.labels,o=f.radius||4,p=o,q=f.center||[0,0],r=q[0],s=q[1],t=function(a,c,d){return function(){var e,f,g,h=0;for(f=0;f<=a;f++)h+=parseFloat(i.evaluate(b[f]));for(e=h,f=a+1;f<b.length;f++)e+=parseFloat(i.evaluate(b[f]));return g=0!==e?2*Math.PI*h/e:0,p()*Math[c](g)+d}},u=function(a,b){var c=-this.point1.coords.usrCoords[1]+this.point2.coords.usrCoords[1],f=-this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[2];i.exists(this.label)&&(this.label.rendNode.style.fontSize=b*i.evaluate(this.label.visProp.fontsize)+"px",this.label.fullUpdate()),this.point2.coords=new e(d.COORDS_BY_USER,[this.point1.coords.usrCoords[1]+c*a,this.point1.coords.usrCoords[2]+f*a],this.board),this.fullUpdate()},v=function(){this.highlighted||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this),u.call(this,1.1,2))},w=function(){this.highlighted&&(this.highlighted=!1,this.board.renderer.noHighlight(this),u.call(this,.9090909,1))},x={fixed:!0,withLabel:!1,visible:!1,name:""};if(!i.isArray(n))for(n=[],g=0;g<b.length;g++)n[g]="";for(i.isFunction(o)||(p=function(){return o}),f.highlightonsector=f.highlightonsector||!1,f.straightfirst=!1,f.straightlast=!1,h=a.create("point",[r,s],x),j[0]=a.create("point",[function(){return p()+r},function(){return s}],x),g=0;g<b.length;g++)j[g+1]=a.create("point",[t(g,"cos",r),t(g,"sin",s)],x),f.name=n[g],f.withlabel=""!==f.name,f.fillcolor=l&&l[g%l.length],f.labelcolor=l&&l[g%l.length],f.highlightfillcolor=m&&m[g%m.length],k[g]=a.create("sector",[h,j[g],j[g+1]],f),f.highlightonsector&&(k[g].hasPoint=k[g].hasPointSector),f.highlightbysize&&(k[g].highlight=v,k[g].noHighlight=w);return{sectors:k,points:j,midpoint:h}},drawRadar:function(b,c,f){var g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$=c.length,_=function(){var a,b,c,f,g=i.evaluate(this.visProp.label.offset).slice(0);return a=this.point1.X(),b=this.point2.X(),c=this.point1.Y(),f=this.point2.Y(),b<a&&(g[0]=-g[0]),f<c&&(g[1]=-g[1]),this.setLabelRelativeCoords(g),new e(d.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)},aa=function(a,c){var d,e,f;return d=b.create("transform",[-(v[c]-t[c]),0],{type:"translate"}),e=b.create("transform",[A/(w[c]+u[c]-(v[c]-t[c])),1],{type:"scale"}),d.melt(e),f=b.create("transform",[a],{type:"rotate"}),d.melt(f),d};if($<=0)return void a.debug("No data");if(j=f.paramarray,!i.exists(j))return void a.debug("Need paramArray attribute");if(k=j.length,k<=1)return void a.debug("Need more than 1 param");for(g=0;g<$;g++)if(k!==c[g].length)return void a.debug("Use data length equal to number of params ("+c[g].length+" != "+k+")");for(l=[],m=[],h=0;h<k;h++)l[h]=c[0][h],m[h]=l[h];for(g=1;g<$;g++)for(h=0;h<k;h++)c[g][h]>l[h]&&(l[h]=c[g][h]),c[g][h]<m[h]&&(m[h]=c[g][h]);for(n=[],o=[],g=0;g<$;g++)n[g]="",o[g]=[];for(p=[],q=[],r=f.startshiftratio||0,s=f.endshiftratio||0,g=0;g<k;g++)p[g]=(l[g]-m[g])*r,q[g]=(l[g]-m[g])*s;if(t=f.startshiftarray||p,u=f.endshiftarray||q,v=f.startarray||m,i.exists(f.start))for(g=0;g<k;g++)v[g]=f.start;if(w=f.endarray||l,i.exists(f.end))for(g=0;g<k;g++)w[g]=f.end;if(t.length!==k)return void a.debug("Start shifts length is not equal to number of parameters");if(u.length!==k)return void a.debug("End shifts length is not equal to number of parameters");if(v.length!==k)return void a.debug("Starts length is not equal to number of parameters");if(w.length!==k)return void a.debug("Ends length is not equal to number of parameters");for(x=f.labelarray||n,y=f.colors,z=f.highlightcolors,A=f.radius||10,Y=f.strokewidth||1,i.exists(f.highlightonsector)||(f.highlightonsector=!1),B={name:f.name,id:f.id,strokewidth:Y,polystrokewidth:f.polystrokewidth||Y,strokecolor:f.strokecolor||"black",straightfirst:!1,straightlast:!1,fillcolor:f.fillColor||"#FFFF88",fillopacity:f.fillOpacity||.4,highlightfillcolor:f.highlightFillColor||"#FF7400",highlightstrokecolor:f.highlightStrokeColor||"black",gradient:f.gradient||"none"},C=f.center||[0,0],D=C[0],E=C[1],F=b.create("point",[D,E],{name:"",fixed:!0,withlabel:!1,visible:!1}),G=Math.PI/2-Math.PI/k,G=f.startangle||0,H=G,I=[],J=[],g=0;g<k;g++)for(H+=2*Math.PI/k,L=A*Math.cos(H)+D,M=A*Math.sin(H)+E,I[g]=b.create("point",[L,M],{name:"",fixed:!0,withlabel:!1,visible:!1}),J[g]=b.create("line",[F,I[g]],{name:j[g],strokeColor:B.strokecolor,strokeWidth:B.strokewidth,strokeOpacity:1,straightFirst:!1,straightLast:!1,withLabel:!0,highlightStrokeColor:B.highlightstrokecolor}),J[g].getLabelAnchor=_,K=aa(H,g),h=0;h<c.length;h++)Z=c[h][g],o[h][g]=b.create("point",[Z,0],{name:"",fixed:!0,withlabel:!1,visible:!1}),o[h][g].addTransform(o[h][g],K);for(N=[],g=0;g<$;g++)for(B.labelcolor=y&&y[g%y.length],B.strokecolor=y&&y[g%y.length],B.fillcolor=y&&y[g%y.length],N[g]=b.create("polygon",o[g],{withLines:!0,withLabel:!1,fillColor:B.fillcolor,fillOpacity:B.fillopacity,highlightFillColor:B.highlightfillcolor}),h=0;h<k;h++)N[g].borders[h].setAttribute("strokecolor:"+y[g%y.length]),N[g].borders[h].setAttribute("strokewidth:"+B.polystrokewidth);switch(O=f.legendposition||"none"){case"right":Q=f.legendleftoffset||2,R=f.legendtopoffset||1,this.legend=b.create("legend",[D+A+Q,E+A-R],{labels:x,colors:y});break;case"none":break;default:a.debug("Unknown legend position")}if(P=[],f.showcircles){for(S=[],g=0;g<6;g++)S[g]=20*g;if(S[0]="0",T=f.circlelabelarray||S,U=T.length,U<2)return void a.debug("Too less circles");for(V=[],W=G+Math.PI/k,K=aa(W,0),B.fillcolor="none",B.highlightfillcolor="none",B.strokecolor=f.strokecolor||"black",B.strokewidth=f.circlestrokewidth||.5,B.layer=0,X=(w[0]-v[0])/(U-1),g=0;g<U;g++)V[g]=b.create("point",[v[0]+g*X,0],{name:T[g],size:0,fixed:!0,withLabel:!0,visible:!0}),V[g].addTransform(V[g],K),P[g]=b.create("circle",[F,V[g]],B)}return this.rendNode=N[0].rendNode,{circles:P,lines:J,points:o,midpoint:F,polygons:N}},updateRenderer:function(){return this},update:function(){return this.needsUpdate&&this.updateDataArray(),this},updateDataArray:function(){}}),a.createChart=function(b,c,d){var e,f,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=[],z=j.isBrowser?b.document.getElementById(c[0]):null;if(1===c.length&&i.isString(c[0])){if(i.exists(z)){if(q=i.copyAttributes(d,b.options,"chart"),z=(new g).loadFromTable(c[0],q.withheaders,q.withheaders),e=z.data,m=z.columnHeaders,f=z.rowHeaders,r=q.width,s=q.name,t=q.strokecolor,u=q.fillcolor,v=q.highlightstrokecolor,w=q.highlightfillcolor,b.suspendUpdate(),x=e.length,p=[],q.rows&&i.isArray(q.rows)){for(k=0;k<x;k++)for(l=0;l<q.rows.length;l++)if(q.rows[l]===k||q.withheaders&&q.rows[l]===f[k]){p.push(e[k]);break}}else p=e;for(x=p.length,k=0;k<x;k++){if(o=[],q.chartstyle&&q.chartstyle.indexOf("bar")!==-1){for(n=r?r:.8,o.push(1-n/2+(k+.5)*n/x),l=1;l<p[k].length;l++)o.push(o[l-1]+1);q.width=n/x}s&&s.length===x?q.name=s[k]:q.withheaders&&(q.name=m[k]),t&&t.length===x?q.strokecolor=t[k]:q.strokecolor=h.hsv2rgb((k+1)/x*360,.9,.6),u&&u.length===x?q.fillcolor=u[k]:q.fillcolor=h.hsv2rgb((k+1)/x*360,.9,1),v&&v.length===x?q.highlightstrokecolor=v[k]:q.highlightstrokecolor=h.hsv2rgb((k+1)/x*360,.9,1),w&&w.length===x?q.highlightfillcolor=w[k]:q.highlightfillcolor=h.hsv2rgb((k+1)/x*360,.9,.6),q.chartstyle&&q.chartstyle.indexOf("bar")!==-1?y.push(new a.Chart(b,[o,p[k]],q)):y.push(new a.Chart(b,[p[k]],q))}b.unsuspendUpdate()}return y}return q=i.copyAttributes(d,b.options,"chart"),new a.Chart(b,c,q)},a.registerElement("chart",a.createChart),a.Legend=function(a,b,c){var f;if(this.constructor(),f=i.copyAttributes(c,a.options,"legend"),this.board=a,this.coords=new e(d.COORDS_BY_USER,b,this.board),this.myAtts={},this.label_array=f.labelarray||f.labels,this.color_array=f.colorarray||f.colors,this.lines=[],this.myAtts.strokewidth=f.strokewidth||5,this.myAtts.straightfirst=!1,this.myAtts.straightlast=!1,this.myAtts.withlabel=!0,this.myAtts.fixed=!0,this.style=f.legendstyle||f.style,"vertical"!==this.style)throw new Error("JSXGraph: Unknown legend style: "+this.style);this.drawVerticalLegend(a,f)},a.Legend.prototype=new f,a.Legend.prototype.drawVerticalLegend=function(a,b){var c,f=b.linelength||1,g=(b.rowheight||20)/this.board.unitY,h=function(){return this.setLabelRelativeCoords(this.visProp.label.offset),new e(d.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)};for(c=0;c<this.label_array.length;c++)this.myAtts.strokecolor=this.color_array[c],this.myAtts.highlightstrokecolor=this.color_array[c],this.myAtts.name=this.label_array[c],this.myAtts.label={offset:[10,0],strokeColor:this.color_array[c],strokeWidth:this.myAtts.strokewidth},this.lines[c]=a.create("line",[[this.coords.usrCoords[1],this.coords.usrCoords[2]-c*g],[this.coords.usrCoords[1]+f,this.coords.usrCoords[2]-c*g]],this.myAtts),this.lines[c].getLabelAnchor=h},a.createLegend=function(b,c,d){var e=[0,0];return i.exists(c)&&2===c.length&&(e=c),new a.Legend(b,e,d)},a.registerElement("legend",a.createLegend),{Chart:a.Chart,Legend:a.Legend,createChart:a.createChart,createLegend:a.createLegend}}),define("base/turtle",["jxg","base/constants","base/element","utils/type","base/curve","base/point","base/line","base/transformation"],function(a,b,c,d,e,f,g,h){"use strict";return a.Turtle=function(a,c,e){var f,g,h;return this.constructor(a,e,b.OBJECT_TYPE_TURTLE,b.OBJECT_CLASS_OTHER),this.turtleIsHidden=!1,this.board=a,this.visProp.curveType="plot",this._attributes=d.copyAttributes(this.visProp,a.options,"turtle"),delete this._attributes.id,f=0,g=0,h=90,0!==c.length&&(3===c.length?(f=c[0],g=c[1],h=c[2]):2===c.length?d.isArray(c[0])?(f=c[0][0],g=c[0][1],h=c[1]):(f=c[0],g=c[1]):(f=c[0][0],g=c[0][1])),this.init(f,g,h),this.methodMap=d.deepCopy(this.methodMap,{forward:"forward",fd:"forward",back:"back",bk:"back",right:"right",rt:"right",left:"left",lt:"left",penUp:"penUp",pu:"penUp",penDown:"penDown",pd:"penDown",clearScreen:"clearScreen",cs:"clearScreen",clean:"clean",setPos:"setPos",home:"home",hideTurtle:"hideTurtle",ht:"hideTurtle",showTurtle:"showTurtle",st:"showTurtle",penSize:"setPenSize",penColor:"setPenColor",pushTurtle:"pushTurtle",push:"pushTurtle",popTurtle:"popTurtle",pop:"popTurtle",lookTo:"lookTo",pos:"pos",moveTo:"moveTo",X:"X",Y:"Y"}),this},a.Turtle.prototype=new c,a.extend(a.Turtle.prototype,{init:function(a,b,c){var d={fixed:!0,name:"",visible:!1,withLabel:!1};this.arrowLen=20/Math.sqrt(this.board.unitX*this.board.unitX+this.board.unitY*this.board.unitY),this.pos=[a,b],this.isPenDown=!0,this.dir=90,this.stack=[],this.objects=[],this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.turtle=this.board.create("point",this.pos,d),this.objects.push(this.turtle),this.turtle2=this.board.create("point",[this.pos[0],this.pos[1]+this.arrowLen],d),this.objects.push(this.turtle2),this.visProp.arrow.lastArrow=!0,this.visProp.arrow.straightFirst=!1,this.visProp.arrow.straightLast=!1,this.arrow=this.board.create("line",[this.turtle,this.turtle2],this.visProp.arrow),this.objects.push(this.arrow),this.subs={arrow:this.arrow},this.inherits.push(this.arrow),this.right(90-c),this.board.update()},forward:function(a){if(0===a)return this;var b,c=a*Math.cos(this.dir*Math.PI/180),d=a*Math.sin(this.dir*Math.PI/180);return this.turtleIsHidden||(b=this.board.create("transform",[c,d],{type:"translate"}),b.applyOnce(this.turtle),b.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]+=c,this.pos[1]+=d,this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update(),this},back:function(a){return this.forward(-a)},right:function(a){if(this.dir-=a,this.dir%=360,!this.turtleIsHidden){var b=this.board.create("transform",[-a*Math.PI/180,this.turtle],{type:"rotate"});b.applyOnce(this.turtle2)}return this.board.update(),this},left:function(a){return this.right(-a)},penUp:function(){return this.isPenDown=!1,this},penDown:function(){return this.isPenDown=!0,this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this},clean:function(){var a,c;for(a=0;a<this.objects.length;a++)c=this.objects[a],c.type===b.OBJECT_TYPE_CURVE&&(this.board.removeObject(c),this.objects.splice(a,1));return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},clearScreen:function(){var a,b,c=this.objects.length;for(a=0;a<c;a++)b=this.objects[a],this.board.removeObject(b);return this.init(0,0,90),this},setPos:function(a,c){var e;return d.isArray(a)?this.pos=a:this.pos=[a,c],this.turtleIsHidden||(this.turtle.setPositionDirectly(b.COORDS_BY_USER,[a,c]),this.turtle2.setPositionDirectly(b.COORDS_BY_USER,[a,c+this.arrowLen]),e=this.board.create("transform",[-(this.dir-90)*Math.PI/180,this.turtle],{type:"rotate"}),e.applyOnce(this.turtle2)),this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},setPenSize:function(a){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeWidth",a)),this.objects.push(this.curve),this},setPenColor:function(a){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeColor",a)),this.objects.push(this.curve),this},setHighlightPenColor:function(a){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("highlightStrokeColor",a)),this.objects.push(this.curve),this},setAttribute:function(a){var c,e,f,g=this.objects.length;for(c=0;c<g;c++)e=this.objects[c],e.type===b.OBJECT_TYPE_CURVE&&e.setAttribute(a);return f=this.visProp.id,this.visProp=d.deepCopy(this.curve.visProp),this.visProp.id=f,this._attributes=d.deepCopy(this.visProp),delete this._attributes.id,this},copyAttr:function(a,b){return this._attributes[a.toLowerCase()]=b,this._attributes},showTurtle:function(){return this.turtleIsHidden=!1,this.arrow.setAttribute({visible:!0}),this.visProp.arrow.visible=!1,this.setPos(this.pos[0],this.pos[1]),this.board.update(),this},hideTurtle:function(){return this.turtleIsHidden=!0,this.arrow.setAttribute({visible:!1}),this.visProp.arrow.visible=!1,this.board.update(),this},home:function(){return this.pos=[0,0],this.setPos(this.pos[0],this.pos[1]),this},pushTurtle:function(){return this.stack.push([this.pos[0],this.pos[1],this.dir]),this},popTurtle:function(){var a=this.stack.pop();return this.pos[0]=a[0],this.pos[1]=a[1],this.dir=a[2],this.setPos(this.pos[0],this.pos[1]),this},lookTo:function(a){var b,c,e,f,g;return d.isArray(a)?(b=this.pos[0],c=this.pos[1],e=a[0],f=a[1],g=Math.atan2(f-c,e-b),this.right(this.dir-180*g/Math.PI)):d.isNumber(a)&&this.right(this.dir-a),this},moveTo:function(a){var b,c,e;return d.isArray(a)&&(b=a[0]-this.pos[0],c=a[1]-this.pos[1],this.turtleIsHidden||(e=this.board.create("transform",[b,c],{type:"translate"}),e.applyOnce(this.turtle),e.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]=a[0],this.pos[1]=a[1],this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update()),this},fd:function(a){return this.forward(a)},bk:function(a){return this.back(a)},lt:function(a){return this.left(a)},rt:function(a){return this.right(a)},pu:function(){return this.penUp()},pd:function(){return this.penDown()},ht:function(){return this.hideTurtle()},st:function(){return this.showTurtle()},cs:function(){return this.clearScreen()},push:function(){return this.pushTurtle()},pop:function(){return this.popTurtle()},evalAt:function(a,c){var d,e,f,g,h=this.objects.length;for(d=0,e=0;d<h;d++)if(f=this.objects[d],f.elementClass===b.OBJECT_CLASS_CURVE){if(e<=a&&a<e+f.numberPoints)return g=a-e,f[c](g);e+=f.numberPoints}return this[c]()},X:function(a){return d.exists(a)?this.evalAt(a,"X"):this.pos[0]},Y:function(a){return d.exists(a)?this.evalAt(a,"Y"):this.pos[1]},Z:function(a){return 1},minX:function(){return 0},maxX:function(){var a,c,d=this.objects.length,e=0;for(a=0;a<d;a++)c=this.objects[a],c.elementClass===b.OBJECT_CLASS_CURVE&&(e+=this.objects[a].numberPoints);return e},hasPoint:function(a,c){var d,e;for(d=0;d<this.objects.length;d++)if(e=this.objects[d],e.type===b.OBJECT_TYPE_CURVE&&e.hasPoint(a,c))return!0;return!1}}),a.createTurtle=function(b,c,e){var f;return c=c||[],f=d.copyAttributes(e,b.options,"turtle"),new a.Turtle(b,c,f)},a.registerElement("turtle",a.createTurtle),{Turtle:a.Turtle,createTurtle:a.createTurtle}}),define("utils/dump",["jxg","utils/type"],function(a,b){"use strict";return a.Dump={addMarkers:function(a,c,d){var e,f,g;b.isArray(c)||(c=[c]),b.isArray(d)||(d=[d]),f=Math.min(c.length,d.length),c.length=f,d.length=f;for(e in a.objects)if(a.objects.hasOwnProperty(e))for(g=0;g<f;g++)a.objects[e][c[g]]=d[g]},deleteMarkers:function(a,c){var d,e,f;b.isArray(c)||(c=[c]),e=c.length,c.length=e;for(d in a.objects)if(a.objects.hasOwnProperty(d))for(f=0;f<e;f++)delete a.objects[d][c[f]]},str:function(a){return"string"==typeof a&&"function"!==a.substr(0,7)&&(a='"'+a+'"'),a},minimizeObject:function(c,d){var e,f,g,h={},i=b.deepCopy(c),j=[];for(g=1;g<arguments.length;g++)j.push(arguments[g]);for(h=b.deepCopy(h,a.Options.elements,!0),g=j.length;g>0;g--)h=b.deepCopy(h,j[g-1],!0);for(e in h)h.hasOwnProperty(e)&&(f=e.toLowerCase(),"object"!=typeof h[e]&&h[e]===i[f]&&(console.log("delete",e),delete i[f]));return i},prepareAttributes:function(b,c){var d,e;d=this.minimizeObject(c.getAttributes(),a.Options[c.elType]);for(e in c.subs)c.subs.hasOwnProperty(e)&&(d[e]=this.minimizeObject(c.subs[e].getAttributes(),a.Options[c.elType][e],a.Options[c.subs[e].elType]),d[e].id=c.subs[e].id,d[e].name=c.subs[e].name);return d.id=c.id,d.name=c.name,d},setBoundingBox:function(a,b,c){return a.push({obj:c,method:"setBoundingBox",params:[b.getBoundingBox(),!0]}),a},dump:function(a){var c,d,e,f,g=[],h=[],i=[],j=a.objectsList.length;for(this.addMarkers(a,"dumped",!1),c=0;c<j;c++)if(d=a.objectsList[c],e={},!d.dumped&&d.dump){for(e.type=d.getType(),e.parents=d.getParents().slice(),"point"===e.type&&1===e.parents[0]&&(e.parents=e.parents.slice(1)),f=0;f<e.parents.length;f++)b.isString(e.parents[f])&&"'"!==e.parents[f][0]&&'"'!==e.parents[f][0]?e.parents[f]='"'+e.parents[f]+'"':b.isArray(e.parents[f])&&(e.parents[f]="["+e.parents[f].toString()+"]");e.attributes=this.prepareAttributes(a,d),"glider"===e.type&&d.onPolygon&&g.push({obj:d.id,prop:"onPolygon",val:!0}),i.push(e)}return this.deleteMarkers(a,"dumped"),{elements:i,props:g,methods:h}},arrayToParamStr:function(a,b){var c,d=[];for(c=0;c<a.length;c++)d.push(b.call(this,a[c]));return d.join(", ")},toJCAN:function(a){var c,d,e;switch(typeof a){case"object":if(a){if(d=[],b.isArray(a)){for(c=0;c<a.length;c++)d.push(this.toJCAN(a[c]));return"["+d.join(",")+"]"}for(e in a)a.hasOwnProperty(e)&&d.push(e+": "+this.toJCAN(a[e]));return"<<"+d.join(", ")+">> "}return"null";case"string":return"'"+a.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return a.toString();case"null":return"null"}},toJessie:function(a){var b,c,d=this.dump(a),e=[];for(d.methods=this.setBoundingBox(d.methods,a,"$board"),c=d.elements,b=0;b<c.length;b++)c[b].attributes.name.length>0&&e.push("// "+c[b].attributes.name),e.push("s"+b+" = "+c[b].type+"("+c[b].parents.join(", ")+") "+this.toJCAN(c[b].attributes).replace(/\n/,"\\n")+";"),e.push("");for(b=0;b<d.methods.length;b++)e.push(d.methods[b].obj+"."+d.methods[b].method+"("+this.arrayToParamStr(d.methods[b].params,this.toJCAN)+");"),e.push("");for(b=0;b<d.props.length;b++)e.push(d.props[b].obj+"."+d.props[b].prop+" = "+this.toJCAN(d.props[b].val)+";"),e.push("");return e.join("\n")},toJavaScript:function(a){var c,d,e=this.dump(a),f=[];for(e.methods=this.setBoundingBox(e.methods,a,"board"),d=e.elements,c=0;c<d.length;c++)f.push('board.create("'+d[c].type+'", ['+d[c].parents.join(", ")+"], "+b.toJSON(d[c].attributes)+");");for(c=0;c<e.methods.length;c++)f.push(e.methods[c].obj+"."+e.methods[c].method+"("+this.arrayToParamStr(e.methods[c].params,b.toJSON)+");"),f.push("");for(c=0;c<e.props.length;c++)f.push(e.props[c].obj+"."+e.props[c].prop+" = "+b.toJSON(e.props[c].val)+";"),f.push("");return f.join("\n")}},a.Dump}),define("element/comb",["jxg","options","utils/type","base/constants","base/line","base/polygon","base/point"],function(a,b,c,d,e,f,g){"use strict";return a.createComb=function(a,b,d){var e,f,h,i,j,k,l,m,n;if(2!==b.length)throw j=b.map(function(a){return"'"+typeof a+"'"}),new Error("JSXGraph: Can't create comb with parent types "+j.join(", ")+".\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");if(c.isArray(b[0])&&b[0].length>1)i=c.copyAttributes(d,a.options,"comb","point1"),e=a.create("point",b[0],i);else if(c.isString(b[0])||c.isPoint(b[0]))e=a.select(b[0]);else if(c.isFunction(b[0])&&c.isPoint(b[0]()))e=b[0]();else{if(!(c.isFunction(b[0])&&b[0]().length&&b[0]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");i=c.copyAttributes(d,a.options,"comb","point1"),e=g.createPoint(a,b[0](),i)}if(c.isArray(b[1])&&b[1].length>1)i=c.copyAttributes(d,a.options,"comb","point2"),f=a.create("point",b[1],i);else if(c.isString(b[1])||c.isPoint(b[1]))f=a.select(b[1]);else if(c.isFunction(b[1])&&c.isPoint(b[1]()))f=b[1]();else{if(!(c.isFunction(b[1])&&b[1]().length&&b[1]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof b[0]+"' and '"+typeof b[1]+"'.\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");i=c.copyAttributes(d,a.options,"comb","point2"),f=g.createPoint(a,b[1](),i)}return i=c.copyAttributes(d,a.options,"comb","curve"),h=a.create("curve",[[0],[0]],i),i=c.copyAttributes(d,a.options,"comb"),k=i.frequency,l=-i.angle,m=i.width,i.reverse&&(n=e,e=f,f=n,l=-l),h.updateDataArray=function(){var a,b,c,d=0,g=e.Dist(f),h=Math.cos(l),i=Math.sin(l),j=(f.X()-e.X())/g,n=(f.Y()-e.Y())/g;for(h*=m/Math.abs(i),i*=m/Math.abs(i),this.dataX=[],this.dataY=[];d<g;)a=e.X()+j*d,b=e.Y()+n*d,c=Math.min(h,g-d)/Math.abs(h),i*=c,h*=c,this.dataX.push(a),this.dataY.push(b),this.dataX.push(a+j*h+n*i),this.dataY.push(b-j*i+n*h),this.dataX.push(NaN),this.dataY.push(NaN),d+=k},h},a.registerElement("comb",a.createComb),{createComb:a.createComb}}),define("element/slopetriangle",["jxg","options","utils/type","base/constants","base/line","base/polygon","base/point","base/element"],function(a,b,c,d,e,f,g,h){"use strict";var i={removeSlopeTriangle:function(){f.Polygon.prototype.remove.call(this),this.board.removeObject(this.toppoint),this.board.removeObject(this.glider),this.board.removeObject(this.baseline),this.board.removeObject(this.basepoint),this.board.removeObject(this.label),this._isPrivateTangent&&this.board.removeObject(this.tangent)},Value:function(){return this.tangent.getSlope()}};return a.createSlopeTriangle=function(b,e,f){var g,h,j,k,l,m,n,o,p,q=!1;if(1===e.length&&e[0].type===d.OBJECT_TYPE_TANGENT)h=e[0],j=h.glider;else if(1===e.length&&e[0].type===d.OBJECT_TYPE_GLIDER)j=e[0],p=c.copyAttributes(f,b.options,"slopetriangle","tangent"),h=b.create("tangent",[j],p),q=!0;else{if(2!==e.length||e[0].elementClass!==d.OBJECT_CLASS_LINE||!c.isPoint(e[1]))throw new Error("JSXGraph: Can't create slope triangle with parent types '"+typeof e[0]+"'.");h=e[0],j=e[1]}return p=c.copyAttributes(f,b.options,"slopetriangle","basepoint"),n=b.create("point",[function(){return[j.X()+1,j.Y()]}],p),p=c.copyAttributes(f,b.options,"slopetriangle","baseline"),m=b.create("line",[j,n],p),p=c.copyAttributes(f,b.options,"slopetriangle","glider"),k=b.create("glider",[j.X()+1,j.Y(),m],p),p=c.copyAttributes(f,b.options,"slopetriangle","toppoint"),l=b.create("point",[function(){return[k.X(),k.Y()+(k.X()-j.X())*h.getSlope()]}],p),p=c.copyAttributes(f,b.options,"slopetriangle"),p.borders=c.copyAttributes(p.borders,b.options,"slopetriangle","borders"),g=b.create("polygon",[j,k,l],p),g.Value=i.Value,g.tangent=h,g._isPrivateTangent=q,g.borders[2].setArrow(!1,!1),p=c.copyAttributes(f,b.options,"slopetriangle","label"),o=b.create("text",[function(){return k.X()+.1},function(){return.5*(k.Y()+l.Y())},function(){return""}],p),o._setText(function(){return c.toFixed(g.Value(),c.evaluate(o.visProp.digits))}),o.fullUpdate(),g.glider=k,g.basepoint=n,g.baseline=m,g.toppoint=l,g.label=o,g.subs={glider:k,basePoint:n,baseLine:m,topPoint:l,label:o},g.inherits.push(k,n,m,l,o),g.methodMap=a.deepCopy(g.methodMap,{tangent:"tangent",glider:"glider",basepoint:"basepoint",baseline:"baseline",toppoint:"toppoint",label:"label",Value:"Value",V:"Value"}),g.remove=i.removeSlopeTriangle,g},a.registerElement("slopetriangle",a.createSlopeTriangle),{createSlopeTriangle:a.createSlopeTriangle}}),define("element/checkbox",["jxg","utils/env","utils/type"],function(a,b,c){"use strict";var d={CheckboxChangeEventHandler:function(){this._value=this.rendNodeCheckbox.checked,this.board.update()}};return a.createCheckbox=function(e,f,g){var h,i,j=c.copyAttributes(g,e.options,"checkbox");return i=[f[0],f[1],'<span style="display:inline"><input type="checkbox" /><label for=""></label></span>'],h=e.create("text",i,j),h.type=c.OBJECT_TYPE_CHECKBOX,h.rendNodeCheckbox=h.rendNode.childNodes[0].childNodes[0],h.rendNodeLabel=h.rendNode.childNodes[0].childNodes[1],h.rendNodeTag=h.rendNodeCheckbox,h.rendNodeTag.disabled=!!j.disabled,h.rendNodeLabel.innerHTML=f[2],h.rendNodeCheckbox.id=h.rendNode.id+"_checkbox",h.rendNodeLabel.id=h.rendNode.id+"_label",h.rendNodeLabel.setAttribute("for",h.rendNodeCheckbox.id),h.visPropOld.fontsize="0px",e.renderer.updateTextStyle(h,!1),h.rendNodeCheckbox.checked=j.checked,h._value=j.checked,h.Value=function(){return this._value},h.update=function(){return this.needsUpdate&&(a.Text.prototype.update.call(this),this._value=this.rendNodeCheckbox.checked),this},b.addEvent(h.rendNodeCheckbox,"change",d.CheckboxChangeEventHandler,h),h},a.registerElement("checkbox",a.createCheckbox),{createCheckbox:a.createCheckbox}}),define("element/input",["jxg","utils/env","utils/type"],function(a,b,c){
"use strict";var d={InputInputEventHandler:function(a){this._value=this.rendNodeInput.value,this.board.update()}};return a.createInput=function(e,f,g){var h,i,j=c.copyAttributes(g,e.options,"input");return i=[f[0],f[1],'<span style="display:inline; white-space:nowrap; padding:0px;"><span></span><input type="text" maxlength="'+j.maxlength+'" style="width:100%"/></span>'],h=e.create("text",i,j),h.type=c.OBJECT_TYPE_INPUT,h.rendNodeLabel=h.rendNode.childNodes[0].childNodes[0],h.rendNodeInput=h.rendNode.childNodes[0].childNodes[1],h.rendNodeLabel.innerHTML=f[3],h.rendNodeInput.value=f[2],h.rendNodeTag=h.rendNodeInput,h.rendNodeTag.disabled=!!j.disabled,h.rendNodeLabel.id=h.rendNode.id+"_label",h.rendNodeInput.id=h.rendNode.id+"_input",h._value=f[2],h.update=function(){return this.needsUpdate&&(a.Text.prototype.update.call(this),this._value=this.rendNodeInput.value),this},h.Value=function(){return this._value},b.addEvent(h.rendNodeInput,"input",d.InputInputEventHandler,h),b.addEvent(h.rendNodeInput,"mousedown",function(a){c.exists(a.stopPropagation)&&a.stopPropagation()},h),b.addEvent(h.rendNodeInput,"touchstart",function(a){c.exists(a.stopPropagation)&&a.stopPropagation()},h),b.addEvent(h.rendNodeInput,"pointerdown",function(a){c.exists(a.stopPropagation)&&a.stopPropagation()},h),h.visPropOld.fontsize="0px",e.renderer.updateTextStyle(h,!1),h},a.registerElement("input",a.createInput),{createInput:a.createInput}}),define("element/button",["jxg","utils/env","utils/type"],function(a,b,c){"use strict";var d={ButtonClickEventHandler:function(){this._handler&&this._handler(),this.board.update()}};return a.createButton=function(e,f,g){var h,i,j=c.copyAttributes(g,e.options,"button");return i=[f[0],f[1],'<button type="button" style="width:100%;"></button>'],h=e.create("text",i,j),h.type=c.OBJECT_TYPE_BUTTON,h.rendNodeButton=h.rendNode.childNodes[0],h.rendNodeButton.id=h.rendNode.id+"_button",h.rendNodeButton.innerHTML=f[2],h.rendNodeTag=h.rendNodeButton,h.rendNodeTag.disabled=!!j.disabled,h.visPropOld.fontsize="0px",e.renderer.updateTextStyle(h,!1),f[3]&&(c.isString(f[3])?(h._jc=new a.JessieCode,h._jc.use(e),h._handler=function(){h._jc.parse(f[3])}):h._handler=f[3]),b.addEvent(h.rendNodeButton,"click",d.ButtonClickEventHandler,h),b.addEvent(h.rendNodeButton,"mousedown",function(a){c.exists(a.stopPropagation)&&a.stopPropagation()},h),b.addEvent(h.rendNodeButton,"touchstart",function(a){c.exists(a.stopPropagation)&&a.stopPropagation()},h),b.addEvent(h.rendNodeButton,"pointerdown",function(a){c.exists(a.stopPropagation)&&a.stopPropagation()},h),h},a.registerElement("button",a.createButton),{createButton:a.createButton}}),define("../build/core-amd.deps.js",["jxg","utils/env","base/constants","utils/type","utils/xml","utils/event","utils/expect","math/math","math/qdt","math/numerics","math/statistics","math/symbolic","math/geometry","math/poly","math/complex","renderer/abstract","renderer/no","reader/file","parser/geonext","base/board","options","jsxgraph","base/element","base/coords","base/point","base/line","base/group","base/circle","element/conic","base/polygon","base/curve","element/arc","element/sector","base/composition","element/composition","element/locus","base/text","base/image","element/slider","element/measure","base/chart","base/transformation","base/turtle","utils/color","base/ticks","utils/zip","utils/base64","utils/uuid","utils/encoding","server/server","element/locus","parser/datasource","parser/jessiecode","utils/dump","renderer/svg","renderer/vml","renderer/canvas","renderer/no","element/comb","element/slopetriangle","element/checkbox","element/input","element/button"],function(a){"use strict";return a}),require("../build/core-amd.deps.js")}());